/*

Siesta 3.0.1
Copyright(c) 2009-2015 Bryntum AB
http://bryntum.com/contact
http://bryntum.com/products/siesta/license

*/
/*

 Copyright (C) 2004-2010 Alex Gorbatchev.

 @license
 Dual licensed under the MIT and GPL licenses.

 Copyright (C) 2004-2010 Alex Gorbatchev.

 @license
 Dual licensed under the MIT and GPL licenses.

 Copyright (C) 2004-2010 Alex Gorbatchev.

 @license
 Dual licensed under the MIT and GPL licenses.
*/
!function(){var f={};f.C="undefined"!=typeof JOOSE_CFG?JOOSE_CFG:{};f.is_IE="\v"=="v";f.is_NodeJS=Boolean("undefined"!=typeof process&&process.pid);f.top=f.is_NodeJS&&global||this;f.stub=function(){return function(){throw Error("Modules can not be instantiated");}};f.VERSION="3.50.1";"undefined"!=typeof module&&(module.exports=f);this.Joose=f;f.A={each:function(a,b,c){c=c||this;for(var d=0,e=a.length;d<e;d++)if(!1===b.call(c,a[d],d))return!1},eachR:function(a,b,c){c=c||this;for(var d=a.length-1;0<=
d;d--)if(!1===b.call(c,a[d],d))return!1},exists:function(a,b){for(var c=0,d=a.length;c<d;c++)if(a[c]==b)return!0;return!1},map:function(a,b,c){c=c||this;for(var d=[],e=0,g=a.length;e<g;e++)d.push(b.call(c,a[e],e));return d},grep:function(a,b){var c=[];f.A.each(a,function(a){b(a)&&c.push(a)});return c},remove:function(a,b){var c=[];f.A.each(a,function(a){a!==b&&c.push(a)});return c}};f.S={saneSplit:function(a,b){var c=(a||"").split(b);1!=c.length||c[0]||c.shift();return c},uppercaseFirst:function(a){return a.substr(0,
1).toUpperCase()+a.substr(1,a.length-1)},strToClass:function(a,b){var c=b||f.top;f.A.each(a.split("."),function(a){if(c)c=c[a];else return!1});return c}};var a=function(){},b=["hasOwnProperty","valueOf","toString","constructor"],c=!0,d;for(d in{toString:1})c=!1;f.O={each:function(a,d,e){e=e||this;for(var g in a)if(!1===d.call(e,a[g],g))return!1;if(c)return f.A.each(b,function(b){if(a.hasOwnProperty(b))return d.call(e,a[b],b)})},eachOwn:function(a,b,c){c=c||this;return f.O.each(a,function(d,e){if(a.hasOwnProperty(e))return b.call(c,
d,e)},c)},copy:function(a,b){b=b||{};f.O.each(a,function(a,c){b[c]=a});return b},copyOwn:function(a,b){b=b||{};f.O.eachOwn(a,function(a,c){b[c]=a});return b},getMutableCopy:function(b){a.prototype=b;return new a},extend:function(a,b){return f.O.copy(b,a)},isEmpty:function(a){for(var b in a)if(a.hasOwnProperty(b))return!1;return!0},isInstance:function(a){return a&&a.meta&&a.constructor==a.meta.c},isClass:function(a){return a&&a.meta&&a.meta.c==a},wantArray:function(a){return a instanceof Array?a:[a]},
isFunction:function(a){return"function"==typeof a&&a.constructor!=/ /.constructor}};f.I={Array:function(){return[]},Object:function(){return{}},Function:function(){return arguments.callee},Now:function(){return new Date}};f.Proto=f.stub();f.Proto.Empty=f.stub();f.Proto.Empty.meta={};(function(){f.Proto.Object=f.stub();var a=function(){var c=a.caller;c==b&&(c=c.caller);if(!c.SUPER)throw"Invalid call to SUPER";return c.SUPER[c.methodName].apply(this,arguments)},b=function(a){return this.SUPER.apply(this,
a)};f.Proto.Object.prototype={SUPERARG:b,SUPER:a,INNER:function(){throw"Invalid call to INNER";},BUILD:function(a){return 1==arguments.length&&"object"==typeof a&&a||{}},initialize:function(){},toString:function(){return"a "+this.meta.name}};f.Proto.Object.meta={constructor:f.Proto.Object,methods:f.O.copy(f.Proto.Object.prototype),attributes:{}};f.Proto.Object.prototype.meta=f.Proto.Object.meta})();(function(){f.Proto.Class=function(){return this.initialize(this.BUILD.apply(this,arguments))||this};
var a={VERSION:null,AUTHORITY:null,constructor:f.Proto.Class,superClass:null,name:null,attributes:null,methods:null,meta:null,c:null,defaultSuperClass:f.Proto.Object,BUILD:function(a,b){this.name=a;return{__extend__:b||{}}},initialize:function(a){a=a.__extend__;this.VERSION=a.VERSION;this.AUTHORITY=a.AUTHORITY;delete a.VERSION;delete a.AUTHORITY;this.c=this.extractConstructor(a);this.adaptConstructor(this.c);a.constructorOnly?delete a.constructorOnly:this.construct(a)},construct:function(a){if(this.prepareProps(a)){var b=
this.superClass=this.extractSuperClass(a);this.processSuperClass(b);this.adaptPrototype(this.c.prototype);this.finalize(a)}},finalize:function(a){this.processStem(a);this.extend(a)},prepareProps:function(a){return!0},extractConstructor:function(a){var b=a.hasOwnProperty("constructor")?a.constructor:this.defaultConstructor();delete a.constructor;return b},extractSuperClass:function(a){if(a.hasOwnProperty("isa")&&!a.isa)throw Error("Attempt to inherit from undefined superclass ["+this.name+"]");var b=
a.isa||this.defaultSuperClass;delete a.isa;return b},processStem:function(){var a=this.superClass.meta;this.methods=f.O.getMutableCopy(a.methods||{});this.attributes=f.O.getMutableCopy(a.attributes||{})},initInstance:function(a,b){f.O.copyOwn(b,a)},defaultConstructor:function(){return function(a){var b=this.BUILD,b=b&&b.apply(this,arguments)||a||{},c=this.meta;c.initInstance(this,b);return c.hasMethod("initialize")&&this.initialize(b)||this}},processSuperClass:function(a){var b=a.prototype;if(!a.meta){var c=
f.O.copy(b);c.isa=f.Proto.Empty;delete c.constructor;c=new this.defaultSuperClass.meta.constructor(null,c);a.meta=b.meta=c;c.c=a}this.c.prototype=f.O.getMutableCopy(b);this.c.superClass=b},adaptConstructor:function(a){a.meta=this;a.hasOwnProperty("toString")||(a.toString=function(){return this.meta.name})},adaptPrototype:function(a){a.constructor=this.c;a.meta=this},addMethod:function(a,b){b.SUPER=this.superClass.prototype;b.methodName=a;this.methods[a]=b;this.c.prototype[a]=b},addAttribute:function(a,
b){this.attributes[a]=b;this.c.prototype[a]=b},removeMethod:function(a){delete this.methods[a];delete this.c.prototype[a]},removeAttribute:function(a){delete this.attributes[a];delete this.c.prototype[a]},hasMethod:function(a){return Boolean(this.methods[a])},hasAttribute:function(a){return void 0!==this.attributes[a]},hasOwnMethod:function(a){return this.hasMethod(a)&&this.methods.hasOwnProperty(a)},hasOwnAttribute:function(a){return this.hasAttribute(a)&&this.attributes.hasOwnProperty(a)},extend:function(a){f.O.eachOwn(a,
function(a,b){"meta"!=b&&"constructor"!=b&&(f.O.isFunction(a)&&!a.meta?this.addMethod(b,a):this.addAttribute(b,a))},this)},subClassOf:function(a,b){return this.subClass(b,null,a)},subClass:function(a,b,c){a=a||{};a.isa=c||this.c;return(new this.constructor(b,a)).c},instantiate:function(){var a=function(){};a.prototype=this.c.prototype;a=new a;return this.c.apply(a,arguments)||a}};f.Proto.Class.prototype=f.O.getMutableCopy(f.Proto.Object.prototype);f.O.extend(f.Proto.Class.prototype,a);f.Proto.Class.prototype.meta=
new f.Proto.Class("Joose.Proto.Class",a);f.Proto.Class.meta.addMethod("isa",function(a){var b=function(){};b.prototype=this.c.prototype;return new b instanceof a})})();f.Managed=f.stub();f.Managed.Property=(new f.Proto.Class("Joose.Managed.Property",{name:null,init:null,value:null,definedIn:null,initialize:function(a){f.Managed.Property.superClass.initialize.call(this,a);this.computeValue()},computeValue:function(){this.value=this.init},preApply:function(a){},postUnApply:function(a){},apply:function(a){a[this.name]=
this.value},isAppliedTo:function(a){return a[this.name]==this.value},unapply:function(a){if(!this.isAppliedTo(a))throw"Unapply of property ["+this.name+"] from ["+a+"] failed";delete a[this.name]},cloneProps:function(){return{name:this.name,init:this.init,definedIn:this.definedIn}},clone:function(a){var b=this.cloneProps();b.name=a||b.name;return new this.constructor(b)}})).c;f.Managed.Property.ConflictMarker=(new f.Proto.Class("Joose.Managed.Property.ConflictMarker",{isa:f.Managed.Property,apply:function(a){throw Error("Attempt to apply ConflictMarker ["+
this.name+"] to ["+a+"]");}})).c;f.Managed.Property.Requirement=(new f.Proto.Class("Joose.Managed.Property.Requirement",{isa:f.Managed.Property,apply:function(a){if(!a.meta.hasMethod(this.name))throw Error("Requirement ["+this.name+"], defined in ["+this.definedIn.definedIn.name+"] is not satisfied for class ["+a+"]");},unapply:function(a){}})).c;f.Managed.Property.Attribute=(new f.Proto.Class("Joose.Managed.Property.Attribute",{isa:f.Managed.Property,slot:null,initialize:function(){f.Managed.Property.Attribute.superClass.initialize.apply(this,
arguments);this.slot=this.name},apply:function(a){a.prototype[this.slot]=this.value},isAppliedTo:function(a){return a.prototype[this.slot]==this.value},unapply:function(a){if(!this.isAppliedTo(a))throw"Unapply of property ["+this.name+"] from ["+a+"] failed";delete a.prototype[this.slot]},clearValue:function(a){delete a[this.slot]},hasValue:function(a){return a.hasOwnProperty(this.slot)},getRawValueFrom:function(a){return a[this.slot]},setRawValueTo:function(a,b){a[this.slot]=b;return this}})).c;
f.Managed.Property.MethodModifier=(new f.Proto.Class("Joose.Managed.Property.MethodModifier",{isa:f.Managed.Property,prepareWrapper:function(){throw"Abstract method [prepareWrapper] of "+this+" was called";},apply:function(a){var b=this.name,c=a.prototype,d=c.hasOwnProperty(b),e=c[b],g=a.meta.superClass.prototype,f=this.prepareWrapper({name:b,modifier:this.value,isOwn:d,originalCall:d?e:function(){return g[b].apply(this,arguments)},superProto:g,target:a});d&&(f.__ORIGINAL__=e);f.__CONTAIN__=this.value;
f.__METHOD__=this;this.value.displayName=this.getDisplayName(a);f.displayName="internal wrapper";c[b]=f},getDisplayName:function(a){return a.meta.name+"["+this.name+"]"},isAppliedTo:function(a){return(a=a.prototype[this.name])&&a.__CONTAIN__==this.value},unapply:function(a){var b=this.name,c=a.prototype,d=c[b].__ORIGINAL__;if(!this.isAppliedTo(a))throw"Unapply of method ["+b+"] from class ["+a+"] failed";d?c[b]=d:delete c[b]}})).c;f.Managed.Property.MethodModifier.Override=(new f.Proto.Class("Joose.Managed.Property.MethodModifier.Override",
{isa:f.Managed.Property.MethodModifier,prepareWrapper:function(a){var b=a.modifier,c=a.originalCall,d=a.superProto,e=d.meta.constructor,g=c;e!=f.Proto.Class&&e!=f.Proto.Object||a.isOwn&&c.IS_OVERRIDE||(g=function(){var a=this.SUPER;this.SUPER=d.SUPER;var b=c.apply(this,arguments);this.SUPER=a;return b});a=function(){var a=this.SUPER;this.SUPER=g;var c=b.apply(this,arguments);this.SUPER=a;return c};a.IS_OVERRIDE=!0;return a},getDisplayName:function(a){return a.meta.name+"[override "+this.name+"]"}})).c;
f.Managed.Property.MethodModifier.Put=(new f.Proto.Class("Joose.Managed.Property.MethodModifier.Put",{isa:f.Managed.Property.MethodModifier.Override,prepareWrapper:function(a){if(a.isOwn)throw"Method ["+a.name+"] is applying over something ["+a.originalCall+"] in class ["+a.target+"]";return f.Managed.Property.MethodModifier.Put.superClass.prepareWrapper.call(this,a)},getDisplayName:function(a){return a.meta.name+"["+this.name+"]"}})).c;f.Managed.Property.MethodModifier.After=(new f.Proto.Class("Joose.Managed.Property.MethodModifier.After",
{isa:f.Managed.Property.MethodModifier,prepareWrapper:function(a){var b=a.modifier,c=a.originalCall;return function(){var a=c.apply(this,arguments);b.apply(this,arguments);return a}},getDisplayName:function(a){return a.meta.name+"[after "+this.name+"]"}})).c;f.Managed.Property.MethodModifier.Before=(new f.Proto.Class("Joose.Managed.Property.MethodModifier.Before",{isa:f.Managed.Property.MethodModifier,prepareWrapper:function(a){var b=a.modifier,c=a.originalCall;return function(){b.apply(this,arguments);
return c.apply(this,arguments)}},getDisplayName:function(a){return a.meta.name+"[before "+this.name+"]"}})).c;f.Managed.Property.MethodModifier.Around=(new f.Proto.Class("Joose.Managed.Property.MethodModifier.Around",{isa:f.Managed.Property.MethodModifier,prepareWrapper:function(a){var b=a.modifier,c=a.originalCall,d,e=function(){return c.apply(d,arguments)};return function(){d=this;var a=[e];a.push.apply(a,arguments);return b.apply(this,a)}},getDisplayName:function(a){return a.meta.name+"[around "+
this.name+"]"}})).c;f.Managed.Property.MethodModifier.Augment=(new f.Proto.Class("Joose.Managed.Property.MethodModifier.Augment",{isa:f.Managed.Property.MethodModifier,prepareWrapper:function(a){var b=function(){var a=[],c=b;do a.push(c.IS_AUGMENT?c.__CONTAIN__:c),c=c.IS_AUGMENT&&(c.__ORIGINAL__||c.SUPER[c.methodName]);while(c);c=this.INNER;this.INNER=function(){var b=a.pop();return b?b.apply(this,arguments):void 0};var d=this.INNER.apply(this,arguments);this.INNER=c;return d};b.methodName=a.name;
b.SUPER=a.superProto;b.IS_AUGMENT=!0;return b},getDisplayName:function(a){return a.meta.name+"[augment "+this.name+"]"}})).c;f.Managed.PropertySet=(new f.Proto.Class("Joose.Managed.PropertySet",{isa:f.Managed.Property,properties:null,propertyMetaClass:f.Managed.Property,initialize:function(a){f.Managed.PropertySet.superClass.initialize.call(this,a);this.properties=a.properties||{}},addProperty:function(a,b){var c=b.meta||this.propertyMetaClass;delete b.meta;b.definedIn=this;b.name=a;return this.properties[a]=
new c(b)},addPropertyObject:function(a){return this.properties[a.name]=a},removeProperty:function(a){var b=this.properties[a];delete this.properties[a];return b},haveProperty:function(a){return null!=this.properties[a]},haveOwnProperty:function(a){return this.haveProperty(a)&&this.properties.hasOwnProperty(a)},getProperty:function(a){return this.properties[a]},each:function(a,b){f.O.each(this.properties,a,b||this)},eachOwn:function(a,b){f.O.eachOwn(this.properties,a,b||this)},eachAll:function(a,b){this.each(a,
b)},cloneProps:function(){var a=f.Managed.PropertySet.superClass.cloneProps.call(this);a.propertyMetaClass=this.propertyMetaClass;return a},clone:function(a){a=this.cleanClone(a);a.properties=f.O.copyOwn(this.properties);return a},cleanClone:function(a){var b=this.cloneProps();b.name=a||b.name;return new this.constructor(b)},alias:function(a){var b=this.properties;f.O.each(a,function(a,c){var d=b[c];d&&this.addPropertyObject(d.clone(a))},this)},exclude:function(a){var b=this.properties;f.A.each(a,
function(a){delete b[a]})},beforeConsumedBy:function(){},flattenTo:function(a){var b=a.properties;this.eachOwn(function(c,d){var e=b[d];e instanceof f.Managed.Property.ConflictMarker||(b.hasOwnProperty(d)&&null!=e?e!=c&&(a.removeProperty(d),a.addProperty(d,{meta:f.Managed.Property.ConflictMarker})):a.addPropertyObject(c))},this)},composeTo:function(a){this.eachOwn(function(b,c){a.haveOwnProperty(c)||a.addPropertyObject(b)})},composeFrom:function(){if(arguments.length){var a=this.cleanClone();f.A.each(arguments,
function(b){var c=!(b instanceof f.Managed.PropertySet),d=c?b.propertySet:b;d.beforeConsumedBy(this,a);if(c){if(b.alias||b.exclude)d=d.clone();b.alias&&d.alias(b.alias);b.exclude&&d.exclude(b.exclude)}d.flattenTo(a)},this);a.composeTo(this)}},preApply:function(a){this.eachOwn(function(b){b.preApply(a)})},apply:function(a){this.eachOwn(function(b){b.apply(a)})},unapply:function(a){this.eachOwn(function(b){b.unapply(a)})},postUnApply:function(a){this.eachOwn(function(b){b.postUnApply(a)})}})).c;var e=
1;f.Managed.PropertySet.Mutable=(new f.Proto.Class("Joose.Managed.PropertySet.Mutable",{isa:f.Managed.PropertySet,ID:null,derivatives:null,opened:null,composedFrom:null,initialize:function(a){f.Managed.PropertySet.Mutable.superClass.initialize.call(this,a);this.opened=1;this.derivatives={};this.ID=e++;this.composedFrom=[]},addComposeInfo:function(){this.ensureOpen();f.A.each(arguments,function(a){this.composedFrom.push(a);(a instanceof f.Managed.PropertySet?a:a.propertySet).derivatives[this.ID]=this},
this)},removeComposeInfo:function(){this.ensureOpen();f.A.each(arguments,function(a){for(var b=0;b<this.composedFrom.length;){var c=this.composedFrom[b],c=c instanceof f.Managed.PropertySet?c:c.propertySet;a==c?(delete c.derivatives[this.ID],this.composedFrom.splice(b,1)):b++}},this)},ensureOpen:function(){if(!this.opened)throw"Mutation of closed property set: ["+this.name+"]";},addProperty:function(a,b){this.ensureOpen();return f.Managed.PropertySet.Mutable.superClass.addProperty.call(this,a,b)},
addPropertyObject:function(a){this.ensureOpen();return f.Managed.PropertySet.Mutable.superClass.addPropertyObject.call(this,a)},removeProperty:function(a){this.ensureOpen();return f.Managed.PropertySet.Mutable.superClass.removeProperty.call(this,a)},composeFrom:function(){this.ensureOpen();return f.Managed.PropertySet.Mutable.superClass.composeFrom.apply(this,this.composedFrom)},open:function(){this.opened++;1==this.opened&&(f.O.each(this.derivatives,function(a){a.open()}),this.deCompose())},close:function(){if(!this.opened)throw"Unmatched 'close' operation on property set: ["+
this.name+"]";1==this.opened&&(this.reCompose(),f.O.each(this.derivatives,function(a){a.close()}));this.opened--},reCompose:function(){this.composeFrom()},deCompose:function(){this.eachOwn(function(a,b){a.definedIn!=this&&this.removeProperty(b)},this)}})).c;f.Managed.StemElement=function(){throw"Modules may not be instantiated.";};f.Managed.StemElement.Attributes=(new f.Proto.Class("Joose.Managed.StemElement.Attributes",{isa:f.Managed.PropertySet.Mutable,propertyMetaClass:f.Managed.Property.Attribute})).c;
f.Managed.StemElement.Methods=(new f.Proto.Class("Joose.Managed.StemElement.Methods",{isa:f.Managed.PropertySet.Mutable,propertyMetaClass:f.Managed.Property.MethodModifier.Put,preApply:function(){},postUnApply:function(){}})).c;f.Managed.StemElement.Requirements=(new f.Proto.Class("Joose.Managed.StemElement.Requirements",{isa:f.Managed.PropertySet.Mutable,propertyMetaClass:f.Managed.Property.Requirement,alias:function(){},exclude:function(){},flattenTo:function(a){this.each(function(b,c){a.haveProperty(c)||
a.addPropertyObject(b)})},composeTo:function(a){this.flattenTo(a)},preApply:function(){},postUnApply:function(){}})).c;f.Managed.StemElement.MethodModifiers=(new f.Proto.Class("Joose.Managed.StemElement.MethodModifiers",{isa:f.Managed.PropertySet.Mutable,propertyMetaClass:null,addProperty:function(a,b){var c=b.meta;delete b.meta;b.definedIn=this;b.name=a;var c=new c(b),d=this.properties;d[a]||(d[a]=[]);d[a].push(c);return c},addPropertyObject:function(a){var b=a.name,c=this.properties;c[b]||(c[b]=
[]);c[b].push(a);return a},removeProperty:function(a){if(this.haveProperty(a)){var b=this.properties,c=b[a].pop();b[a].length||f.Managed.StemElement.MethodModifiers.superClass.removeProperty.call(this,a);return c}},alias:function(){},exclude:function(){},flattenTo:function(a){var b=a.properties;this.each(function(a,c){var d=b[c];null==d&&(d=b[c]=[]);f.A.each(a,function(a){f.A.exists(d,a)||d.push(a)})})},composeTo:function(a){this.flattenTo(a)},deCompose:function(){this.each(function(a,b){for(var c=
0;c<a.length;)a[c].definedIn!=this?a.splice(c,1):c++})},preApply:function(a){},postUnApply:function(a){},apply:function(a){this.each(function(b,c){f.A.each(b,function(b){b.apply(a)})})},unapply:function(a){this.each(function(b,c){for(var d=b.length-1;0<=d;d--)b[d].unapply(a)})}})).c;f.Managed.PropertySet.Composition=(new f.Proto.Class("Joose.Managed.PropertySet.Composition",{isa:f.Managed.PropertySet.Mutable,propertyMetaClass:f.Managed.PropertySet.Mutable,processOrder:null,each:function(a,b){var c=
this.properties;b=b||this;f.A.each(this.processOrder,function(d){a.call(b,c[d],d)})},eachR:function(a,b){var c=this.properties;b=b||this;f.A.eachR(this.processOrder,function(d){a.call(b,c[d],d)})},clone:function(a){var b=this.cleanClone(a);this.each(function(a){b.addPropertyObject(a.clone())});return b},alias:function(a){this.each(function(b){b.alias(a)})},exclude:function(a){this.each(function(b){b.exclude(a)})},flattenTo:function(a){var b=a.properties;this.each(function(c,d){var e=b[d]||a.addProperty(d,
{meta:c.constructor});c.flattenTo(e)})},composeTo:function(a){var b=a.properties;this.each(function(c,d){var e=b[d]||a.addProperty(d,{meta:c.constructor});c.composeTo(e)})},deCompose:function(){this.eachR(function(a){a.open()});f.Managed.PropertySet.Composition.superClass.deCompose.call(this)},reCompose:function(){f.Managed.PropertySet.Composition.superClass.reCompose.call(this);this.each(function(a){a.close()})},unapply:function(a){this.eachR(function(b){b.unapply(a)})}})).c;f.Managed.Stem=(new f.Proto.Class("Joose.Managed.Stem",
{isa:f.Managed.PropertySet.Composition,targetMeta:null,attributesMC:f.Managed.StemElement.Attributes,methodsMC:f.Managed.StemElement.Methods,requirementsMC:f.Managed.StemElement.Requirements,methodsModifiersMC:f.Managed.StemElement.MethodModifiers,processOrder:["attributes","methods","requirements","methodsModifiers"],initialize:function(a){f.Managed.Stem.superClass.initialize.call(this,a);a=this.targetMeta;this.addProperty("attributes",{meta:this.attributesMC,properties:a?a.attributes:{}});this.addProperty("methods",
{meta:this.methodsMC,properties:a?a.methods:{}});this.addProperty("requirements",{meta:this.requirementsMC});this.addProperty("methodsModifiers",{meta:this.methodsModifiersMC})},reCompose:function(){var a=this.targetMeta.c;this.preApply(a);f.Managed.Stem.superClass.reCompose.call(this);this.apply(a)},deCompose:function(){var a=this.targetMeta.c;this.unapply(a);f.Managed.Stem.superClass.deCompose.call(this);this.postUnApply(a)}})).c;f.Managed.Builder=(new f.Proto.Class("Joose.Managed.Builder",{targetMeta:null,
_buildStart:function(a,b){a.stem.open();f.A.each("trait traits removeTrait removeTraits does doesnot doesnt".split(" "),function(c){b[c]&&(this[c](a,b[c]),delete b[c])},this)},_extend:function(a){if(!f.O.isEmpty(a)){var b=this.targetMeta;this._buildStart(b,a);f.O.eachOwn(a,function(a,c){var d=this[c];if(!d)throw Error("Unknown builder ["+c+"] was used during extending of ["+b.c+"]");d.call(this,b,a)},this);this._buildComplete(b,a)}},_buildComplete:function(a,b){a.stem.close()},methods:function(a,
b){f.O.eachOwn(b,function(b,c){a.addMethod(c,b)})},removeMethods:function(a,b){f.A.each(b,function(b){a.removeMethod(b)})},have:function(a,b){f.O.eachOwn(b,function(b,c){a.addAttribute(c,b)})},havenot:function(a,b){f.A.each(b,function(b){a.removeAttribute(b)})},havent:function(a,b){this.havenot(a,b)},after:function(a,b){f.O.each(b,function(b,c){a.addMethodModifier(c,b,f.Managed.Property.MethodModifier.After)})},before:function(a,b){f.O.each(b,function(b,c){a.addMethodModifier(c,b,f.Managed.Property.MethodModifier.Before)})},
override:function(a,b){f.O.each(b,function(b,c){a.addMethodModifier(c,b,f.Managed.Property.MethodModifier.Override)})},around:function(a,b){f.O.each(b,function(b,c){a.addMethodModifier(c,b,f.Managed.Property.MethodModifier.Around)})},augment:function(a,b){f.O.each(b,function(b,c){a.addMethodModifier(c,b,f.Managed.Property.MethodModifier.Augment)})},removeModifier:function(a,b){f.A.each(b,function(b){a.removeMethodModifier(b)})},does:function(a,b){f.A.each(f.O.wantArray(b),function(b){a.addRole(b)})},
doesnot:function(a,b){f.A.each(f.O.wantArray(b),function(b){a.removeRole(b)})},doesnt:function(a,b){this.doesnot(a,b)},trait:function(){this.traits.apply(this,arguments)},traits:function(a,b){if(!a.firstPass){if(!a.meta.isDetached)throw"Can't apply trait to not detached class";a.meta.extend({does:b})}},removeTrait:function(){this.removeTraits.apply(this,arguments)},removeTraits:function(a,b){if(!a.meta.isDetached)throw"Can't remove trait from not detached class";a.meta.extend({doesnot:b})},name:function(a,
b){a.name=b}})).c;f.Managed.Class=(new f.Proto.Class("Joose.Managed.Class",{isa:f.Proto.Class,stem:null,stemClass:f.Managed.Stem,stemClassCreated:!1,builder:null,builderClass:f.Managed.Builder,builderClassCreated:!1,isDetached:!1,firstPass:!0,skipTraitsAnchor:{},BUILD:function(){var a=f.Managed.Class.superClass.BUILD.apply(this,arguments),b=a.__extend__,c=f.O.wantArray(b.trait||b.traits||[]);delete b.trait;delete b.traits;f.A.each(f.O.wantArray(b.does||[]),function(a){a=a.meta instanceof f.Managed.Class?
a:a.role;a.meta.meta.isDetached&&c.push(a.meta.constructor)});c.length&&(b.traits=c);return a},initInstance:function(a,b){f.O.each(this.attributes,function(c,d){c instanceof f.Managed.Attribute?c.initFromConfig(a,b):b.hasOwnProperty(d)&&(a[d]=b[d])})},defaultConstructor:function(){return function(a,b){var c=this.meta,d=a==c.skipTraitsAnchor,e=this.BUILD,e=e&&e.apply(this,d?b:arguments)||(d?b[0]:a)||{},g=e.__extend__||e,f=g.trait||g.traits;if(f||g.detached)if(delete g.trait,delete g.traits,delete g.detached,
!d)return d=c.subClass({does:f||[]},c.name).meta,d.isDetached=!0,d.instantiate(c.skipTraitsAnchor,arguments);c.initInstance(this,e);return c.hasMethod("initialize")&&this.initialize(e)||this}},finalize:function(a){f.Managed.Class.superClass.finalize.call(this,a);this.stem.close();this.afterMutate()},processStem:function(){f.Managed.Class.superClass.processStem.call(this);this.builder=new this.builderClass({targetMeta:this});this.stem=new this.stemClass({name:this.name,targetMeta:this});var a=this.getClassInAttribute("builderClass");
a&&(this.builderClassCreated=!0,this.addAttribute("builderClass",this.subClassOf(a)));if(a=this.getClassInAttribute("stemClass"))this.stemClassCreated=!0,this.addAttribute("stemClass",this.subClassOf(a))},extend:function(a){a.builder&&(this.getBuilderTarget().meta.extend(a.builder),delete a.builder);a.stem&&(this.getStemTarget().meta.extend(a.stem),delete a.stem);this.builder._extend(a);this.firstPass=!1;this.stem.opened||this.afterMutate()},getBuilderTarget:function(){var a=this.getClassInAttribute("builderClass");
if(!a)throw"Attempt to extend a builder on non-meta class";return a},getStemTarget:function(){var a=this.getClassInAttribute("stemClass");if(!a)throw"Attempt to extend a stem on non-meta class";return a},getClassInAttribute:function(a){a=this.getAttribute(a);a instanceof f.Managed.Property.Attribute&&(a=a.value);return a},addMethodModifier:function(a,b,c){var d={};d.init=b;d.meta=c;return this.stem.properties.methodsModifiers.addProperty(a,d)},removeMethodModifier:function(a){return this.stem.properties.methodsModifiers.removeProperty(a)},
addMethod:function(a,b,c){c=c||{};c.init=b;return this.stem.properties.methods.addProperty(a,c)},addAttribute:function(a,b,c){c=c||{};c.init=b;return this.stem.properties.attributes.addProperty(a,c)},removeMethod:function(a){return this.stem.properties.methods.removeProperty(a)},removeAttribute:function(a){return this.stem.properties.attributes.removeProperty(a)},hasMethod:function(a){return this.stem.properties.methods.haveProperty(a)},hasAttribute:function(a){return this.stem.properties.attributes.haveProperty(a)},
hasMethodModifiersFor:function(a){return this.stem.properties.methodsModifiers.haveProperty(a)},hasOwnMethod:function(a){return this.stem.properties.methods.haveOwnProperty(a)},hasOwnAttribute:function(a){return this.stem.properties.attributes.haveOwnProperty(a)},getMethod:function(a){return this.stem.properties.methods.getProperty(a)},getAttribute:function(a){return this.stem.properties.attributes.getProperty(a)},eachRole:function(a,b,c){f.A.each(a,function(a,d){b.call(c||this,a,a.meta instanceof
f.Managed.Class?a:a.role,d)},this)},addRole:function(){this.eachRole(arguments,function(a,b){this.beforeRoleAdd(b);var c=a;b!=a?(c.propertySet=b.meta.stem,delete c.role):c=c.meta.stem;this.stem.addComposeInfo(c)},this)},beforeRoleAdd:function(a){a=a.meta;a.builderClassCreated&&this.getBuilderTarget().meta.extend({does:[a.getBuilderTarget()]});a.stemClassCreated&&this.getStemTarget().meta.extend({does:[a.getStemTarget()]});a.meta.isDetached&&!this.firstPass&&this.builder.traits(this,a.constructor)},
beforeRoleRemove:function(a){a=a.meta;a.builderClassCreated&&this.getBuilderTarget().meta.extend({doesnt:[a.getBuilderTarget()]});a.stemClassCreated&&this.getStemTarget().meta.extend({doesnt:[a.getStemTarget()]});a.meta.isDetached&&!this.firstPass&&this.builder.removeTraits(this,a.constructor)},removeRole:function(){this.eachRole(arguments,function(a,b){this.beforeRoleRemove(b);this.stem.removeComposeInfo(b.meta.stem)},this)},getRoles:function(){return f.A.map(this.stem.composedFrom,function(a){return a instanceof
f.Managed.PropertySet?a.targetMeta.c:a.propertySet})},does:function(a){for(var b=this.getRoles(),c=0;c<b.length;c++)if(a==b[c])return!0;for(c=0;c<b.length;c++)if(b[c].meta.does(a))return!0;b=this.superClass.meta;return this.superClass!=f.Proto.Empty&&b&&b.meta&&b.meta.hasMethod("does")?b.does(a):!1},getMethods:function(){return this.stem.properties.methods},getAttributes:function(){return this.stem.properties.attributes},afterMutate:function(){},getCurrentMethod:function(){for(var a=arguments.callee.caller,
b=0;a&&5>b;a=a.caller,b++)if(a.__METHOD__)return a.__METHOD__;return null}})).c;f.Managed.Role=(new f.Managed.Class("Joose.Managed.Role",{isa:f.Managed.Class,have:{defaultSuperClass:f.Proto.Empty,builderRole:null,stemRole:null},methods:{defaultConstructor:function(){return function(){throw Error("Roles cant be instantiated");}},processSuperClass:function(){if(this.superClass!=this.defaultSuperClass)throw Error("Roles can't inherit from anything");},getBuilderTarget:function(){this.builderRole||(this.builderRole=
(new this.constructor).c,this.builderClassCreated=!0);return this.builderRole},getStemTarget:function(){this.stemRole||(this.stemRole=(new this.constructor).c,this.stemClassCreated=!0);return this.stemRole},addRequirement:function(a){this.stem.properties.requirements.addProperty(a,{})}},stem:{methods:{apply:function(){},unapply:function(){}}},builder:{methods:{requires:function(a,b){f.A.each(f.O.wantArray(b),function(b){a.addRequirement(b)},this)}}}})).c;f.Managed.Attribute=(new f.Managed.Class("Joose.Managed.Attribute",
{isa:f.Managed.Property.Attribute,have:{is:null,builder:null,isPrivate:!1,role:null,publicName:null,setterName:null,getterName:null,readable:!1,writeable:!1,hasGetter:!1,hasSetter:!1,required:!1,canInlineSetRaw:!0,canInlineGetRaw:!0},after:{initialize:function(){var a=this.name;this.publicName=a.replace(/^_+/,"");this.slot=this.isPrivate?"$"+a:a;this.setterName=this.setterName||this.getSetterName();this.getterName=this.getterName||this.getGetterName();this.readable=this.hasGetter=/^r/i.test(this.is);
this.writeable=this.hasSetter=/^.w/i.test(this.is)}},override:{computeValue:function(){var a=this.init;!f.O.isClass(a)&&f.O.isFunction(a)||this.SUPER()},preApply:function(a){a.meta.extend({methods:this.getAccessorsFor(a)})},postUnApply:function(a){a.meta.extend({removeMethods:this.getAccessorsFrom(a)})}},methods:{getAccessorsFor:function(a){a=a.meta;var b=this.setterName,c=this.getterName,d={};this.hasSetter&&!a.hasMethod(b)&&(d[b]=this.getSetter(),d[b].ACCESSOR_FROM=this);this.hasGetter&&!a.hasMethod(c)&&
(d[c]=this.getGetter(),d[c].ACCESSOR_FROM=this);return d},getAccessorsFrom:function(a){var b=a.meta;a=this.setterName;var c=this.getterName,d=this.hasSetter&&b.getMethod(a),b=this.hasGetter&&b.getMethod(c),e=[];d&&d.value.ACCESSOR_FROM==this&&e.push(a);b&&b.value.ACCESSOR_FROM==this&&e.push(c);return e},getGetterName:function(){return"get"+f.S.uppercaseFirst(this.publicName)},getSetterName:function(){return"set"+f.S.uppercaseFirst(this.publicName)},getSetter:function(){var a=this,b=a.slot;return a.canInlineSetRaw?
function(a){this[b]=a;return this}:function(){return a.setRawValueTo.apply(this,arguments)}},getGetter:function(){var a=this,b=a.slot;return a.canInlineGetRaw?function(a){return this[b]}:function(){return a.getRawValueFrom.apply(this,arguments)}},getValueFrom:function(a){var b=this.getterName;return this.readable&&a.meta.hasMethod(b)?a[b]():this.getRawValueFrom(a)},setValueTo:function(a,b){var c=this.setterName;if(this.writeable&&a.meta.hasMethod(c))a[c](b);else this.setRawValueTo(a,b)},initFromConfig:function(a,
b){var c=this.name,d,e=!1;if(b.hasOwnProperty(c))d=b[c],e=!0;else{var g=this.init;f.O.isFunction(g)&&!f.O.isClass(g)?(d=g.call(a,b,c),e=!0):this.builder&&(d=a[this.builder.replace(/^this\./,"")](b,c),e=!0)}if(e)this.setRawValueTo(a,d);else if(this.required)throw Error("Required attribute ["+c+"] is missed during initialization of "+a);}}})).c;f.Managed.Attribute.Builder=(new f.Managed.Role("Joose.Managed.Attribute.Builder",{have:{defaultAttributeClass:f.Managed.Attribute},builder:{methods:{has:function(a,
b){f.O.eachOwn(b,function(b,c){if("object"!=typeof b||null==b||b.constructor==/ /.constructor)b={init:b};b.meta=b.meta||a.defaultAttributeClass;/^__/.test(c)&&(c=c.replace(/^_+/,""),b.isPrivate=!0);a.addAttribute(c,b.init,b)},this)},hasnot:function(a,b){this.havenot(a,b)},hasnt:function(a,b){this.hasnot(a,b)}}}})).c;f.Managed.My=(new f.Managed.Role("Joose.Managed.My",{have:{myClass:null,needToReAlias:!1},methods:{createMy:function(a){var b=this instanceof f.Managed.Role,c=a.my||{};delete a.my;a=this.superClass.meta.myClass;
b||(c.isa||!a)||(c.isa=a);c.meta||c.isa||(c.meta=this.constructor);c.name=this.name+".my";c=this.myClass=g(c);a=this.c;a.prototype.my=a.my=b?c:new c({HOST:a});this.needToReAlias=!0},aliasStaticMethods:function(){this.needToReAlias=!1;var a=this.c,b=this.myClass.prototype;f.O.eachOwn(a,function(b,c){b.IS_ALIAS&&delete a[c]});this.myClass.meta.stem.properties.methods.each(function(c,d){a[d]||((a[d]=function(){return b[d].apply(a.my,arguments)}).IS_ALIAS=!0)})}},override:{extend:function(a){var b=this.myClass;
!b&&this.superClass.meta.myClass&&this.createMy(a);a.my&&(b?(this.needToReAlias=!0,b.meta.extend(a.my),delete a.my):this.createMy(a));this.SUPER(a);!this.needToReAlias||this instanceof f.Managed.Role||this.aliasStaticMethods()}},before:{addRole:function(){var a;f.A.each(arguments,function(b){if(!b)throw Error("Attempt to consume an undefined Role into ["+this.name+"]");b=b.meta instanceof f.Managed.Class?b:b.role;b.meta.meta.hasAttribute("myClass")&&b.meta.myClass&&(this.myClass?(a=this.myClass.meta.stem,
a.opened||a.open(),a.addComposeInfo(b.my.meta.stem)):this.createMy({my:{does:b.meta.myClass}}))},this);a&&(a.close(),this.needToReAlias=!0)},removeRole:function(){if(this.myClass){var a=this.myClass.meta.stem;a.open();f.A.each(arguments,function(b){b.meta.meta.hasAttribute("myClass")&&b.meta.myClass&&(a.removeComposeInfo(b.my.meta.stem),this.needToReAlias=!0)},this);a.close()}}}})).c;f.Namespace=f.stub();f.Namespace.Able=(new f.Managed.Role("Joose.Namespace.Able",{have:{bodyFunc:null},before:{extend:function(a){a.body&&
(this.bodyFunc=a.body,delete a.body)}},after:{afterMutate:function(){var a=this.bodyFunc;delete this.bodyFunc;a&&f.Namespace.Manager.my.executeIn(this.c,a)}}})).c;f.Managed.Bootstrap=(new f.Managed.Role("Joose.Managed.Bootstrap",{does:[f.Namespace.Able,f.Managed.My,f.Managed.Attribute.Builder]})).c;f.Meta=f.stub();f.Meta.Object=(new f.Proto.Class("Joose.Meta.Object",{isa:f.Proto.Object})).c;f.Meta.Class=(new f.Managed.Class("Joose.Meta.Class",{isa:f.Managed.Class,does:f.Managed.Bootstrap,have:{defaultSuperClass:f.Meta.Object}})).c;
f.Meta.Role=(new f.Meta.Class("Joose.Meta.Role",{isa:f.Managed.Role,does:f.Managed.Bootstrap})).c;f.Namespace.Keeper=(new f.Meta.Class("Joose.Namespace.Keeper",{isa:f.Meta.Class,have:{externalConstructor:null},methods:{defaultConstructor:function(){return function(){var a=arguments.callee.meta;if(a instanceof f.Namespace.Keeper)throw Error("Module ["+a.c+"] may not be instantiated. Forgot to 'use' the class with the same name?");var b=a.externalConstructor;if("function"==typeof b)return b.meta=a,
b.apply(this,arguments);throw"NamespaceKeeper of ["+a.name+"] was planted incorrectly.";}},plant:function(a){var b=this.c;b.meta=a.meta;b.meta.c=b;b.meta.externalConstructor=a}}})).c;f.Namespace.Manager=(new f.Managed.Class("Joose.Namespace.Manager",{have:{current:null},methods:{initialize:function(){this.current=[f.top]},getCurrent:function(){return this.current[0]},executeIn:function(a,b){var c=this.current;c.unshift(a);var d=b.call(a,a);c.shift();return d},earlyCreate:function(a,b,c){c.constructorOnly=
!0;return(new b(a,c)).c},create:function(a,b,c){if(!a)return(new b(a,c)).c;var d=this;if(/^\./.test(a))return this.executeIn(f.top,function(){return d.create(a.replace(/^\./,""),b,c)});for(var e=c||{},g=f.S.saneSplit(a,"."),s=this.getCurrent(),t=s==f.top?[]:f.S.saneSplit(s.meta.name,"."),w=0;w<g.length;w++){var y=g[w],z=w==g.length-1;if("meta"==y||"my"==y||!y)throw"Module name ["+a+"] may not include a part called 'meta' or 'my' or empty part.";var C=s[y];t.push(y);var M=t.join("."),H=!1;if("undefined"==
typeof C)z?(C=this.earlyCreate(M,b,e),H=!0):C=(new f.Namespace.Keeper(M)).c,s[y]=C;else if(z&&C&&C.meta)if(s=C.meta,b==f.Namespace.Keeper)s.extend(e);else if(s instanceof f.Namespace.Keeper)s.plant(this.earlyCreate(M,b,e)),H=!0;else throw Error("Double declaration of ["+M+"]");else if(z&&!(C&&C.meta&&C.meta.meta))throw"Trying to setup module "+M+" failed. There is already something: "+C;z&&this.prepareMeta(C.meta);H&&C.meta.construct(e);s=C}return s},prepareMeta:function(){},prepareProperties:function(a,
b,c,d){a&&"string"!=typeof a&&(b=a,a=null);var e;b&&b.meta&&(e=b.meta,delete b.meta);e||(e=b&&"function"==typeof b.isa&&b.isa.meta?b.isa.meta.constructor:c);return d.call(this,a,e,b)},getDefaultHelperFor:function(a){var b=this;return function(c,d){return b.prepareProperties(c,d,a,function(a,c,d){return b.create(a,c,d)})}},register:function(a,b,c){var d=this;if(this.meta.hasMethod(a))b=function(){return d[a].apply(d,arguments)},f.top[a]||(f.top[a]=b),f[a]||(f[a]=b),f.is_NodeJS&&"undefined"!=typeof exports&&
(exports[a]=b);else{var e={};e[a]=c||this.getDefaultHelperFor(b);this.meta.extend({methods:e});this.register(a)}},Module:function(a,b){return this.prepareProperties(a,b,f.Namespace.Keeper,function(a,b,c){"function"==typeof c&&(c={body:c});return this.create(a,b,c)})}}})).c;f.Namespace.Manager.my=new f.Namespace.Manager;f.Namespace.Manager.my.register("Class",f.Meta.Class);f.Namespace.Manager.my.register("Role",f.Meta.Role);f.Namespace.Manager.my.register("Module");var g=f.Class;d=f.Role;d("Joose.Attribute.Delegate",
{have:{handles:null},override:{eachDelegate:function(a,b,c){if("string"==typeof a)return b.call(c,a,a);if(a instanceof Array)return f.A.each(a,function(a){b.call(c,a,a)});a===Object(a)&&f.O.eachOwn(a,function(a,d){b.call(c,d,a)})},getAccessorsFor:function(a){var b=a.meta,c=this.SUPER(a),d=this;this.eachDelegate(this.handles,function(a,e){b.hasMethod(a)||((c[a]=function(){var a=d.getValueFrom(this);return a[e].apply(a,arguments)}).ACCESSOR_FROM=d)});return c},getAccessorsFrom:function(a){var b=this.SUPER(a),
c=this,d=a.meta;this.eachDelegate(this.handles,function(a){var e=d.getMethod(a);e&&e.value.ACCESSOR_FROM==c&&b.push(a)});return b}}});d("Joose.Attribute.Trigger",{have:{trigger:null},after:{initialize:function(){if(this.trigger){if(!this.writeable)throw Error("Can't use `trigger` for read-only attributes");this.hasSetter=!0}}},override:{getSetter:function(){var a=this.SUPER(),b=this.trigger;if(!b)return a;var c=this,d=f.O.isFunction(c.init)?null:c.init;return function(){var e=c.hasValue(this)?c.getValueFrom(this):
d,g=a.apply(this,arguments);b.call(this,c.getValueFrom(this),e);return g}}}});d("Joose.Attribute.Lazy",{have:{lazy:null},before:{computeValue:function(){"function"==typeof this.init&&this.lazy&&(this.lazy=this.init,delete this.init)}},after:{initialize:function(){this.lazy&&(this.readable=this.hasGetter=!0)}},override:{getGetter:function(){var a=this.SUPER(),b=this.lazy;if(!b)return a;var c=this;return function(){if(!c.hasValue(this)){var d="function"==typeof b?b:this[b.replace(/^this\./,"")];c.setValueTo(this,
d.apply(this,arguments))}return a.call(this)}}}});d("Joose.Attribute.Accessor.Combined",{have:{isCombined:!1},after:{initialize:function(){if(this.isCombined=this.isCombined||/..c/i.test(this.is))this.slot="$$"+this.name,this.hasGetter=!0,this.hasSetter=!1,this.setterName=this.getterName=this.publicName}},override:{getGetter:function(){var a=this.SUPER();if(!this.isCombined)return a;var b=this.getSetter(),c=this;return function(){if(!arguments.length){if(c.readable)return a.call(this);throw Error("Call to getter of unreadable attribute: ["+
c.name+"]");}if(c.writeable)return b.apply(this,arguments);throw Error("Call to setter of read-only attribute: ["+c.name+"]");}}}});f.Managed.Attribute.meta.extend({does:[f.Attribute.Delegate,f.Attribute.Trigger,f.Attribute.Lazy,f.Attribute.Accessor.Combined]});d("Joose.Meta.Singleton",{has:{forceInstance:f.I.Object,instance:null},override:{defaultConstructor:function(){var a=this,b=this.SUPER();this.adaptConstructor(b);return function(c,d){if(c==a.forceInstance)return b.apply(this,d)||this;var e=
a.instance;e?a.hasMethod("configure")&&e.configure.apply(e,arguments):a.instance=new a.c(a.forceInstance,arguments);return a.instance}}}});f.Namespace.Manager.my.register("Singleton",g({isa:f.Meta.Class,meta:f.Meta.Class,does:f.Meta.Singleton}))}();
Class("Scope.Provider",{VERSION:0.12,has:{name:null,scope:null,seedingCode:null,seedingScript:null,preload:{is:"ro",init:Joose.I.Array},cleanupCallback:null,beforeCleanupCallback:null},methods:{isCSS:function(f){return/\.css(\?.*)?$/i.test(f)},isAlreadySetUp:function(){return Boolean(this.scope)},addPreload:function(f){if(this.isAlreadySetUp())throw Error("Can't use `addPreload` - scope is already setup. Use `runCode/runScript` instead");"string"==typeof f?f=this.isCSS(f)?{type:"css",url:f}:{type:"js",
url:f}:f.text&&(f={type:"js",content:f.text});if(!f.type)throw Error("Preload descriptor must have the `type` property");this.preload.push(f)},addOnErrorHandler:function(f,a){throw"Abstract method `addOnErrorHandler` of Scope.Provider called";},create:function(){throw"Abstract method `create` of Scope.Provider called";},setup:function(f){throw"Abstract method `setup` of Scope.Provider called";},cleanup:function(f){throw"Abstract method `cleanup` of Scope.Provider called";},runCode:function(f,a){throw"Abstract method `runCode` of Scope.Provider called";
},runScript:function(f,a){throw"Abstract method `runScript` of Scope.Provider called";}}});Scope.Provider.__ONLOAD__={};Scope.Provider.__ONERROR__={};
Role("Scope.Provider.Role.WithDOM",{requires:["getDocument","create","getPreload","isAlreadySetUp","setViewportSize"],has:{useStrictMode:!0,sourceURL:null,minViewportSize:null,parentWindow:function(){return window},scopeId:function(){return Math.round(1E10*Math.random())},attachToOnError:function(){return function(f,a,b,c){var d=f.onerror;d&&d.__SP_MANAGED__||(f.onerror=function(e,g,k){b=(f.opener||f.parent).Scope.Provider.__ONERROR__[a];if(!b.__CALLING__&&(b.__CALLING__=!0,d&&d.apply(this,arguments),
b.apply(this,arguments),b.__CALLING__=!1,!1!==c))return f.WebKitPoint?!1:!0},f.onerror.__SP_MANAGED__=!0)}},cachedOnError:null},override:{cleanup:function(){this.cachedOnError=null;try{this.scope.onerror=null}catch(f){}this.SUPERARG(arguments);this.scope=null}},methods:{cleanupHanlders:function(){var f=this.parentWindow.Scope.Provider;delete f.__ONLOAD__[this.scopeId];delete f.__ONERROR__[this.scopeId]},getHead:function(){return this.getDocument().getElementsByTagName("head")[0]},installOnErrorHandler:function(f){if(!this.isAlreadySetUp())throw"Scope should be already set up";
this.attachToOnError(this.scope,this.scopeId,f)},addOnErrorHandler:function(f,a){f.__SP_MANAGED__=!0;this.cachedOnError=f;var b=this.scopeId;this.parentWindow.Scope.Provider.__ONERROR__[b]=f;b=";("+this.attachToOnError.toString()+")(window, "+b+", (window.opener || window.parent).Scope.Provider.__ONERROR__[ "+b+" ], "+a+");";this.isAlreadySetUp()?this.runCode(b):this.getPreload().unshift({type:"js",content:b,unordered:!0})},addSeedingToPreload:function(){var f=this.getPreload();this.seedingCode&&
f.unshift({type:"js",content:this.seedingCode});this.seedingScript&&f.push({type:"js",url:this.seedingScript})},setup:function(f){var a="v"=="\v"||Boolean(this.parentWindow.msWriteProfilerMark),b=!1;Joose.A.each(this.getPreload(),function(a){if("js"==a.type&&a.content&&!a.unordered)return b=!0,!1});this.sourceURL||a&&b?(this.addSeedingToPreload(),this.setupIncrementally(f)):(a||this.addSeedingToPreload(),this.setupWithDocWrite(f,a))},setupWithDocWrite:function(f,a){var b=[],c=this;Joose.A.each(this.getPreload(),
function(a){if("js"==a.type)b.push(c.getScriptTagString(a.url,a.content));else if("css"==a.type)b.push(c.getLinkTagString(a.url,a.content));else throw"Incorrect preload descriptor "+a;});this.create();var d=this.scopeId;this.parentWindow.Scope.Provider.__ONLOAD__[d]=function(){var b=function(){f&&f(c)};a?(c.seedingCode&&c.runCode(c.seedingCode),c.seedingScript?c.runScript(c.seedingScript,b):b()):b()};var e=this.getDocument();e.open();e.write([this.useStrictMode?"<!DOCTYPE html>":"",'<html style="width: 100%; height: 100%; margin : 0; padding : 0;"><head>',
b.join(""),"</head>",'<body style="margin : 0; padding : 0; width: 100%; height: 100%" onload="(window.opener || window.parent).Scope.Provider.__ONLOAD__['+d+']()">',"</body></html>"].join(""));e.close();c.cachedOnError&&c.installOnErrorHandler(c.cachedOnError)},setupIncrementally:function(f){var a=this;this.create(function(){var b=function(c,d){var e=function(){b(c,d)};if(c.length){var g=c.shift();g.url?a.runScript(g.url,e):"js"==g.type?a.runCode(g.content,e):(a.addStyleTag(g.content),e())}else d&&
d()};b(a.getPreload().slice(),f)})},getScriptTagString:function(f,a){var b='<script type="text/javascript"';return b=f?b+(' src="'+f+'">\x3c/script>'):b+(">"+a.replace(/<\/script>/gi,"\\x3C/script>")+"\x3c/script>")},getLinkTagString:function(f,a){if(f)return'<link href="'+f+'" rel="stylesheet" type="text/css" />';if(a)return"<style>"+a+"</style>"},loadCSS:function(f,a){var b=this.getDocument(),c=b.createElement("link");c.type="text/css";c.rel="stylesheet";c.href=f;this.getHead().appendChild(c);var d=
!1,c=function(){d||(d=!0,clearTimeout(e),a&&a(),b.body.removeChild(g))},e=setTimeout(c,3E3),g=b.createElement("img");g.onerror=c;b.body.appendChild(g);g.src=f},runCode:function(f,a){this.getHead().appendChild(this.createScriptTag(f));a&&a()},runScript:function(f,a){this.isCSS(f)?this.loadCSS(f,a):this.getHead().appendChild(this.createScriptTag(null,f,a))},createScriptTag:function(f,a,b){var c=this.getDocument().createElement("script");c.setAttribute("type","text/javascript");a&&c.setAttribute("src",
a);f&&(c.text=f);b&&(c.onload=c.onreadystatechange=function(){if(!c.readyState||"loaded"==c.readyState||"complete"==c.readyState||4==c.readyState&&200==c.status)c.onload=c.onreadystatechange=null,"v"=="\v"?setTimeout(b,0):b()});return c},addStyleTag:function(f){var a=this.getDocument(),b=a.createElement("style");b.setAttribute("type","text/css");a.getElementsByTagName("head")[0].appendChild(b);b.styleSheet?b.styleSheet.cssText=f:b.appendChild(a.createTextNode(f))}}});
Class("Scope.Provider.IFrame",{isa:Scope.Provider,does:Scope.Provider.Role.WithDOM,have:{iframe:null,cls:null,performWrap:!1,wrapCls:null,wrapper:null,parentEl:null,cleanupDelay:1E3},methods:{getDocument:function(){return this.iframe.contentWindow.document},setViewportSize:function(f,a){var b=this.iframe;b&&(b.style.width=f+"px",b.style.height=a+"px")},create:function(f){var a=this,b=this.parentWindow.document,c=this.iframe=b.createElement("iframe"),d=this.minViewportSize;c.className=this.cls||"";
c.style.width=(d&&d.width||1024)+"px";c.style.height=(d&&d.height||768)+"px";c.setAttribute("frameborder",0);this.name&&c.setAttribute("name",this.name);var e=!1,g=function(){e||(c.detachEvent?c.detachEvent("onload",g):c.onload=null,f&&f(a))};c.attachEvent?c.attachEvent("onload",g):c.onload=g;c.src=this.sourceURL||"about:blank";if(this.performWrap){var k=this.wrapper=this.wrapper||b.createElement("div");k.className=this.wrapCls||"";k.appendChild(c)}(this.parentEl||b.body).appendChild(k||c);var l=
this.scope=c.contentWindow,b=this.getDocument();if("v"=="\v"||Boolean(this.parentWindow.msWriteProfilerMark))this.sourceURL&&(e=!0),b.open(),b.write(""),b.close(),e=!1,c.onreadystatechange=function(){"complete"==c.readyState&&(c.onreadystatechange=null);a.cachedOnError&&a.attachToOnError(l,a.scopeId,a.cachedOnError)},this.sourceURL&&(c.src=this.sourceURL);a.cachedOnError&&a.installOnErrorHandler(a.cachedOnError)},cleanup:function(){var f=this.wrapper||this.iframe,a=this.iframe,b=this;f.style.display=
"none";this.runCode(";("+function(){window.onunload||(window.onunload=function(){return"something"})}.toString()+")();");this.wrapper=this.scope=this.iframe=null;setTimeout(function(){b.beforeCleanupCallback&&b.beforeCleanupCallback();b.beforeCleanupCallback=null;a.src="javascript:false";setTimeout(function(){(b.parentEl||b.parentWindow.document.body).removeChild(f);a=f=null;b.parentEl=null;b.cleanupHanlders();b.cleanupCallback&&b.cleanupCallback();b.cleanupCallback=null},b.cleanupDelay)},b.cleanupDelay)}}});
Class("Scope.Provider.Window",{isa:Scope.Provider,does:Scope.Provider.Role.WithDOM,has:{popupWindow:null},methods:{setViewportSize:function(f,a){var b=this.popupWindow;b&&b.resizeTo(f,a)},create:function(f){var a=this.minViewportSize,b=this.scope=this.popupWindow=this.parentWindow.open(this.sourceURL||"about:blank","_blank","left=10,top=10,width="+(a&&a.width||1024)+",height="+(a&&a.height||768));if(!b)throw alert("Please enable popups for the host with this test suite running: "+this.parentWindow.location.host),
"Please enable popups for the host with this test suite running: "+this.parentWindow.location.host;"v"!="\v"&&!Boolean(this.parentWindow.msWriteProfilerMark)||this.sourceURL||(a=this.getDocument(),a.open(),a.write(""),a.close());this.cachedOnError&&this.installOnErrorHandler(this.cachedOnError);var c=function(a,b){var c=!1,k=!0,l=a.document,f=l.documentElement,n=l.addEventListener?"addEventListener":"attachEvent",p=l.addEventListener?"removeEventListener":"detachEvent",r=l.addEventListener?"":"on",
s=function(k){if("readystatechange"!=k.type||"complete"==l.readyState)("load"==k.type?a:l)[p](r+k.type,s,!1),!c&&(c=!0)&&b.call(a,k.type||k)},t=function(){try{f.doScroll("left")}catch(a){setTimeout(t,50);return}s("poll")};if("complete"==l.readyState)b.call(a,"lazy");else{if(l.createEventObject&&f.doScroll){try{k=!a.frameElement}catch(w){}k&&t()}l[n](r+"DOMContentLoaded",s,!1);l[n](r+"readystatechange",s,!1);a[n](r+"load",s,!1)}};this.sourceURL?setTimeout(function(){c(b,f||function(){})},10):c(b,f||
function(){})},getDocument:function(){return this.popupWindow.document},cleanup:function(){this.beforeCleanupCallback&&this.beforeCleanupCallback();this.beforeCleanupCallback=null;this.popupWindow.close();this.popupWindow=null;this.cleanupHanlders();this.cleanupCallback&&this.cleanupCallback();this.cleanupCallback=null}}});
Class("Scope.Provider.NodeJS",{isa:Scope.Provider,has:{sourceURL:null},methods:{compile:function(f,a,b){var c=require("module"),d=require("path");a=a.replace(/^\#\!.*/,"");var e=function(a){return f.require(a)};e.resolve=function(a){return c._resolveFilename(a,f)[1]};Object.defineProperty(e,"paths",{get:function(){throw Error("modRequire.paths is removed. Use node_modules folders, or the NODE_PATH environment variable instead.");}});e.main=process.mainModule;e.extensions=c._extensions;e.registerExtension=
function(){throw Error("modRequire.registerExtension() removed. Use modRequire.extensions instead.");};e.cache=c._cache;d=d.dirname(b);a=c.wrap(a);return require("vm").runInContext(a,this.scope,b).apply(f.exports,[f.exports,e,f,b,d])},addOnErrorHandler:function(f,a){},create:function(f){var a=require("vm"),b={};Joose.O.extend(b,{process:process,global:b,root:root,setTimeout:setTimeout,clearTimeout:clearTimeout,setInterval:setInterval,clearInterval:clearInterval});this.scope=a.createContext(b);f&&
f()},setup:function(f){this.create();var a=this;this.seedingCode&&require("vm").runInContext(this.seedingCode,this.scope);Joose.A.each(this.getPreload(),function(b){"js"==b.type&&(b.url?a.runScript(b.url):a.runCode(b.content))});if(this.seedingScript){var b=require("module"),c=require("path"),b=new b("./"+this.sourceURL,require.main),c=b.filename=c.join(c.dirname(require.main.filename),this.sourceURL),d=require("fs").readFileSync(c,"utf8");65279===d.charCodeAt(0)&&(d=d.slice(1));this.compile(b,d,
c)}f&&f()},runCode:function(f,a){var b=require("vm").runInContext(f,this.scope);a&&a(b);return b},runScript:function(f,a){var b=require("fs").readFileSync(f,"utf8"),b=require("vm").runInContext(b,this.scope,f);a&&a(b);return b},cleanup:function(){this.beforeCleanupCallback&&this.beforeCleanupCallback();this.cleanupCallback&&this.cleanupCallback()}}});
Class("JooseX.Observable.Event",{has:{name:{required:!0},args:{required:!0},source:{required:!0},splat:null,current:null,bubbling:!0},methods:{stopPropagation:function(){this.bubbling=!1}}});
Class("JooseX.Observable.Listener",{has:{channel:{required:!0},eventName:{required:!0},func:{required:!0},scope:null,single:!1,buffer:null,bufferMax:null,bufferStartedAt:null,bufferTimeout:null,delayTimeout:null,delay:null},methods:{activate:function(f,a){var b=this;if(null!=b.buffer){if(null!=b.bufferMax)if(!b.bufferStartedAt)b.bufferStartedAt=new Date;else if(new Date-b.bufferStartedAt>b.bufferMax)return;b.bufferTimeout&&clearTimeout(b.bufferTimeout);b.bufferTimeout=setTimeout(function(){delete b.bufferStartedAt;
delete b.bufferTimeout;b.doActivate(f,a)},b.buffer)}else if(null!=b.delay)b.delayTimeout=setTimeout(function(){delete b.delayTimeout;b.doActivate(f,a)},b.delay);else return b.doActivate(f,a)},doActivate:function(f,a){this.single&&this.remove();return!1!==this.func.apply(this.scope||f.source,[f].concat(a))},cancel:function(){this.buffer&&(clearTimeout(this.bufferTimeout),delete this.bufferTimeout,delete this.bufferStartedAt);this.delay&&clearTimeout(this.delayTimeout)},remove:function(){this.channel.removeListener(this)}}});
Class("JooseX.Observable.Channel",{has:{channels:Joose.I.Object,listeners:Joose.I.Object},methods:{destroy:function(){Joose.O.each(this.channels,function(f,a){f.purgeListeners()});this.channels=null;Joose.O.each(this.listeners,function(f,a){this.listeners[a]=null},this);this.listeners=null},getListenersFor:function(f,a,b){var c=this.listeners;if(c["**"]){var d=f.concat(a);Joose.A.each(c["**"],function(a){b.push({listener:a,splat:d})})}f.length?(c=this.getSingleChannel(f.shift(),!0))&&c.getListenersFor(f,
a,b):(c["*"]&&Joose.A.each(c["*"],function(c){b.push({listener:c,splat:a})}),c[a]&&Joose.A.each(c[a],function(a){b.push({listener:a})}))},hasListenerFor:function(f,a){var b=this.listeners;if(b["**"]&&b["**"].length)return!0;if(f.length){if(b=this.getSingleChannel(f.shift(),!0))return b.hasListenerFor(f,a)}else if(b["*"]&&b["*"].length||b[a]&&b[a].length)return!0;return!1},addListener:function(f){var a=f.eventName,b=this.listeners;b[a]=b[a]||[];b[a].push(f)},removeListener:function(f){if(this.listeners){var a=
this.listeners[f.eventName];a&&Joose.A.each(a,function(b,c){if(b==f)return a.splice(c,1),!1})}},removeListenerByHandler:function(f,a,b){var c=this.listeners[f];c&&Joose.A.each(c,function(d,e){if(d.func==a&&d.scope==b)return c.splice(e,1),!1})},getSingleChannel:function(f,a){var b=this.channels;return b[f]?b[f]:a?null:b[f]=new JooseX.Observable.Channel},getChannel:function(f,a){if(!f.length)return this;var b=this.getSingleChannel(f.shift(),a);return a&&!b?null:b.getChannel(f,a)}}});
Role("JooseX.Observable",{VERSION:0.04,has:{rootChannel:{is:"rw",init:function(){return new JooseX.Observable.Channel}},suspendCounter:0},methods:{getBubbleTarget:function(){},parseEventPath:function(f){f=f.split("/");var a=f.pop();f.length&&!f[0]&&f.shift();return{channels:f,eventName:a}},on:function(f,a,b,c){if(!a)throw"Not valid listener function provided when subsribing on event: "+f;var d=this.parseEventPath(f);f=this.getRootChannel().getChannel(d.channels);a=new JooseX.Observable.Listener(Joose.O.extend(c||
{},{channel:f,eventName:d.eventName,func:a,scope:b}));f.addListener(a);return a},un:function(f,a,b){if(f instanceof JooseX.Observable.Listener)f.remove();else{f=this.parseEventPath(f);var c=this.getRootChannel().getChannel(f.channels,!0);c&&c.removeListenerByHandler(f.eventName,a,b)}},emit:function(){return this.fireEvent.apply(this,arguments)},fireEvent:function(f){if(!this.suspendCounter){var a=Array.prototype.slice.call(arguments,1),b=new JooseX.Observable.Event({name:f,args:a,source:this});return this.propagateEvent(b,
f,a)}},propagateEvent:function(f,a,b){if(!this.suspendCounter){var c=this.parseEventPath(a),d=c.eventName;if("*"==!d||"**"==d)throw Error("Can't fire an empty event or event with `*`, `**` names ");var e=[];this.getRootChannel().getListenersFor(c.channels,d,e);var g=!0;f.current=this;e.length&&Joose.A.each(e,function(a){f.splat=a.splat;g=!1!==a.listener.activate(f,b)&&g});f.bubbling&&(c=this.getBubbleTarget())&&(g=!1!==c.propagateEvent(f,a,b)&&g);return g}},hasListenerFor:function(f){f=this.parseEventPath(f);
return this.getRootChannel().hasListenerFor(f.channels,f.eventName)},purgeListeners:function(){this.rootChannel.destroy();this.rootChannel=new JooseX.Observable.Channel},suspendEvents:function(){this.suspendCounter++},resumeEvents:function(){this.suspendCounter--;0>this.suspendCounter&&(this.suspendCounter=0)}}});var JSON;JSON||(JSON={});
(function(){function f(a){return 10>a?"0"+a:a}function a(a){d.lastIndex=0;return d.test(a)?'"'+a.replace(d,function(a){var b=k[a];return"string"===typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function b(c,d){var k,f,s,t,w=e,y,z=d[c];z&&("object"===typeof z&&"function"===typeof z.toJSON)&&(z=z.toJSON(c));"function"===typeof l&&(z=l.call(d,c,z));switch(typeof z){case "string":return a(z);case "number":return isFinite(z)?String(z):"null";case "boolean":case "null":return String(z);
case "object":if(!z)return"null";e+=g;y=[];if("[object Array]"===Object.prototype.toString.apply(z)){t=z.length;for(k=0;k<t;k+=1)y[k]=b(k,z)||"null";s=0===y.length?"[]":e?"[\n"+e+y.join(",\n"+e)+"\n"+w+"]":"["+y.join(",")+"]";e=w;return s}if(l&&"object"===typeof l)for(t=l.length,k=0;k<t;k+=1)"string"===typeof l[k]&&(f=l[k],(s=b(f,z))&&y.push(a(f)+(e?": ":":")+s));else for(f in z)Object.prototype.hasOwnProperty.call(z,f)&&(s=b(f,z))&&y.push(a(f)+(e?": ":":")+s);s=0===y.length?"{}":e?"{\n"+e+y.join(",\n"+
e)+"\n"+w+"}":"{"+y.join(",")+"}";e=w;return s}}"function"!==typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(a){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(a){return this.valueOf()});var c=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
d=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,e,g,k={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},l;"function"!==typeof JSON.stringify&&(JSON.stringify=function(a,c,d){var k;g=e="";if("number"===typeof d)for(k=0;k<d;k+=1)g+=" ";else"string"===typeof d&&(g=d);if((l=c)&&"function"!==typeof c&&("object"!==typeof c||"number"!==typeof c.length))throw Error("JSON.stringify");return b("",{"":a})});
"function"!==typeof JSON.parse&&(JSON.parse=function(a,b){function d(a,c){var e,g,k=a[c];if(k&&"object"===typeof k)for(e in k)Object.prototype.hasOwnProperty.call(k,e)&&(g=d(k,e),void 0!==g?k[e]=g:delete k[e]);return b.call(a,c,k)}var e;a=String(a);c.lastIndex=0;c.test(a)&&(a=a.replace(c,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return e=eval("("+a+")"),"function"===typeof b?d({"":e},""):e;throw new SyntaxError("JSON.parse");})})();
!function(){var f=1;Class("Data.Visitor2",{has:{seenPlaceholder:{init:{}},outOfDepthPlaceholder:{init:{}},seen:Joose.I.Object,maxDepth:null},methods:{getClassNameFor:function(a){return Joose.O.isInstance(a)?a.meta.name:Object.prototype.toString.call(a).replace(/^\[object /,"").replace(/\]$/,"")},getRefAdr:function(){return f++},assignRefAdrTo:function(a){a.__REFADR__||(Object.defineProperty?Object.defineProperty(a,"__REFADR__",{value:f++}):a.__REFADR__=f++);return a.__REFADR__},isSeen:function(a){return a.__REFADR__&&
this.seen.hasOwnProperty(a.__REFADR__)},markSeenAs:function(a,b){return this.seen[a.__REFADR__]=b},hasSeenResultFor:function(a){a=a.__REFADR__;return this.seen.hasOwnProperty(a)&&this.seen[a]!=this.seenPlaceholder},visit:function(a,b){return b>this.maxDepth?this.visitOutOfDepthValue(a,b+1):Object(a)===a?this.isSeen(a)?this.visitSeen(a,b+1):this.visitNotSeen(a,b+1):this.visitValue(a,b+1)},visitOutOfDepthValue:function(a,b){return this.outOfDepthPlaceholder},visitValue:function(a,b){return a},visitSeen:function(a,
b){return this.seen[a.__REFADR__]},getInitialSeenMarker:function(a,b){return this.seenPlaceholder},visitNotSeen:function(a,b){this.assignRefAdrTo(a);this.markSeenAs(a,this.getInitialSeenMarker(a,b));if(Joose.O.isInstance(a))return this.markSeenAs(a,this.visitJooseInstance(a,b));var c="visit"+this.getClassNameFor(a);this.meta.hasMethod(c)||(c="visitObject");return this.markSeenAs(a,this[c](a,b))},visitArray:function(a,b){Joose.A.each(a,function(c,d){this.visitArrayEntry(c,d,a,b)},this);return a},visitArrayEntry:function(a,
b,c,d){return this.visit(a,d)},visitObject:function(a,b){Joose.O.eachOwn(a,function(c,d){"__REFADR__"!=d&&(this.visitObjectKey(d,c,a,b),this.visitObjectValue(c,d,a,b))},this);return a},visitJooseInstance:function(a,b){return this.visitObject(a,b)},visitObjectKey:function(a,b,c,d){return this.visitValue(a,d)},visitObjectValue:function(a,b,c,d){return this.visit(a,d)}},my:{has:{HOST:null},methods:{visit:function(a,b){return(new this.HOST({maxDepth:b||Infinity})).visit(a,0)}}}})}();
(function(){Class("Siesta.Util.Serializer",{isa:Data.Visitor2,has:{result:Joose.I.Array,manualEnum:function(){for(var a in{toString:1})return!1;return!0}},methods:{assignRefAdrTo:function(a){try{return this.SUPER(a)}catch(b){a.__REFADR__||(a.__REFADR__=this.getRefAdr())}return a.__REFADR__},write:function(a){this.result.push(a)},visitOutOfDepthValue:function(a,b){this.write("...")},visitValue:function(a){null==a?this.write(a+""):this.write("string"==typeof a?'"'+a.replace(/"/g,'\\"').replace(/\n/g,
"\\n")+'"':a+"")},visitObjectKey:function(a,b,c){this.write('"'+a+'": ')},getClassNameFor:function(a){return null!=a.nodeType&&null!=a.nodeName&&a.tagName?"DOMElement":null!=a.document&&null!=a.location&&null!=a.location.href?"Window":this.SUPER(a)},visitSeen:function(a,b){this.write("[Circular]")},visitRegExp:function(a,b){this.write(a+"")},visitFunction:function(a,b){this.write("function "+(a.name||"")+"() { ... }")},visitDate:function(a,b){this.write('"'+a+'"')},visitObject:function(a,b){for(var c in a)if("__REFADR__"!=
c&&(!a.hasOwnProperty||a.hasOwnProperty(c))){var d=a[c];this.visitObjectKey(c,d,a,b);this.visitObjectValue(d,c,a,b)}var e=this;this.manualEnum&&Joose.A.each(["hasOwnProperty","valueOf","toString","constructor"],function(c){if(a.hasOwnProperty&&a.hasOwnProperty(c)){var d=a[c];e.visitObjectKey(c,d,a,b);e.visitObjectValue(d,c,a,b)}});return a},visitJooseInstance:function(a,b){return a.meta.hasMethod("toString")?(this.write(a.toString()),a):this.SUPERARG(arguments)},visitDOMElement:function(a,b){var c=
"&lt;"+a.tagName;a.id&&(c+=' id="'+a.id+'"');a.className&&(c+=' class="'+a.className+'"');this.write(c+"&gt;")},visitDOMStringMap:function(){this.write("[DOMStringMap]")},visitWindow:function(){this.write("[window]")},visitLocation:function(){this.write("[window.location]")}},before:{visitObject:function(){this.write("{")},visitArray:function(){this.write("[")}},after:{visitObject:function(){var a=this.result;", "==a[a.length-1]&&a.pop();this.write("}")},visitArray:function(){var a=this.result;", "==
a[a.length-1]&&a.pop();this.write("]")},visitObjectValue:function(){this.write(", ")},visitArrayEntry:function(){this.write(", ")}},my:{has:{HOST:null},methods:{stringify:function(a,b){var c=new this.HOST({maxDepth:b||4});c.visit(a,0);return c.result.join("")}}}});Role("Siesta.Util.Role.CanFormatStrings",{has:{serializeFormatingPlaceholders:!0},methods:{formatString:function(a,b){if(!b)return a;for(var c,d=[],e=[],g=/\{(\!)?((?:\w|-|_)+?)\}/g;c=g.exec(a);)e.push(c[1]),d.push(c[2]);var k=a;Joose.A.each(d,
function(a,c){var d=e[c];k=k.replace(RegExp("\\{"+(d?"!":"")+a+"\\}","g"),b.hasOwnProperty(a)?d||!this.serializeFormatingPlaceholders?b[a]+"":Siesta.Util.Serializer.stringify(b[a]):"")},this);return k}}});Role("Siesta.Util.Role.CanGetType",{methods:{typeOf:function(a){return Object.prototype.toString.call(a).slice(8,-1)}}});Class("Siesta.Util.Queue",{has:{steps:Joose.I.Array,interval:100,callbackDelay:0,deferer:{required:!0},deferClearer:null,processor:null,processorScope:null,currentTimeout:null,
callback:null,scope:null,isAborted:!1,observeTest:null,currentDelayStepId:null,isDestroyed:!1},methods:{addStep:function(a){this.addSyncStep(a)},addSyncStep:function(a){this.steps.push(a)},addAsyncStep:function(a){a.isAsync=!0;this.steps.push(a)},addDelayStep:function(a){var b=this.deferer,c=this;this.addAsyncStep({processor:function(d){c.currentDelayStepId=b(d.next,a||500)}})},run:function(a,b){this.callback=a;this.scope=b;this.observeTest&&this.observeTest.on("testfinalize",function(){this.abort(!0)},
this,{single:!0});this.doSteps(this.steps.slice(),a,b)},abort:function(a){if(!this.isDestroyed){this.isAborted=!0;var b=this.deferClearer;if(!b)throw"Need `deferClearer` to be able to `abort` the queue";b(this.currentDelayStepId);b(this.currentTimeout);a||this.callback.call(this.scope||this);this.destroy()}},doSteps:function(a,b,c){this.currentTimeout=null;var d=this,e=this.deferer,g=a.shift();if(!this.isAborted)if(g)for(;this.doOneStep(g,a,b,c)&&!this.isAborted;)if(a.length)g=a.shift();else{this.doSteps(a,
b,c);break}else b&&(this.callbackDelay?e(function(){d.isAborted||(b.call(c||this),d.destroy())},this.callbackDelay):(b.call(c||this),d.destroy()))},doOneStep:function(a,b,c,d){var e=this,g=this.deferer,k=a.processor||this.processor,l=a.processorScope||this.processorScope,f=this.steps.length-b.length-1;if(!k)throw Error("No process function found for step: "+f);if(a.isAsync){var n=!1,p=!1,g=a.next=function(){p?e.doSteps(b,c,d):n=!0};k.call(l||e,a,f,this,g);p=!0;if(n)return!0}else k.call(l||e,a,f,this),
this.isAborted||((a=a.interval||e.interval)?this.currentTimeout=g(function(){e.doSteps(b,c,d)},a):e.doSteps(b,c,d))},destroy:function(){if(!this.isDestroyed){this.processor=this.processorScope=this.callback=this.observeTest=this.deferer=this.deferClearer=null;for(var a=0;a<this.steps.length;a++)this.steps[a].next=null;this.steps=null;this.isDestroyed=!0}}}});Class("Siesta.Util.XMLNode",{has:{children:Joose.I.Array,tag:{required:!0},attributes:Joose.I.Object,textContent:null,escapeTable:{init:{"&":"&amp;",
"<":"&lt;",">":"&gt;",'"':"&quot;"}}},methods:{escapeXml:function(a){var b=this;return"string"!=typeof a?a:a.replace(/[&<>"]/g,function(a){return b.escapeTable[a]})},toString:function(){var a=this,b=[];Joose.A.each(this.children,function(a){b.push(a.toString())});var c=[];Joose.O.each(this.attributes,function(b,e){c.push(e+'="'+a.escapeXml(b)+'"')});c.sort();c.unshift(this.tag);return"<"+c.join(" ")+">"+(null!=this.textContent?this.escapeXml(this.textContent):"")+b.join("")+"</"+this.tag+">"},appendChild:function(a){a instanceof
Siesta.Util.XMLNode?a.parent=this:a=new Siesta.Util.XMLNode(Joose.O.extend(a,{parent:this}));this.children.push(a);return a},setAttribute:function(a,b){this.attributes[a]=b}}});Class("Siesta.Util.Rect",{has:{left:null,top:null,width:null,height:null,right:null,bottom:null},methods:{initialize:function(){var a=this.left,b=this.width,c=this.right;null==c&&(null!=a&&null!=b)&&(this.right=a+b-1);null==b&&(null!=a&&null!=c)&&(this.width=c-a+1);a=this.top;b=this.height;c=this.bottom;null==c&&(null!=a&&
null!=b)&&(this.bottom=a+b-1);null==b&&(null!=a&&null!=c)&&(this.height=c-a+1)},isEmpty:function(){return null==this.left},intersect:function(a){return a.isEmpty()||this.isEmpty()||a.left>this.right||a.right<this.left||a.top>this.bottom||a.bottom<this.top?this.my.getEmpty():new this.constructor({left:Math.max(this.left,a.left),right:Math.min(this.right,a.right),top:Math.max(this.top,a.top),bottom:Math.min(this.bottom,a.bottom)})},contains:function(a,b){return this.left<=a&&a<=this.right&&this.top<=
b&&b<=this.bottom},cropLeftRight:function(a){return this.intersect(new this.constructor({left:a.left,right:a.right,top:this.top,bottom:this.bottom}))},cropTopBottom:function(a){return this.intersect(new this.constructor({left:this.left,right:this.right,top:a.top,bottom:a.bottom}))},equalsTo:function(a){return this.left==a.left&&this.right==a.right&&this.top==a.top&&this.bottom==a.bottom}},my:{has:{HOST:null},methods:{getEmpty:function(){return new this.HOST}}}});Class("Siesta.Content.Resource",{has:{url:null,
content:null},methods:{asHTML:function(){throw"Abstract method called";},asDescriptor:function(){throw"Abstract method called";},canCache:function(){}}});Class("Siesta.Content.Resource.CSS",{isa:Siesta.Content.Resource,has:{},methods:{asHTML:function(){},asDescriptor:function(){var a={type:"css"};this.url&&(a.url=this.url);this.content&&(a.content=this.content);return a}}});Class("Siesta.Content.Resource.JavaScript",{isa:Siesta.Content.Resource,has:{instrument:!1},methods:{asHTML:function(){},asDescriptor:function(){var a=
{type:"js"};this.url&&(a.url=this.url);this.content&&(a.content=this.content);return a}}});Class("Siesta.Content.Preset",{has:{preload:Joose.I.Array,resources:Joose.I.Array},methods:{initialize:function(){var a=this;Joose.A.each(this.preload,function(b){a.addResource(b)})},isCSS:function(a){return/\.css(\?.*)?$/i.test(a)},getResourceFromDescriptor:function(a){var b,c;if("string"==typeof a)b=this.isCSS(a)?Siesta.Content.Resource.CSS:Siesta.Content.Resource.JavaScript,c={url:a};else if(a.text)b=Siesta.Content.Resource.JavaScript,
c={content:a.text};else{if(!a.url&&!a.content)throw"Incorrect preload descriptor:"+a;b=a.type&&"css"==a.type||this.isCSS(a.url)?Siesta.Content.Resource.CSS:Siesta.Content.Resource.JavaScript;c={};a.url&&(c.url=a.url);a.content&&(c.content=a.content);a.instrument&&(c.instrument=a.instrument)}return new b(c)},addResource:function(a){a=a instanceof Siesta.Content.Resource&&a||this.getResourceFromDescriptor(a);this.resources.push(a);return a},eachResource:function(a,b){return Joose.A.each(this.resources,
a,b||this)},prepareScope:function(a,b){this.eachResource(function(c){b.hasContentOf(c)?a.addPreload({type:c instanceof Siesta.Content.Resource.CSS?"css":"js",content:b.getContentOf(c)}):a.addPreload(c.asDescriptor())})}}});Class("Siesta.Content.Manager",{has:{disabled:!1,presets:{required:!0},urls:Joose.I.Object,maxLoads:5,harness:null},methods:{cache:function(a,b,c){if(this.disabled)a&&a();else{var d=this.urls,e=this;Joose.A.each(this.presets,function(a){a.eachResource(function(a){a.url&&(d[a.url]=
null)})});var g=0,k=0,l=[];Joose.O.each(d,function(a,b){e.hasContentOf(b)||l.push(b)});var f=l.length;if(f)for(var n=function(){if(l.length){var p=l.shift();e.load(p,function(b){k||(d[p]=b,++g==f?a&&a():n())},c?function(){++g==f?a&&a():n()}:function(){k++;b&&b(p)})}},p=0;p<this.maxLoads;p++)n();else a&&a()}},load:function(a,b,c){throw"abstract method `load` called";},addContent:function(a,b){this.urls[a]=b},hasContentOf:function(a){a instanceof Siesta.Content.Resource&&(a=a.url);return"string"==typeof this.urls[a]},
getContentOf:function(a){a instanceof Siesta.Content.Resource&&(a=a.url);return this.urls[a]}}});Class("Siesta",{VERSION:"3.0.1",my:{has:{config:null,activeHarness:null},methods:{getConfigForTestScript:function(a){try{return eval(a),this.config}catch(b){return null}},StartTest:function(a,b){this.config="object"==typeof a?a:"object"==typeof b?b:null}}}});"undefined"==typeof StartTest&&(StartTest=Siesta.StartTest);"undefined"==typeof startTest&&(startTest=Siesta.StartTest);"undefined"==typeof describe&&
(describe=Siesta.StartTest);Siesta.CurrentLocale=Siesta.CurrentLocale||{"Siesta.Harness.Browser.UI.AboutWindow":{upgradeText:"Upgrade to Siesta Standard",closeText:"Close",titleText:"ABOUT SIESTA (v. {VERSION})",bodyText:'<img height="35" src="http://www.bryntum.com/bryntum-logo.png"/>             <p>Siesta is a JavaScript unit and functional test tool made by <a target="_blank" href="http://www.bryntum.com">Bryntum</a>. You can test any web page or JavaScript code, including Ext JS, jQuery or NodeJS.              Siesta comes in two versions: <strong>Lite</strong> and <strong>Standard</strong>. With Lite, you can launch your tests in the browser UI.              With the Standard version, you can also automate your tests and use the automation scripts together with tools like PhantomJS or Selenium WebDriver. </p>             Siesta would not be possible without these awesome products & libraries: <br>                     <ul style="padding:0 0 0 30px">                       <li><a href="http://sencha.com/extjs">Ext JS</a></li>                        <li><a href="http://jquery.com">jQuery</a></li>                        <li><a href="http://http://alexgorbatchev.com/SyntaxHighlighter/">SyntaxHighlighter</a></li>                        <li><a href="http://joose.it/">Joose</a></li>                        <li><a href="https://github.com/gotwarlost/istanbul">Istanbul</a></li>                     </ul>'},
"Siesta.Harness.Browser.UI.AssertionGrid":{initializingText:"Initializing test..."},"Siesta.Harness.Browser.UI.CoverageReport":{closeText:"Close",showText:"Show: ",lowText:"Low",mediumText:"Med",highText:"High",statementsText:"Statements",branchesText:"Branches",functionsText:"Functions",linesText:"Lines",loadingText:"Loading coverage data...",loadingErrorText:"Loading error",loadingErrorMessageText:"Could not load the report data from this url: ",globalNamespaceText:"[Global namespace]"},"Siesta.Harness.Browser.UI.DomContainer":{title:"DOM Panel",
viewDocsText:"View documentation for ",docsUrlText:"http://docs.sencha.com/{0}/apidocs/#!/api/{1}"},"Siesta.Harness.Browser.UI.ResultPanel":{rerunText:"Run test",toggleDomVisibleText:"Toggle DOM visible",viewSourceText:"View source",showFailedOnlyText:"Show failed only",componentInspectorText:"Toggle Ext Component Inspector",eventRecorderText:"Event Recorder",closeText:"Close"},"Siesta.Harness.Browser.UI.TestGrid":{title:"Test list",nameText:"Name",filterTestsText:"Filter tests",expandCollapseAllText:"Expand / Collapse all",
runCheckedText:"Run checked",runFailedText:"Run failed",runAllText:"Run all",showCoverageReportText:"Show coverage report",passText:"Pass",failText:"Fail",optionsText:"Options...",todoPassedText:"todo assertion(s) passed",todoFailedText:"todo assertion(s) failed",viewDomText:"View DOM",transparentExText:"Transparent exceptions",cachePreloadsText:"Cache preloads",autoLaunchText:"Auto launch",speedRunText:"Speed run",breakOnFailText:"Break on fail",debuggerOnFailText:"Debugger on fail",aboutText:"About Siesta",
documentationText:"Siesta Documentation",siestaDocsUrl:"http://bryntum.com/docs/siesta",filterFieldTooltip:'Supported formats for tests filtering:\n1) TERM1 TERM2 - both "TERM1" and "TERM2" should present in the test url\n2) TERM1 TERM2 | TERM3 TERM4 | ... - both "TERM1" and "TERM2" should present in the test url, OR both TERM3 and TERM4, etc, can be repeated indefinitely\n3) GROUP_TERM > TEST_TERM - filters only withing the specified `group`',landscape:"Landscape"},"Siesta.Harness.Browser.UI.VersionUpdateButton":{newUpdateText:"New Update Available...",
updateWindowTitleText:"New version available for download! Current version: ",cancelText:"Cancel",changelogLoadFailedText:"Bummer! Failed to fetch changelog.",downloadText:"Download ",liteText:" (Lite)",standardText:" (Standard)",loadingChangelogText:"Loading changelog..."},"Siesta.Harness.Browser.UI.Viewport":{apiLinkText:"API Documentation",apiLinkUrl:"http://bryntum.com/docs/siesta",uncheckOthersText:"Uncheck others (and check this)",uncheckAllText:"Uncheck all",checkAllText:"Check all",runThisText:"Run this",
expandAll:"Expand all",collapseAll:"Collapse all",filterToCurrentGroup:"Filter to current group",filterToFailed:"Filter to failed",httpWarningTitle:"You must use a web server",httpWarningDesc:"You must run Siesta in a web server context, and not using the file:/// protocol"},"Siesta.Harness.Browser":{codeCoverageWarningText:"Can not enable code coverage - did you forget to include the `siesta-coverage-all.js` on the harness page?",noJasmine:"No `jasmine` object found on spec runner page",noJasmineSiestaReporter:"Can't find SiestaReporter in Jasmine. \nDid you add the `siesta/bin/jasmine-siesta-reporter.js` file to your spec runner page?"},
"Siesta.Result.Assertion":{todoText:"TODO: ",passText:"ok",failText:"fail"},"Siesta.Role.ConsoleReporter":{passText:"PASS",failText:"FAIL",warnText:"WARN",missingFileText:"Test file [{URL}] not found.",allTestsPassedText:"All tests passed",failuresFoundText:"There are failures"},"Siesta.Test.Action.Drag":{byOrToMissingText:'Either "to" or "by" configuration option is required for "drag" step',byAndToDefinedText:'Exactly one of "to" or "by" configuration options is required for "drag" step, not both'},
"Siesta.Test.Action.Eval":{invalidMethodNameText:"Invalid method name: ",wrongFormatText:"Wrong format of the action string: ",parseErrorText:"Can't parse arguments: "},"Siesta.Test.Action.Wait":{missingMethodText:"Could not find a waitFor method named "},"Siesta.Test.BDD.Expectation":{expectText:"Expect",needNotText:"Need not",needText:"Need",needMatchingText:"Need matching",needNotMatchingText:"Need not matching",needStringNotContainingText:"Need string not containing",needStringContainingText:"Need string containing",
needArrayNotContainingText:"Need array not containing",needArrayContainingText:"Need array containing",needGreaterEqualThanText:"Need value greater or equal than",needGreaterThanText:"Need value greater than",needLessThanText:"Need value less than",needLessEqualThanText:"Need value less or equal than",needValueNotCloseToText:"Need value not close to",needValueCloseToText:"Need value close to",toBeText:"to be",toBeDefinedText:"to be defined",toBeUndefinedText:"to be undefined",toBeEqualToText:"to be equal to",
toBeTruthyText:"to be truthy",toBeFalsyText:"to be falsy",toMatchText:"to match",toContainText:"to contain",toBeLessThanText:"to be less than",toBeGreaterThanText:"to be greater than",toBeCloseToText:"to be close to",toThrowText:"to throw exception",thresholdIsText:"Threshold is ",exactMatchText:"Exact match text",thrownExceptionText:"Thrown exception",noExceptionThrownText:"No exception thrown",wrongSpy:"Incorrect spy instance",toHaveBeenCalledDescTpl:"Expect method {methodName} to have been called {need} times",
actualNbrOfCalls:"Actual number of calls",expectedNbrOfCalls:"Expected number of calls",toHaveBeenCalledWithDescTpl:"Expect method {methodName} to have been called at least once with the specified arguments"},"Siesta.Test.ExtJS.Ajax":{ajaxIsLoading:"An Ajax call is currently loading",allAjaxRequestsToComplete:"all ajax requests to complete",ajaxRequest:"ajax request",toComplete:"to complete"},"Siesta.Test.ExtJS.Component":{badInputText:"Expected an Ext.Component, got",toBeVisible:"to be visible",
toNotBeVisible:"to not be visible",component:"component",Component:"Component",componentQuery:"componentQuery",compositeQuery:"composite query",toReturnEmptyArray:"to return an empty array",toReturnEmpty:"to return empty",toReturnAVisibleComponent:"to return a visible component",toReturnHiddenCmp:"to return a hidden/missing component",invalidDestroysOkInput:"No components provided, or component query returned empty result",exception:"Exception",exceptionAnnotation:'Exception thrown while calling "destroy" method of',
destroyFailed:"was not destroyed (probably destroy was canceled in the `beforedestroy` listener)",destroyPassed:"All passed components were destroyed ok"},"Siesta.Test.ExtJS.DataView":{view:"view",toRender:"to render"},"Siesta.Test.ExtJS.Element":{top:"top",left:"left",bottom:"bottom",right:"right"},"Siesta.Test.ExtJS.Grid":{waitForRowsVisible:"rows to show for panel with id"},"Siesta.Test.ExtJS.Observable":{hasListenerInvalid:"1st argument for `t.hasListener` should be an observable instance",hasListenerPass:"Observable has listener for {eventName}",
hasListenerFail:"Provided observable has no listeners for event",isFiredWithSignatureNotFired:'event was not fired during the test"',observableFired:"Observable fired",correctSignature:"with correct signature",incorrectSignature:"with incorrect signature"},"Siesta.Test.ExtJS.Store":{storesToLoad:"stores to load",failedToLoadStore:"Failed to load the store",URL:"URL"},"Siesta.Test.Action":{missingTestAction:"Action [{0}] requires `{1}` method in your test class"},"Siesta.Test.BDD":{codeBodyMissing:"Code body is not provided for",
codeBodyOf:"Code body of",missingFirstArg:"does not declare a test instance as 1st argument",iitFound:"t.iit should only be used during debugging",noObject:"No object to spy on"},"Siesta.Test.BDD.Spy":{spyingNotOnFunction:"Trying to create a spy over a non-function property"},"Siesta.Test.Browser":{noDomElementFound:"No DOM element found for CSS selector",noActionTargetFound:"No action target found for",waitForEvent:"observable to fire its",event:"event",wrongFormat:"Wrong format for expected number of events",
unrecognizedSignature:"Unrecognized signature for `firesOk`",observableFired:"Observable fired",observableFiredOk:"Observable fired expected number of",actualNbrEvents:"Actual number of events",expectedNbrEvents:"Expected number of events",events:"events",noElementFound:"Could not find any element at",targetElementOfAction:"Target element of action",targetElementOfSomeAction:"Target element of some action",isNotVisible:"is not visible or not reachable",text:"text",toBePresent:"to be present",toNotBePresent:"to not be present",
target:"target",toAppear:"to appear"},"Siesta.Test.Date":{isEqualTo:"is equal to",Got:"Got"},"Siesta.Test.Element":{elementContent:"element content",toAppear:"to appear",toDisappear:"to disappear",monkeyException:"Monkey testing action did not complete properly - probably an exception was thrown",monkeyNoExceptions:"No exceptions thrown during monkey test",monkeyActionLog:"Monkey action log",elementHasClass:"Element has the CSS class",elementHasNoClass:"Element has no CSS class",elementClasses:"Classes of element",
needClass:"Need CSS class",hasStyleDescTpl:"Element has correct {value} for CSS style {property}",elementStyles:"Styles of element",needStyle:"Need style",hasNotStyleDescTpl:"Element does not have: {value} for CSS style {property}",hasTheStyle:"Element has the style",element:"element",toBeTopEl:"to be the top element at its position",toNotBeTopEl:"to not be the top element at its position",selector:"selector",selectors:"selectors",toAppear:"to appear",toAppearAt:"to appear at",noCssSelector:"A CSS selector must be supplied",
waitForSelectorsBadInput:"An array of CSS selectors must be supplied",Position:"Position",noElementAtPosition:"No element found at the specified position",elementIsAtDescTpl:"DOM element or its child is at [ {x}, {y} ] coordinates",topElement:"Top element",elementIsAtPassTpl:"DOM element is at [ {x}, {y} ] coordinates",allowChildrenDesc:"Need exactly this or its child",allowChildrenAnnotation:"Passed element is not the top-most one and not the child of one",shouldBe:"Should be",noChildrenFailAnnotation:"Passed element is not the top-most one",
topLeft:"(t-l)",bottomLeft:"(b-l)",topRight:"(t-r)",bottomRight:"(b-r)",elementIsNotTopElementPassTpl:"Element is not the top element on the screen",selectorIsAtPassTpl:"Found element matching CSS selector {selector} at [ {xy} ]",elementMatching:"Element matching",selectorIsAtFailAnnotation:"Passed selector does not match any selector at",selectorExistsFailTpl:"No element matching the passed selector found",selectorExistsPassTpl:"Found DOM element(s) matching CSS selector {selector}",selectorNotExistsFailTpl:"Elements found matching the passed selector",
selectorNotExistsPassTpl:"Did not find any DOM element(s) matching CSS selector {selector}",toChangeForElement:"to change for element",selectorCountIsPassTpl:"Found exactly {count} elements matching {selector}",selectorCountIsFailTpl:"Found {got} elements matching the selector {selector}, expected {need}",isInViewPassTpl:"Passed element is within the visible viewport",toAppearInTheViewport:"to appear in the viewport",elementIsEmptyPassTpl:"Passed element is empty",elementIsNotEmptyPassTpl:"Passed element is not empty",
elementToBeEmpty:"element to be empty",elementToNotBeEmpty:"element to not be empty"},"Siesta.Test.ExtJS":{bundleUrlNotFound:"Cannot find Ext JS bundle url",assertNoGlobalExtOverridesInvalid:"Was not able to find the Ext JS bundle URL in the `assertNoGlobalExtOverrides` assertion",assertNoGlobalExtOverridesPassTpl:"No global Ext overrides found",assertNoGlobalExtOverridesGotDesc:"Number of overrides found",foundOverridesFor:"Found overrides for",animationsToFinalize:"animations to finalize",extOverridesInvalid:"Was not able to find the ExtJS bundle URL in the `assertMaxNumberOfGlobalExtOverrides` assertion)",
foundLessOrEqualThan:"Found less or equal than",nbrOverridesFound:"Number of overrides found",globalOverrides:"Ext JS global overrides"},"Siesta.Test.ExtJSCore":{waitedForRequires:"Waiting for required classes took too long - \nCheck the `Net` tab in Firebug and the `loaderPath` config",waitedForExt:"Waiting for Ext.onReady took too long - probably some dependency could not be loaded. \nCheck the `Net` tab in Firebug and the `loaderPath` config",waitedForApp:"Waiting for MVC application launch took too long - no MVC application on test page? \nYou may need to disable the `waitForAppReady` config option",
noComponentMatch:'Your component query: "{component}" returned no components',multipleComponentMatch:'Your component query: "{component}" returned more than 1 component',noComponentFound:"No component found for CQ",knownBugIn:"Known bug in",Class:"Class",wasLoaded:"was loaded",wasNotLoaded:"was not loaded",invalidCompositeQuery:"Invalid composite query selector",ComponentQuery:"ComponentQuery",CompositeQuery:"CompositeQuery",matchedNoCmp:"matched no Ext.Component",messageBoxVisible:"Message box is visible",
messageBoxHidden:"Message box is hidden"},"Siesta.Test.Function":{Need:"need",atLeast:"at least",exactly:"exactly",methodCalledExactly:"method was called exactly {n} times",exceptionEvalutingClass:"Exception [{e}] caught while evaluating the class name"},"Siesta.Test.More":{isGreaterPassTpl:"`{value1}` is greater than `{value2}`",isLessPassTpl:"`{value1}` is less than `{value2}`",isGreaterEqualPassTpl:"`{value1}` is greater or equal to`{value2}`",isLessEqualPassTpl:"`{value1}` is less or equal to`{value2}`",
isApproxToPassTpl:"`{value1}` is approximately equal to `{value2}`",needGreaterThan:"Need greater than",needGreaterEqualTo:"Need greater or equal to",needLessThan:"Need less than",needLessEqualTo:"Need less or equal to",exactMatch:"Exact match",withinThreshold:"Match within treshhold",needApprox:"Need approx",thresholdIs:"Threshold is",stringMatchesRe:"`{string}` matches regexp {regex}",stringNotMatchesRe:"`{string}` does not match regexp {regex}",needStringMatching:"Need string matching",needStringNotMatching:"Need string not matching",
needStringContaining:"Need string containing",needStringNotContaining:"Need string not containing",stringHasSubstring:"`{string}` has a substring: `{regex}`",stringHasNoSubstring:"`{string}` does not have a substring: `{regex}`",throwsOkInvalid:"throws_ok accepts a function as 1st argument",didntThrow:"Function did not throw an exception",exMatchesRe:"Function throws exception matching to {expected}",exceptionStringifiesTo:"Exception stringifies to",exContainsSubstring:"Function throws exception containing a substring: {expected}",
fnDoesntThrow:"Function does not throw any exceptions",fnThrew:"Function threw an exception",isInstanceOfPass:"Object is an instance of the specified class",needInstanceOf:"Need instance of",isAString:"{value} is a string",aStringValue:"AStringValue",isAnObject:"{value} is an object",anObject:"An object value",isAnArray:"{value} is an array",anArrayValue:"An array value",isANumber:"{value} is a number",aNumberValue:"a number value",isABoolean:"{value} is a boolean",aBooleanValue:"a number value",
isADate:"{value} is a date",aDateValue:"a date value",isARe:"{value} is a regular expression",aReValue:"a regular expression",isAFunction:"{value} is a function",aFunctionValue:"a function",isDeeplyPassTpl:"{obj1} is deeply equal to {obj2}",isDeeplyStrictPassTpl:"{obj1} is strictly deeply equal to {obj2}",globalCheckNotSupported:"Testing leakage of global variables is not supported on this platform",globalVariables:"Global Variables",noGlobalsFound:"No unexpected global variables found",globalFound:"Unexpected global found",
globalName:"Global name",value:"value",conditionToBeFulfilled:"condition to be fulfilled",ms:"ms",waitingFor:"Waiting for",waitedTooLong:"Waited too long for",conditionNotFulfilled:"Condition was not fullfilled during",waitingAborted:"Waiting aborted",Waited:"Waited",checkerException:"checker threw an exception",Exception:"Exception",msFor:"ms for",forcedWaitFinalization:"Forced finalization of waiting for",chainStepNotCompleted:"The step in `t.chain()` call did not complete within required timeframe, chain can not proceed",
stepNumber:"Step number",oneBased:"(1-based)",atLine:"At line",chainStepEx:"Chain step threw an exception",stepFn:"Step function",notUsingNext:'does not use the provided "next" function anywhere',calledMoreThanOnce:"The `next` callback of {num} step (1-based) of `t.chain()` call at line {line} is called more than once."},"Siesta.Test.SenchaTouch":{STSetupFailed:"Waiting for Ext.setup took too long - some dependency could not be loaded? Check the `Net` tab in Firebug",invalidSwipeDir:"Invalid swipe direction",
moveFingerByInvalidInput:"Trying to call moveFingerBy without relative distances",scrollUntilFailed:"scrollUntil failed to achieve its mission",scrollUntilElementVisibleInvalid:"scrollUntilElementVisible: target or scrollable not provided",scrollerReachPos:"scroller to reach position"},"Siesta.Test":{noCodeProvidedToTest:"No code provided to test",addingAssertionsAfterDone:"Adding assertions after the test has finished",testFailedAndAborted:"Assertion failed, test execution aborted",atLine:"at line",
of:"of",character:"character",isTruthy:'`{value}` is a "truthy" value',needTruthy:'Need "truthy" value',isFalsy:'`{value}` is a "falsy" value',needFalsy:'Need "falsy" value',isEqualTo:"`{got}` is equal to `{expected}`",isNotEqualTo:"`{got}` is not equal to `{expected}`",needNot:"Need not",isStrictlyEqual:"`{got}` is strictly equal to `{expected}`",needStrictly:"Need strictly",isStrictlyNotEqual:"`{got}` is strictly not equal to `{expected}`",needStrictlyNot:"Need strictly not",alreadyWaiting:"Already waiting with title",
noOngoingWait:"There is no ongoing `wait` action with title",noMatchingEndAsync:"No matching `endAsync` call within",endAsyncMisuse:"Calls to endAsync without argument should only be performed if you have single beginAsync statement",codeBodyMissingForSubTest:"Code body is not provided for sub test",codeBodyMissingTestArg:"Code body of sub test [{name}] does not declare a test instance as 1st argument",Subtest:"Subtest",Test:"Test",failedToFinishWithin:"failed to finish within",threwException:"threw an exception",
testAlreadyStarted:"Test has already been started",setupTookTooLong:"`setup` method took too long to complete",errorBeforeTestStarted:"Error happened before the test started",testStillRunning:"Your test is still considered to be running, if this is unexpected please see console for more information",testNotFinalized:'Your test [{url}] has not finalized, most likely since a timer (setTimeout) is still active. If this is the expected behavior, try setting "overrideSetTimeout : false" on your Harness configuration.',
missingDoneCall:"Test has completed, but there was no `t.done()` call. Add it at the bottom, or use `t.beginAsync()` for asynchronous code",allTestsPassed:"All tests passed","Snoozed until":"Snoozed until",testTearDownTimeout:"Test's tear down process has timeout out"},"Siesta.Recorder.Editor.Code":{invalidSyntax:"Invalid syntax"},"Siesta.Recorder.Editor.DragTarget":{targetLabel:"Target",toLabel:"To",byLabel:"By",cancelButtonText:"Cancel",saveButtonText:"Save",dragVariantTitle:"Edit `drag` action",
moveCursorVariantTitle:"Edit `moveCursor` action"},"Siesta.Recorder.UI.EventView":{actionColumnHeader:"Action",offsetColumnHeader:"Offset"},"Siesta.Recorder.UI.RecorderPanel":{queryMatchesNothing:"Query matches no DOM elements or components",queryMatchesMultiple:"Query matches multiple components",noVisibleElsFound:"No visible elements found for target",noTestDetected:"No test detected",noTestStarted:"You need to run a test first",recordTooltip:"Record",stopTooltip:"Stop",playTooltip:"Play",clearTooltip:"Clear all",
codeWindowTitle:"Code",addNewTooltip:"Add a new step",removeAllPromptTitle:"Remove all?",removeAllPromptMessage:"Do you want to clear the recorded events?",Error:"Error"},"Siesta.Recorder.UI.TargetColumn":{headerText:"Target / Value",by:"by",to:"to"}};Siesta.Resource=function(){var a=Class({does:Siesta.Util.Role.CanFormatStrings,has:{dict:null},methods:{get:function(a,c){var d=this.dict[a];if(d)return this.formatString(d,c);window.console&&console.error&&window.top.console.error("TEXT_NOT_DEFINED: "+
a);return"TEXT_NOT_DEFINED: "+a}}});return function(b,c){var d=Siesta.CurrentLocale[b];if(!d)throw"Missing dictionary for namespace: "+b;d=new a({dict:d,serializeFormatingPlaceholders:!1});return c?d.get(c):d}}();(function(){var a=0;Class("Siesta.Result",{has:{description:null,children:Joose.I.Array,length:0,id:function(){return++a},parent:null},methods:{itemAt:function(a){return this.children[a]},push:function(a){this.children.push(a);a.parent=this;this.length=this.children.length},each:function(a,
c){var d=this.children;if(!1===a.call(c||this,this))return!1;for(var e=0;e<d.length;e++)if(!1===d[e].each(a,c))return!1},eachChild:function(a,c){for(var d=this.children,e=0;e<d.length;e++)if(!1===a.call(c,d[e]))return!1},toString:function(){return this.description},toJSON:function(){return{type:this.meta.name,description:this.description}},findChildById:function(a){var c;this.each(function(d){if(d.id==a)return c=d,!1});return c}},my:{methods:{seedID:function(b){a=b}}}})})();Class("Siesta.Result.Diagnostic",
{isa:Siesta.Result,has:{isWarning:!1},methods:{toString:function(){return"# "+this.description},toJSON:function(){var a={type:this.meta.name,description:this.description};this.isWarning&&(a.isWarning=!0);return a}}});Class("Siesta.Result.Summary",{isa:Siesta.Result,has:{isFailed:!1},methods:{getTest:function(){return this.parent.test},toString:function(){}}});Class("Siesta.Result.Assertion",{isa:Siesta.Result,has:{name:null,passed:null,annotation:null,index:null,sourceLine:null,isSkipped:!1,isTodo:!1,
isException:!1,exceptionType:null,isWaitFor:!1,completed:!1},methods:{isPassed:function(a){return a?this.passed:this.isTodo||this.isWaitFor&&!this.completed?!0:this.passed},toString:function(){var a=Siesta.Resource("Siesta.Result.Assertion"),a=(this.isTodo?a.get("todoText"):"")+(this.passed?a.get("passText"):a.get("failText"))+" "+this.index+" - "+this.description;this.annotation&&(a+="\n"+this.annotation);return a},toJSON:function(){var a=this,b={type:this.meta.name,passed:this.passed,description:String(this.description)||
"No description",annotation:String(this.annotation)};Joose.A.each(["isTodo","isWaitFor","isException","sourceLine","name"],function(c){a[c]&&(b[c]=a[c])});this.isException&&(b.exceptionType=this.exceptionType);return b}}});Class("Siesta.Result.SubTest",{isa:Siesta.Result,has:{test:null},methods:{isWorking:function(){return!this.test.isFinished()},toJSON:function(){var a=this.test,b=!(a instanceof Object),c={type:this.meta.name,name:a.name,startDate:a.startDate,endDate:a.endDate||new Date-0,passed:b?
null:a.isPassed()};a.parent||(c.url=a.url,c.jUnitClass=a.getJUnitClass(),c.groups=a.groups);a.specType&&(c.bddSpecType=a.specType);var d=!1,e=[];Joose.A.each(this.children,function(a){if(a instanceof Siesta.Result.Assertion||a instanceof Siesta.Result.Diagnostic||a instanceof Siesta.Result.SubTest)a=a.toJSON(),a.passed||a.isTodo||(d=!0),e.push(a)});c.assertions=e;b&&(c.passed=!(d||a.failed||!a.endDate));return c}}});Role("Siesta.Test.Function",{methods:{isCalled:function(a,b,c){this.isCalledNTimes(a,
b,1,c,!0)},isCalledOnce:function(a,b,c){this.isCalledNTimes(a,b,1,c,!1)},isCalledNTimes:function(a,b,c,d,e){var g=this,k="string"===typeof a?a:g.getPropertyName(b,a),l=0,f=Siesta.Resource("Siesta.Test.Function");d=d?d+" ":"";this.on("beforetestfinalizeearly",function(){l===c||e&&l>c?g.pass(d||k+" "+f.get("methodCalledExactly").replace("{n}",c)):g.fail(d||k,{assertionName:"isCalledNTimes "+k,got:l,need:c,needDesc:f.get("Need")+" "+(e?f.get("atLeast"):f.get("exactly"))+" "})});a=b[k];b[k]=function(){l++;
return a.apply(this,arguments)}},isntCalled:function(a,b,c){this.isCalledNTimes(a,b,0,c)},getPropertyName:function(a,b){for(var c in a)if(a[c]===b)return c},methodIsCalledNTimes:function(a,b,c,d,e){var g=this,k=0,l=Siesta.Resource("Siesta.Test.Function");d=d?d+" ":"";try{"String"==g.typeOf(b)&&(b=g.global.eval(b))}catch(f){g.fail(d,{assertionName:"isMethodCalled",annotation:l.get("exceptionEvalutingClass").replace("{e}",f)+"["+b+"]"});return}b=b.prototype;var n="string"===typeof a?a:g.getPropertyName(b,
a);g.on("beforetestfinalizeearly",function(){k===c||e&&k>c?g.pass(d||n+" "+l.get("methodCalledExactly").replace("{n}",c)):g.fail(d||n,{assertionName:"methodIsCalledNTimes "+n,got:k,need:c,needDesc:l.get("Need")+" "+(e?l.get("atLeast"):l.get("exactly"))+" "})});a=b[n];b[n]=function(){k++;return a.apply(this,arguments)}},methodIsCalled:function(a,b,c){this.methodIsCalledNTimes(a,b,1,c,!0)},methodIsntCalled:function(a,b,c){this.methodIsCalledNTimes(a,b,0,c)}}});Role("Siesta.Test.Date",{methods:{isDateEq:function(a,
b,c){this.isDateEqual.apply(this,arguments)},isDateEqual:function(a,b,c){var d=Siesta.Resource("Siesta.Test.Date");0===a-b?this.pass(c,{descTpl:"{got} "+d.get("isEqualTo")+" {expectedDate}",got:a,expectedDate:b}):this.fail(c,{assertionName:"isDateEqual",got:a?a.toString():"",gotDesc:d.get("Got"),need:b.toString()})}}});Role("Siesta.Test.More",{requires:["isFailed","typeOf","on"],has:{autoCheckGlobals:!1,expectedGlobals:Joose.I.Array,disableGlobalsCheck:!1,browserGlobals:{init:["console","getInterface",
"ExtBox1","__IE_DEVTOOLBAR_CONSOLE_COMMAND_LINE",/__BROWSERTOOLS/,"seleniumAlert","_phantom","callPhantom","onload","onerror","StartTest","startTest","__loaderInstrumentationHookInstalled__","describe","setTimeout","clearTimeout","requestAnimationFrame","cancelAnimationFrame","__coverage__",/__cov_\d+/]},waitForTimeout:1E4,waitForPollInterval:100},methods:{isGreater:function(a,b,c){var d=Siesta.Resource("Siesta.Test.More");a>b?this.pass(c,{descTpl:d.get("isGreaterPassTpl"),value1:a,value2:b}):this.fail(c,
{assertionName:"isGreater",got:a,need:b,needDesc:d.get("needGreaterThan")})},isLess:function(a,b,c){var d=Siesta.Resource("Siesta.Test.More");a<b?this.pass(c,{descTpl:d.get("isLessPassTpl"),value1:a,value2:b}):this.fail(c,{assertionName:"isLess",got:a,need:b,needDesc:d.get("needLessThan")})},isGE:function(){this.isGreaterOrEqual.apply(this,arguments)},isGreaterOrEqual:function(a,b,c){var d=Siesta.Resource("Siesta.Test.More");a>=b?this.pass(c,{descTpl:d.get("isGreaterEqualPassTpl"),value1:a,value2:b}):
this.fail(c,{assertionName:"isGreaterOrEqual",got:a,need:b,needDesc:d.get("needGreaterEqualTo")})},isLE:function(){this.isLessOrEqual.apply(this,arguments)},isLessOrEqual:function(a,b,c){var d=Siesta.Resource("Siesta.Test.More");a<=b?this.pass(c,{descTpl:d.get("isLessEqualPassTpl"),value1:a,value2:b}):this.fail(c,{assertionName:"isLessOrEqual",got:a,need:b,needDesc:d.get("needLessEqualTo")})},isApprox:function(a,b,c,d){var e=Siesta.Resource("Siesta.Test.More");2==arguments.length&&(c=Math.abs(0.05*
a));3==arguments.length&&"String"==this.typeOf(c)&&(d=c,c=Math.abs(0.05*a));Math.abs(function(a,b){var c=function(a){return(a=(a+"").split(".")[1])&&a.length||0},c=Math.max(c(a),c(b)),c=Math.pow(10,c);return(a*c-b*c)/c}(b,a))<=c?this.pass(d,{descTpl:e.get("isApproxToPassTpl"),value1:a,value2:b,annotation:b==a?e.get("exactMatch"):e.get("withinThreshold")+": "+c}):this.fail(d,{assertionName:"isApprox",got:a,need:b,needDesc:e.get("needApprox"),annotation:e.get("thresholdIs")+": "+c})},like:function(a,
b,c){var d=Siesta.Resource("Siesta.Test.More");"RegExp"==this.typeOf(b)?a.match(b)?this.pass(c,{descTpl:d.get("stringMatchesRe"),string:a,regex:b}):this.fail(c,{assertionName:"like",got:a,need:b,needDesc:d.get("needStringMatching")}):-1!=a.indexOf(b)?this.pass(c,{descTpl:d.get("stringHasSubstring"),string:a,regex:b}):this.fail(c,{assertionName:"like",got:a,need:b,needDesc:d.get("needStringContaining")})},unlike:function(a,b,c){var d=Siesta.Resource("Siesta.Test.More");"RegExp"==this.typeOf(b)?a.match(b)?
this.fail(c,{assertionName:"unlike",got:a,need:b,needDesc:d.get("needStringNotMatching")}):this.pass(c,{descTpl:d.get("stringNotMatchesRe"),string:a,regex:b}):-1==a.indexOf(b)?this.pass(c,{descTpl:d.get("stringHasNoSubstring"),string:a,regex:b}):this.fail(c,{assertionName:"unlike",got:a,need:b,needDesc:d.get("needStringNotContaining")})},"throws":function(){this.throwsOk.apply(this,arguments)},throws_ok:function(){this.throwsOk.apply(this,arguments)},throwsOk:function(a,b,c){var d=Siesta.Resource("Siesta.Test.More");
if("Function"!=this.typeOf(a))throw Error(d.get("throwsOkInvalid"));a=this.getExceptionCatcher()(a);void 0===a?this.fail(c,{assertionName:"throws_ok",annotation:d.get("didntThrow")}):(a instanceof this.getTestErrorClass()&&(a=a.message||a.description),a=""+a,"RegExp"==this.typeOf(b)?a.match(b)?this.pass(c,{descTpl:d.get("exMatchesRe"),expected:b}):this.fail(c,{assertionName:"throws_ok",got:a,gotDesc:d.get("exceptionStringifiesTo"),need:b,needDesc:d.get("needStringMatching")}):-1!=a.indexOf(b)?this.pass(c,
{descTpl:d.get("exContainsSubstring"),expected:b}):this.fail(c,{assertionName:"throws_ok",got:a,gotDesc:d.get("exceptionStringifiesTo"),need:b,needDesc:d.get("needStringContaining")}))},lives_ok:function(){this.livesOk.apply(this,arguments)},lives:function(){this.livesOk.apply(this,arguments)},livesOk:function(a,b){"Function"!=this.typeOf(a)&&(a=[b,b=a][0]);var c=Siesta.Resource("Siesta.Test.More"),d=this.getExceptionCatcher()(a);void 0===d?this.pass(b,{descTpl:c.get("fnDoesntThrow")}):this.fail(b,
{assertionName:"lives_ok",annotation:c.get("fnThrew")+": "+d})},isa_ok:function(a,b,c){this.isInstanceOf(a,b,c)},isaOk:function(a,b,c){this.isInstanceOf(a,b,c)},isInstanceOf:function(a,b,c){var d=Siesta.Resource("Siesta.Test.More");try{"String"==this.typeOf(b)&&(b=this.global.eval(b))}catch(e){this.fail(c,{assertionName:"isa_ok",annotation:Siesta.Resource("Siesta.Test.Function","exceptionEvalutingClass")});return}a instanceof b?this.pass(c,{descTpl:d.get("isInstanceOfPass")}):this.fail(c,{assertionName:"isa_ok",
got:a,need:String(b),needDesc:d.get("needInstanceOf")})},isString:function(a,b){var c=Siesta.Resource("Siesta.Test.More");"String"==this.typeOf(a)?this.pass(b,{descTpl:c.get("isAString"),value:a}):this.fail(b,{got:a,need:c.get("aStringValue")})},isObject:function(a,b){var c=Siesta.Resource("Siesta.Test.More");"Object"==this.typeOf(a)?this.pass(b,{descTpl:c.get("isAnObject"),value:a}):this.fail(b,{got:a,need:c.get("anObject")})},isArray:function(a,b){var c=Siesta.Resource("Siesta.Test.More");"Array"==
this.typeOf(a)?this.pass(b,{descTpl:c.get("isAnArray"),value:a}):this.fail(b,{got:a,need:c.get("anArrayValue")})},isNumber:function(a,b){var c=Siesta.Resource("Siesta.Test.More");"Number"==this.typeOf(a)?this.pass(b,{descTpl:c.get("isANumber"),value:a}):this.fail(b,{got:a,need:c.get("aNumberValue")})},isBoolean:function(a,b){var c=Siesta.Resource("Siesta.Test.More");"Boolean"==this.typeOf(a)?this.pass(b,{descTpl:c.get("isABoolean"),value:a}):this.fail(b,{got:a,need:c.get("aBooleanValue")})},isDate:function(a,
b){var c=Siesta.Resource("Siesta.Test.More");"Date"==this.typeOf(a)?this.pass(b,{descTpl:c.get("isADate"),value:a}):this.fail(b,{got:a,need:c.get("aDateValue")})},isRegExp:function(a,b){var c=Siesta.Resource("Siesta.Test.More");"RegExp"==this.typeOf(a)?this.pass(b,{descTpl:c.get("isARe"),value:a}):this.fail(b,{got:a,need:c.get("aReValue")})},isFunction:function(a,b){var c=Siesta.Resource("Siesta.Test.More");"Function"==this.typeOf(a)?this.pass(b,{descTpl:c.get("isAFunction"),value:a}):this.fail(b,
{got:a,need:c.get("aFunctionValue")})},is_deeply:function(a,b,c){this.isDeeply.apply(this,arguments)},isDeeply:function(a,b,c){if(this.typeOf(a)===this.typeOf(b)&&this.compareObjects(a,b)){var d=Siesta.Resource("Siesta.Test.More");this.pass(c,{descTpl:d.get("isDeeplyPassTpl"),obj1:a,obj2:b})}else this.fail(c,{assertionName:"isDeeply",got:a,need:b})},isDeeplyStrict:function(a,b,c){if(this.typeOf(a)===this.typeOf(b)&&this.compareObjects(a,b,!0)){var d=Siesta.Resource("Siesta.Test.More");this.pass(c,
{descTpl:d.get("isDeeplyStrictPassTpl"),obj1:a,obj2:b})}else this.fail(c,{assertionName:"isDeeplyStrict",got:a,need:b})},expectGlobal:function(){this.expectGlobals.apply(this,arguments)},expectGlobals:function(){this.expectedGlobals.push.apply(this.expectedGlobals,arguments)},isGlobalExpected:function(a,b){var c=this;if(!b||b&&!b.expectedStrings)b||(b={}),Joose.O.extend(b,{expectedStrings:{},expectedRegExps:[]}),Joose.A.each(this.expectedGlobals.concat(this.browserGlobals),function(a){"RegExp"==c.typeOf(a)?
b.expectedRegExps.push(a):b.expectedStrings[a]=!0});if(b.expectedStrings[a])return!0;if(Siesta.Harness.Browser.FeatureSupport().supports.imageWithIdCreatesGlobalEnumerable){var d=this.global.document.getElementById(a);if(d&&"img"==d.tagName.toLowerCase())return!0}for(d=0;d<b.expectedRegExps.length;d++)if(b.expectedRegExps[d].test(a))return!0;return!1},forEachUnexpectedGlobal:function(a,b){b=b||this;var c={},d;for(d in this.global)this.isGlobalExpected(d,c)||a.call(b,d)},verifyGlobals:function(){var a=
Siesta.Resource("Siesta.Test.More");if(this.disableGlobalsCheck)this.diag(a.get("globalCheckNotSupported"));else{this.expectGlobals.apply(this,arguments);this.diag(a.get("globalVariables"));var b=!1;this.forEachUnexpectedGlobal(function(c){this.fail(a.get("globalFound"),a.get("globalName")+": "+c+", "+a.get("value")+": "+Siesta.Util.Serializer.stringify(this.global[c]));b=!0});b||this.pass(a.get("noGlobalsFound"))}},startWaiting:function(a,b){var c=new Siesta.Result.Assertion({description:a,isWaitFor:!0,
sourceLine:b});this.fireEvent("testupdate",this,c,this.getResults());return c},finalizeWaiting:function(a,b,c,d,e){a.completed=!0;b?this.pass(c,d,a):(this.fail(c,d,a),e&&e())},waitFor:function(a,b,c,d,e){var g=Siesta.Resource("Siesta.Test.More"),k=" "+g.get("conditionToBeFulfilled"),l="waitFor",f=this,n=f.getSourceLine(),p=f.originalSetTimeout,r=f.originalClearTimeout,s;if(1===arguments.length&&"Object"==this.typeOf(a)){var t=a;a=t.method;b=t.callback;c=t.scope;d=t.timeout;e=t.interval;k=t.description||
k;l=t.assertionName||l;s=t.errback}t="Number"==this.typeOf(a);b=b||function(){};var k=t?a+" "+g.get("ms"):k,w,y=f.startWaiting(g.get("waitingFor")+" "+k,n);e=e||this.waitForPollInterval;d=d||this.waitForTimeout;var z=this.beginAsync((t?a:d)+3*e,function(){r(w);f.finalizeWaiting(y,!1,g.get("waitedTooLong")+": "+k,{assertionName:l,annotation:g.get("conditionNotFulfilled")+" "+d+g.get("ms")},s);return!0}),C=!1;this.on("beforetestfinalize",function(){C||(C=!0,f.finalizeWaiting(y,!1,g.get("waitingAborted")),
f.endAsync(z),r(w))},null,{single:!0});if(t)w=p(function(){C=!0;f.finalizeWaiting(y,!0,g.get("Waited")+" "+a+" "+g.get("ms"));f.endAsync(z);f.processCallbackFromTest(b,[],c||f)},a);else{var M,H=new Date,P=function(){var n=new Date-H;if(n>d)f.endAsync(z),f.finalizeWaiting(y,!1,g.get("waitedTooLong")+": "+k,{assertionName:l,annotation:g.get("conditionNotFulfilled")+" "+d+g.get("ms")},s),C=!0;else{try{M=a.call(c||f)}catch(r){f.endAsync(z);f.finalizeWaiting(y,!1,l+" "+g.get("checkerException"),{assertionName:l,
got:r.toString(),gotDesc:g.get("Exception")},s);C=!0;return}null!=M&&!1!==M?(f.endAsync(z),C=!0,f.finalizeWaiting(y,!0,g.get("Waited")+" "+n+" "+g.get("msFor")+" "+k),f.processCallbackFromTest(b,[M],c||f)):w=p(P,e)}};P()}return{force:function(){C||(C=!0,r(w),f.endAsync(z),f.finalizeWaiting(y,!0,g.get("forcedWaitFinalization")+" "+k),f.processCallbackFromTest(b,[],c||f))}}},waitForMs:function(){return this.waitFor.apply(this,arguments)},waitForFn:function(){return this.waitFor.apply(this,arguments)},
analyzeChainStep:function(a){a=a.toString();var b=a.match(/function\s*[^(]*\(\s*(.*?)\s*(?:,|\))/)[1];return b?-1!=a.match(/\{([\s\S]*)\}/)[1].indexOf(b):!1},chain:function(){var a=this.flattenArray(arguments),b=Siesta.Resource("Siesta.Test.More"),c=[];Joose.A.each(a,function(a){a&&c.push(a)});var a=c,d=a.length;if(d){var e=this,g=arguments.callee,k=new Siesta.Util.Queue({deferer:this.originalSetTimeout,deferClearer:this.originalClearTimeout,interval:g.hasOwnProperty("actionDelay")?g.actionDelay:
this.actionDelay,observeTest:this});delete g.actionDelay;var l=e.getSourceLine(),f=[];Joose.A.each(a,function(a,c){var g=c==d-1;k.addAsyncStep({processor:function(d){var k="wait"==a.action||a.waitFor||a instanceof Siesta.Test;if(!k)var w=e.beginAsync((a.timeout||e.defaultTimeout)+100,function(){e.fail(b.get("chainStepNotCompleted"),{sourceLine:l,annotation:b.get("stepNumber")+": "+(c+1)+" "+b.get("oneBased")+(l?"\n"+b.get("atLine")+": "+l:""),ownTextOnly:!0});return!0});var y=function(){var g=arguments.callee;
g.__CALLED__&&e.fail(b.get("calledMoreThanOnce",{num:c+1,line:l}));g.__CALLED__=!0;k||e.endAsync(w);f=Array.prototype.slice.call(arguments);a.desc&&e.pass(a.desc);d.next()};if(a instanceof Siesta.Test)e.launchSubTest(a,y);else if("Function"==e.typeOf(a)||"Function"==e.typeOf(a.action)){var z="Function"==e.typeOf(a)?a:a.action;f.unshift(g?function(){}:y);g||e.analyzeChainStep(z)||e.fail(b.get("stepFn")+" ["+z.toString()+"] "+b.get("notUsingNext"));e.transparentEx?z.apply(e,f):(y=e.getExceptionCatcher()(function(){z.apply(e,
f)}),void 0!==y&&e.fail(b.get("chainStepEx"),{annotation:e.stringifyException(y)}));g&&e.endAsync(w)}else"String"==e.typeOf(a)?y=new Siesta.Test.Action.Eval({actionString:a,next:y,test:e}):(a.next=y,a.test=e,y=Siesta.Test.ActionRegistry().create(a,e,f)),y.process()}})});k.run()}},chainForArray:function(a,b,c,d){var e=this,g=[];Joose.A[d?"eachR":"each"](a,function(a,c){var d=b.call(e,a,c);"Array"==e.typeOf(d)?g.push.apply(g,d):d&&g.push(d)});c&&g.push(function(){e.processCallbackFromTest(c)});this.chain(g)},
verifyExpectedNumber:function(a,b){var c="==";if("String"==this.typeOf(b)){var d=/([<>=]=?)\s*(\d+)/.exec(b),c=Siesta.Resource("Siesta.Test.Browser");if(!d)throw Error(c.get("wrongFormat")+": "+b);c=d[1];b=Number(d[2])}switch(c){case "==":return a==b;case "<=":return a<=b;case ">=":return a>=b;case "<":return a<b;case ">":return a>b}}},after:{initialize:function(){this.on("beforetestfinalize",function(){!this.autoCheckGlobals||(this.isFailed()||this.parent)||this.verifyGlobals()},this)}}});Role("Siesta.Test.Role.Placeholder",
{requires:["equalsTo"]});Class("Siesta.Test.BDD.Spy",{does:[Siesta.Util.Role.CanGetType],has:{name:null,processor:{lazy:"this.buildProcessor"},hostObject:null,propertyName:null,hasOwnOriginalValue:!1,originalValue:null,strategy:"returnValue",returnValueObj:void 0,fakeFunc:null,throwErrorObj:null,callsLog:Joose.I.Array,calls:null,t:null,and:function(){return this}},methods:{initialize:function(){var a=this;this.calls={any:function(){return 0<a.callsLog.length},count:function(){return a.callsLog.length},
argsFor:function(b){return a.callsLog[b].args},allArgs:function(b){return Joose.A.map(a.callsLog,function(a){return a.args})},all:function(){return a.callsLog},mostRecent:function(){return a.callsLog[a.callsLog.length-1]},first:function(){return a.callsLog[0]},reset:function(){a.reset()}};var b=Siesta.Resource("Siesta.Test.BDD.Spy"),c=this.hostObject,d=this.propertyName;if(c){if("Function"!=this.typeOf(c[d]))throw b.get("spyingNotOnFunction");this.hasOwnOriginalValue=c.hasOwnProperty(d);this.originalValue=
c[d];this.originalValue.__SIESTA_SPY__&&this.originalValue.__SIESTA_SPY__.remove();c[d]=this.getProcessor()}this.t&&this.t.spies.push(this)},buildProcessor:function(){var a=this,b=function(){var b=Array.prototype.slice.call(arguments),d={object:this,args:b};a.callsLog.push(d);return d.returnValue=a[a.strategy+"Strategy"](this,b)};b.__SIESTA_SPY__=b.and=a;b.calls=a.calls;return b},returnValueStrategy:function(a,b){return this.returnValueObj},callThroughStrategy:function(a,b){return this.originalValue.apply(a,
b)},callFakeStrategy:function(a,b){return this.fakeFunc.apply(a,b)},throwErrorStrategy:function(a,b){var c=this.throwErrorObj,d=this.t&&this.t.global?this.t.global.Error:Error;c instanceof d||(c=new d(c));throw c;},callThrough:function(){if(!this.hostObject)throw"Need the host object to call through to original method";this.strategy="callThrough";return this},stub:function(){this.returnValue();return this},returnValue:function(a){this.strategy="returnValue";this.returnValueObj=a;return this},callFake:function(a){this.strategy=
"callFake";this.fakeFunc=a;return this},throwError:function(a){this.strategy="throwError";this.throwErrorObj=a;return this},remove:function(){var a=this.hostObject;a&&(this.hasOwnOriginalValue?a[this.propertyName]=this.originalValue:delete a[this.propertyName]);this.originalValue=this.hostObject=null;this.callsLog=[];this.returnValueObj=this.fakeFunc=this.throwErrorObj=null;a=this.getProcessor();this.processor=a.and=a.calls=a.__SIESTA_SPY__=null},reset:function(){this.callsLog=[]}}});Class("Siesta.Test.BDD.Placeholder",
{does:Siesta.Test.Role.Placeholder,has:{clsConstructor:{required:!0},t:null,context:null,globals:{init:"String Boolean Number Date RegExp Function Array Object".split(" ")}},methods:{getClassName:function(a){var b=this.getClassConstructor(),c=this.context,d;Joose.A.each(this.globals,function(a){if(b==c[a])return d=a,!1});return a?d:d||(b?b+"":"")},getClassConstructor:function(){return this.clsConstructor},equalsTo:function(a){var b=this.getClassConstructor();if(!b)return!0;if(a instanceof Siesta.Test.BDD.Placeholder){var c=
this.getClassName(!0);return"Object"!=a.getClassName(!0)||"Date"!=c&&"RegExp"!=c&&"Function"!=c&&"Array"!=c?b==a.getClassConstructor():!0}var c=!1,d=this.getClassName(!0);d&&(c=this.t.typeOf(a)==d||a instanceof this.context[d]);return c||a instanceof b},toString:function(){return"any "+(this.getClassName()||"value")}}});Class("Siesta.Test.BDD.NumberPlaceholder",{does:Siesta.Test.Role.Placeholder,has:{value:{required:!0},threshold:null},methods:{initialize:function(){null==this.threshold&&(this.threshold=
0.05*this.value)},equalsTo:function(a){return Math.abs(a-this.value)<=this.threshold},toString:function(){return"any number approximately equal to "+this.value}}});Class("Siesta.Test.BDD.StringPlaceholder",{does:Siesta.Test.Role.Placeholder,has:{value:{required:!0}},methods:{equalsTo:function(a){return"[object RegExp]"==Object.prototype.toString(this.value)?this.value.test(a):-1<String(a).indexOf(this.value)},toString:function(){return"[object RegExp]"==Object.prototype.toString(this.value)?"any string matching: "+
this.value:"any string containing: "+this.value}}});Class("Siesta.Test.BDD.Expectation",{does:[Siesta.Util.Role.CanGetType],has:{value:null,isNot:!1,not:null,t:null},methods:{initialize:function(){this.isNot||(this.not=new this.constructor({isNot:!0,t:this.t,value:this.value}))},process:function(a,b){var c=this.isNot;b=b||{};b.not=b.not||c?"not ":"";b.got=b.hasOwnProperty("got")?b.got:this.value;b.noGot&&delete b.got;var d=b.assertionName;d&&c&&(b.assertionName=d.replace(/^(expect\(.+?\)\.)/,"$1not."));
this.t[(c?!a:a)?"pass":"fail"](null,b)},toBe:function(a){var b=Siesta.Resource("Siesta.Test.BDD.Expectation");this.process(this.t.compareObjects(this.value,a,!0,!0),{descTpl:b.get("expectText")+" {got} {!not}"+b.get("toBeText")+" {need}",assertionName:"expect(got).toBe(need)",need:a,needDesc:this.isNot?b.get("needNotText"):b.get("needText")})},toEqual:function(a){var b=Siesta.Resource("Siesta.Test.BDD.Expectation");this.process(this.t.compareObjects(this.value,a,!0),{descTpl:b.get("expectText")+" {got} {!not}"+
b.get("toBeEqualToText")+" {need}",assertionName:"expect(got).toEqual(need)",need:a,needDesc:this.isNot?b.get("needNotText"):b.get("needText")})},toBeNull:function(){var a=Siesta.Resource("Siesta.Test.BDD.Expectation");this.process(this.t.compareObjects(this.value,null,!0,!0),{descTpl:a.get("expectText")+" {got} {!not}"+a.get("toBeText")+" null",assertionName:"expect(got).toBeNull()",need:null,needDesc:this.isNot?a.get("needNotText"):a.get("needText")})},toBeNaN:function(){var a=this.value,b=Siesta.Resource("Siesta.Test.BDD.Expectation");
this.process("Number"==this.t.typeOf(a)&&a!=a,{descTpl:b.get("expectText")+" {got} {!not}"+b.get("toBeText")+" NaN",assertionName:"expect(got).toBeNaN()",need:NaN,needDesc:this.isNot?b.get("needNotText"):b.get("needText")})},toBeDefined:function(){var a=Siesta.Resource("Siesta.Test.BDD.Expectation");this.process(void 0!==this.value,{descTpl:a.get("expectText")+" {got} {!not}"+a.get("toBeDefinedText"),assertionName:"expect(got).toBeDefined()"})},toBeUndefined:function(a){a=Siesta.Resource("Siesta.Test.BDD.Expectation");
this.process(void 0===this.value,{descTpl:a.get("expectText")+" {got} {!not}"+a.get("toBeUndefinedText"),assertionName:"expect(got).toBeUndefined()"})},toBeTruthy:function(){var a=Siesta.Resource("Siesta.Test.BDD.Expectation");this.process(this.value,{descTpl:a.get("expectText")+" {got} {!not}"+a.get("toBeTruthyText"),assertionName:"expect(got).toBeTruthy()"})},toBeFalsy:function(){var a=Siesta.Resource("Siesta.Test.BDD.Expectation");this.process(!this.value,{descTpl:a.get("expectText")+" {got} {!not}"+
a.get("toBeFalsyText"),assertionName:"expect(got).toBeFalsy()"})},toMatch:function(a){var b=Siesta.Resource("Siesta.Test.BDD.Expectation");if("RegExp"!=this.t.typeOf(a))throw Error("`expect().toMatch()` matcher expects a regular expression");this.process(RegExp(a).test(this.value),{descTpl:b.get("expectText")+" {got} {!not}"+b.get("toMatchText")+" {need}",assertionName:"expect(got).toMatch(need)",need:a,needDesc:this.isNot?b.get("needNotMatchingText"):b.get("needMatchingText")})},toContain:function(a){var b=
this.value,c=this.t,d=Siesta.Resource("Siesta.Test.BDD.Expectation"),e=!1;if("String"==c.typeOf(b))this.process(0<=b.indexOf(a),{descTpl:d.get("expectText")+" {got} {!not}"+d.get("toContainText")+" {need}",assertionName:"expect(got).toContain(need)",need:a,needDesc:this.isNot?d.get("needStringNotContainingText"):d.get("needStringContainingText")});else{for(var b=Array.prototype.slice.call(b),g=0;g<b.length;g++)if(c.compareObjects(a,b[g],!0)){e=!0;break}this.process(e,{descTpl:d.get("expectText")+
" {got} {!not}"+d.get("toContainText")+" {need}",assertionName:"expect(got).toContain(need)",need:a,needDesc:this.isNot?d.get("needArrayNotContainingText"):d.get("needArrayContainingText")})}},toBeLessThan:function(a){var b=Siesta.Resource("Siesta.Test.BDD.Expectation");this.process(this.value<a,{descTpl:b.get("expectText")+" {got} {!not}"+b.get("toBeLessThanText")+" {need}",assertionName:"expect(got).toBeLessThan(need)",need:a,needDesc:this.isNot?b.get("needGreaterEqualThanText"):b.get("needLessThanText")})},
toBeGreaterThan:function(a){var b=Siesta.Resource("Siesta.Test.BDD.Expectation");this.process(this.value>a,{descTpl:b.get("expectText")+" {got} {!not}"+b.get("toBeGreaterThanText")+" {need}",assertionName:"expect(got).toBeGreaterThan(need)",need:a,needDesc:this.isNot?b.get("needLessEqualThanText"):b.get("needGreaterThanText")})},toBeCloseTo:function(a,b){var c=Math.pow(10,-(null!=b?b:2))/2,d=Math.abs(this.value-a),e=Siesta.Resource("Siesta.Test.BDD.Expectation");this.process(d<c,{descTpl:e.get("expectText")+
" {got} {!not}"+e.get("toBeCloseToText")+" {need}",assertionName:"expect(got).toBeCloseTo(need)",need:a,needDesc:this.isNot?e.get("needValueNotCloseToText"):e.get("needValueCloseToText"),annotation:d?e.get("thresholdIsText")+c:e.get("exactMatchText")})},toThrow:function(){var a=this.value,b=this.t,c=Siesta.Resource("Siesta.Test.BDD.Expectation");if("Function"!=b.typeOf(a))throw Error("`expect().toMatch()` matcher expects a function");a=b.getExceptionCatcher()(a);a instanceof b.getTestErrorClass()&&
(a=a.message||a.description);this.process(void 0!==a,{descTpl:c.get("expectText")+" function {!not}"+c.get("toThrowText"),assertionName:"expect(func).toThrow()",annotation:a?c.get("thrownExceptionText")+": "+Siesta.Util.Serializer.stringify(a):c.get("noExceptionThrownText"),noGot:!0})},toHaveBeenCalled:function(a){a=null!=a?a:">=1";var b=this.value,c=this.t,d=Siesta.Resource("Siesta.Test.BDD.Expectation");if("Function"==this.typeOf(b)){if(!b.__SIESTA_SPY__)throw Error(d.get("wrongSpy"));b=b.__SIESTA_SPY__}if(!(b instanceof
Siesta.Test.BDD.Spy))throw Error(d.get("wrongSpy"));this.process(c.verifyExpectedNumber(b.callsLog.length,a),{descTpl:d.get("toHaveBeenCalledDescTpl"),assertionName:"expect(func).toHaveBeenCalled()",methodName:b.propertyName,got:b.callsLog.length,gotDesc:d.get("actualNbrOfCalls"),need:a,needDesc:d.get("expectedNbrOfCalls")})},toHaveBeenCalledWith:function(){var a=this.value,b=this.t,c=Siesta.Resource("Siesta.Test.BDD.Expectation");if("Function"==this.typeOf(a)){if(!a.__SIESTA_SPY__)throw Error(c.get("wrongSpy"));
a=a.__SIESTA_SPY__}if(!(a instanceof Siesta.Test.BDD.Spy))throw Error(c.get("wrongSpy"));var d=Array.prototype.slice.call(arguments),e=!1;Joose.A.each(a.callsLog,function(a){if(b.compareObjects(a.args,d))return e=!0,!1});this.process(e,{descTpl:c.get("toHaveBeenCalledWithDescTpl"),assertionName:"expect(func).toHaveBeenCalledWith()",methodName:a.propertyName,noGot:!0})}}});Role("Siesta.Test.BDD",{requires:["getSubTest","chain"],has:{specType:null,beforeEachHooks:Joose.I.Array,afterEachHooks:Joose.I.Array,
sequentialSubTests:Joose.I.Array,codeProcessed:!1,launchTimeout:null,expectationClass:Siesta.Test.BDD.Expectation,failOnExclusiveSpecsWhenAutomated:!1,spies:Joose.I.Array},methods:{checkSpecFunction:function(a,b,c){if(!a)throw Error(Siesta.Resource("Siesta.Test.BDD","codeBodyMissing")+" "+("describe"==b?"suite":"spec")+" ["+c+"]");if(!a.length)throw Error(Siesta.Resource("Siesta.Test.BDD","codeBodyOf")+" "+("describe"==b?"suite":"spec")+" ["+c+"] "+Siesta.Resource("Siesta.Test.BDD","missingFirstArg"));
},ddescribe:function(a,b,c){this.describe(a,b,c,!0)},xdescribe:function(){},describe:function(a,b,c,d){this.checkSpecFunction(b,"describe",a);a=this.getSubTest({name:a,run:b,isExclusive:d,specType:"describe",timeout:c});this.codeProcessed&&this.scheduleSpecsLaunch();this.sequentialSubTests.push(a)},iit:function(a,b,c){this.harness.isAutomated&&this.failOnExclusiveSpecsWhenAutomated&&this.fail(Siesta.Resource("Siesta.Test.BDD","iitFound"));this.it(a,b,c,!0)},xit:function(){},it:function(a,b,c,d){this.checkSpecFunction(b,
"it",a);a=this.getSubTest({name:a,run:b,isExclusive:d,specType:"it",timeout:c});this.codeProcessed&&this.scheduleSpecsLaunch();this.sequentialSubTests.push(a)},expect:function(a){return new this.expectationClass({t:this,value:a})},any:function(a){return new Siesta.Test.BDD.Placeholder({clsConstructor:a,t:this,context:this.global})},anyNumberApprox:function(a,b){return new Siesta.Test.BDD.NumberPlaceholder({value:a,threshold:b})},anyStringLike:function(a){return new Siesta.Test.BDD.StringPlaceholder({value:a})},
scheduleSpecsLaunch:function(){if(!this.launchTimeout){var a=this.beginAsync(),b=this.originalSetTimeout,c=this;this.launchTimeout=b(function(){c.endAsync(a);c.launchTimeout=null;c.launchSpecs()},0)}},runBeforeSpecHooks:function(a){var b=this,c=function(a){b.chainForArray(b.beforeEachHooks,function(a){return a.isAsync?a.code:function(b){a.code();b()}},a)};this.parent?this.parent.runBeforeSpecHooks(function(){c(a)}):c(a)},runAfterSpecHooks:function(a){var b=this;b.chainForArray(this.afterEachHooks,
function(a){return a.isAsync?a.code:function(b){a.code();b()}},function(){b.parent?b.parent.runAfterSpecHooks(a):a()},!0)},launchSpecs:function(){var a=this,b=this.sequentialSubTests;this.sequentialSubTests=[];this.chain.actionDelay=0;var c=[];Joose.A.each(b,function(a){a.isExclusive&&c.push(a)});this.chainForArray(c.length?c:b,function(b){return["it"==b.specType?function(b){a.runBeforeSpecHooks(b)}:null,b,"it"==b.specType?function(b){a.runAfterSpecHooks(b)}:null]})},beforeEach:function(a,b){this.beforeEachHooks.push({code:a,
isAsync:b})},afterEach:function(a,b){this.afterEachHooks.push({code:a,isAsync:b})},spyOn:function(a,b){var c=Siesta.Resource("Siesta.Test.BDD");if(a)return new Siesta.Test.BDD.Spy({name:b,t:this,hostObject:a,propertyName:b});this.warn(c.get("noObject"))},createSpy:function(a){return(new Siesta.Test.BDD.Spy({name:a||"James Bond",t:this})).getProcessor()},createSpyObj:function(a,b){1==arguments.length&&(b=a,a=null);a=a||"spyObject";var c=this,d={};Joose.A.each(b,function(b){d[b]=c.createSpy(a)});return d}},
override:{onTestFinalize:function(){Joose.A.each(this.spies,function(a){a.remove()});this.spies=null;this.SUPER()},afterLaunch:function(){this.codeProcessed=!0;this.launchSpecs();this.SUPERARG(arguments)}}});Role("Siesta.Test.Sub",{has:{isExclusive:!1,parent:{required:!0}},methods:{getExceptionCatcher:function(){return this.parent.getExceptionCatcher()},getTestErrorClass:function(){return this.parent.getTestErrorClass()},getStartTestAnchor:function(){return this.parent.getStartTestAnchor()},expectGlobals:function(){return this.parent.expectGlobals.apply(this.parent,
arguments)}}});Class("Siesta.Test",{does:[Siesta.Util.Role.CanFormatStrings,Siesta.Util.Role.CanGetType,Siesta.Test.More,Siesta.Test.Date,Siesta.Test.Function,Siesta.Test.BDD,JooseX.Observable],has:{name:null,url:{required:!0},urlExtractRegex:{is:"rwc",lazy:function(){return RegExp(this.url.replace(/([.*+?^${}()|[\]\/\\])/g,"\\$1")+":(\\d+)")}},assertPlanned:null,assertCount:0,isTodo:!1,results:{lazy:function(){return new Siesta.Result.SubTest({description:this.name||"Root",test:this})}},run:null,
startTestAnchor:null,exceptionCatcher:null,testErrorClass:null,generation:function(){return Math.random()},parent:null,harness:null,isReadyTimeout:1E4,failed:!1,failedException:null,failedExceptionType:null,startDate:null,endDate:null,lastActivityDate:null,contentManager:null,scopeProvider:null,global:null,reusingSandbox:!1,sandboxCleanup:!0,scriptScopeProvider:null,transparentEx:!1,needDone:!1,isDone:!1,defaultTimeout:15E3,subTestTimeout:null,timeout:null,timeoutsCount:function(){return{counter:1}},
timeoutIds:Joose.I.Object,idsToIndex:Joose.I.Object,waitTitles:Joose.I.Object,processed:!1,finalizationStarted:!1,callback:null,nbrExceptions:0,testEndReported:!1,needToCleanup:!0,overrideSetTimeout:!1,overrideForSetTimeout:null,overrideForClearTimeout:null,originalSetTimeout:null,originalClearTimeout:null,sourceLineForAllAssertions:!1,$passCount:null,$failCount:null,actionableMethods:{lazy:"buildActionableMethods"},jUnitClass:null,groups:null,config:null},methods:{initialize:function(){this.on("teststart",
function(a){this.parent&&a.stopPropagation()});this.on("testfinalize",function(a){this.parent&&a.stopPropagation()});this.on("beforetestfinalize",function(a){this.parent&&a.stopPropagation()});this.on("beforetestfinalizeearly",function(a){this.parent&&a.stopPropagation()});this.subTestTimeout=this.subTestTimeout||2*this.defaultTimeout;this.config&&Joose.O.extend(this,this.config)},isReady:function(){var a=Siesta.Resource("Siesta.Test");this.run=this.run||this.getStartTestAnchor().args&&this.getStartTestAnchor().args[0];
return{ready:"Function"==this.typeOf(this.run),reason:a.get("noCodeProvidedToTest")}},isFromTheSameGeneration:function(a){return this.generation==a.generation},toString:function(){return this.url},plan:function(a){if(null!=this.assertPlanned)throw Error("Test plan can't be changed");this.assertPlanned=a},addResult:function(a){var b=a instanceof Siesta.Result.Assertion;b&&(a.isTodo=this.isTodo);if(b&&((this.isDone||this.isFinished())&&!a.isTodo)&&!this.testEndReported){this.testEndReported=!0;var c=
Siesta.Resource("Siesta.Test");this.fail(c.get("addingAssertionsAfterDone"))}b&&!a.index&&(a.index=++this.assertCount);this.getResults().push(a);this.$passCount=this.$failCount=null;this.fireEvent("testupdate",this,a,this.getResults());this.lastActivityDate=new Date},diag:function(a){this.addResult(new Siesta.Result.Diagnostic({description:String(a||"")}))},pass:function(a,b,c){b&&"String"!=this.typeOf(b)&&(!a&&b.descTpl&&(a=this.formatString(b.descTpl,b)),b=b.annotation);c&&(c.passed=!0,c.description=
String(a||""),c.annotation=b);this.addResult(c||new Siesta.Result.Assertion({passed:!0,annotation:String(b||""),description:String(a||""),sourceLine:c&&c.sourceLine||b&&b.sourceLine||this.sourceLineForAllAssertions&&this.getSourceLine()||null}))},fail:function(a,b,c){var d=c&&c.sourceLine||b&&b.sourceLine||this.getSourceLine(),e="";if(b&&"String"!=this.typeOf(b)){!a&&b.descTpl&&(a=this.formatString(b.descTpl,b));var g=[],k=b,l=k.hasOwnProperty("got"),f=k.hasOwnProperty("need"),n=k.gotDesc||"Got",
p=k.needDesc||"Need",e=k.assertionName;b=k.annotation;k.ownTextOnly||!e&&!d||g.push("Failed assertion "+(e?"`"+e+"` ":"")+this.formatSourceLine(d));if(l&&f)var r=Math.max(n.length,p.length),n=this.appendSpaces(n,r-n.length+1),p=this.appendSpaces(p,r-p.length+1);l&&g.push(n+": "+Siesta.Util.Serializer.stringify(k.got));f&&g.push(p+": "+Siesta.Util.Serializer.stringify(k.need));b&&g.push(b);b=g.join("\n")}c&&(c.name=e,c.passed=!1,c.annotation=b,c.description=a);this.addResult(c||new Siesta.Result.Assertion({name:e,
passed:!1,sourceLine:d,annotation:String(b||""),description:String(a||"")}));if(!this.isTodo&&(this.harness.debuggerOnFail&&eval("debugger"),this.harness.breakOnFail))throw a=Siesta.Resource("Siesta.Test"),this.finalize(!0),a.get("testFailedAndAborted");},getSource:function(){return this.contentManager.getContentOf(this.url)},getSourceLine:function(){try{throw Error();}catch(a){if(a.stack){var b=a.stack.match(this.urlExtractRegex());if(b)return b[1]}return null}},getStartTestAnchor:function(){return this.startTestAnchor},
getExceptionCatcher:function(){return this.exceptionCatcher},getTestErrorClass:function(){return this.testErrorClass},processCallbackFromTest:function(a,b,c){var d=this;if(!a)return!0;if(this.transparentEx)a.apply(c||this.global,b||[]);else{var e=this.getExceptionCatcher()(function(){a.apply(c||d.global,b||[])});if(e)return this.failWithException(e),!1}return!0},getStackTrace:function(a){if(Object(a)!==a||!a.stack)return null;for(var b=a.stack+"",c=/^@/.test(b),b=b.split("\n"),d=Siesta.Resource("Siesta.Test"),
e=[],g,k=0;k<b.length;k++)if(b[k]){if(!k)if(c)e.push(a+"");else{e.push(b[k]);continue}if(c){g=/(.*?):(\d+):(\d+)$/.exec(b[k]);if(!g)return null;e.push("    "+d.get("atLine")+" "+g[2]+" "+d.get("of")+" "+g[1])}else{g=/\s*at\s(.*?):(\d+):(\d+)/.exec(b[k]);if(!g)return null;e.push("    "+d.get("atLine")+" "+g[2]+", "+d.get("character")+" "+g[3]+", "+d.get("of")+" "+g[1])}}return e.length?e:null},formatSourceLine:function(a){var b=Siesta.Resource("Siesta.Test");return a?b.get("atLine")+" "+a+" "+b.get("of")+
" "+this.url:""},appendSpaces:function(a,b){for(var c="";b--;)c+=" ";return a+c},eachAssertion:function(a,b){b=b||this;this.getResults().each(function(c){c instanceof Siesta.Result.Assertion&&a.call(b,c)})},eachSubTest:function(a,b){b=b||this;this.getResults().each(function(c){if(c instanceof Siesta.Result.SubTest&&!1===a.call(b,c.test))return!1})},eachChildTest:function(a,b){b=b||this;this.getResults().eachChild(function(c){if(c instanceof Siesta.Result.SubTest&&!1===a.call(b,c.test))return!1})},
countKeys:function(a){var b=0;Joose.O.eachOwn(a,function(){b++});return b},compareObjects:function(a,b,c,d,e){var g=Joose.O.isInstance(a)&&a.meta.does(Siesta.Test.Role.Placeholder),k=Joose.O.isInstance(b)&&b.meta.does(Siesta.Test.Role.Placeholder);if(c){if(a===b)return!0}else if(a==b)return!0;if(g&&k)return a.equalsTo(b);if(k)return b.equalsTo(a);if(g)return a.equalsTo(b);if(d)return!1;d=this.typeOf(a);g=this.typeOf(b);if(d!=g)return!1;var l=this;if("Object"==d||e)return this.countKeys(a)!=this.countKeys(b)?
!1:!1===Joose.O.eachOwn(a,function(a,d){if(!l.compareObjects(a,b[d],c))return!1})?!1:!0;if("Array"==d){if(a.length!=b.length)return!1;for(e=0;e<a.length;e++)if(!this.compareObjects(a[e],b[e],c))return!1;return!0}return"Function"==d?a.toString()==b.toString()&&(!c||this.compareObjects(a,b,c,!1,!0)):"RegExp"==d?a.source==b.source&&a.global==b.global&&a.ignoreCase==b.ignoreCase&&a.multiline==b.multiline&&(!c||this.compareObjects(a,b,c,!1,!0)):"Date"==d?!Boolean(a-b)&&(!c||this.compareObjects(a,b,c,!1,
!0)):!1},ok:function(a,b){var c=Siesta.Resource("Siesta.Test");a?this.pass(b,{descTpl:c.get("isTruthy"),value:a}):this.fail(b,{assertionName:"ok",got:a,annotation:c.get("needTruthy")})},notok:function(){this.notOk.apply(this,arguments)},notOk:function(a,b){var c=Siesta.Resource("Siesta.Test");a?this.fail(b,{assertionName:"notOk",got:a,annotation:c.get("needFalsy")}):this.pass(b,{descTpl:c.get("isFalsy"),value:a})},is:function(a,b,c){var d=Siesta.Resource("Siesta.Test");b&&a instanceof this.global.Date?
this.isDateEqual(a,b,c):this.compareObjects(a,b,!1,!0)?this.pass(c,{descTpl:d.get("isEqualTo"),got:a,expected:b}):this.fail(c,{assertionName:"is",got:a,need:b})},isnot:function(){this.isNot.apply(this,arguments)},isnt:function(){this.isNot.apply(this,arguments)},isNot:function(a,b,c){var d=Siesta.Resource("Siesta.Test");this.compareObjects(a,b,!1,!0)?this.fail(c,{assertionName:"isnt",got:a,need:b,needDesc:d.get("needNot")}):this.pass(c,{descTpl:d.get("isNotEqualTo"),got:a,expected:b})},isStrict:function(a,
b,c){var d=Siesta.Resource("Siesta.Test");this.compareObjects(a,b,!0,!0)?this.pass(c,{descTpl:d.get("isStrictlyEqual"),got:a,expected:b}):this.fail(c,{assertionName:"isStrict",got:a,need:b,needDesc:d.get("needStrictly")})},isntStrict:function(){this.isNotStrict.apply(this,arguments)},isNotStrict:function(a,b,c){var d=Siesta.Resource("Siesta.Test");this.compareObjects(a,b,!0,!0)?this.fail(c,{assertionName:"isntStrict",got:a,need:b,needDesc:d.get("needStrictlyNot")}):this.pass(c,{descTpl:d.get("isStrictlyNotEqual"),
got:a,expected:b})},wait:function(a,b){var c=Siesta.Resource("Siesta.Test");if(this.waitTitles.hasOwnProperty(a))throw Error(c.get("alreadyWaiting")+" ["+a+"]");return this.waitTitles[a]=this.beginAsync(b)},endWait:function(a){var b=Siesta.Resource("Siesta.Test");if(!this.waitTitles.hasOwnProperty(a))throw Error(b.get("noOngoingWait")+" ["+a+"]");this.endAsync(this.waitTitles[a]);delete this.waitTitles[a]},beginAsync:function(a,b){a=a||this.defaultTimeout;var c=Siesta.Resource("Siesta.Test"),d=this,
e=this.originalSetTimeout,g=this.timeoutsCount.counter++,e=e(function(){d.hasAsyncFrame(g)&&(b&&b.call(d,d)||d.fail(c.get("noMatchingEndAsync")+" "+a+" "+Siesta.Resource("Siesta.Test.More","ms")),d.endAsync(g))},a);this.timeoutIds[g]=e;return g},timeoutIdToIndex:function(a){return"object"==typeof a?a.__index:this.idsToIndex[a]},hasAsyncFrame:function(a){return this.timeoutIds.hasOwnProperty(a)},hasAsyncFrameByTimeoutId:function(a){return this.timeoutIds.hasOwnProperty(this.timeoutIdToIndex(a))},endAsync:function(a){var b=
this.originalSetTimeout,c=this.originalClearTimeout||this.global.clearTimeout,d=0,e=Siesta.Resource("Siesta.Test");null==a&&Joose.O.each(this.timeoutIds,function(b,c){a=c;if(d++)throw Error(e.get("endAsyncMisuse"));});c(this.timeoutIds[a]);delete this.timeoutIds[a];var g=this;this.processed&&!this.isFinished()&&b(function(){g.finalize()},1)},clearTimeouts:function(){var a=this.originalClearTimeout;Joose.O.each(this.timeoutIds,function(b,c){a(b)});this.timeoutIds={}},skipIf:function(a,b,c,d){d=d||
1;if(a)for(a=1;a<=d;a++)this.addResult(new Siesta.Result.Assertion({passed:!0,isSkipped:!0,description:"SKIPPED: "+b}));else c()},skip:function(a,b,c){this.skipIf(!0,a,b,c)},processSubTestConfig:function(a){return Joose.O.extend({trait:Siesta.Test.Sub,parent:this,isTodo:this.isTodo,transparentEx:this.transparentEx,waitForTimeout:this.waitForTimeout,waitForPollInterval:this.waitForPollInterval,defaultTimeout:this.defaultTimeout,timeout:this.subTestTimeout,subTestTimeout:this.subTestTimeout,global:this.global,
url:this.url,scopeProvider:this.scopeProvider,harness:this.harness,generation:this.generation,overrideSetTimeout:this.overrideSetTimeout,originalSetTimeout:this.originalSetTimeout,originalClearTimeout:this.originalClearTimeout,timeoutsCount:this.timeoutsCount,autoCheckGlobals:!1,needToCleanup:!1},a)},getSubTest:function(a,b,c){var d,e=Siesta.Resource("Siesta.Test");2==arguments.length||3==arguments.length?d={name:a,run:b,timeout:c}:1==arguments.length&&"Function"==this.typeOf(a)&&(d={name:"Sub test",
run:a});d=d||a||{};null==d.timeout&&delete d.timeout;var g=d.name;if(!d.run)throw this.failWithException(e.get("codeBodyMissingForSubTest")+" ["+g+"]"),Error(e.get("codeBodyMissingForSubTest")+" ["+g+"]");if(!d.run.length)throw this.failWithException(e.get("codeBodyMissingTestArg").replace("{name}",g)),Error(e.get("codeBodyMissingTestArg").replace("{name}",g));return new (d.meta||this.constructor)(this.processSubTestConfig(d))},launchSubTest:function(a,b){var c=this,d=Siesta.Resource("Siesta.Test"),
e=a.timeout||this.subTestTimeout,g=this.beginAsync(e,function(){c.fail(d.get("Subtest")+" "+(a.name?"["+a.name+"]":"")+" "+d.get("failedToFinishWithin")+" "+e+" "+Siesta.Resource("Siesta.Test.More","ms"));c.restoreTimeoutOverrides();k.remove();a.finalize(!0);b&&b(a);return!0}),k=a.on("testfinalize",function(){c.endAsync(g);c.restoreTimeoutOverrides();b&&b(a)});this.addResult(a.getResults());a.start()},todo:function(a,b,c){"Function"==this.typeOf(a)&&(a=[b,b=a][0]);a=this.getSubTest({name:a,run:b,
isTodo:!0,transparentEx:!1});this.launchSubTest(a,c)},snooze:function(a,b,c){var d=Siesta.Resource("Siesta.Test");new Date>new Date(a)?b.call(this.global,this):this.todo(d.get("Snoozed until")+" "+new Date(a)+": "+(c||""),b)},subTest:function(a,b,c,d){a=this.getSubTest({name:a||Siesta.Resource("Siesta.Test","Subtest"),timeout:d,run:b});this.launchSubTest(a,c);return a},stringifyException:function(a,b){var c=a+"",d=(b||this.getStackTrace(a)||[]).join("\n");-1==d.indexOf(c)&&(d=c+d);return d},failWithException:function(a){var b=
Siesta.Resource("Siesta.Test");this.failed=!0;this.failedException=a+"";this.failedExceptionType=this.typeOf(a);var c=this.getStackTrace(a);this.addResult(new Siesta.Result.Assertion({isException:!0,exceptionType:this.failedExceptionType,passed:!1,description:(this.parent?b.get("Subtest")+" `"+this.name+"`":b.get("Test")+" ")+" "+b.get("threwException"),annotation:this.stringifyException(a,c)}));this.fireEvent("testfailedwithexception",this,a,c);this.finalize(!0)},restoreTimeoutOverrides:function(){this.overrideSetTimeout&&
(this.global.setTimeout=this.overrideForSetTimeout,this.global.clearTimeout=this.overrideForClearTimeout)},start:function(a){var b=Siesta.Resource("Siesta.Test");if(this.startDate)throw b.get("testAlreadyStarted");this.startDate=new Date-0;this.fireEvent("teststart",this);if(a)this.failWithException(a);else if(this.parent||this.reusingSandbox)this.launch();else{var c=this,d,e=function(a){var d=!1,e=setTimeout(function(){d=!0;c.launch(b.get("setupTookTooLong"))},c.isReadyTimeout);c.setup(function(){d||
(clearTimeout(e),c.launch())},function(a){d||(clearTimeout(e),c.launch(a))})},g=c.isReady();if(g.ready)e();else var k=setTimeout(function(){clearInterval(l);e(d)},c.isReadyTimeout),l=setInterval(function(){g=c.isReady();g.ready?(clearInterval(l),clearTimeout(k),e()):d=g.reason||d},100)}},setup:function(a,b){a.call(this)},tearDown:function(a,b){a.call(this)},earlySetup:function(a,b){a.call(this)},cleanupContextBeforeStart:function(){var a=this.global;this.forEachUnexpectedGlobal(function(b){try{delete a[b]}catch(c){}})},
clearAsyncFrameGlobally:function(a){for(var b=this;b.parent;)b=b.parent;b.eachSubTest(function(b){if(b.hasAsyncFrameByTimeoutId(a))return b.overrideForClearTimeout(a),!1})},launch:function(a){if(a){var b=Siesta.Resource("Siesta.Test");this.fail(b.get("errorBeforeTestStarted"),{annotation:a})}var c=this,d=this.global;a=this.scopeProvider;var e=this.originalSetTimeout,g=this.originalClearTimeout;this.overrideSetTimeout&&(this.reusingSandbox||a.runCode("var setTimeout, clearTimeout;"),d.setTimeout=this.overrideForSetTimeout=
function(a,b){var d=c.timeoutsCount.counter++,k=e(function(){g(k);delete c.timeoutIds[d];c.processed&&!c.isFinished()&&e(function(){c.finalize()},1);a()},b);"object"==typeof k?k.__index=d:c.idsToIndex[k]=d;return c.timeoutIds[d]=k},d.clearTimeout=this.overrideForClearTimeout=function(a){null!=a&&(c.hasAsyncFrameByTimeoutId(a)?(g(a),a=c.timeoutIdToIndex(a),null!=a&&delete c.timeoutIds[a],c.processed&&!c.isFinished()&&e(function(){c.finalize()},1)):c.clearAsyncFrameGlobally(a))});this.needToCleanup&&
(a.beforeCleanupCallback=function(){c.isFinished()||c.finalize(!0);c.overrideSetTimeout&&(d.setTimeout=e,d.clearTimeout=g);d=e=g=null;c.eachSubTest(function(a){a.cleanup()})});this.reusingSandbox&&this.sandboxCleanup&&this.cleanupContextBeforeStart();d.focus&&d.focus();var k=this.run;if(this.transparentEx)k(c);else var l=this.getExceptionCatcher()(function(){k(c)});this.afterLaunch(l)},cleanup:function(){this.scopeProvider=this.startTestAnchor=this.exceptionCatcher=this.testErrorClass=this.global=
this.run=this.originalSetTimeout=this.originalClearTimeout=this.overrideForSetTimeout=this.overrideForClearTimeout=null;this.purgeListeners()},afterLaunch:function(a){a?this.failWithException(a):this.finalize()},finalize:function(a){var b=this,c=Siesta.Resource("Siesta.Test");if(!b.finalizationStarted&&!b.isFinished())if(b.processed=!0,a&&(b.clearTimeouts(),b.eachChildTest(function(a){a.finalize(!0)})),Joose.O.isEmpty(b.timeoutIds)){if(!b.needDone&&!b.isDone){b.fireEvent("beforetestfinalizeearly",
b);if(!Joose.O.isEmpty(b.timeoutIds))if(a)b.clearTimeouts();else return;b.fireEvent("beforetestfinalize",b)}b.finalizationStarted=!0;var d=function(a){a&&b.fail(a);b.endDate=new Date-0;b.parent||b.addResult(new Siesta.Result.Summary({isFailed:b.isFailed(),description:b.getSummaryMessage()}));b.onTestFinalize();b.fireEvent("testfinalize",b);b.fireEvent("testendbubbling",b);b.callback&&b.callback();b.callback=null};if(b.parent||b.reusingSandbox)d();else{a=b.originalSetTimeout;var e=b.originalClearTimeout,
g=!1,k=a(function(){g=!0;d(c.get("testTearDownTimeout"))},b.isReadyTimeout);b.tearDown(function(){e(k);g||d()},function(a){e(k);g||d(a)})}}else!b.__timeoutWarning&&(b.overrideSetTimeout&&b.lastActivityDate&&new Date-b.lastActivityDate>2*b.defaultTimeout)&&(b.diag(c.get("testStillRunning")),b.warn(c.get("testNotFinalized").replace("{url}",b.url)),b.__timeoutWarning=!0)},onTestFinalize:function(){},getSummaryMessage:function(a){var b=[],c=this.getPassCount(),d=this.getFailCount(),e=this.assertPlanned,
g=d+c;b.push("Passed: "+c);b.push("Failed: "+d);this.failed||(null!=e?(g<e&&b.push("Looks like you planned "+e+" tests, but ran only "+g),g>e&&b.push("Looks like you planned "+e+" tests, but ran "+(g-e)+" extra tests, "+g+" total."),g!=e||d||b.push("All tests passed")):(c=Siesta.Resource("Siesta.Test"),this.isDoneCorrectly()||b.push(c.get("missingDoneCall")),this.isDoneCorrectly()&&!d&&b.push(c.get("allTestsPassed"))));return a?b.join(a):b},done:function(a){var b=this;if(a){var c=this.beginAsync(),
d=this.originalSetTimeout;d(function(){b.endAsync(c);b.done()},a)}else this.fireEvent("beforetestfinalizeearly"),this.fireEvent("beforetestfinalize"),this.isDone=!0,this.processed&&this.finalize()},isDoneCorrectly:function(){return!this.needDone||this.isDone},getAssertionCount:function(a){var b=0;this.eachAssertion(function(c){a&&c.isTodo||b++});return b},getPassCount:function(a){if(null!=this.$passCount&&!a)return this.$passCount;var b=0;this.eachAssertion(function(c){!c.passed||!a&&c.isTodo||b++});
return a?b:this.$passCount=b},getTodoPassCount:function(){var a=0;this.eachAssertion(function(b){b.isTodo&&b.passed&&a++});return a},getTodoFailCount:function(){var a=0;this.eachAssertion(function(b){b.isTodo&&!b.passed&&a++});return a},getFailCount:function(a){if(null!=this.$failCount&&!a)return this.$failCount;var b=0;this.eachAssertion(function(c){c.passed||!a&&c.isTodo||b++});return a?b:this.$failCount=b},getFailedAssertions:function(){var a=[];this.eachAssertion(function(b){b.isPassed()||a.push(b)});
return a},isPassed:function(){var a=this.getPassCount(),b=this.getFailCount(),c=this.assertPlanned;return this.isFinished()&&!this.failed&&!b&&(null!=c&&a==c||null==c&&this.isDoneCorrectly())},isFailed:function(){var a=this.getPassCount(),b=this.getFailCount(),c=this.assertPlanned;return this.failed||b||this.isFinished()&&(null!=c&&a!=c||null==c&&!this.isDoneCorrectly())},isFailedWithException:function(){return this.failed},isStarted:function(){return null!=this.startDate},isFinished:function(){return null!=
this.endDate},getDuration:function(){return this.endDate-this.startDate},getBubbleTarget:function(){return this.parent||this.harness},warn:function(a){this.addResult(new Siesta.Result.Diagnostic({description:a,isWarning:!0}))},flattenArray:function(a){var b=this,c=[];Joose.A.each(a,function(a){"Array"==b.typeOf(a)?c.push.apply(c,b.flattenArray(a)):c.push(a)});return c},trimString:function(a){return String(a).replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")},buildActionableMethods:function(){var a=
{};this.meta.getMethods().each(function(b,c){a[c.toLowerCase()]=c});return a},getJUnitClass:function(){return this.jUnitClass||this.meta.name||"Siesta.Test"},resource:function(){return Siesta.Resource.apply(Siesta.Resource,arguments)}}});Singleton("Siesta.Test.ActionRegistry",{has:{actionClasses:Joose.I.Object},methods:{registerAction:function(a,b){this.actionClasses[a.toLowerCase()]=b},getActionClass:function(a){return this.actionClasses[a.toLowerCase()]},create:function(a,b,c){if(a!==Object(a))throw"Action configuration should be an Object instance";
if(!a.action){var d=this.actionClasses,e={};b&&(e=b.getActionableMethods());Joose.O.eachOwn(a,function(b,c){var l=c.toLowerCase();if(d[l]){a.action=l;switch(l){case "waitfor":break;case "type":a.text=b;break;default:a.target=b}return!1}if(e[l])return l.match(/^waitFor/i)?(a.action="wait",a.waitFor=e[l]):(a.action="methodCall",a.methodName=e[l]),a.args=b||[],!1})}if(!a.action)throw"Need to include `action` property or shortcut property in the step config";"wait"!=a.action&&("waitfor"!=a.action&&"delay"!=
a.action&&"methodCall"!=a.action)&&(!a.args&&c)&&(a.args=c);return new (this.getActionClass(a.action))(a)}}});Class("Siesta.Test.Action",{has:{args:null,desc:null,test:{required:!0},next:{required:!0},requiredTestMethod:null},methods:{initialize:function(){var a=this.requiredTestMethod;if(a&&!this.test[a])throw Error(Siesta.Resource("Siesta.Test.Action","missingTestAction").replace("{0}",this.meta.name).replace("{1}",a));},process:function(){this.next()}}});Class("Siesta.Test.Action.Done",{isa:Siesta.Test.Action,
has:{delay:null},methods:{process:function(){this.test.done(this.delay);this.next()}}});Siesta.Test.ActionRegistry().registerAction("done",Siesta.Test.Action.Done);Class("Siesta.Test.Action.Wait",{isa:Siesta.Test.Action,has:{delay:1E3,timeout:null,args:Joose.I.Array,waitFor:null,trigger:null},methods:{process:function(){var a=this.waitFor,b=this.test;if("Number"===b.typeOf(a)||"Function"===b.typeOf(a))this.args=[a],a="";null==a&&(this.args=[this.delay],a="");"Function"===b.typeOf(this.args)&&"waitForFn"!=
a&&(this.args=this.args.call(b,this));"Array"!==b.typeOf(this.args)&&(this.args=[this.args]);a=a.replace(/^waitFor/,"");a="waitFor"+Joose.S.uppercaseFirst(a);if(!b[a])throw Siesta.Resource("Siesta.Test.Action.Wait","missingMethodText")+a;"waitFor"===a?b.waitFor({method:this.args[0],callback:this.next,scope:b,timeout:this.timeout||b.waitForTimeout,description:this.desc||""}):b[a].apply(b,this.args.concat(this.next,b,this.timeout||b.waitForTimeout));if(a=this.trigger)"Function"==b.typeOf(a)?a.call(b,
b):(a instanceof Siesta.Test.Action||(a.next=function(){},a.test=this.test,a=Siesta.Test.ActionRegistry().create(a,b)),a.process())}}});Joose.A.each(["wait","waitFor","delay"],function(a){Siesta.Test.ActionRegistry().registerAction(a,Siesta.Test.Action.Wait)});Class("Siesta.Test.Action.Eval",{isa:Siesta.Test.Action,has:{actionString:null},methods:{process:function(){var a=this.test,b=this.parseActionString(this.actionString);if(b.error)a.fail(b.error),this.next();else{var c=b.methodName;c&&"Function"==
a.typeOf(a[c])?(b.params.push(this.next),a[c].apply(a,b.params)):(a.fail(Siesta.Resource("Siesta.Test.Action.Eval","invalidMethodNameText")+c),this.next())}},parseActionString:function(a){var b=/^\s*(.+?)\(\s*(.*)\s*\)\s*$/.exec(a);if(!b)return{error:Siesta.Resource("Siesta.Test.Action.Eval","wrongFormatText")+a};a=b[1].replace(/^t\./,"");try{var c=JSON.parse("["+b[2]+"]")}catch(d){return{error:Siesta.Resource("Siesta.Test.Action.Eval","parseErrorText")+b[2]}}return{methodName:a,params:c}}}});Class("Siesta.Test.Action.MethodCall",
{isa:Siesta.Test.Action,has:{methodName:null,args:null,callbackIndex:null},methods:{process:function(){var a=this.test,b=this.methodName,c=this.args;"Function"==a.typeOf(c)&&(c=c.call(a,this));"Array"!=a.typeOf(c)&&(c=[c]);null!=this.callbackIndex?c.splice(this.callbackIndex,0,this.next):c.push(this.next);a[b].apply(a,c)}}});Siesta.Test.ActionRegistry().registerAction("methodCall",Siesta.Test.Action.MethodCall);Class("Siesta.Harness",{does:[JooseX.Observable,Siesta.Util.Role.CanGetType],has:{title:null,
testClass:Siesta.Test,contentManagerClass:Siesta.Content.Manager,descriptors:Joose.I.Array,descriptorsById:Joose.I.Object,launchCounter:0,launches:Joose.I.Object,scopesByURL:Joose.I.Object,testsByURL:Joose.I.Object,transparentEx:!1,scopeProviderConfig:null,scopeProvider:null,runCore:"parallel",maxThreads:4,autoCheckGlobals:!1,disableGlobalsCheck:!1,expectedGlobals:Joose.I.Array,cleanScopeGlobals:Joose.I.Array,preload:Joose.I.Array,cachePreload:!1,mainPreset:null,emptyPreset:null,verbosity:0,keepNLastResults:2,
lastResultsURLs:Joose.I.Array,lastResultsByURL:Joose.I.Object,overrideSetTimeout:!1,needDone:!1,needToStop:!1,increaseTimeoutThreshold:8,startDate:null,endDate:null,waitForTimeout:1E4,defaultTimeout:15E3,subTestTimeout:null,isReadyTimeout:1E4,pauseBetweenTests:300,failOnExclusiveSpecsWhenAutomated:!1,setupDone:!1,sourceLineForAllAssertions:!1,currentLaunchId:null},methods:{initialize:function(){var a=this;a.on("testupdate",function(b,c,d,e){a.onTestUpdate(c,d,e)});a.on("testfailedwithexception",function(b,
c,d,e){a.onTestFail(c,d,e)});a.on("teststart",function(b,c){a.onTestStart(c)});a.on("testfinalize",function(b,c){a.onTestEnd(c)})},onTestUpdate:function(a,b,c){},onTestFail:function(a,b,c){},onTestStart:function(a){},onTestEnd:function(a){},onTestSuiteStart:function(a,b){this.startDate=new Date;this.fireEvent("testsuitestart",this)},onTestSuiteEnd:function(a,b){this.endDate=new Date;this.fireEvent("testsuiteend",this)},onBeforeScopePreload:function(a,b){this.fireEvent("beforescopepreload",a,b)},onAfterScopePreload:function(a,
b){this.fireEvent("afterscopepreload",a,b)},onCachingError:function(a,b){},configure:function(a){Joose.O.copy(a,this);var b=this;a.listeners&&Joose.O.each(a.listeners,function(c,d){if("scope"!=d)b.on(d,c,a.scope||b)})},processPreloadArray:function(a){var b=this;Joose.A.each(a,function(c,d){Object(c)!==c&&(a[d]=b.normalizeURL(c))});return a},populateCleanScopeGlobals:function(a,b){var c=new (eval(a)),d=this.cleanScopeGlobals;c.setup(function(){for(var a in c.scope)d.push(a);b();setTimeout(function(){c.cleanup()},
0)})},startSingle:function(a,b){var c=this;this.__counter__=this.__counter__||0;var d=function(){c.launch([c.normalizeDescriptor(a,c,c.__counter__++)],b)};c.setupDone?d():this.setup(d)},setup:function(a){var b=this;this.mainPreset=new Siesta.Content.Preset({preload:this.processPreloadArray(this.preload)});this.emptyPreset=new Siesta.Content.Preset;this.populateCleanScopeGlobals(this.scopeProvider,function(){b.setupDone=!0;a()})},start:function(){var a=Siesta.my.activeHarness=this,b=Array.prototype.concat.apply([],
arguments);this.setup(function(){a.normalizeDescriptors(b);a.launch(a.descriptors)})},normalizeDescriptors:function(a){var b=this,c=[];Joose.A.each(a,function(a,e){a&&c.push(b.normalizeDescriptor(a,b,e))});b.descriptors=c},launch:function(a,b,c){var d=this.currentLaunchId=this.launchCounter++,e=this;this.needToStop=!1;var g=this.flattenDescriptors(a),k=new Siesta.Content.Preset,l=[k,this.mainPreset];Joose.A.each(g,function(a){a.preset!=e.mainPreset&&a.preset!=e.emptyPreset&&l.push(a.preset);a.testCode||
k.addResource(a.url);e.deleteTestByURL(a.url)});var f=new this.contentManagerClass({harness:this,presets:[k].concat(this.cachePreload?l:[])}),n=this.launches[d]={increaseTimeout:"parallel"==this.runCore&&g.length>this.increaseTimeoutThreshold,launchId:d,descriptors:g.slice(),descriptorsLeft:null,contentManager:f};e.onTestSuiteStart(a,f);f.cache(function(){Joose.A.each(g,function(a){var b=a.url;f.hasContentOf(b)?(b=a.testConfig=Siesta.getConfigForTestScript(f.getContentOf(b)))&&(b.preload||b.alsoPreload)&&
(a.preset=e.getDescriptorPreset(a)):a.testCode||e.markMissingFile(a);e.normalizeScopeProvider(a)});e.fireEvent("testsuitelaunch",a,f);e.runCoreGeneral(g,f,n,n.callback=function(){e.onTestSuiteEnd(a,f);b&&b(a);delete e.launches[d]})},function(){},!0)},markMissingFile:function(a){a.isMissing=!0},flattenDescriptors:function(a,b){var c=[],d=this;Joose.A.each(a,function(a){a.group?(b&&c.push(a),c.push.apply(c,d.flattenDescriptors(a.items,b))):c.push(a)});return c},lookUpValueInDescriptorTree:function(a,
b,c){var d=a.testConfig;if(d&&d.hasOwnProperty(b))return d[b];if(a.hasOwnProperty(b))return a[b];if(a=a.parent)return a==this?c?void 0:this[b]:this.lookUpValueInDescriptorTree(a,b,c)},getDescriptorConfig:function(a,b,c){return this.lookUpValueInDescriptorTree(a,b,c)},getDescriptorPreset:function(a){var b=this.getDescriptorConfig(a,"preload",!0);a=this.getDescriptorConfig(a,"alsoPreload",!0);return b||a?(b=(b||this.preload).concat(a||[]),b.length?new Siesta.Content.Preset({preload:this.processPreloadArray(b)}):
this.emptyPreset):this.mainPreset},normalizeScopeProvider:function(a){var b=this.getDescriptorConfig(a,"scopeProvider");if(b)var c,b=(c=/^=(.+)/.exec(b))?c[1]:b.replace(/^(Scope\.Provider\.)?/,"Scope.Provider.");a.scopeProvider=b;a.scopeProviderConfig=this.getDescriptorConfig(a,"scopeProviderConfig")},normalizeDescriptor:function(a,b,c,d){"string"==typeof a&&(a={url:a});d=d||0;var e=this;a.parent=b;if(a.group){a.id=b==this?"testFolder-"+d+"-"+c:b.id+"/"+d+"-"+c;var g=[];Joose.A.each(a.items||[],function(b,
c){b&&g.push(e.normalizeDescriptor(b,a,c,d+1))});a.items=g}else a.id=a.url,a.preset=this.getDescriptorPreset(a);return this.descriptorsById[a.id]=a},runCoreGeneral:function(a,b,c,d){var e="runCore"+Joose.S.uppercaseFirst(this.runCore);if("function"!=typeof this[e])throw Error("Invalid `runCore` specified: ["+this.runCore+"]");this[e](a,b,c,d)},runCoreParallel:function(a,b,c,d){var e=this,g=0,k=a.length;k||d();for(var l=!1,f=!1,n=!1,p=function(n){e.processURL(n,n.index,b,c,function(){g++;e.needToStop||
l?(l=!0,f||(f=!0,d())):g==k?d():r(a)})},r=function(a){var b=a.shift();b&&(n?setTimeout(function(){p(b)},e.pauseBetweenTests):p(b))},s=1;s<=this.maxThreads;s++)r(a);n=!0},runCoreSequential:function(a,b,c,d){c.descriptorsLeft||(c.descriptorsLeft=a);if(a.length&&!this.needToStop){var e=a.shift(),g=this,k=a.length;this.processURL(e,e.index,b,c,function(){a.length&&a.length==k?setTimeout(function(){g.runCoreSequential(a,b,c,d)},g.pauseBetweenTests):d()})}else d()},getSeedingCode:function(a,b){return";("+
function(a,b){StartTest=startTest=describe=function(){arguments.callee.args=arguments};StartTest.launchId=b;StartTest.id=a;StartTest.exceptionCatcher=function(a){var b;try{a()}catch(c){b=c}return b};StartTest.testErrorClass=Error}.toString()+")("+JSON.stringify(a.id)+", "+b+")"},getScopeProviderConfigFor:function(a,b){var c=Joose.O.copy(a.scopeProviderConfig||{});c.seedingCode=this.getSeedingCode(a,b);return c},keepTestResult:function(a){if(this.lastResultsByURL[a]){var b=-1;Joose.A.each(this.lastResultsURLs,
function(c,d){if(c==a)return b=d,!1});this.lastResultsURLs.splice(b,1);this.lastResultsURLs.push(a)}else this.lastResultsURLs.push(a),this.lastResultsByURL[a]=!0,this.lastResultsURLs.length>this.keepNLastResults&&this.releaseTestResult()},releaseTestResult:function(){if(!(this.lastResultsURLs.length<=this.keepNLastResults)){var a=this.lastResultsURLs.shift();delete this.lastResultsByURL[a];var b=this.getTestByURL(a);b&&b.isFinished()&&this.cleanupScopeForURL(a)}},isKeepingResultForURL:function(a){return this.lastResultsByURL[a]},
setupScope:function(a,b){var c=a.url,d=eval(a.scopeProvider);this.cleanupScopeForURL(c);this.keepTestResult(c);return this.scopesByURL[c]=new d(this.getScopeProviderConfigFor(a,b))},cleanupScopeForURL:function(a){var b=this.scopesByURL[a];b&&(delete this.scopesByURL[a],b.cleanup())},prepareScopeSeeding:function(a,b,c){b.testCode||this.cachePreload&&c.hasContentOf(b.url)?a.addPreload({type:"js",content:b.testCode||c.getContentOf(b.url)+"\n//# sourceURL="+b.url}):a.seedingScript=this.resolveURL(b.url,
a,b)},normalizeURL:function(a){return a},resolveURL:function(a,b,c){return a},canUseCachedContent:function(a){return this.cachePreload&&a instanceof Siesta.Content.Resource.JavaScript},addCachedResourceToPreloads:function(a,b,c){a.addPreload({type:"js",content:b.getContentOf(c)})},processURL:function(a,b,c,d,e,g){function k(b){r.setup(function(){l.onAfterScopePreload(r,f,w);r.scope?l.launchTest({testHolder:n,desc:a,scopeProvider:r,contentManager:c,launchOptions:d,preloadErrors:b||p,onErrorHandler:s,
startTestAnchor:r.scope.StartTest,noCleanup:g,reusingSandbox:!1},e):e()})}var l=this,f=a.url;if(a.isMissing)e();else{var n={},p=[],r=this.setupScope(a,d.launchId);b=this.getDescriptorConfig(a,"transparentEx");var s=function(a,b,c,d,e){(d=n.test)&&d.isStarted()?(d.nbrExceptions++,d.failWithException(e||a+" "+b+" "+c)):p.push(e&&e.stack?e.stack+"":a+" "+b+" "+c)};r.addOnErrorHandler(s,!b);a.preset.eachResource(function(b){c.hasContentOf(b)&&l.canUseCachedContent(b)?l.addCachedResourceToPreloads(r,c,
b):(b=b.asDescriptor(),b.url&&(b.url=l.resolveURL(b.url,r,a)),r.addPreload(b))});l.prepareScopeSeeding(r,a,c);b=l.getDescriptorConfig(a,"testClass");"String"==l.typeOf(b)&&(b=Joose.S.strToClass(b));var t=l.getNewTestConfiguration(a,r,c,d),w=n.test=new b(t);this.onBeforeScopePreload(r,f,w);w.earlySetup(function(){k()},function(a){k(a)})}},launchTest:function(a,b){var c=a.scopeProvider,d=a.desc,e=this,g=d.url;c.addOnErrorHandler(a.onErrorHandler,!this.getDescriptorConfig(d,"transparentEx"));var k=a.testHolder.test,
f=a.startTestAnchor,m=f&&f.args,d=c.scope,n=a.noCleanup;Joose.O.extend(k,{startTestAnchor:f,exceptionCatcher:f.exceptionCatcher,testErrorClass:f.testErrorClass,global:d,originalSetTimeout:a.originalSetTimeout||d.setTimeout,originalClearTimeout:a.originalClearTimeout||d.clearTimeout,run:m&&("function"==typeof m[0]?m[0]:m[1]),reusingSandbox:a.reusingSandbox,callback:function(){n||e.isKeepingResultForURL(g)||e.cleanupScopeForURL(g);b&&b()}});this.saveTestWithURL(g,k);f=function(){e.fireEvent("beforeteststart",
k);k.isFinished()||k.start(a.preloadErrors[0]);k=a=null};a.reusingSandbox?f():c instanceof Scope.Provider.IFrame?d.setTimeout(f,10):setTimeout(f,50)},getNewTestConfiguration:function(a,b,c,d){for(var e=[],g=a.parent;g;)g.parent&&e.unshift(String(g.group)),g=g.parent;b={url:a.url,name:a.name,groups:e,jUnitClass:this.getDescriptorConfig(a,"jUnitClass"),harness:this,expectedGlobals:this.cleanScopeGlobals.concat(this.getDescriptorConfig(a,"expectedGlobals")),autoCheckGlobals:this.getDescriptorConfig(a,
"autoCheckGlobals"),disableGlobalsCheck:this.disableGlobalsCheck,scopeProvider:b,contentManager:c,transparentEx:this.getDescriptorConfig(a,"transparentEx"),needDone:this.getDescriptorConfig(a,"needDone"),overrideSetTimeout:this.getDescriptorConfig(a,"overrideSetTimeout"),defaultTimeout:this.getDescriptorConfig(a,"defaultTimeout")*(d.increaseTimeout?2:1),subTestTimeout:this.getDescriptorConfig(a,"subTestTimeout")*(d.increaseTimeout?2:1),waitForTimeout:this.getDescriptorConfig(a,"waitForTimeout")*(d.increaseTimeout?
3:1),isReadyTimeout:this.getDescriptorConfig(a,"isReadyTimeout"),sourceLineForAllAssertions:this.sourceLineForAllAssertions,sandboxCleanup:this.getDescriptorConfig(a,"sandboxCleanup"),config:this.getDescriptorConfig(a,"config"),failOnExclusiveSpecsWhenAutomated:this.getDescriptorConfig(a,"failOnExclusiveSpecsWhenAutomated")};(a.testConfig||a.config)&&Joose.O.extend(b,a.testConfig||a.config);return b},getScriptDescriptor:function(a){return this.descriptorsById[a]},getTestByURL:function(a){return this.testsByURL[a]},
saveTestWithURL:function(a,b){this.testsByURL[a]=b},deleteTestByURL:function(a){var b=this.testsByURL[a];if(b){try{b.finalize(!0)}catch(c){}this.cleanupScopeForURL(a)}delete this.testsByURL[a]},allPassed:function(){var a=!0,b=this;Joose.A.each(this.flattenDescriptors(this.descriptors),function(c){if(c.isMissing)return a=!1;(c=b.getTestByURL(c.url))&&(a=a&&c.isPassed())});return a},generateReport:function(a){arguments.length||(a=__REPORT_OPTIONS__);Object(a)!==a&&(a={format:a||"JSON"});var b="generate"+
a.format+"Report";if(!this[b])throw"Can't generate report - missing the `"+b+"` method";return this[b](a)}}});Role("Siesta.Role.CanStyleOutput",{has:{disableColoring:!1,style:{is:"rwc",lazy:"this.buildStyle"},styles:{init:{bold:[1,22],italic:[3,23],underline:[4,24],"black ":[30,39],yellow:[33,39],cyan:[36,39],white:[37,39],green:[32,39],red:[31,39],grey:[90,39],blue:[34,39],magenta:[35,39],"bgblack ":[40,49],bgyellow:[43,49],bgcyan:[46,49],bgwhite:[47,49],bggreen:[42,49],bgred:[41,49],bggrey:[100,
49],bgblue:[44,49],bgmagenta:[45,49],inverse:[7,27]}}},methods:{buildStyle:function(){var a=this,b={};Joose.O.each(this.styles,function(c,d){b[d]=function(b){return a.styled(b,d)}});return b},styled:function(a,b){if(this.disableColoring)return a;var c=this.styles;return"\u001b["+c[b][0]+"m"+a+"\u001b["+c[b][1]+"m"}}});Role("Siesta.Role.ConsoleReporter",{requires:["log","exit","allPassed"],does:[Siesta.Role.CanStyleOutput],has:{needSummaryMessage:!0},after:{markMissingFile:function(a){this.warn(Siesta.Resource("Siesta.Role.ConsoleReporter",
"missingFileText").replace("{URL}",a.url))},onTestSuiteStart:function(){},onTestSuiteEnd:function(){this.exit(this.getExitCode())},onTestEnd:function(a){var b=a.isPassed();this.log("["+(b?this.style().green(Siesta.Resource("Siesta.Role.ConsoleReporter","passText")):this.style().red(Siesta.Resource("Siesta.Role.ConsoleReporter","failText")))+"]  "+a.url+(b?"":"\n"))},onTestUpdate:function(a,b,c){a=b+"";c=0<this.verbosity;if(b instanceof Siesta.Result.Assertion){if(b.isWaitFor&&!b.completed)return;
b.isException&&!b.isTodo?(a=this.style().bold(this.style().red(a)),c=!0):b.isTodo?(a=this.styled(a,b.passed?"magenta":"yellow"),b.passed&&!b.isWaitFor&&(c=!0)):(a=this.styled(a,b.passed?"green":"red"),b.passed||(c=!0))}if(b instanceof Siesta.Result.Diagnostic&&(a=this.styled(a,"bold"),b.isWarning)){this.logWarning(b);return}b instanceof Siesta.Result.Summary&&(c=this.needSummaryMessage,a=this.styled(b.description.join(""),"bold"));c&&this.log(a)}},methods:{warn:function(a){this.log(this.styled("["+
Siesta.Resource("Siesta.Role.ConsoleReporter","warnText")+"] ","red")+a)},logWarning:function(a){this.warn(a+"")},getSummaryMessage:function(a){return(a=null!=a?a:this.allPassed())?this.style().bold(this.style().green(Siesta.Resource("Siesta.Role.ConsoleReporter","allTestsPassedText"))):this.style().bold(this.style().red(Siesta.Resource("Siesta.Role.ConsoleReporter","failuresFoundText")))},getExitCode:function(){return this.allPassed()?0:1}}});(function(a,b){function c(a,c,d){if(d===b&&1===a.nodeType)if(d=
"data-"+c.replace(Ea,"$1-$2").toLowerCase(),d=a.getAttribute(d),"string"===typeof d){try{d="true"===d?!0:"false"===d?!1:"null"===d?null:h.isNaN(d)?Fa.test(d)?h.parseJSON(d):d:parseFloat(d)}catch(e){}h.data(a,c,d)}else d=b;return d}function d(a){for(var b in a)if("toJSON"!==b)return!1;return!0}function e(a,c,d){var e=c+"defer",g=c+"queue",k=c+"mark",f=h.data(a,e,b,!0);!f||("queue"!==d&&h.data(a,g,b,!0)||"mark"!==d&&h.data(a,k,b,!0))||setTimeout(function(){h.data(a,g,b,!0)||h.data(a,k,b,!0)||(h.removeData(a,
e,!0),f.resolve())},0)}function g(){return!1}function k(){return!0}function f(a,c,d){var e=h.extend({},d[0]);e.type=a;e.originalEvent={};e.liveFired=b;h.event.handle.call(c,e);e.isDefaultPrevented()&&d[0].preventDefault()}function m(a){var b,c,d,e,g,k,f,l,q,m,n,D=[];e=[];g=h._data(this,"events");if(a.liveFired!==this&&g&&g.live&&!(a.target.disabled||a.button&&"click"===a.type)){a.namespace&&(n=RegExp("(^|\\.)"+a.namespace.split(".").join("\\.(?:.*\\.)?")+"(\\.|$)"));a.liveFired=this;var p=g.live.slice(0);
for(f=0;f<p.length;f++)g=p[f],g.origType.replace($a,"")===a.type?e.push(g.selector):p.splice(f--,1);e=h(a.target).closest(e,a.currentTarget);l=0;for(q=e.length;l<q;l++)for(m=e[l],f=0;f<p.length;f++)if(g=p[f],m.selector===g.selector&&(!n||n.test(g.namespace))&&!m.elem.disabled){k=m.elem;d=null;if("mouseenter"===g.preType||"mouseleave"===g.preType)a.type=g.preType,(d=h(a.relatedTarget).closest(g.selector)[0])&&h.contains(k,d)&&(d=k);d&&d===k||D.push({elem:k,handleObj:g,level:m.level})}l=0;for(q=D.length;l<
q;l++){e=D[l];if(c&&e.level>c)break;a.currentTarget=e.elem;a.data=e.handleObj.data;a.handleObj=e.handleObj;n=e.handleObj.origHandler.apply(e.elem,arguments);if(!1===n||a.isPropagationStopped())if(c=e.level,!1===n&&(b=!1),a.isImmediatePropagationStopped())break}return b}}function n(a,b){return(a&&"*"!==a?a+".":"")+b.replace(sa,"`").replace(ba,"&")}function p(a,b,c){b=b||0;if(h.isFunction(b))return h.grep(a,function(a,d){return!!b.call(a,d,a)===c});if(b.nodeType)return h.grep(a,function(a,d){return a===
b===c});if("string"===typeof b){var d=h.grep(a,function(a){return 1===a.nodeType});if(B.test(b))return h.filter(b,d,!c);b=h.filter(b,d)}return h.grep(a,function(a,d){return 0<=h.inArray(a,b)===c})}function r(a,b){if(1===b.nodeType&&h.hasData(a)){var c=h.expando,d=h.data(a),e=h.data(b,d);if(d=d[c]){var g=d.events,e=e[c]=h.extend({},d);if(g){delete e.handle;e.events={};for(var k in g)for(c=0,d=g[k].length;c<d;c++)h.event.add(b,k+(g[k][c].namespace?".":"")+g[k][c].namespace,g[k][c],g[k][c].data)}}}}
function s(a,b){var c;if(1===b.nodeType){b.clearAttributes&&b.clearAttributes();b.mergeAttributes&&b.mergeAttributes(a);c=b.nodeName.toLowerCase();if("object"===c)b.outerHTML=a.outerHTML;else if("input"===c&&("checkbox"===a.type||"radio"===a.type))a.checked&&(b.defaultChecked=b.checked=a.checked),b.value!==a.value&&(b.value=a.value);else if("option"===c)b.selected=a.defaultSelected;else if("input"===c||"textarea"===c)b.defaultValue=a.defaultValue;b.removeAttribute(h.expando)}}function t(a){return"getElementsByTagName"in
a?a.getElementsByTagName("*"):"querySelectorAll"in a?a.querySelectorAll("*"):[]}function w(a){if("checkbox"===a.type||"radio"===a.type)a.defaultChecked=a.checked}function y(a){h.nodeName(a,"input")?w(a):"getElementsByTagName"in a&&h.grep(a.getElementsByTagName("input"),w)}function z(a,b){b.src?h.ajax({url:b.src,async:!1,dataType:"script"}):h.globalEval((b.text||b.textContent||b.innerHTML||"").replace(Yb,"/*$0*/"));b.parentNode&&b.parentNode.removeChild(b)}function C(a,b,c){var d="width"===b?a.offsetWidth:
a.offsetHeight,e="width"===b?ca:pc;if(0<d)return"border"!==c&&h.each(e,function(){c||(d-=parseFloat(h.css(a,"padding"+this))||0);d="margin"===c?d+(parseFloat(h.css(a,c+this))||0):d-(parseFloat(h.css(a,"border"+this+"Width"))||0)}),d+"px";d=Ta(a,b,b);if(0>d||null==d)d=a.style[b]||0;d=parseFloat(d)||0;c&&h.each(e,function(){d+=parseFloat(h.css(a,"padding"+this))||0;"padding"!==c&&(d+=parseFloat(h.css(a,"border"+this+"Width"))||0);"margin"===c&&(d+=parseFloat(h.css(a,c+this))||0)});return d+"px"}function M(a){return function(b,
c){"string"!==typeof b&&(c=b,b="*");if(h.isFunction(c))for(var d=b.toLowerCase().split(W),e=0,g=d.length,k,f;e<g;e++)k=d[e],(f=/^\+/.test(k))&&(k=k.substr(1)||"*"),k=a[k]=a[k]||[],k[f?"unshift":"push"](c)}}function H(a,c,d,e,g,k){g=g||c.dataTypes[0];k=k||{};k[g]=!0;g=a[g];for(var h=0,f=g?g.length:0,l=a===ab,q;h<f&&(l||!q);h++)q=g[h](c,d,e),"string"===typeof q&&(!l||k[q]?q=b:(c.dataTypes.unshift(q),q=H(a,c,d,e,q,k)));!l&&q||k["*"]||(q=H(a,c,d,e,"*",k));return q}function P(a,b,c,d){if(h.isArray(b))h.each(b,
function(b,e){c||Mc.test(a)?d(a,e):P(a+"["+("object"===typeof e||h.isArray(e)?b:"")+"]",e,c,d)});else if(c||null==b||"object"!==typeof b)d(a,b);else for(var e in b)P(a+"["+e+"]",b[e],c,d)}function T(){try{return new a.XMLHttpRequest}catch(b){}}function ma(){setTimeout(fa,0);return nb=h.now()}function fa(){nb=b}function J(a,b){var c={};h.each(Fb.concat.apply([],Fb.slice(0,b)),function(){c[this]=a});return c}function Ga(a){if(!wb[a]){var b=x.body,c=h("<"+a+">").appendTo(b),d=c.css("display");c.remove();
if("none"===d||""===d)Z||(Z=x.createElement("iframe"),Z.frameBorder=Z.width=Z.height=0),b.appendChild(Z),Ha&&Z.createElement||(Ha=(Z.contentWindow||Z.contentDocument).document,Ha.write(("CSS1Compat"===x.compatMode?"<!doctype html>":"")+"<html><body>"),Ha.close()),c=Ha.createElement(a),Ha.body.appendChild(c),d=h.css(c,"display"),b.removeChild(Z);wb[a]=d}return wb[a]}function na(a){return h.isWindow(a)?a:9===a.nodeType?a.defaultView||a.parentWindow:!1}var x=a.document,bb=a.navigator,U=a.location,h=
function(){function c(){if(!d.isReady){try{x.documentElement.doScroll("left")}catch(a){setTimeout(c,1);return}d.ready()}}var d=function(a,b){return new d.fn.init(a,b,k)},e=a.jQuery,g=a.$,k,h=/^(?:[^<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,f=/\S/,l=/^\s+/,q=/\s+$/,m=/\d/,n=/^<(\w+)\s*\/?>(?:<\/\1>)?$/,D=/^[\],:{}\s]*$/,p=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,G=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,B=/(?:^|:|,)(?:\s*\[)+/g,r=/(webkit)[ \/]([\w.]+)/,s=/(opera)(?:.*version)?[ \/]([\w.]+)/,
N=/(msie) ([\w.]+)/,t=/(mozilla)(?:.*? rv:([\w.]+))?/,Ia=/-([a-z])/ig,ka=function(a,b){return b.toUpperCase()},Ja=bb.userAgent,ga,Ka,Hb=Object.prototype.toString,y=Object.prototype.hasOwnProperty,K=Array.prototype.push,w=Array.prototype.slice,z=String.prototype.trim,R=Array.prototype.indexOf,ra={};d.fn=d.prototype={constructor:d,init:function(a,c,e){var A;if(!a)return this;if(a.nodeType)return this.context=this[0]=a,this.length=1,this;if("body"===a&&!c&&x.body)return this.context=x,this[0]=x.body,
this.selector=a,this.length=1,this;if("string"===typeof a){A="<"===a.charAt(0)&&">"===a.charAt(a.length-1)&&3<=a.length?[null,a,null]:h.exec(a);if(!A||!A[1]&&c)return!c||c.jquery?(c||e).find(a):this.constructor(c).find(a);if(A[1])return e=(c=c instanceof d?c[0]:c)?c.ownerDocument||c:x,(a=n.exec(a))?d.isPlainObject(c)?(a=[x.createElement(a[1])],d.fn.attr.call(a,c,!0)):a=[e.createElement(a[1])]:(a=d.buildFragment([A[1]],[e]),a=(a.cacheable?d.clone(a.fragment):a.fragment).childNodes),d.merge(this,a);
if((c=x.getElementById(A[2]))&&c.parentNode){if(c.id!==A[2])return e.find(a);this.length=1;this[0]=c}this.context=x;this.selector=a;return this}if(d.isFunction(a))return e.ready(a);a.selector!==b&&(this.selector=a.selector,this.context=a.context);return d.makeArray(a,this)},selector:"",jquery:"1.6.2",length:0,size:function(){return this.length},toArray:function(){return w.call(this,0)},get:function(a){return null==a?this.toArray():0>a?this[this.length+a]:this[a]},pushStack:function(a,b,c){var e=this.constructor();
d.isArray(a)?K.apply(e,a):d.merge(e,a);e.prevObject=this;e.context=this.context;"find"===b?e.selector=this.selector+(this.selector?" ":"")+c:b&&(e.selector=this.selector+"."+b+"("+c+")");return e},each:function(a,b){return d.each(this,a,b)},ready:function(a){d.bindReady();ga.done(a);return this},eq:function(a){return-1===a?this.slice(a):this.slice(a,+a+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},slice:function(){return this.pushStack(w.apply(this,arguments),"slice",
w.call(arguments).join(","))},map:function(a){return this.pushStack(d.map(this,function(b,c){return a.call(b,c,b)}))},end:function(){return this.prevObject||this.constructor(null)},push:K,sort:[].sort,splice:[].splice};d.fn.init.prototype=d.fn;d.extend=d.fn.extend=function(){var a,c,e,A,g,k=arguments[0]||{},h=1,f=arguments.length,V=!1;"boolean"===typeof k&&(V=k,k=arguments[1]||{},h=2);"object"===typeof k||d.isFunction(k)||(k={});f===h&&(k=this,--h);for(;h<f;h++)if(null!=(a=arguments[h]))for(c in a)e=
k[c],A=a[c],k!==A&&(V&&A&&(d.isPlainObject(A)||(g=d.isArray(A)))?(g?(g=!1,e=e&&d.isArray(e)?e:[]):e=e&&d.isPlainObject(e)?e:{},k[c]=d.extend(V,e,A)):A!==b&&(k[c]=A));return k};d.extend({noConflict:function(b){a.$===d&&(a.$=g);b&&a.jQuery===d&&(a.jQuery=e);return d},isReady:!1,readyWait:1,holdReady:function(a){a?d.readyWait++:d.ready(!0)},ready:function(a){if(!0===a&&!--d.readyWait||!0!==a&&!d.isReady){if(!x.body)return setTimeout(d.ready,1);d.isReady=!0;!0!==a&&0<--d.readyWait||(ga.resolveWith(x,
[d]),d.fn.trigger&&d(x).trigger("ready").unbind("ready"))}},bindReady:function(){if(!ga){ga=d._Deferred();if("complete"===x.readyState)return setTimeout(d.ready,1);if(x.addEventListener)x.addEventListener("DOMContentLoaded",Ka,!1),a.addEventListener("load",d.ready,!1);else if(x.attachEvent){x.attachEvent("onreadystatechange",Ka);a.attachEvent("onload",d.ready);var b=!1;try{b=null==a.frameElement}catch(e){}x.documentElement.doScroll&&b&&c()}}},isFunction:function(a){return"function"===d.type(a)},isArray:Array.isArray||
function(a){return"array"===d.type(a)},isWindow:function(a){return a&&"object"===typeof a&&"setInterval"in a},isNaN:function(a){return null==a||!m.test(a)||isNaN(a)},type:function(a){return null==a?String(a):ra[Hb.call(a)]||"object"},isPlainObject:function(a){if(!a||("object"!==d.type(a)||a.nodeType||d.isWindow(a))||a.constructor&&!y.call(a,"constructor")&&!y.call(a.constructor.prototype,"isPrototypeOf"))return!1;for(var c in a);return c===b||y.call(a,c)},isEmptyObject:function(a){for(var b in a)return!1;
return!0},error:function(a){throw a;},parseJSON:function(b){if("string"!==typeof b||!b)return null;b=d.trim(b);if(a.JSON&&a.JSON.parse)return a.JSON.parse(b);if(D.test(b.replace(p,"@").replace(G,"]").replace(B,"")))return(new Function("return "+b))();d.error("Invalid JSON: "+b)},parseXML:function(b,c,e){a.DOMParser?(e=new DOMParser,c=e.parseFromString(b,"text/xml")):(c=new ActiveXObject("Microsoft.XMLDOM"),c.async="false",c.loadXML(b));(e=c.documentElement)&&e.nodeName&&"parsererror"!==e.nodeName||
d.error("Invalid XML: "+b);return c},noop:function(){},globalEval:function(b){b&&f.test(b)&&(a.execScript||function(b){a.eval.call(a,b)})(b)},camelCase:function(a){return a.replace(Ia,ka)},nodeName:function(a,b){return a.nodeName&&a.nodeName.toUpperCase()===b.toUpperCase()},each:function(a,c,e){var A,g=0,k=a.length,h=k===b||d.isFunction(a);if(e)if(h)for(A in a){if(!1===c.apply(a[A],e))break}else for(;g<k&&!1!==c.apply(a[g++],e););else if(h)for(A in a){if(!1===c.call(a[A],A,a[A]))break}else for(;g<
k&&!1!==c.call(a[g],g,a[g++]););return a},trim:z?function(a){return null==a?"":z.call(a)}:function(a){return null==a?"":a.toString().replace(l,"").replace(q,"")},makeArray:function(a,b){var c=b||[];if(null!=a){var e=d.type(a);null==a.length||"string"===e||"function"===e||"regexp"===e||d.isWindow(a)?K.call(c,a):d.merge(c,a)}return c},inArray:function(a,b){if(R)return R.call(b,a);for(var c=0,d=b.length;c<d;c++)if(b[c]===a)return c;return-1},merge:function(a,c){var d=a.length,e=0;if("number"===typeof c.length)for(var A=
c.length;e<A;e++)a[d++]=c[e];else for(;c[e]!==b;)a[d++]=c[e++];a.length=d;return a},grep:function(a,b,c){var d=[],e;c=!!c;for(var A=0,g=a.length;A<g;A++)e=!!b(a[A],A),c!==e&&d.push(a[A]);return d},map:function(a,c,e){var A,g,k=[],h=0,f=a.length;if(a instanceof d||f!==b&&"number"===typeof f&&(0<f&&a[0]&&a[f-1]||0===f||d.isArray(a)))for(;h<f;h++)A=c(a[h],h,e),null!=A&&(k[k.length]=A);else for(g in a)A=c(a[g],g,e),null!=A&&(k[k.length]=A);return k.concat.apply([],k)},guid:1,proxy:function(a,c){if("string"===
typeof c){var e=a[c];c=a;a=e}if(!d.isFunction(a))return b;var A=w.call(arguments,2),e=function(){return a.apply(c,A.concat(w.call(arguments)))};e.guid=a.guid=a.guid||e.guid||d.guid++;return e},access:function(a,c,e,A,g,k){var h=a.length;if("object"===typeof c){for(var f in c)d.access(a,f,c[f],A,g,e);return a}if(e!==b){A=!k&&A&&d.isFunction(e);for(f=0;f<h;f++)g(a[f],c,A?e.call(a[f],f,g(a[f],c)):e,k);return a}return h?g(a[0],c):b},now:function(){return(new Date).getTime()},uaMatch:function(a){a=a.toLowerCase();
if(a.match(/trident/i)&&a.match(/rv.\d\d/))return{browser:"msie",version:"11.0"};a=r.exec(a)||s.exec(a)||N.exec(a)||0>a.indexOf("compatible")&&t.exec(a)||[];return{browser:a[1]||"",version:a[2]||"0"}},sub:function(){function a(b,c){return new a.fn.init(b,c)}d.extend(!0,a,this);a.superclass=this;a.fn=a.prototype=this();a.fn.constructor=a;a.sub=this.sub;a.fn.init=function(c,e){e&&(e instanceof d&&!(e instanceof a))&&(e=a(e));return d.fn.init.call(this,c,e,b)};a.fn.init.prototype=a.fn;var b=a(x);return a},
browser:{}});d.each("Boolean Number String Function Array Date RegExp Object".split(" "),function(a,b){ra["[object "+b+"]"]=b.toLowerCase()});Ja=d.uaMatch(Ja);Ja.browser&&(d.browser[Ja.browser]=!0,d.browser.version=Ja.version);d.browser.webkit&&(d.browser.safari=!0);f.test("\u00a0")&&(l=/^[\s\xA0]+/,q=/[\s\xA0]+$/);k=d(x);x.addEventListener?Ka=function(){x.removeEventListener("DOMContentLoaded",Ka,!1);d.ready()}:x.attachEvent&&(Ka=function(){"complete"===x.readyState&&(x.detachEvent("onreadystatechange",
Ka),d.ready())});return d}(),ha="done fail isResolved isRejected promise then always pipe".split(" "),Ua=[].slice;h.extend({_Deferred:function(){var a=[],b,c,d,e={done:function(){if(!d){var c=arguments,g,k,f,l,V;b&&(V=b,b=0);g=0;for(k=c.length;g<k;g++)f=c[g],l=h.type(f),"array"===l?e.done.apply(e,f):"function"===l&&a.push(f);V&&e.resolveWith(V[0],V[1])}return this},resolveWith:function(e,g){if(!d&&!b&&!c){g=g||[];c=1;try{for(;a[0];)a.shift().apply(e,g)}finally{b=[e,g],c=0}}return this},resolve:function(){e.resolveWith(this,
arguments);return this},isResolved:function(){return!(!c&&!b)},cancel:function(){d=1;a=[];return this}};return e},Deferred:function(a){var b=h._Deferred(),c=h._Deferred(),d;h.extend(b,{then:function(a,c){b.done(a).fail(c);return this},always:function(){return b.done.apply(b,arguments).fail.apply(this,arguments)},fail:c.done,rejectWith:c.resolveWith,reject:c.resolve,isRejected:c.isResolved,pipe:function(a,c){return h.Deferred(function(d){h.each({done:[a,"resolve"],fail:[c,"reject"]},function(a,c){var e=
c[0],A=c[1],g;if(h.isFunction(e))b[a](function(){if((g=e.apply(this,arguments))&&h.isFunction(g.promise))g.promise().then(d.resolve,d.reject);else d[A](g)});else b[a](d[A])})}).promise()},promise:function(a){if(null==a){if(d)return d;d=a={}}for(var c=ha.length;c--;)a[ha[c]]=b[ha[c]];return a}});b.done(c.cancel).fail(b.cancel);delete b.cancel;a&&a.call(b,b);return b},when:function(a){function b(a){return function(b){c[a]=1<arguments.length?Ua.call(arguments,0):b;--g||k.resolveWith(k,Ua.call(c,0))}}
var c=arguments,d=0,e=c.length,g=e,k=1>=e&&a&&h.isFunction(a.promise)?a:h.Deferred();if(1<e){for(;d<e;d++)c[d]&&h.isFunction(c[d].promise)?c[d].promise().then(b(d),k.reject):--g;g||k.resolveWith(k,c)}else k!==a&&k.resolveWith(k,e?[a]:[]);return k.promise()}});h.support=function(){var a=x.createElement("div"),b=x.documentElement,c,d,e,g,k,f;a.setAttribute("className","t");a.innerHTML="   <link/><table></table><a href='/a' style='top:1px;float:left;opacity:.55;'>a</a><input type='checkbox'/>";c=a.getElementsByTagName("*");
d=a.getElementsByTagName("a")[0];if(!c||!c.length||!d)return{};e=x.createElement("select");g=e.appendChild(x.createElement("option"));c=a.getElementsByTagName("input")[0];k={leadingWhitespace:3===a.firstChild.nodeType,tbody:!a.getElementsByTagName("tbody").length,htmlSerialize:!!a.getElementsByTagName("link").length,style:/top/.test(d.getAttribute("style")),hrefNormalized:"/a"===d.getAttribute("href"),opacity:/^0.55$/.test(d.style.opacity),cssFloat:!!d.style.cssFloat,checkOn:"on"===c.value,optSelected:g.selected,
getSetAttribute:"t"!==a.className,submitBubbles:!0,changeBubbles:!0,focusinBubbles:!1,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0};c.checked=!0;k.noCloneChecked=c.cloneNode(!0).checked;e.disabled=!0;k.optDisabled=!g.disabled;try{delete a.test}catch(l){k.deleteExpando=!1}!a.addEventListener&&(a.attachEvent&&a.fireEvent)&&(a.attachEvent("onclick",function(){k.noCloneEvent=!1}),a.cloneNode(!0).fireEvent("onclick"));c=x.createElement("input");
c.value="t";c.setAttribute("type","radio");k.radioValue="t"===c.value;c.setAttribute("checked","checked");a.appendChild(c);d=x.createDocumentFragment();d.appendChild(a.firstChild);k.checkClone=d.cloneNode(!0).cloneNode(!0).lastChild.checked;a.innerHTML="";a.style.width=a.style.paddingLeft="1px";e=x.getElementsByTagName("body")[0];d=x.createElement(e?"div":"body");g={visibility:"hidden",width:0,height:0,border:0,margin:0};e&&h.extend(g,{position:"absolute",left:-1E3,top:-1E3});for(f in g)d.style[f]=
g[f];d.appendChild(a);b=e||b;b.insertBefore(d,b.firstChild);k.appendChecked=c.checked;k.boxModel=2===a.offsetWidth;"zoom"in a.style&&(a.style.display="inline",a.style.zoom=1,k.inlineBlockNeedsLayout=2===a.offsetWidth,a.style.display="",a.innerHTML="<div style='width:4px;'></div>",k.shrinkWrapBlocks=2!==a.offsetWidth);a.innerHTML="<table><tr><td style='padding:0;border:0;display:none'></td><td>t</td></tr></table>";e=a.getElementsByTagName("td");c=0===e[0].offsetHeight;e[0].style.display="";e[1].style.display=
"none";k.reliableHiddenOffsets=c&&0===e[0].offsetHeight;a.innerHTML="";x.defaultView&&x.defaultView.getComputedStyle&&(c=x.createElement("div"),c.style.width="0",c.style.marginRight="0",a.appendChild(c),k.reliableMarginRight=0===(parseInt((x.defaultView.getComputedStyle(c,null)||{marginRight:0}).marginRight,10)||0));d.innerHTML="";b.removeChild(d);if(a.attachEvent)for(f in{submit:1,change:1,focusin:1})b="on"+f,c=b in a,c||(a.setAttribute(b,"return;"),c="function"===typeof a[b]),k[f+"Bubbles"]=c;d=
d=e=g=e=c=a=c=null;return k}();h.boxModel=h.support.boxModel;var Fa=/^(?:\{.*\}|\[.*\])$/,Ea=/([a-z])([A-Z])/g;h.extend({cache:{},uuid:0,expando:"jQuery"+(h.fn.jquery+Math.random()).replace(/\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(a){a=a.nodeType?h.cache[a[h.expando]]:a[h.expando];return!!a&&!d(a)},data:function(a,c,d,e){if(h.acceptData(a)){var g=h.expando,k="string"===typeof c,f=a.nodeType,l=f?h.cache:a,q=f?a[h.expando]:a[h.expando]&&
h.expando;if(q&&(!e||!q||l[q][g])||!k||d!==b){q||(f?a[h.expando]=q=++h.uuid:q=h.expando);l[q]||(l[q]={},f||(l[q].toJSON=h.noop));if("object"===typeof c||"function"===typeof c)e?l[q][g]=h.extend(l[q][g],c):l[q]=h.extend(l[q],c);a=l[q];e&&(a[g]||(a[g]={}),a=a[g]);d!==b&&(a[h.camelCase(c)]=d);return"events"!==c||a[c]?k?a[h.camelCase(c)]||a[c]:a:a[g]&&a[g].events}}},removeData:function(b,c,e){if(h.acceptData(b)){var g=h.expando,k=b.nodeType,f=k?h.cache:b,l=k?b[h.expando]:h.expando;if(f[l]){if(c){var q=
e?f[l][g]:f[l];if(q&&(delete q[c],!d(q)))return}if(e&&(delete f[l][g],!d(f[l])))return;c=f[l][g];h.support.deleteExpando||f!=a?delete f[l]:f[l]=null;c?(f[l]={},k||(f[l].toJSON=h.noop),f[l][g]=c):k&&(h.support.deleteExpando?delete b[h.expando]:b.removeAttribute?b.removeAttribute(h.expando):b[h.expando]=null)}}},_data:function(a,b,c){return h.data(a,b,c,!0)},acceptData:function(a){if(a.nodeName){var b=h.noData[a.nodeName.toLowerCase()];if(b)return!(!0===b||a.getAttribute("classid")!==b)}return!0}});
h.fn.extend({data:function(a,d){var e=null;if("undefined"===typeof a){if(this.length&&(e=h.data(this[0]),1===this[0].nodeType))for(var g=this[0].attributes,k,f=0,l=g.length;f<l;f++)k=g[f].name,0===k.indexOf("data-")&&(k=h.camelCase(k.substring(5)),c(this[0],k,e[k]));return e}if("object"===typeof a)return this.each(function(){h.data(this,a)});var q=a.split(".");q[1]=q[1]?"."+q[1]:"";return d===b?(e=this.triggerHandler("getData"+q[1]+"!",[q[0]]),e===b&&this.length&&(e=h.data(this[0],a),e=c(this[0],
a,e)),e===b&&q[1]?this.data(q[0]):e):this.each(function(){var b=h(this),c=[q[0],d];b.triggerHandler("setData"+q[1]+"!",c);h.data(this,a,d);b.triggerHandler("changeData"+q[1]+"!",c)})},removeData:function(a){return this.each(function(){h.removeData(this,a)})}});h.extend({_mark:function(a,c){a&&(c=(c||"fx")+"mark",h.data(a,c,(h.data(a,c,b,!0)||0)+1,!0))},_unmark:function(a,c,d){!0!==a&&(d=c,c=a,a=!1);if(c){d=d||"fx";var g=d+"mark";(a=a?0:(h.data(c,g,b,!0)||1)-1)?h.data(c,g,a,!0):(h.removeData(c,g,!0),
e(c,d,"mark"))}},queue:function(a,c,d){if(a){c=(c||"fx")+"queue";var e=h.data(a,c,b,!0);d&&(!e||h.isArray(d)?e=h.data(a,c,h.makeArray(d),!0):e.push(d));return e||[]}},dequeue:function(a,b){b=b||"fx";var c=h.queue(a,b),d=c.shift();"inprogress"===d&&(d=c.shift());d&&("fx"===b&&c.unshift("inprogress"),d.call(a,function(){h.dequeue(a,b)}));c.length||(h.removeData(a,b+"queue",!0),e(a,b,"queue"))}});h.fn.extend({queue:function(a,c){"string"!==typeof a&&(c=a,a="fx");return c===b?h.queue(this[0],a):this.each(function(){var b=
h.queue(this,a,c);"fx"===a&&"inprogress"!==b[0]&&h.dequeue(this,a)})},dequeue:function(a){return this.each(function(){h.dequeue(this,a)})},delay:function(a,b){a=h.fx?h.fx.speeds[a]||a:a;b=b||"fx";return this.queue(b,function(){var c=this;setTimeout(function(){h.dequeue(c,b)},a)})},clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(a,c){function d(){--f||e.resolveWith(g,[g])}"string"!==typeof a&&(a=b);a=a||"fx";for(var e=h.Deferred(),g=this,k=g.length,f=1,l=a+"defer",q=a+"queue",
m=a+"mark",n;k--;)if(n=h.data(g[k],l,b,!0)||(h.data(g[k],q,b,!0)||h.data(g[k],m,b,!0))&&h.data(g[k],l,h._Deferred(),!0))f++,n.done(d);d();return e.promise()}});var Va=/[\n\t\r]/g,ta=/\s+/,Ba=/\r/g,qa=/^(?:button|input)$/i,Wa=/^(?:button|input|object|select|textarea)$/i,db=/^a(?:rea)?$/i,da=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,ob=/\:|^on/,la,L;h.fn.extend({attr:function(a,b){return h.access(this,a,b,!0,h.attr)},
removeAttr:function(a){return this.each(function(){h.removeAttr(this,a)})},prop:function(a,b){return h.access(this,a,b,!0,h.prop)},removeProp:function(a){a=h.propFix[a]||a;return this.each(function(){try{this[a]=b,delete this[a]}catch(c){}})},addClass:function(a){var b,c,d,e,g,k,f;if(h.isFunction(a))return this.each(function(b){h(this).addClass(a.call(this,b,this.className))});if(a&&"string"===typeof a)for(b=a.split(ta),c=0,d=this.length;c<d;c++)if(e=this[c],1===e.nodeType)if(e.className||1!==b.length){g=
" "+e.className+" ";k=0;for(f=b.length;k<f;k++)~g.indexOf(" "+b[k]+" ")||(g+=b[k]+" ");e.className=h.trim(g)}else e.className=a;return this},removeClass:function(a){var c,d,e,g,k,f,l;if(h.isFunction(a))return this.each(function(b){h(this).removeClass(a.call(this,b,this.className))});if(a&&"string"===typeof a||a===b)for(c=(a||"").split(ta),d=0,e=this.length;d<e;d++)if(g=this[d],1===g.nodeType&&g.className)if(a){k=(" "+g.className+" ").replace(Va," ");f=0;for(l=c.length;f<l;f++)k=k.replace(" "+c[f]+
" "," ");g.className=h.trim(k)}else g.className="";return this},toggleClass:function(a,b){var c=typeof a,d="boolean"===typeof b;return h.isFunction(a)?this.each(function(c){h(this).toggleClass(a.call(this,c,this.className,b),b)}):this.each(function(){if("string"===c)for(var e,g=0,k=h(this),f=b,l=a.split(ta);e=l[g++];)f=d?f:!k.hasClass(e),k[f?"addClass":"removeClass"](e);else if("undefined"===c||"boolean"===c)this.className&&h._data(this,"__className__",this.className),this.className=this.className||
!1===a?"":h._data(this,"__className__")||""})},hasClass:function(a){a=" "+a+" ";for(var b=0,c=this.length;b<c;b++)if(-1<(" "+this[b].className+" ").replace(Va," ").indexOf(a))return!0;return!1},val:function(a){var c,d,e=this[0];if(!arguments.length){if(e){if((c=h.valHooks[e.nodeName.toLowerCase()]||h.valHooks[e.type])&&"get"in c&&(d=c.get(e,"value"))!==b)return d;d=e.value;return"string"===typeof d?d.replace(Ba,""):null==d?"":d}return b}var g=h.isFunction(a);return this.each(function(d){var e=h(this);
1===this.nodeType&&(d=g?a.call(this,d,e.val()):a,null==d?d="":"number"===typeof d?d+="":h.isArray(d)&&(d=h.map(d,function(a){return null==a?"":a+""})),c=h.valHooks[this.nodeName.toLowerCase()]||h.valHooks[this.type],c&&"set"in c&&c.set(this,d,"value")!==b||(this.value=d))})}});h.extend({valHooks:{option:{get:function(a){var b=a.attributes.value;return!b||b.specified?a.value:a.text}},select:{get:function(a){var b,c=a.selectedIndex,d=[],e=a.options;a="select-one"===a.type;if(0>c)return null;for(var g=
a?c:0,k=a?c+1:e.length;g<k;g++)if(b=e[g],b.selected&&!((h.support.optDisabled?b.disabled:null!==b.getAttribute("disabled"))||b.parentNode.disabled&&h.nodeName(b.parentNode,"optgroup"))){b=h(b).val();if(a)return b;d.push(b)}return a&&!d.length&&e.length?h(e[c]).val():d},set:function(a,b){var c=h.makeArray(b);h(a).find("option").each(function(){this.selected=0<=h.inArray(h(this).val(),c)});c.length||(a.selectedIndex=-1);return c}}},attrFn:{val:!0,css:!0,html:!0,text:!0,data:!0,width:!0,height:!0,offset:!0},
attrFix:{tabindex:"tabIndex"},attr:function(a,c,d,e){var g=a.nodeType;if(!a||3===g||8===g||2===g)return b;if(e&&c in h.attrFn)return h(a)[c](d);if(!("getAttribute"in a))return h.prop(a,c,d);var k,f;if(e=1!==g||!h.isXMLDoc(a))c=h.attrFix[c]||c,(f=h.attrHooks[c])||(da.test(c)?f=L:la&&("className"!==c&&(h.nodeName(a,"form")||ob.test(c)))&&(f=la));if(d!==b){if(null===d)return h.removeAttr(a,c),b;if(f&&"set"in f&&e&&(k=f.set(a,d,c))!==b)return k;a.setAttribute(c,""+d);return d}if(f&&"get"in f&&e&&null!==
(k=f.get(a,c)))return k;k=a.getAttribute(c);return null===k?b:k},removeAttr:function(a,b){var c;1===a.nodeType&&(b=h.attrFix[b]||b,h.support.getSetAttribute?a.removeAttribute(b):(h.attr(a,b,""),a.removeAttributeNode(a.getAttributeNode(b))),da.test(b)&&(c=h.propFix[b]||b)in a&&(a[c]=!1))},attrHooks:{type:{set:function(a,b){if(qa.test(a.nodeName)&&a.parentNode)h.error("type property can't be changed");else if(!h.support.radioValue&&"radio"===b&&h.nodeName(a,"input")){var c=a.value;a.setAttribute("type",
b);c&&(a.value=c);return b}}},tabIndex:{get:function(a){var c=a.getAttributeNode("tabIndex");return c&&c.specified?parseInt(c.value,10):Wa.test(a.nodeName)||db.test(a.nodeName)&&a.href?0:b}},value:{get:function(a,b){return la&&h.nodeName(a,"button")?la.get(a,b):b in a?a.value:null},set:function(a,b,c){if(la&&h.nodeName(a,"button"))return la.set(a,b,c);a.value=b}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",
rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(a,c,d){var e=a.nodeType;if(!a||3===e||8===e||2===e)return b;var g,k;1===e&&h.isXMLDoc(a)||(c=h.propFix[c]||c,k=h.propHooks[c]);return d!==b?k&&"set"in k&&(g=k.set(a,d,c))!==b?g:a[c]=d:k&&"get"in k&&(g=k.get(a,c))!==b?g:a[c]},propHooks:{}});L={get:function(a,c){return h.prop(a,c)?c.toLowerCase():b},set:function(a,b,c){!1===b?h.removeAttr(a,c):(b=h.propFix[c]||c,b in a&&(a[b]=
!0),a.setAttribute(c,c.toLowerCase()));return c}};h.support.getSetAttribute||(h.attrFix=h.propFix,la=h.attrHooks.name=h.attrHooks.title=h.valHooks.button={get:function(a,c){var d;return(d=a.getAttributeNode(c))&&""!==d.nodeValue?d.nodeValue:b},set:function(a,b,c){if(a=a.getAttributeNode(c))return a.nodeValue=b}},h.each(["width","height"],function(a,b){h.attrHooks[b]=h.extend(h.attrHooks[b],{set:function(a,c){if(""===c)return a.setAttribute(b,"auto"),c}})}));h.support.hrefNormalized||h.each(["href",
"src","width","height"],function(a,c){h.attrHooks[c]=h.extend(h.attrHooks[c],{get:function(a){a=a.getAttribute(c,2);return null===a?b:a}})});h.support.style||(h.attrHooks.style={get:function(a){return a.style.cssText.toLowerCase()||b},set:function(a,b){return a.style.cssText=""+b}});h.support.optSelected||(h.propHooks.selected=h.extend(h.propHooks.selected,{get:function(a){if(a=a.parentNode)a.selectedIndex,a.parentNode&&a.parentNode.selectedIndex}}));h.support.checkOn||h.each(["radio","checkbox"],
function(){h.valHooks[this]={get:function(a){return null===a.getAttribute("value")?"on":a.value}}});h.each(["radio","checkbox"],function(){h.valHooks[this]=h.extend(h.valHooks[this],{set:function(a,b){if(h.isArray(b))return a.checked=0<=h.inArray(h(a).val(),b)}})});var $a=/\.(.*)$/,N=/^(?:textarea|input|select)$/i,sa=/\./g,ba=/ /g,ya=/[^\w\s.|`]/g,Jb=function(a){return a.replace(ya,"\\$&")};h.event={add:function(a,c,d,e){if(3!==a.nodeType&&8!==a.nodeType){if(!1===d)d=g;else if(!d)return;var k,f;d.handler&&
(k=d,d=k.handler);d.guid||(d.guid=h.guid++);if(f=h._data(a)){var l=f.events,q=f.handle;l||(f.events=l={});q||(f.handle=q=function(a){return"undefined"===typeof h||a&&h.event.triggered===a.type?b:h.event.handle.apply(q.elem,arguments)});q.elem=a;c=c.split(" ");for(var m,n=0,D;m=c[n++];){f=k?h.extend({},k):{handler:d,data:e};-1<m.indexOf(".")?(D=m.split("."),m=D.shift(),f.namespace=D.slice(0).sort().join(".")):(D=[],f.namespace="");f.type=m;f.guid||(f.guid=d.guid);var p=l[m],G=h.event.special[m]||{};
p||(p=l[m]=[],G.setup&&!1!==G.setup.call(a,e,D,q)||(a.addEventListener?a.addEventListener(m,q,!1):a.attachEvent&&a.attachEvent("on"+m,q)));G.add&&(G.add.call(a,f),f.handler.guid||(f.handler.guid=d.guid));p.push(f);h.event.global[m]=!0}a=null}}},global:{},remove:function(a,c,d,e){if(3!==a.nodeType&&8!==a.nodeType){!1===d&&(d=g);var k,f,l=0,q,m,n,D,p,G,B=h.hasData(a)&&h._data(a),r=B&&B.events;if(B&&r)if(c&&c.type&&(d=c.handler,c=c.type),!c||"string"===typeof c&&"."===c.charAt(0))for(k in c=c||"",r)h.event.remove(a,
k+c);else{for(c=c.split(" ");k=c[l++];)if(D=k,q=0>k.indexOf("."),m=[],q||(m=k.split("."),k=m.shift(),n=RegExp("(^|\\.)"+h.map(m.slice(0).sort(),Jb).join("\\.(?:.*\\.)?")+"(\\.|$)")),p=r[k])if(d){D=h.event.special[k]||{};for(f=e||0;f<p.length;f++)if(G=p[f],d.guid===G.guid){if(q||n.test(G.namespace))null==e&&p.splice(f--,1),D.remove&&D.remove.call(a,G);if(null!=e)break}if(0===p.length||null!=e&&1===p.length)D.teardown&&!1!==D.teardown.call(a,m)||h.removeEvent(a,k,B.handle),delete r[k]}else for(f=0;f<
p.length;f++)if(G=p[f],q||n.test(G.namespace))h.event.remove(a,D,G.handler,f),p.splice(f--,1);if(h.isEmptyObject(r)){if(c=B.handle)c.elem=null;delete B.events;delete B.handle;h.isEmptyObject(B)&&h.removeData(a,b,!0)}}}},customEvent:{getData:!0,setData:!0,changeData:!0},trigger:function(c,d,e,g){var k=c.type||c,f=[],l;0<=k.indexOf("!")&&(k=k.slice(0,-1),l=!0);0<=k.indexOf(".")&&(f=k.split("."),k=f.shift(),f.sort());if(e&&!h.event.customEvent[k]||h.event.global[k]){c="object"===typeof c?c[h.expando]?
c:new h.Event(k,c):new h.Event(k);c.type=k;c.exclusive=l;c.namespace=f.join(".");c.namespace_re=RegExp("(^|\\.)"+f.join("\\.(?:.*\\.)?")+"(\\.|$)");if(g||!e)c.preventDefault(),c.stopPropagation();if(!e)h.each(h.cache,function(){var a=this[h.expando];a&&(a.events&&a.events[k])&&h.event.trigger(c,d,a.handle.elem)});else if(3!==e.nodeType&&8!==e.nodeType){c.result=b;c.target=e;d=null!=d?h.makeArray(d):[];d.unshift(c);f=e;g=0>k.indexOf(":")?"on"+k:"";do l=h._data(f,"handle"),c.currentTarget=f,l&&l.apply(f,
d),g&&(h.acceptData(f)&&f[g]&&!1===f[g].apply(f,d))&&(c.result=!1,c.preventDefault()),f=f.parentNode||f.ownerDocument||f===c.target.ownerDocument&&a;while(f&&!c.isPropagationStopped());if(!c.isDefaultPrevented()){var q,f=h.event.special[k]||{};if(!(f._default&&!1!==f._default.call(e.ownerDocument,c)||"click"===k&&h.nodeName(e,"a")||!h.acceptData(e))){try{g&&e[k]&&((q=e[g])&&(e[g]=null),h.event.triggered=k,e[k]())}catch(m){}q&&(e[g]=q);h.event.triggered=b}}return c.result}}},handle:function(c){c=h.event.fix(c||
a.event);var d=((h._data(this,"events")||{})[c.type]||[]).slice(0),e=!c.exclusive&&!c.namespace,g=Array.prototype.slice.call(arguments,0);g[0]=c;c.currentTarget=this;for(var k=0,f=d.length;k<f;k++){var l=d[k];if(e||c.namespace_re.test(l.namespace))if(c.handler=l.handler,c.data=l.data,c.handleObj=l,l=l.handler.apply(this,g),l!==b&&(c.result=l,!1===l&&(c.preventDefault(),c.stopPropagation())),c.isImmediatePropagationStopped())break}return c.result},props:"altKey attrChange attrName bubbles button cancelable charCode clientX clientY ctrlKey currentTarget data detail eventPhase fromElement handler keyCode layerX layerY metaKey newValue offsetX offsetY pageX pageY prevValue relatedNode relatedTarget screenX screenY shiftKey srcElement target toElement view wheelDelta which".split(" "),
fix:function(a){if(a[h.expando])return a;var c=a;a=h.Event(c);for(var d=this.props.length,e;d;)e=this.props[--d],a[e]=c[e];a.target||(a.target=a.srcElement||x);3===a.target.nodeType&&(a.target=a.target.parentNode);!a.relatedTarget&&a.fromElement&&(a.relatedTarget=a.fromElement===a.target?a.toElement:a.fromElement);null==a.pageX&&null!=a.clientX&&(d=a.target.ownerDocument||x,c=d.documentElement,d=d.body,a.pageX=a.clientX+(c&&c.scrollLeft||d&&d.scrollLeft||0)-(c&&c.clientLeft||d&&d.clientLeft||0),a.pageY=
a.clientY+(c&&c.scrollTop||d&&d.scrollTop||0)-(c&&c.clientTop||d&&d.clientTop||0));null!=a.which||null==a.charCode&&null==a.keyCode||(a.which=null!=a.charCode?a.charCode:a.keyCode);!a.metaKey&&a.ctrlKey&&(a.metaKey=a.ctrlKey);a.which||a.button===b||(a.which=a.button&1?1:a.button&2?3:a.button&4?2:0);return a},guid:1E8,proxy:h.proxy,special:{ready:{setup:h.bindReady,teardown:h.noop},live:{add:function(a){h.event.add(this,n(a.origType,a.selector),h.extend({},a,{handler:m,guid:a.handler.guid}))},remove:function(a){h.event.remove(this,
n(a.origType,a.selector),a)}},beforeunload:{setup:function(a,b,c){h.isWindow(this)&&(this.onbeforeunload=c)},teardown:function(a,b){this.onbeforeunload===b&&(this.onbeforeunload=null)}}}};h.removeEvent=x.removeEventListener?function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c,!1)}:function(a,b,c){a.detachEvent&&a.detachEvent("on"+b,c)};h.Event=function(a,b){if(!this.preventDefault)return new h.Event(a,b);a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||
!1===a.returnValue||a.getPreventDefault&&a.getPreventDefault()?k:g):this.type=a;b&&h.extend(this,b);this.timeStamp=h.now();this[h.expando]=!0};h.Event.prototype={preventDefault:function(){this.isDefaultPrevented=k;var a=this.originalEvent;a&&(a.preventDefault?a.preventDefault():a.returnValue=!1)},stopPropagation:function(){this.isPropagationStopped=k;var a=this.originalEvent;a&&(a.stopPropagation&&a.stopPropagation(),a.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=
k;this.stopPropagation()},isDefaultPrevented:g,isPropagationStopped:g,isImmediatePropagationStopped:g};var cc=function(a){var b=a.relatedTarget,c=!1,d=a.type;a.type=a.data;b!==this&&(b&&(c=h.contains(this,b)),c||(h.event.handle.apply(this,arguments),a.type=d))},pb=function(a){a.type=a.data;h.event.handle.apply(this,arguments)};h.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(a,b){h.event.special[a]={setup:function(c){h.event.add(this,b,c&&c.selector?pb:cc,a)},teardown:function(a){h.event.remove(this,
b,a&&a.selector?pb:cc)}}});h.support.submitBubbles||(h.event.special.submit={setup:function(a,b){if(h.nodeName(this,"form"))return!1;h.event.add(this,"click.specialSubmit",function(a){var b=a.target,c=b.type;"submit"!==c&&"image"!==c||!h(b).closest("form").length||f("submit",this,arguments)});h.event.add(this,"keypress.specialSubmit",function(a){var b=a.target,c=b.type;"text"!==c&&"password"!==c||(!h(b).closest("form").length||13!==a.keyCode)||f("submit",this,arguments)})},teardown:function(a){h.event.remove(this,
".specialSubmit")}});if(!h.support.changeBubbles){var ia,eb=function(a){var b=a.type,c=a.value;"radio"===b||"checkbox"===b?c=a.checked:"select-multiple"===b?c=-1<a.selectedIndex?h.map(a.options,function(a){return a.selected}).join("-"):"":h.nodeName(a,"select")&&(c=a.selectedIndex);return c},xb=function(a,c){var d=a.target,e,g;N.test(d.nodeName)&&!d.readOnly&&(e=h._data(d,"_change_data"),g=eb(d),"focusout"===a.type&&"radio"===d.type||h._data(d,"_change_data",g),e===b||g===e||null==e&&!g||(a.type=
"change",a.liveFired=b,h.event.trigger(a,c,d)))};h.event.special.change={filters:{focusout:xb,beforedeactivate:xb,click:function(a){var b=a.target,c=h.nodeName(b,"input")?b.type:"";("radio"===c||"checkbox"===c||h.nodeName(b,"select"))&&xb.call(this,a)},keydown:function(a){var b=a.target,c=h.nodeName(b,"input")?b.type:"";(13===a.keyCode&&!h.nodeName(b,"textarea")||32===a.keyCode&&("checkbox"===c||"radio"===c)||"select-multiple"===c)&&xb.call(this,a)},beforeactivate:function(a){a=a.target;h._data(a,
"_change_data",eb(a))}},setup:function(a,b){if("file"===this.type)return!1;for(var c in ia)h.event.add(this,c+".specialChange",ia[c]);return N.test(this.nodeName)},teardown:function(a){h.event.remove(this,".specialChange");return N.test(this.nodeName)}};ia=h.event.special.change.filters;ia.focus=ia.beforeactivate}h.support.focusinBubbles||h.each({focus:"focusin",blur:"focusout"},function(a,b){function c(a){var d=h.event.fix(a);d.type=b;d.originalEvent={};h.event.trigger(d,null,d.target);d.isDefaultPrevented()&&
a.preventDefault()}var d=0;h.event.special[b]={setup:function(){0===d++&&x.addEventListener(a,c,!0)},teardown:function(){0===--d&&x.removeEventListener(a,c,!0)}}});h.each(["bind","one"],function(a,c){h.fn[c]=function(a,d,e){var g;if("object"===typeof a){for(var k in a)this[c](k,d,a[k],e);return this}if(2===arguments.length||!1===d)e=d,d=b;"one"===c?(g=function(a){h(this).unbind(a,g);return e.apply(this,arguments)},g.guid=e.guid||h.guid++):g=e;if("unload"===a&&"one"!==c)this.one(a,d,e);else{k=0;for(var f=
this.length;k<f;k++)h.event.add(this[k],a,g,d)}return this}});h.fn.extend({unbind:function(a,b){if("object"!==typeof a||a.preventDefault)for(var c=0,d=this.length;c<d;c++)h.event.remove(this[c],a,b);else for(c in a)this.unbind(c,a[c]);return this},delegate:function(a,b,c,d){return this.live(b,c,d,a)},undelegate:function(a,b,c){return 0===arguments.length?this.unbind("live"):this.die(b,null,c,a)},trigger:function(a,b){return this.each(function(){h.event.trigger(a,b,this)})},triggerHandler:function(a,
b){if(this[0])return h.event.trigger(a,b,this[0],!0)},toggle:function(a){var b=arguments,c=a.guid||h.guid++,d=0,e=function(c){var e=(h.data(this,"lastToggle"+a.guid)||0)%d;h.data(this,"lastToggle"+a.guid,e+1);c.preventDefault();return b[e].apply(this,arguments)||!1};for(e.guid=c;d<b.length;)b[d++].guid=c;return this.click(e)},hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)}});var Ca={focus:"focusin",blur:"focusout",mouseenter:"mouseover",mouseleave:"mouseout"};h.each(["live","die"],
function(a,c){h.fn[c]=function(a,d,e,k){var f=0,l,A,q=k||this.selector,m=k?this:h(this.context);if("object"===typeof a&&!a.preventDefault){for(l in a)m[c](l,d,a[l],q);return this}if("die"===c&&!a&&k&&"."===k.charAt(0))return m.unbind(k),this;if(!1===d||h.isFunction(d))e=d||g,d=b;for(a=(a||"").split(" ");null!=(k=a[f++]);)if(l=$a.exec(k),A="",l&&(A=l[0],k=k.replace($a,"")),"hover"===k)a.push("mouseenter"+A,"mouseleave"+A);else if(l=k,Ca[k]?(a.push(Ca[k]+A),k+=A):k=(Ca[k]||k)+A,"live"===c){A=0;for(var D=
m.length;A<D;A++)h.event.add(m[A],"live."+n(k,q),{data:d,selector:q,handler:e,origType:k,origHandler:e,preType:l})}else m.unbind("live."+n(k,q),e);return this}});h.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error".split(" "),function(a,b){h.fn[b]=function(a,c){null==c&&(c=a,a=null);return 0<arguments.length?this.bind(b,a,c):this.trigger(b)};h.attrFn&&(h.attrFn[b]=
!0)});(function(){function a(b,c,d,e,g,k){g=0;for(var f=e.length;g<f;g++){var h=e[g];if(h){for(var l=!1,h=h[b];h;){if(h.sizcache===d){l=e[h.sizset];break}1!==h.nodeType||k||(h.sizcache=d,h.sizset=g);if(h.nodeName.toLowerCase()===c){l=h;break}h=h[b]}e[g]=l}}}function c(a,b,d,e,g,k){g=0;for(var f=e.length;g<f;g++){var h=e[g];if(h){for(var l=!1,h=h[a];h;){if(h.sizcache===d){l=e[h.sizset];break}if(1===h.nodeType)if(k||(h.sizcache=d,h.sizset=g),"string"!==typeof b){if(h===b){l=!0;break}}else if(0<m.filter(b,
[h]).length){l=h;break}h=h[a]}e[g]=l}}}var d=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,e=0,g=Object.prototype.toString,k=!1,f=!0,l=/\\/g,q=/\W/;[0,0].sort(function(){f=!1;return 0});var m=function(a,b,c,e){c=c||[];var k=b=b||x;if(1!==b.nodeType&&9!==b.nodeType)return[];if(!a||"string"!==typeof a)return c;var f,h,l,A,q,ua=!0,ja=m.isXML(b),p=[],G=a;do if(d.exec(""),f=d.exec(G))if(G=f[3],p.push(f[1]),f[2]){A=
f[3];break}while(f);if(1<p.length&&D.exec(a))if(2===p.length&&n.relative[p[0]])h=t(p[0]+p[1],b);else for(h=n.relative[p[0]]?[b]:m(p.shift(),b);p.length;)a=p.shift(),n.relative[a]&&(a+=p.shift()),h=t(a,h);else if(!e&&(1<p.length&&9===b.nodeType&&!ja&&n.match.ID.test(p[0])&&!n.match.ID.test(p[p.length-1]))&&(f=m.find(p.shift(),b,ja),b=f.expr?m.filter(f.expr,f.set)[0]:f.set[0]),b)for(f=e?{expr:p.pop(),set:B(e)}:m.find(p.pop(),1!==p.length||"~"!==p[0]&&"+"!==p[0]||!b.parentNode?b:b.parentNode,ja),h=f.expr?
m.filter(f.expr,f.set):f.set,0<p.length?l=B(h):ua=!1;p.length;)f=q=p.pop(),n.relative[q]?f=p.pop():q="",null==f&&(f=b),n.relative[q](l,f,ja);else l=[];l||(l=h);l||m.error(q||a);if("[object Array]"===g.call(l))if(ua)if(b&&1===b.nodeType)for(a=0;null!=l[a];a++)l[a]&&(!0===l[a]||1===l[a].nodeType&&m.contains(b,l[a]))&&c.push(h[a]);else for(a=0;null!=l[a];a++)l[a]&&1===l[a].nodeType&&c.push(h[a]);else c.push.apply(c,l);else B(l,c);A&&(m(A,k,c,e),m.uniqueSort(c));return c};m.uniqueSort=function(a){if(s&&
(k=f,a.sort(s),k))for(var b=1;b<a.length;b++)a[b]===a[b-1]&&a.splice(b--,1);return a};m.matches=function(a,b){return m(a,null,null,b)};m.matchesSelector=function(a,b){return 0<m(b,null,null,[a]).length};m.find=function(a,b,c){var d;if(!a)return[];for(var e=0,g=n.order.length;e<g;e++){var k,f=n.order[e];if(k=n.leftMatch[f].exec(a)){var h=k[1];k.splice(1,1);if("\\"!==h.substr(h.length-1)&&(k[1]=(k[1]||"").replace(l,""),d=n.find[f](k,b,c),null!=d)){a=a.replace(n.match[f],"");break}}}d||(d="undefined"!==
typeof b.getElementsByTagName?b.getElementsByTagName("*"):[]);return{set:d,expr:a}};m.filter=function(a,c,d,e){for(var g,k,f=a,h=[],l=c,A=c&&c[0]&&m.isXML(c[0]);a&&c.length;){for(var q in n.filter)if(null!=(g=n.leftMatch[q].exec(a))&&g[2]){var ua,ja,p=n.filter[q];ja=g[1];k=!1;g.splice(1,1);if("\\"!==ja.substr(ja.length-1)){l===h&&(h=[]);if(n.preFilter[q])if(g=n.preFilter[q](g,l,d,h,e,A),!g)k=ua=!0;else if(!0===g)continue;if(g)for(var D=0;null!=(ja=l[D]);D++)if(ja){ua=p(ja,g,D,l);var V=e^!!ua;d&&null!=
ua?V?k=!0:l[D]=!1:V&&(h.push(ja),k=!0)}if(ua!==b){d||(l=h);a=a.replace(n.match[q],"");if(!k)return[];break}}}if(a===f)if(null==k)m.error(a);else break;f=a}return l};m.error=function(a){throw"Syntax error, unrecognized expression: "+a;};var n=m.selectors={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF\-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF\-]|\\.)+)\s*(?:(\S?=)\s*(?:(['"])(.*?)\3|(#?(?:[\w\u00c0-\uFFFF\-]|\\.)*)|)|)\s*\]/,
TAG:/^((?:[\w\u00c0-\uFFFF\*\-]|\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\(\s*(even|odd|(?:[+\-]?\d+|(?:[+\-]?\d*)?n\s*(?:[+\-]\s*\d+)?))\s*\))?/,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^\-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF\-]|\\.)+)(?:\((['"]?)((?:\([^\)]+\)|[^\(\)]*)+)\2\))?/},leftMatch:{},attrMap:{"class":"className","for":"htmlFor"},attrHandle:{href:function(a){return a.getAttribute("href")},type:function(a){return a.getAttribute("type")}},relative:{"+":function(a,b){var c=
"string"===typeof b,d=c&&!q.test(b),c=c&&!d;d&&(b=b.toLowerCase());for(var d=0,e=a.length,g;d<e;d++)if(g=a[d]){for(;(g=g.previousSibling)&&1!==g.nodeType;);a[d]=c||g&&g.nodeName.toLowerCase()===b?g||!1:g===b}c&&m.filter(b,a,!0)},">":function(a,b){var c,d="string"===typeof b,e=0,g=a.length;if(d&&!q.test(b))for(b=b.toLowerCase();e<g;e++){if(c=a[e])c=c.parentNode,a[e]=c.nodeName.toLowerCase()===b?c:!1}else{for(;e<g;e++)(c=a[e])&&(a[e]=d?c.parentNode:c.parentNode===b);d&&m.filter(b,a,!0)}},"":function(b,
d,g){var k,f=e++,h=c;"string"!==typeof d||q.test(d)||(k=d=d.toLowerCase(),h=a);h("parentNode",d,f,b,k,g)},"~":function(b,d,g){var k,f=e++,h=c;"string"!==typeof d||q.test(d)||(k=d=d.toLowerCase(),h=a);h("previousSibling",d,f,b,k,g)}},find:{ID:function(a,b,c){if("undefined"!==typeof b.getElementById&&!c)return(a=b.getElementById(a[1]))&&a.parentNode?[a]:[]},NAME:function(a,b){if("undefined"!==typeof b.getElementsByName){for(var c=[],d=b.getElementsByName(a[1]),e=0,g=d.length;e<g;e++)d[e].getAttribute("name")===
a[1]&&c.push(d[e]);return 0===c.length?null:c}},TAG:function(a,b){if("undefined"!==typeof b.getElementsByTagName)return b.getElementsByTagName(a[1])}},preFilter:{CLASS:function(a,b,c,d,e,g){a=" "+a[1].replace(l,"")+" ";if(g)return a;g=0;for(var k;null!=(k=b[g]);g++)k&&(e^(k.className&&0<=(" "+k.className+" ").replace(/[\t\n\r]/g," ").indexOf(a))?c||d.push(k):c&&(b[g]=!1));return!1},ID:function(a){return a[1].replace(l,"")},TAG:function(a,b){return a[1].replace(l,"").toLowerCase()},CHILD:function(a){if("nth"===
a[1]){a[2]||m.error(a[0]);a[2]=a[2].replace(/^\+|\s*/g,"");var b=/(-?)(\d*)(?:n([+\-]?\d*))?/.exec("even"===a[2]&&"2n"||"odd"===a[2]&&"2n+1"||!/\D/.test(a[2])&&"0n+"+a[2]||a[2]);a[2]=b[1]+(b[2]||1)-0;a[3]=b[3]-0}else a[2]&&m.error(a[0]);a[0]=e++;return a},ATTR:function(a,b,c,d,e,g){b=a[1]=a[1].replace(l,"");!g&&n.attrMap[b]&&(a[1]=n.attrMap[b]);a[4]=(a[4]||a[5]||"").replace(l,"");"~="===a[2]&&(a[4]=" "+a[4]+" ");return a},PSEUDO:function(a,b,c,e,g){if("not"===a[1])if(1<(d.exec(a[3])||"").length||
/^\w/.test(a[3]))a[3]=m(a[3],null,null,b);else return a=m.filter(a[3],b,c,1^g),c||e.push.apply(e,a),!1;else if(n.match.POS.test(a[0])||n.match.CHILD.test(a[0]))return!0;return a},POS:function(a){a.unshift(!0);return a}},filters:{enabled:function(a){return!1===a.disabled&&"hidden"!==a.type},disabled:function(a){return!0===a.disabled},checked:function(a){return!0===a.checked},selected:function(a){a.parentNode&&a.parentNode.selectedIndex;return!0===a.selected},parent:function(a){return!!a.firstChild},
empty:function(a){return!a.firstChild},has:function(a,b,c){return!!m(c[3],a).length},header:function(a){return/h\d/i.test(a.nodeName)},text:function(a){var b=a.getAttribute("type"),c=a.type;return"input"===a.nodeName.toLowerCase()&&"text"===c&&(b===c||null===b)},radio:function(a){return"input"===a.nodeName.toLowerCase()&&"radio"===a.type},checkbox:function(a){return"input"===a.nodeName.toLowerCase()&&"checkbox"===a.type},file:function(a){return"input"===a.nodeName.toLowerCase()&&"file"===a.type},
password:function(a){return"input"===a.nodeName.toLowerCase()&&"password"===a.type},submit:function(a){var b=a.nodeName.toLowerCase();return("input"===b||"button"===b)&&"submit"===a.type},image:function(a){return"input"===a.nodeName.toLowerCase()&&"image"===a.type},reset:function(a){var b=a.nodeName.toLowerCase();return("input"===b||"button"===b)&&"reset"===a.type},button:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&"button"===a.type||"button"===b},input:function(a){return/input|select|textarea|button/i.test(a.nodeName)},
focus:function(a){return a===a.ownerDocument.activeElement}},setFilters:{first:function(a,b){return 0===b},last:function(a,b,c,d){return b===d.length-1},even:function(a,b){return 0===b%2},odd:function(a,b){return 1===b%2},lt:function(a,b,c){return b<c[3]-0},gt:function(a,b,c){return b>c[3]-0},nth:function(a,b,c){return c[3]-0===b},eq:function(a,b,c){return c[3]-0===b}},filter:{PSEUDO:function(a,b,c,d){var e=b[1],g=n.filters[e];if(g)return g(a,c,b,d);if("contains"===e)return 0<=(a.textContent||a.innerText||
m.getText([a])||"").indexOf(b[3]);if("not"===e){b=b[3];c=0;for(d=b.length;c<d;c++)if(b[c]===a)return!1;return!0}m.error(e)},CHILD:function(a,b){var c=b[1],d=a;switch(c){case "only":case "first":for(;d=d.previousSibling;)if(1===d.nodeType)return!1;if("first"===c)return!0;d=a;case "last":for(;d=d.nextSibling;)if(1===d.nodeType)return!1;return!0;case "nth":var c=b[2],e=b[3];if(1===c&&0===e)return!0;var g=b[0],k=a.parentNode;if(k&&(k.sizcache!==g||!a.nodeIndex)){for(var f=0,d=k.firstChild;d;d=d.nextSibling)1===
d.nodeType&&(d.nodeIndex=++f);k.sizcache=g}d=a.nodeIndex-e;return 0===c?0===d:0===d%c&&0<=d/c}},ID:function(a,b){return 1===a.nodeType&&a.getAttribute("id")===b},TAG:function(a,b){return"*"===b&&1===a.nodeType||a.nodeName.toLowerCase()===b},CLASS:function(a,b){return-1<(" "+(a.className||a.getAttribute("class"))+" ").indexOf(b)},ATTR:function(a,b){var c=b[1],c=n.attrHandle[c]?n.attrHandle[c](a):null!=a[c]?a[c]:a.getAttribute(c),d=c+"",e=b[2],g=b[4];return null==c?"!="===e:"="===e?d===g:"*="===e?0<=
d.indexOf(g):"~="===e?0<=(" "+d+" ").indexOf(g):g?"!="===e?d!==g:"^="===e?0===d.indexOf(g):"$="===e?d.substr(d.length-g.length)===g:"|="===e?d===g||d.substr(0,g.length+1)===g+"-":!1:d&&!1!==c},POS:function(a,b,c,d){var e=n.setFilters[b[2]];if(e)return e(a,c,b,d)}}},D=n.match.POS,p=function(a,b){return"\\"+(b-0+1)},G;for(G in n.match)n.match[G]=RegExp(n.match[G].source+/(?![^\[]*\])(?![^\(]*\))/.source),n.leftMatch[G]=RegExp(/(^(?:.|\r|\n)*?)/.source+n.match[G].source.replace(/\\(\d+)/g,p));var B=
function(a,b){a=Array.prototype.slice.call(a,0);return b?(b.push.apply(b,a),b):a};try{Array.prototype.slice.call(x.documentElement.childNodes,0)[0].nodeType}catch(r){B=function(a,b){var c=0,d=b||[];if("[object Array]"===g.call(a))Array.prototype.push.apply(d,a);else if("number"===typeof a.length)for(var e=a.length;c<e;c++)d.push(a[c]);else for(;a[c];c++)d.push(a[c]);return d}}var s,N;x.documentElement.compareDocumentPosition?s=function(a,b){return a===b?(k=!0,0):a.compareDocumentPosition&&b.compareDocumentPosition?
a.compareDocumentPosition(b)&4?-1:1:a.compareDocumentPosition?-1:1}:(s=function(a,b){if(a===b)return k=!0,0;if(a.sourceIndex&&b.sourceIndex)return a.sourceIndex-b.sourceIndex;var c,d,e=[],g=[];c=a.parentNode;d=b.parentNode;var f=c;if(c===d)return N(a,b);if(!c)return-1;if(!d)return 1;for(;f;)e.unshift(f),f=f.parentNode;for(f=d;f;)g.unshift(f),f=f.parentNode;c=e.length;d=g.length;for(f=0;f<c&&f<d;f++)if(e[f]!==g[f])return N(e[f],g[f]);return f===c?N(a,g[f],-1):N(e[f],b,1)},N=function(a,b,c){if(a===
b)return c;for(a=a.nextSibling;a;){if(a===b)return-1;a=a.nextSibling}return 1});m.getText=function(a){for(var b="",c,d=0;a[d];d++)c=a[d],3===c.nodeType||4===c.nodeType?b+=c.nodeValue:8!==c.nodeType&&(b+=m.getText(c.childNodes));return b};(function(){var a=x.createElement("div"),c="script"+(new Date).getTime(),d=x.documentElement;a.innerHTML="<a name='"+c+"'/>";d.insertBefore(a,d.firstChild);x.getElementById(c)&&(n.find.ID=function(a,c,d){if("undefined"!==typeof c.getElementById&&!d)return(c=c.getElementById(a[1]))?
c.id===a[1]||"undefined"!==typeof c.getAttributeNode&&c.getAttributeNode("id").nodeValue===a[1]?[c]:b:[]},n.filter.ID=function(a,b){var c="undefined"!==typeof a.getAttributeNode&&a.getAttributeNode("id");return 1===a.nodeType&&c&&c.nodeValue===b});d.removeChild(a);d=a=null})();(function(){var a=x.createElement("div");a.appendChild(x.createComment(""));0<a.getElementsByTagName("*").length&&(n.find.TAG=function(a,b){var c=b.getElementsByTagName(a[1]);if("*"===a[1]){for(var d=[],e=0;c[e];e++)1===c[e].nodeType&&
d.push(c[e]);c=d}return c});a.innerHTML="<a href='#'></a>";a.firstChild&&("undefined"!==typeof a.firstChild.getAttribute&&"#"!==a.firstChild.getAttribute("href"))&&(n.attrHandle.href=function(a){return a.getAttribute("href",2)});a=null})();x.querySelectorAll&&function(){var a=m,b=x.createElement("div");b.innerHTML="<p class='TEST'></p>";if(!b.querySelectorAll||0!==b.querySelectorAll(".TEST").length){m=function(b,c,d,e){c=c||x;if(!e&&!m.isXML(c)){var g=/^(\w+$)|^\.([\w\-]+$)|^#([\w\-]+$)/.exec(b);
if(g&&(1===c.nodeType||9===c.nodeType)){if(g[1])return B(c.getElementsByTagName(b),d);if(g[2]&&n.find.CLASS&&c.getElementsByClassName)return B(c.getElementsByClassName(g[2]),d)}if(9===c.nodeType){if("body"===b&&c.body)return B([c.body],d);if(g&&g[3]){var k=c.getElementById(g[3]);if(k&&k.parentNode){if(k.id===g[3])return B([k],d)}else return B([],d)}try{return B(c.querySelectorAll(b),d)}catch(f){}}else if(1===c.nodeType&&"object"!==c.nodeName.toLowerCase()){var g=c,h=(k=c.getAttribute("id"))||"__sizzle__",
l=c.parentNode,q=/^\s*[+~]/.test(b);k?h=h.replace(/'/g,"\\$&"):c.setAttribute("id",h);q&&l&&(c=c.parentNode);try{if(!q||l)return B(c.querySelectorAll("[id='"+h+"'] "+b),d)}catch(A){}finally{k||g.removeAttribute("id")}}}return a(b,c,d,e)};for(var c in a)m[c]=a[c];b=null}}();(function(){var a=x.documentElement,b=a.matchesSelector||a.mozMatchesSelector||a.webkitMatchesSelector||a.msMatchesSelector;if(b){var c=!b.call(x.createElement("div"),"div"),d=!1;try{b.call(x.documentElement,"[test!='']:sizzle")}catch(e){d=
!0}m.matchesSelector=function(a,e){e=e.replace(/\=\s*([^'"\]]*)\s*\]/g,"='$1']");if(!m.isXML(a))try{if(d||!n.match.PSEUDO.test(e)&&!/!=/.test(e)){var g=b.call(a,e);if(g||!c||a.document&&11!==a.document.nodeType)return g}}catch(k){}return 0<m(e,null,null,[a]).length}}})();(function(){var a=x.createElement("div");a.innerHTML="<div class='test e'></div><div class='test'></div>";a.getElementsByClassName&&0!==a.getElementsByClassName("e").length&&(a.lastChild.className="e",1!==a.getElementsByClassName("e").length&&
(n.order.splice(1,0,"CLASS"),n.find.CLASS=function(a,b,c){if("undefined"!==typeof b.getElementsByClassName&&!c)return b.getElementsByClassName(a[1])},a=null))})();m.contains=x.documentElement.contains?function(a,b){return a!==b&&(a.contains?a.contains(b):!0)}:x.documentElement.compareDocumentPosition?function(a,b){return!!(a.compareDocumentPosition(b)&16)}:function(){return!1};m.isXML=function(a){return(a=(a?a.ownerDocument||a:0).documentElement)?"HTML"!==a.nodeName:!1};var t=function(a,b){for(var c,
d=[],e="",g=b.nodeType?[b]:b;c=n.match.PSEUDO.exec(a);)e+=c[0],a=a.replace(n.match.PSEUDO,"");a=n.relative[a]?a+"*":a;c=0;for(var k=g.length;c<k;c++)m(a,g[c],d);return m.filter(e,d)};h.find=m;h.expr=m.selectors;h.expr[":"]=h.expr.filters;h.unique=m.uniqueSort;h.text=m.getText;h.isXMLDoc=m.isXML;h.contains=m.contains})();var q=/Until$/,D=/^(?:parents|prevUntil|prevAll)/,G=/,/,B=/^.[^:#\[\.,]*$/,K=Array.prototype.slice,R=h.expr.match.POS,ra={children:!0,contents:!0,next:!0,prev:!0};h.fn.extend({find:function(a){var b=
this,c,d;if("string"!==typeof a)return h(a).filter(function(){c=0;for(d=b.length;c<d;c++)if(h.contains(b[c],this))return!0});var e=this.pushStack("","find",a),g,k,f;c=0;for(d=this.length;c<d;c++)if(g=e.length,h.find(a,this[c],e),0<c)for(k=g;k<e.length;k++)for(f=0;f<g;f++)if(e[f]===e[k]){e.splice(k--,1);break}return e},has:function(a){var b=h(a);return this.filter(function(){for(var a=0,c=b.length;a<c;a++)if(h.contains(this,b[a]))return!0})},not:function(a){return this.pushStack(p(this,a,!1),"not",
a)},filter:function(a){return this.pushStack(p(this,a,!0),"filter",a)},is:function(a){return!!a&&("string"===typeof a?0<h.filter(a,this).length:0<this.filter(a).length)},closest:function(a,b){var c=[],d,e,g=this[0];if(h.isArray(a)){var k,f={},l=1;if(g&&a.length){d=0;for(e=a.length;d<e;d++)k=a[d],f[k]||(f[k]=R.test(k)?h(k,b||this.context):k);for(;g&&g.ownerDocument&&g!==b;){for(k in f)d=f[k],(d.jquery?-1<d.index(g):h(g).is(d))&&c.push({selector:k,elem:g,level:l});g=g.parentNode;l++}}return c}k=R.test(a)||
"string"!==typeof a?h(a,b||this.context):0;d=0;for(e=this.length;d<e;d++)for(g=this[d];g;)if(k?-1<k.index(g):h.find.matchesSelector(g,a)){c.push(g);break}else if(g=g.parentNode,!g||!g.ownerDocument||g===b||11===g.nodeType)break;c=1<c.length?h.unique(c):c;return this.pushStack(c,"closest",a)},index:function(a){return a&&"string"!==typeof a?h.inArray(a.jquery?a[0]:a,this):h.inArray(this[0],a?h(a):this.parent().children())},add:function(a,b){var c="string"===typeof a?h(a,b):h.makeArray(a&&a.nodeType?
[a]:a),d=h.merge(this.get(),c);return this.pushStack(c[0]&&c[0].parentNode&&11!==c[0].parentNode.nodeType&&d[0]&&d[0].parentNode&&11!==d[0].parentNode.nodeType?h.unique(d):d)},andSelf:function(){return this.add(this.prevObject)}});h.each({parent:function(a){return(a=a.parentNode)&&11!==a.nodeType?a:null},parents:function(a){return h.dir(a,"parentNode")},parentsUntil:function(a,b,c){return h.dir(a,"parentNode",c)},next:function(a){return h.nth(a,2,"nextSibling")},prev:function(a){return h.nth(a,2,
"previousSibling")},nextAll:function(a){return h.dir(a,"nextSibling")},prevAll:function(a){return h.dir(a,"previousSibling")},nextUntil:function(a,b,c){return h.dir(a,"nextSibling",c)},prevUntil:function(a,b,c){return h.dir(a,"previousSibling",c)},siblings:function(a){return h.sibling(a.parentNode.firstChild,a)},children:function(a){return h.sibling(a.firstChild)},contents:function(a){return h.nodeName(a,"iframe")?a.contentDocument||a.contentWindow.document:h.makeArray(a.childNodes)}},function(a,
b){h.fn[a]=function(c,d){var e=h.map(this,b,c),g=K.call(arguments);q.test(a)||(d=c);d&&"string"===typeof d&&(e=h.filter(d,e));e=1<this.length&&!ra[a]?h.unique(e):e;(1<this.length||G.test(d))&&D.test(a)&&(e=e.reverse());return this.pushStack(e,a,g.join(","))}});h.extend({filter:function(a,b,c){c&&(a=":not("+a+")");return 1===b.length?h.find.matchesSelector(b[0],a)?[b[0]]:[]:h.find.matches(a,b)},dir:function(a,c,d){var e=[];for(a=a[c];a&&9!==a.nodeType&&(d===b||1!==a.nodeType||!h(a).is(d));)1===a.nodeType&&
e.push(a),a=a[c];return e},nth:function(a,b,c,d){b=b||1;for(d=0;a&&(1!==a.nodeType||++d!==b);a=a[c]);return a},sibling:function(a,b){for(var c=[];a;a=a.nextSibling)1===a.nodeType&&a!==b&&c.push(a);return c}});var Ma=/ jQuery\d+="(?:\d+|null)"/g,tc=/^\s+/,zc=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/ig,dc=/<([\w:]+)/,Oc=/<tbody/i,fb=/<|&#?\w+;/,Ac=/<(?:script|object|embed|option|style)/i,Bc=/checked\s*(?:[^=]|=\s*.checked.)/i,ec=/\/(java|ecma)script/i,Yb=/^\s*<!(?:\[CDATA\[|\-\-)/,
X={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]};X.optgroup=X.option;X.tbody=X.tfoot=X.colgroup=X.caption=X.thead;X.th=X.td;h.support.htmlSerialize||(X._default=[1,"div<div>","</div>"]);h.fn.extend({text:function(a){return h.isFunction(a)?
this.each(function(b){var c=h(this);c.text(a.call(this,b,c.text()))}):"object"!==typeof a&&a!==b?this.empty().append((this[0]&&this[0].ownerDocument||x).createTextNode(a)):h.text(this)},wrapAll:function(a){if(h.isFunction(a))return this.each(function(b){h(this).wrapAll(a.call(this,b))});if(this[0]){var b=h(a,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&b.insertBefore(this[0]);b.map(function(){for(var a=this;a.firstChild&&1===a.firstChild.nodeType;)a=a.firstChild;return a}).append(this)}return this},
wrapInner:function(a){return h.isFunction(a)?this.each(function(b){h(this).wrapInner(a.call(this,b))}):this.each(function(){var b=h(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){return this.each(function(){h(this).wrapAll(a)})},unwrap:function(){return this.parent().each(function(){h.nodeName(this,"body")||h(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(a){1===this.nodeType&&this.appendChild(a)})},prepend:function(){return this.domManip(arguments,
!0,function(a){1===this.nodeType&&this.insertBefore(a,this.firstChild)})},before:function(){if(this[0]&&this[0].parentNode)return this.domManip(arguments,!1,function(a){this.parentNode.insertBefore(a,this)});if(arguments.length){var a=h(arguments[0]);a.push.apply(a,this.toArray());return this.pushStack(a,"before",arguments)}},after:function(){if(this[0]&&this[0].parentNode)return this.domManip(arguments,!1,function(a){this.parentNode.insertBefore(a,this.nextSibling)});if(arguments.length){var a=this.pushStack(this,
"after",arguments);a.push.apply(a,h(arguments[0]).toArray());return a}},remove:function(a,b){for(var c=0,d;null!=(d=this[c]);c++)if(!a||h.filter(a,[d]).length)b||1!==d.nodeType||(h.cleanData(d.getElementsByTagName("*")),h.cleanData([d])),d.parentNode&&d.parentNode.removeChild(d);return this},empty:function(){for(var a=0,b;null!=(b=this[a]);a++)for(1===b.nodeType&&h.cleanData(b.getElementsByTagName("*"));b.firstChild;)b.removeChild(b.firstChild);return this},clone:function(a,b){a=null==a?!1:a;b=null==
b?a:b;return this.map(function(){return h.clone(this,a,b)})},html:function(a){if(a===b)return this[0]&&1===this[0].nodeType?this[0].innerHTML.replace(Ma,""):null;if("string"!==typeof a||Ac.test(a)||!h.support.leadingWhitespace&&tc.test(a)||X[(dc.exec(a)||["",""])[1].toLowerCase()])h.isFunction(a)?this.each(function(b){var c=h(this);c.html(a.call(this,b,c.html()))}):this.empty().append(a);else{a=a.replace(zc,"<$1></$2>");try{for(var c=0,d=this.length;c<d;c++)1===this[c].nodeType&&(h.cleanData(this[c].getElementsByTagName("*")),
this[c].innerHTML=a)}catch(e){this.empty().append(a)}}return this},replaceWith:function(a){if(this[0]&&this[0].parentNode){if(h.isFunction(a))return this.each(function(b){var c=h(this),d=c.html();c.replaceWith(a.call(this,b,d))});"string"!==typeof a&&(a=h(a).detach());return this.each(function(){var b=this.nextSibling,c=this.parentNode;h(this).remove();b?h(b).before(a):h(c).append(a)})}return this.length?this.pushStack(h(h.isFunction(a)?a():a),"replaceWith",a):this},detach:function(a){return this.remove(a,
!0)},domManip:function(a,c,d){var e,g,k,f=a[0],l=[];if(!h.support.checkClone&&3===arguments.length&&"string"===typeof f&&Bc.test(f))return this.each(function(){h(this).domManip(a,c,d,!0)});if(h.isFunction(f))return this.each(function(e){var g=h(this);a[0]=f.call(this,e,c?g.html():b);g.domManip(a,c,d)});if(this[0]){e=f&&f.parentNode;e=h.support.parentNode&&e&&11===e.nodeType&&e.childNodes.length===this.length?{fragment:e}:h.buildFragment(a,this,l);k=e.fragment;if(g=1===k.childNodes.length?k=k.firstChild:
k.firstChild){c=c&&h.nodeName(g,"tr");g=0;for(var q=this.length,m=q-1;g<q;g++)d.call(c?h.nodeName(this[g],"table")?this[g].getElementsByTagName("tbody")[0]||this[g].appendChild(this[g].ownerDocument.createElement("tbody")):this[g]:this[g],e.cacheable||1<q&&g<m?h.clone(k,!0,!0):k)}l.length&&h.each(l,z)}return this}});h.buildFragment=function(a,b,c){var d,e,g,k;b&&b[0]&&(k=b[0].ownerDocument||b[0]);k.createDocumentFragment||(k=x);1===a.length&&("string"===typeof a[0]&&512>a[0].length&&k===x&&"<"===
a[0].charAt(0)&&!Ac.test(a[0])&&(h.support.checkClone||!Bc.test(a[0])))&&(e=!0,(g=h.fragments[a[0]])&&1!==g&&(d=g));d||(d=k.createDocumentFragment(),h.clean(a,k,d,c));e&&(h.fragments[a[0]]=g?d:1);return{fragment:d,cacheable:e}};h.fragments={};h.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){h.fn[a]=function(c){var d=[];c=h(c);var e=1===this.length&&this[0].parentNode;if(e&&11===e.nodeType&&1===e.childNodes.length&&1===
c.length)return c[b](this[0]),this;for(var e=0,g=c.length;e<g;e++){var k=(0<e?this.clone(!0):this).get();h(c[e])[b](k);d=d.concat(k)}return this.pushStack(d,a,c.selector)}});h.extend({clone:function(a,b,c){var d=a.cloneNode(!0),e,g,k;if(!(h.support.noCloneEvent&&h.support.noCloneChecked||1!==a.nodeType&&11!==a.nodeType||h.isXMLDoc(a)))for(s(a,d),e=t(a),g=t(d),k=0;e[k];++k)s(e[k],g[k]);if(b&&(r(a,d),c))for(e=t(a),g=t(d),k=0;e[k];++k)r(e[k],g[k]);return d},clean:function(a,b,c,d){b=b||x;"undefined"===
typeof b.createElement&&(b=b.ownerDocument||b[0]&&b[0].ownerDocument||x);for(var e=[],g,k=0,f;null!=(f=a[k]);k++)if("number"===typeof f&&(f+=""),f){if("string"===typeof f)if(fb.test(f)){f=f.replace(zc,"<$1></$2>");g=(dc.exec(f)||["",""])[1].toLowerCase();var l=X[g]||X._default,q=l[0],m=b.createElement("div");for(m.innerHTML=l[1]+f+l[2];q--;)m=m.lastChild;if(!h.support.tbody)for(q=Oc.test(f),l="table"!==g||q?"<table>"!==l[1]||q?[]:m.childNodes:m.firstChild&&m.firstChild.childNodes,g=l.length-1;0<=
g;--g)h.nodeName(l[g],"tbody")&&!l[g].childNodes.length&&l[g].parentNode.removeChild(l[g]);!h.support.leadingWhitespace&&tc.test(f)&&m.insertBefore(b.createTextNode(tc.exec(f)[0]),m.firstChild);f=m.childNodes}else f=b.createTextNode(f);var n;if(!h.support.appendChecked)if(f[0]&&"number"===typeof(n=f.length))for(g=0;g<n;g++)y(f[g]);else y(f);f.nodeType?e.push(f):e=h.merge(e,f)}if(c)for(a=function(a){return!a.type||ec.test(a.type)},k=0;e[k];k++)!d||!h.nodeName(e[k],"script")||e[k].type&&"text/javascript"!==
e[k].type.toLowerCase()?(1===e[k].nodeType&&(b=h.grep(e[k].getElementsByTagName("script"),a),e.splice.apply(e,[k+1,0].concat(b))),c.appendChild(e[k])):d.push(e[k].parentNode?e[k].parentNode.removeChild(e[k]):e[k]);return e},cleanData:function(a){for(var b,c,d=h.cache,e=h.expando,g=h.event.special,k=h.support.deleteExpando,f=0,l;null!=(l=a[f]);f++)if(!l.nodeName||!h.noData[l.nodeName.toLowerCase()])if(c=l[h.expando]){if((b=d[c]&&d[c][e])&&b.events){for(var q in b.events)g[q]?h.event.remove(l,q):h.removeEvent(l,
q,b.handle);b.handle&&(b.handle.elem=null)}k?delete l[h.expando]:l.removeAttribute&&l.removeAttribute(h.expando);delete d[c]}}});var Xa=/alpha\([^)]*\)/i,Pc=/opacity=([^)]*)/,fc=/([A-Z]|^ms)/g,qb=/^-?\d+(?:px)?$/i,Qc=/^-?\d/,rb=/^[+\-]=/,yb=/[^+\-\.\de]+/g,zb={position:"absolute",visibility:"hidden",display:"block"},ca=["Left","Right"],pc=["Top","Bottom"],Ta,Kb,Lb;h.fn.css=function(a,c){return 2===arguments.length&&c===b?this:h.access(this,a,c,!0,function(a,c,d){return d!==b?h.style(a,c,d):h.css(a,
c)})};h.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=Ta(a,"opacity","opacity");return""===c?"1":c}return a.style.opacity}}},cssNumber:{fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":h.support.cssFloat?"cssFloat":"styleFloat"},style:function(a,c,d,e){if(a&&3!==a.nodeType&&8!==a.nodeType&&a.style){var g,k=h.camelCase(c),f=a.style,l=h.cssHooks[k];c=h.cssProps[k]||k;if(d!==b){if(e=typeof d,!("number"===e&&isNaN(d)||null==d||
("string"===e&&rb.test(d)&&(d=+d.replace(yb,"")+parseFloat(h.css(a,c)),e="number"),"number"!==e||h.cssNumber[k]||(d+="px"),l&&"set"in l&&(d=l.set(a,d))===b)))try{f[c]=d}catch(q){}}else return l&&"get"in l&&(g=l.get(a,!1,e))!==b?g:f[c]}},css:function(a,c,d){var e,g;c=h.camelCase(c);g=h.cssHooks[c];c=h.cssProps[c]||c;"cssFloat"===c&&(c="float");if(g&&"get"in g&&(e=g.get(a,!0,d))!==b)return e;if(Ta)return Ta(a,c)},swap:function(a,b,c){var d={},e;for(e in b)d[e]=a.style[e],a.style[e]=b[e];c.call(a);for(e in b)a.style[e]=
d[e]}});h.curCSS=h.css;h.each(["height","width"],function(a,b){h.cssHooks[b]={get:function(a,c,d){var e;if(c){if(0!==a.offsetWidth)return C(a,b,d);h.swap(a,zb,function(){e=C(a,b,d)});return e}},set:function(a,b){if(qb.test(b)){if(b=parseFloat(b),0<=b)return b+"px"}else return b}}});h.support.opacity||(h.cssHooks.opacity={get:function(a,b){return Pc.test((b&&a.currentStyle?a.currentStyle.filter:a.style.filter)||"")?parseFloat(RegExp.$1)/100+"":b?"1":""},set:function(a,b){var c=a.style,d=a.currentStyle;
c.zoom=1;var e=h.isNaN(b)?"":"alpha(opacity="+100*b+")",d=d&&d.filter||c.filter||"";c.filter=Xa.test(d)?d.replace(Xa,e):d+" "+e}});h(function(){h.support.reliableMarginRight||(h.cssHooks.marginRight={get:function(a,b){var c;h.swap(a,{display:"inline-block"},function(){c=b?Ta(a,"margin-right","marginRight"):a.style.marginRight});return c}})});x.defaultView&&x.defaultView.getComputedStyle&&(Kb=function(a,c){var d,e;c=c.replace(fc,"-$1").toLowerCase();if(!(e=a.ownerDocument.defaultView))return b;if(e=
e.getComputedStyle(a,null))d=e.getPropertyValue(c),""!==d||h.contains(a.ownerDocument.documentElement,a)||(d=h.style(a,c));return d});x.documentElement.currentStyle&&(Lb=function(a,b){var c,d=a.currentStyle&&a.currentStyle[b],e=a.runtimeStyle&&a.runtimeStyle[b],g=a.style;!qb.test(d)&&Qc.test(d)&&(c=g.left,e&&(a.runtimeStyle.left=a.currentStyle.left),g.left="fontSize"===b?"1em":d||0,d=g.pixelLeft+"px",g.left=c,e&&(a.runtimeStyle.left=e));return""===d?"auto":d});Ta=Kb||Lb;h.expr&&h.expr.filters&&(h.expr.filters.hidden=
function(a){var b=a.offsetHeight;return 0===a.offsetWidth&&0===b||!h.support.reliableHiddenOffsets&&"none"===(a.style.display||h.css(a,"display"))},h.expr.filters.visible=function(a){return!h.expr.filters.hidden(a)});var Ya=/%20/g,Mc=/\[\]$/,gc=/\r?\n/g,Mb=/#.*$/,hc=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,ic=/^(?:color|date|datetime|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,Na=/^(?:GET|HEAD)$/,sb=/^\/\//,tb=/\?/,Oa=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,Ab=
/^(?:select|textarea)/i,W=/\s+/,Nb=/([?&])_=[^&]*/,Ob=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+))?)?/,jc=h.fn.load,ab={},Pb={},Za,Pa;try{Za=U.href}catch(uc){Za=x.createElement("a"),Za.href="",Za=Za.href}Pa=Ob.exec(Za.toLowerCase())||[];h.fn.extend({load:function(a,c,d){if("string"!==typeof a&&jc)return jc.apply(this,arguments);if(!this.length)return this;var e=a.indexOf(" ");if(0<=e){var g=a.slice(e,a.length);a=a.slice(0,e)}e="GET";c&&(h.isFunction(c)?(d=c,c=b):"object"===typeof c&&(c=h.param(c,
h.ajaxSettings.traditional),e="POST"));var k=this;h.ajax({url:a,type:e,dataType:"html",data:c,complete:function(a,b,c){c=a.responseText;a.isResolved()&&(a.done(function(a){c=a}),k.html(g?h("<div>").append(c.replace(Oa,"")).find(g):c));d&&k.each(d,[c,b,a])}});return this},serialize:function(){return h.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?h.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||
Ab.test(this.nodeName)||ic.test(this.type))}).map(function(a,b){var c=h(this).val();return null==c?null:h.isArray(c)?h.map(c,function(a,c){return{name:b.name,value:a.replace(gc,"\r\n")}}):{name:b.name,value:c.replace(gc,"\r\n")}}).get()}});h.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(a,b){h.fn[b]=function(a){return this.bind(b,a)}});h.each(["get","post"],function(a,c){h[c]=function(a,d,e,g){h.isFunction(d)&&(g=g||e,e=d,d=b);return h.ajax({type:c,url:a,
data:d,success:e,dataType:g})}});h.extend({getScript:function(a,c){return h.get(a,b,c,"script")},getJSON:function(a,b,c){return h.get(a,b,c,"json")},ajaxSetup:function(a,b){b?h.extend(!0,a,h.ajaxSettings,b):(b=a,a=h.extend(!0,h.ajaxSettings,b));for(var c in{context:1,url:1})c in b?a[c]=b[c]:c in h.ajaxSettings&&(a[c]=h.ajaxSettings[c]);return a},ajaxSettings:{url:Za,isLocal:/^(?:about|app|app\-storage|.+\-extension|file|widget):$/.test(Pa[1]),global:!0,type:"GET",contentType:"application/x-www-form-urlencoded",
processData:!0,async:!0,accepts:{xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":"*/*"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":a.String,"text html":!0,"text json":h.parseJSON,"text xml":h.parseXML}},ajaxPrefilter:M(ab),ajaxTransport:M(Pb),ajax:function(a,c){function d(a,c,n,D){if(2!==N){N=2;r&&clearTimeout(r);B=b;p=D||"";K.readyState=a?4:0;var A,G,s;if(n){D=
e;var ua=K,y=D.contents,V=D.dataTypes,w=D.responseFields,z,R,ra,x;for(R in w)R in n&&(ua[w[R]]=n[R]);for(;"*"===V[0];)V.shift(),z===b&&(z=D.mimeType||ua.getResponseHeader("content-type"));if(z)for(R in y)if(y[R]&&y[R].test(z)){V.unshift(R);break}if(V[0]in n)ra=V[0];else{for(R in n){if(!V[0]||D.converters[R+" "+V[0]]){ra=R;break}x||(x=R)}ra=ra||x}ra?(ra!==V[0]&&V.unshift(ra),n=n[ra]):n=void 0}else n=b;if(200<=a&&300>a||304===a){if(e.ifModified){if(z=K.getResponseHeader("Last-Modified"))h.lastModified[m]=
z;if(z=K.getResponseHeader("Etag"))h.etag[m]=z}if(304===a)c="notmodified",A=!0;else try{z=e;z.dataFilter&&(n=z.dataFilter(n,z.dataType));var C=z.dataTypes;R={};var ba,sa,ya=C.length,H,E=C[0],M,J,Ma,ca,Q;for(ba=1;ba<ya;ba++){if(1===ba)for(sa in z.converters)"string"===typeof sa&&(R[sa.toLowerCase()]=z.converters[sa]);M=E;E=C[ba];if("*"===E)E=M;else if("*"!==M&&M!==E){J=M+" "+E;Ma=R[J]||R["* "+E];if(!Ma)for(ca in Q=b,R)if(H=ca.split(" "),H[0]===M||"*"===H[0])if(Q=R[H[1]+" "+E]){ca=R[ca];!0===ca?Ma=
Q:!0===Q&&(Ma=ca);break}Ma||Q||h.error("No conversion from "+J.replace(" "," to "));!0!==Ma&&(n=Ma?Ma(n):Q(ca(n)))}}G=n;c="success";A=!0}catch(L){c="parsererror",s=L}}else if(s=c,!c||a)c="error",0>a&&(a=0);K.status=a;K.statusText=c;A?f.resolveWith(g,[G,c,K]):f.rejectWith(g,[K,c,s]);K.statusCode(q);q=b;t&&k.trigger("ajax"+(A?"Success":"Error"),[K,e,A?G:s]);l.resolveWith(g,[K,c]);t&&(k.trigger("ajaxComplete",[K,e]),--h.active||h.event.trigger("ajaxStop"))}}"object"===typeof a&&(c=a,a=b);c=c||{};var e=
h.ajaxSetup({},c),g=e.context||e,k=g!==e&&(g.nodeType||g instanceof h)?h(g):h.event,f=h.Deferred(),l=h._Deferred(),q=e.statusCode||{},m,n={},D={},p,G,B,r,s,N=0,t,y,K={readyState:0,setRequestHeader:function(a,b){if(!N){var c=a.toLowerCase();a=D[c]=D[c]||a;n[a]=b}return this},getAllResponseHeaders:function(){return 2===N?p:null},getResponseHeader:function(a){var c;if(2===N){if(!G)for(G={};c=hc.exec(p);)G[c[1].toLowerCase()]=c[2];c=G[a.toLowerCase()]}return c===b?null:c},overrideMimeType:function(a){N||
(e.mimeType=a);return this},abort:function(a){a=a||"abort";B&&B.abort(a);d(0,a);return this}};f.promise(K);K.success=K.done;K.error=K.fail;K.complete=l.done;K.statusCode=function(a){if(a){var b;if(2>N)for(b in a)q[b]=[q[b],a[b]];else b=a[K.status],K.then(b,b)}return this};e.url=((a||e.url)+"").replace(Mb,"").replace(sb,Pa[1]+"//");e.dataTypes=h.trim(e.dataType||"*").toLowerCase().split(W);null==e.crossDomain&&(s=Ob.exec(e.url.toLowerCase()),e.crossDomain=!(!s||s[1]==Pa[1]&&s[2]==Pa[2]&&(s[3]||("http:"===
s[1]?80:443))==(Pa[3]||("http:"===Pa[1]?80:443))));e.data&&(e.processData&&"string"!==typeof e.data)&&(e.data=h.param(e.data,e.traditional));H(ab,e,c,K);if(2===N)return!1;t=e.global;e.type=e.type.toUpperCase();e.hasContent=!Na.test(e.type);t&&0===h.active++&&h.event.trigger("ajaxStart");if(!e.hasContent&&(e.data&&(e.url+=(tb.test(e.url)?"&":"?")+e.data),m=e.url,!1===e.cache)){s=h.now();var w=e.url.replace(Nb,"$1_="+s);e.url=w+(w===e.url?(tb.test(e.url)?"&":"?")+"_="+s:"")}(e.data&&e.hasContent&&!1!==
e.contentType||c.contentType)&&K.setRequestHeader("Content-Type",e.contentType);e.ifModified&&(m=m||e.url,h.lastModified[m]&&K.setRequestHeader("If-Modified-Since",h.lastModified[m]),h.etag[m]&&K.setRequestHeader("If-None-Match",h.etag[m]));K.setRequestHeader("Accept",e.dataTypes[0]&&e.accepts[e.dataTypes[0]]?e.accepts[e.dataTypes[0]]+("*"!==e.dataTypes[0]?", */*; q=0.01":""):e.accepts["*"]);for(y in e.headers)K.setRequestHeader(y,e.headers[y]);if(e.beforeSend&&(!1===e.beforeSend.call(g,K,e)||2===
N))return K.abort(),!1;for(y in{success:1,error:1,complete:1})K[y](e[y]);if(B=H(Pb,e,c,K)){K.readyState=1;t&&k.trigger("ajaxSend",[K,e]);e.async&&0<e.timeout&&(r=setTimeout(function(){K.abort("timeout")},e.timeout));try{N=1,B.send(n,d)}catch(z){2>status?d(-1,z):h.error(z)}}else d(-1,"No Transport");return K},param:function(a,c){var d=[],e=function(a,b){b=h.isFunction(b)?b():b;d[d.length]=encodeURIComponent(a)+"="+encodeURIComponent(b)};c===b&&(c=h.ajaxSettings.traditional);if(h.isArray(a)||a.jquery&&
!h.isPlainObject(a))h.each(a,function(){e(this.name,this.value)});else for(var g in a)P(g,a[g],c,e);return d.join("&").replace(Ya,"+")}});h.extend({active:0,lastModified:{},etag:{}});var Ub=h.now(),hb=/(\=)\?(&|$)|\?\?/i;h.ajaxSetup({jsonp:"callback",jsonpCallback:function(){return h.expando+"_"+Ub++}});h.ajaxPrefilter("json jsonp",function(b,c,d){c="application/x-www-form-urlencoded"===b.contentType&&"string"===typeof b.data;if("jsonp"===b.dataTypes[0]||!1!==b.jsonp&&(hb.test(b.url)||c&&hb.test(b.data))){var e,
g=b.jsonpCallback=h.isFunction(b.jsonpCallback)?b.jsonpCallback():b.jsonpCallback,k=a[g],f=b.url,l=b.data,q="$1"+g+"$2";!1!==b.jsonp&&(f=f.replace(hb,q),b.url===f&&(c&&(l=l.replace(hb,q)),b.data===l&&(f+=(/\?/.test(f)?"&":"?")+b.jsonp+"="+g)));b.url=f;b.data=l;a[g]=function(a){e=[a]};d.always(function(){a[g]=k;if(e&&h.isFunction(k))a[g](e[0])});b.converters["script json"]=function(){e||h.error(g+" was not called");return e[0]};b.dataTypes[0]="json";return"script"}});h.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},
contents:{script:/javascript|ecmascript/},converters:{"text script":function(a){h.globalEval(a);return a}}});h.ajaxPrefilter("script",function(a){a.cache===b&&(a.cache=!1);a.crossDomain&&(a.type="GET",a.global=!1)});h.ajaxTransport("script",function(a){if(a.crossDomain){var c,d=x.head||x.getElementsByTagName("head")[0]||x.documentElement;return{send:function(e,g){c=x.createElement("script");c.async="async";a.scriptCharset&&(c.charset=a.scriptCharset);c.src=a.url;c.onload=c.onreadystatechange=function(a,
e){if(e||!c.readyState||/loaded|complete/.test(c.readyState))c.onload=c.onreadystatechange=null,d&&c.parentNode&&d.removeChild(c),c=b,e||g(200,"success")};d.insertBefore(c,d.firstChild)},abort:function(){if(c)c.onload(0,1)}}}});var Bb=a.ActiveXObject?function(){for(var a in Ra)Ra[a](0,1)}:!1,Vb=0,Ra;h.ajaxSettings.xhr=a.ActiveXObject?function(){var b;if(!(b=!this.isLocal&&T()))a:{try{b=new a.ActiveXObject("Microsoft.XMLHTTP");break a}catch(c){}b=void 0}return b}:T;(function(a){h.extend(h.support,
{ajax:!!a,cors:!!a&&"withCredentials"in a})})(h.ajaxSettings.xhr());h.support.ajax&&h.ajaxTransport(function(c){if(!c.crossDomain||h.support.cors){var d;return{send:function(e,g){var k=c.xhr(),f,l;c.username?k.open(c.type,c.url,c.async,c.username,c.password):k.open(c.type,c.url,c.async);if(c.xhrFields)for(l in c.xhrFields)k[l]=c.xhrFields[l];c.mimeType&&k.overrideMimeType&&k.overrideMimeType(c.mimeType);c.crossDomain||e["X-Requested-With"]||(e["X-Requested-With"]="XMLHttpRequest");try{for(l in e)k.setRequestHeader(l,
e[l])}catch(q){}k.send(c.hasContent&&c.data||null);d=function(a,e){var l,q,m,n,D;try{if(d&&(e||4===k.readyState))if(d=b,f&&(k.onreadystatechange=h.noop,Bb&&delete Ra[f]),e)4!==k.readyState&&k.abort();else{l=k.status;m=k.getAllResponseHeaders();n={};(D=k.responseXML)&&D.documentElement&&(n.xml=D);n.text=k.responseText;try{q=k.statusText}catch(p){q=""}l||!c.isLocal||c.crossDomain?1223===l&&(l=204):l=n.text?200:404}}catch(G){e||g(-1,G)}n&&g(l,q,n,m)};c.async&&4!==k.readyState?(f=++Vb,Bb&&(Ra||(Ra={},
h(a).unload(Bb)),Ra[f]=d),k.onreadystatechange=d):d()},abort:function(){d&&d(0,1)}}}});var wb={},Z,Ha,Sa=/^(?:toggle|show|hide)$/,Wb=/^([+\-]=)?([\d+.\-]+)([a-z%]*)$/i,wa,Fb=[["height","marginTop","marginBottom","paddingTop","paddingBottom"],["width","marginLeft","marginRight","paddingLeft","paddingRight"],["opacity"]],nb,Cb=a.webkitRequestAnimationFrame||a.mozRequestAnimationFrame||a.oRequestAnimationFrame;h.fn.extend({show:function(a,b,c){if(a||0===a)return this.animate(J("show",3),a,b,c);c=0;for(var d=
this.length;c<d;c++)a=this[c],a.style&&(b=a.style.display,h._data(a,"olddisplay")||"none"!==b||(b=a.style.display=""),""===b&&"none"===h.css(a,"display")&&h._data(a,"olddisplay",Ga(a.nodeName)));for(c=0;c<d;c++)if(a=this[c],a.style&&(b=a.style.display,""===b||"none"===b))a.style.display=h._data(a,"olddisplay")||"";return this},hide:function(a,b,c){if(a||0===a)return this.animate(J("hide",3),a,b,c);a=0;for(b=this.length;a<b;a++)this[a].style&&(c=h.css(this[a],"display"),"none"===c||h._data(this[a],
"olddisplay")||h._data(this[a],"olddisplay",c));for(a=0;a<b;a++)this[a].style&&(this[a].style.display="none");return this},_toggle:h.fn.toggle,toggle:function(a,b,c){var d="boolean"===typeof a;h.isFunction(a)&&h.isFunction(b)?this._toggle.apply(this,arguments):null==a||d?this.each(function(){var b=d?a:h(this).is(":hidden");h(this)[b?"show":"hide"]()}):this.animate(J("toggle",3),a,b,c);return this},fadeTo:function(a,b,c,d){return this.filter(":hidden").css("opacity",0).show().end().animate({opacity:b},
a,c,d)},animate:function(a,b,c,d){var e=h.speed(b,c,d);if(h.isEmptyObject(a))return this.each(e.complete,[!1]);a=h.extend({},a);return this[!1===e.queue?"each":"queue"](function(){!1===e.queue&&h._mark(this);var b=h.extend({},e),c=1===this.nodeType,d=c&&h(this).is(":hidden"),g,k,f,l,q;b.animatedProperties={};for(f in a){g=h.camelCase(f);f!==g&&(a[g]=a[f],delete a[f]);k=a[g];h.isArray(k)?(b.animatedProperties[g]=k[1],k=a[g]=k[0]):b.animatedProperties[g]=b.specialEasing&&b.specialEasing[g]||b.easing||
"swing";if("hide"===k&&d||"show"===k&&!d)return b.complete.call(this);!c||"height"!==g&&"width"!==g||(b.overflow=[this.style.overflow,this.style.overflowX,this.style.overflowY],"inline"===h.css(this,"display")&&"none"===h.css(this,"float")&&(h.support.inlineBlockNeedsLayout?(k=Ga(this.nodeName),"inline"===k?this.style.display="inline-block":(this.style.display="inline",this.style.zoom=1)):this.style.display="inline-block"))}null!=b.overflow&&(this.style.overflow="hidden");for(f in a)if(c=new h.fx(this,
b,f),k=a[f],Sa.test(k))c["toggle"===k?d?"show":"hide":k]();else g=Wb.exec(k),l=c.cur(),g?(k=parseFloat(g[2]),q=g[3]||(h.cssNumber[f]?"":"px"),"px"!==q&&(h.style(this,f,(k||1)+q),l*=(k||1)/c.cur(),h.style(this,f,l+q)),g[1]&&(k=("-="===g[1]?-1:1)*k+l),c.custom(l,k,q)):c.custom(l,k,"");return!0})},stop:function(a,b){a&&this.queue([]);this.each(function(){var a=h.timers,c=a.length;for(b||h._unmark(!0,this);c--;)if(a[c].elem===this){if(b)a[c](!0);a.splice(c,1)}});b||this.dequeue();return this}});h.each({slideDown:J("show",
1),slideUp:J("hide",1),slideToggle:J("toggle",1),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){h.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}});h.extend({speed:function(a,b,c){var d=a&&"object"===typeof a?h.extend({},a):{complete:c||!c&&b||h.isFunction(a)&&a,duration:a,easing:c&&b||b&&!h.isFunction(b)&&b};d.duration=h.fx.off?0:"number"===typeof d.duration?d.duration:d.duration in h.fx.speeds?h.fx.speeds[d.duration]:h.fx.speeds._default;d.old=
d.complete;d.complete=function(a){h.isFunction(d.old)&&d.old.call(this);!1!==d.queue?h.dequeue(this):!1!==a&&h._unmark(this)};return d},easing:{linear:function(a,b,c,d){return c+d*a},swing:function(a,b,c,d){return(-Math.cos(a*Math.PI)/2+0.5)*d+c}},timers:[],fx:function(a,b,c){this.options=b;this.elem=a;this.prop=c;b.orig=b.orig||{}}});h.fx.prototype={update:function(){this.options.step&&this.options.step.call(this.elem,this.now,this);(h.fx.step[this.prop]||h.fx.step._default)(this)},cur:function(){if(null!=
this.elem[this.prop]&&(!this.elem.style||null==this.elem.style[this.prop]))return this.elem[this.prop];var a,b=h.css(this.elem,this.prop);return isNaN(a=parseFloat(b))?b&&"auto"!==b?b:0:a},custom:function(a,b,c){function d(a){return e.step(a)}var e=this,g=h.fx,k;this.startTime=nb||ma();this.start=a;this.end=b;this.unit=c||this.unit||(h.cssNumber[this.prop]?"":"px");this.now=this.start;this.pos=this.state=0;d.elem=this.elem;d()&&(h.timers.push(d)&&!wa)&&(Cb?(wa=!0,k=function(){wa&&(Cb(k),g.tick())},
Cb(k)):wa=setInterval(g.tick,g.interval))},show:function(){this.options.orig[this.prop]=h.style(this.elem,this.prop);this.options.show=!0;this.custom("width"===this.prop||"height"===this.prop?1:0,this.cur());h(this.elem).show()},hide:function(){this.options.orig[this.prop]=h.style(this.elem,this.prop);this.options.hide=!0;this.custom(this.cur(),0)},step:function(a){var b=nb||ma(),c=!0,d=this.elem,e=this.options,g;if(a||b>=e.duration+this.startTime){this.now=this.end;this.pos=this.state=1;this.update();
e.animatedProperties[this.prop]=!0;for(g in e.animatedProperties)!0!==e.animatedProperties[g]&&(c=!1);if(c){null==e.overflow||h.support.shrinkWrapBlocks||h.each(["","X","Y"],function(a,b){d.style["overflow"+b]=e.overflow[a]});e.hide&&h(d).hide();if(e.hide||e.show)for(var k in e.animatedProperties)h.style(d,k,e.orig[k]);e.complete.call(d)}return!1}Infinity==e.duration?this.now=b:(a=b-this.startTime,this.state=a/e.duration,this.pos=h.easing[e.animatedProperties[this.prop]](this.state,a,0,1,e.duration),
this.now=this.start+(this.end-this.start)*this.pos);this.update();return!0}};h.extend(h.fx,{tick:function(){for(var a=h.timers,b=0;b<a.length;++b)a[b]()||a.splice(b--,1);a.length||h.fx.stop()},interval:13,stop:function(){clearInterval(wa);wa=null},speeds:{slow:600,fast:200,_default:400},step:{opacity:function(a){h.style(a.elem,"opacity",a.now)},_default:function(a){a.elem.style&&null!=a.elem.style[a.prop]?a.elem.style[a.prop]=("width"===a.prop||"height"===a.prop?Math.max(0,a.now):a.now)+a.unit:a.elem[a.prop]=
a.now}}});h.expr&&h.expr.filters&&(h.expr.filters.animated=function(a){return h.grep(h.timers,function(b){return a===b.elem}).length});var lc=/^t(?:able|d|h)$/i,ub=/^(?:body|html)$/i;h.fn.offset="getBoundingClientRect"in x.documentElement?function(a){var b=this[0],c;if(a)return this.each(function(b){h.offset.setOffset(this,a,b)});if(!b||!b.ownerDocument)return null;if(b===b.ownerDocument.body)return h.offset.bodyOffset(b);try{c=b.getBoundingClientRect()}catch(d){}var e=b.ownerDocument,g=e.documentElement;
if(!c||!h.contains(g,b))return c?{top:c.top,left:c.left}:{top:0,left:0};b=e.body;e=na(e);return{top:c.top+(e.pageYOffset||h.support.boxModel&&g.scrollTop||b.scrollTop)-(g.clientTop||b.clientTop||0),left:c.left+(e.pageXOffset||h.support.boxModel&&g.scrollLeft||b.scrollLeft)-(g.clientLeft||b.clientLeft||0)}}:function(a){var b=this[0];if(a)return this.each(function(b){h.offset.setOffset(this,a,b)});if(!b||!b.ownerDocument)return null;if(b===b.ownerDocument.body)return h.offset.bodyOffset(b);h.offset.initialize();
var c,d=b.offsetParent,e=b.ownerDocument,g=e.documentElement,k=e.body;c=(e=e.defaultView)?e.getComputedStyle(b,null):b.currentStyle;for(var f=b.offsetTop,l=b.offsetLeft;(b=b.parentNode)&&(b!==k&&b!==g)&&(!h.offset.supportsFixedPosition||"fixed"!==c.position);)c=e?e.getComputedStyle(b,null):b.currentStyle,f-=b.scrollTop,l-=b.scrollLeft,b===d&&(f+=b.offsetTop,l+=b.offsetLeft,!h.offset.doesNotAddBorder||h.offset.doesAddBorderForTableAndCells&&lc.test(b.nodeName)||(f+=parseFloat(c.borderTopWidth)||0,
l+=parseFloat(c.borderLeftWidth)||0),d=b.offsetParent),h.offset.subtractsBorderForOverflowNotVisible&&"visible"!==c.overflow&&(f+=parseFloat(c.borderTopWidth)||0,l+=parseFloat(c.borderLeftWidth)||0);if("relative"===c.position||"static"===c.position)f+=k.offsetTop,l+=k.offsetLeft;h.offset.supportsFixedPosition&&"fixed"===c.position&&(f+=Math.max(g.scrollTop,k.scrollTop),l+=Math.max(g.scrollLeft,k.scrollLeft));return{top:f,left:l}};h.offset={initialize:function(){var a=x.body,b=x.createElement("div"),
c,d,e,g=parseFloat(h.css(a,"marginTop"))||0;h.extend(b.style,{position:"absolute",top:0,left:0,margin:0,border:0,width:"1px",height:"1px",visibility:"hidden"});b.innerHTML="<div style='position:absolute;top:0;left:0;margin:0;border:5px solid #000;padding:0;width:1px;height:1px;'><div></div></div><table style='position:absolute;top:0;left:0;margin:0;border:5px solid #000;padding:0;width:1px;height:1px;' cellpadding='0' cellspacing='0'><tr><td></td></tr></table>";a.insertBefore(b,a.firstChild);c=b.firstChild;
d=c.firstChild;e=c.nextSibling.firstChild.firstChild;this.doesNotAddBorder=5!==d.offsetTop;this.doesAddBorderForTableAndCells=5===e.offsetTop;d.style.position="fixed";d.style.top="20px";this.supportsFixedPosition=20===d.offsetTop||15===d.offsetTop;d.style.position=d.style.top="";c.style.overflow="hidden";c.style.position="relative";this.subtractsBorderForOverflowNotVisible=-5===d.offsetTop;this.doesNotIncludeMarginInBodyOffset=a.offsetTop!==g;a.removeChild(b);h.offset.initialize=h.noop},bodyOffset:function(a){var b=
a.offsetTop,c=a.offsetLeft;h.offset.initialize();h.offset.doesNotIncludeMarginInBodyOffset&&(b+=parseFloat(h.css(a,"marginTop"))||0,c+=parseFloat(h.css(a,"marginLeft"))||0);return{top:b,left:c}},setOffset:function(a,b,c){var d=h.css(a,"position");"static"===d&&(a.style.position="relative");var e=h(a),g=e.offset(),k=h.css(a,"top"),f=h.css(a,"left"),l={},q={};("absolute"===d||"fixed"===d)&&-1<h.inArray("auto",[k,f])?(q=e.position(),d=q.top,f=q.left):(d=parseFloat(k)||0,f=parseFloat(f)||0);h.isFunction(b)&&
(b=b.call(a,c,g));null!=b.top&&(l.top=b.top-g.top+d);null!=b.left&&(l.left=b.left-g.left+f);"using"in b?b.using.call(a,l):e.css(l)}};h.fn.extend({position:function(){if(!this[0])return null;var a=this[0],b=this.offsetParent(),c=this.offset(),d=ub.test(b[0].nodeName)?{top:0,left:0}:b.offset();c.top-=parseFloat(h.css(a,"marginTop"))||0;c.left-=parseFloat(h.css(a,"marginLeft"))||0;d.top+=parseFloat(h.css(b[0],"borderTopWidth"))||0;d.left+=parseFloat(h.css(b[0],"borderLeftWidth"))||0;return{top:c.top-
d.top,left:c.left-d.left}},offsetParent:function(){return this.map(function(){for(var a=this.offsetParent||x.body;a&&!ub.test(a.nodeName)&&"static"===h.css(a,"position");)a=a.offsetParent;return a})}});h.each(["Left","Top"],function(a,c){var d="scroll"+c;h.fn[d]=function(c){var e,g;return c===b?(e=this[0],e?(g=na(e))?g[a?"pageYOffset":"pageXOffset"]||h.support.boxModel&&g.document.documentElement[d]||g.document.body[d]:e[d]:null):this.each(function(){(g=na(this))?g.scrollTo(a?h(g).scrollLeft():c,
a?c:h(g).scrollTop()):this[d]=c})}});h.each(["Height","Width"],function(a,c){var d=c.toLowerCase();h.fn["inner"+c]=function(){var a=this[0];return a&&a.style?parseFloat(h.css(a,d,"padding")):null};h.fn["outer"+c]=function(a){var b=this[0];return b&&b.style?parseFloat(h.css(b,d,a?"margin":"border")):null};h.fn[d]=function(a){var e=this[0];if(!e)return null==a?null:this;if(h.isFunction(a))return this.each(function(b){var c=h(this);c[d](a.call(this,b,c[d]()))});if(h.isWindow(e)){var g=e.document.documentElement["client"+
c];return"CSS1Compat"===e.document.compatMode&&g||e.document.body["client"+c]||g}return 9===e.nodeType?Math.max(e.documentElement["client"+c],e.body["scroll"+c],e.documentElement["scroll"+c],e.body["offset"+c],e.documentElement["offset"+c]):a===b?(e=h.css(e,d),g=parseFloat(e),h.isNaN(g)?e:g):this.css(d,"string"===typeof a?a:a+"px")}});a.jQuery=a.$=h;a.$.rebindWindowContext=function(b){a=b;x=b.document;rootjQuery=$(x);return function(a,b){return new h.fn.init(a,b,rootjQuery)}}})(window);jQuery.fn.center=
function(){this.css("position","absolute");this.css("top",Math.max(0,($(window).height()-this.outerHeight())/2+$(window).scrollTop())+"px");this.css("left",Math.max(0,($(window).width()-this.outerWidth())/2+$(window).scrollLeft())+"px");return this};(function(a){var b={vertical:{x:!1,y:!0},horizontal:{x:!0,y:!1},both:{x:!0,y:!0},x:{x:!0,y:!1},y:{x:!1,y:!0}},c={duration:"fast",direction:"both"},d=/^(?:html)$/i,e=function(b){var c=a(window),e=d.test(b[0].nodeName),g;if(e)g={top:0,left:0,bottom:0,right:0};
else{var f=b[0],r;r=document.defaultView&&document.defaultView.getComputedStyle?document.defaultView.getComputedStyle(f,null):f.currentStyle;var s=document.defaultView&&document.defaultView.getComputedStyle?!0:!1;g=parseFloat(s?r.borderTopWidth:a.css(f,"borderTopWidth"))||0;var t=parseFloat(s?r.borderLeftWidth:a.css(f,"borderLeftWidth"))||0,w=parseFloat(s?r.borderBottomWidth:a.css(f,"borderBottomWidth"))||0,f=parseFloat(s?r.borderRightWidth:a.css(f,"borderRightWidth"))||0;g={top:g,left:t,bottom:w,
right:f,vertical:g+w,horizontal:t+f}}c={top:(e?c:b).scrollTop(),left:(e?c:b).scrollLeft()};t={right:e?0:b.innerWidth()-b[0].clientWidth,bottom:e?0:b.innerHeight()-b[0].clientHeight};w=b[0].getBoundingClientRect();return{border:g,scroll:c,scrollbar:t,rect:{top:e?0:w.top,left:e?0:w.left,bottom:e?b[0].clientHeight:w.bottom,right:e?b[0].clientWidth:w.right}}};a.fn.extend({scrollintoview:function(g){g=a.extend({},c,g);g.direction=b["string"===typeof g.direction&&g.direction.toLowerCase()]||b.both;var f=
"";!0===g.direction.x&&(f="horizontal");!0===g.direction.y&&(f=f?"both":"vertical");var m=this.eq(0),n=m.closest(":scrollable("+f+")");if(0<n.length){var n=n.eq(0),p=e(m),f=e(n),m=p.rect.top-(f.rect.top+f.border.top),r=f.rect.bottom-f.border.bottom-f.scrollbar.bottom-p.rect.bottom,s=p.rect.left-(f.rect.left+f.border.left),p=f.rect.right-f.border.right-f.scrollbar.right-p.rect.right,t={};!0===g.direction.y&&(0>m?t.scrollTop=f.scroll.top+m:0<m&&0>r&&(t.scrollTop=f.scroll.top+Math.min(m,-r)));!0===g.direction.x&&
(0>s?t.scrollLeft=f.scroll.left+s:0<s&&0>p&&(t.scrollLeft=f.scroll.left+Math.min(s,-p)));a.isEmptyObject(t)?a.isFunction(g.complete)&&g.complete.call(n[0]):(d.test(n[0].nodeName)&&(n=a("html,body")),n.animate(t,g.duration).eq(0).queue(function(b){a.isFunction(g.complete)&&g.complete.call(n[0]);b()}))}return this}});var g={auto:!0,scroll:!0,visible:!1,hidden:!1};a.extend(a.expr[":"],{scrollable:function(a,c,e,f){c=b["string"===typeof e[3]&&e[3].toLowerCase()]||b.both;e=document.defaultView&&document.defaultView.getComputedStyle?
document.defaultView.getComputedStyle(a,null):a.currentStyle;var p=g[e.overflowX.toLowerCase()]||!1,r=g[e.overflowY.toLowerCase()]||!1,s=d.test(a.nodeName);if(!p&&!r&&!s)return!1;a={height:{scroll:a.scrollHeight,client:a.clientHeight},width:{scroll:a.scrollWidth,client:a.clientWidth},scrollableX:function(){return(p||s)&&this.width.scroll>this.width.client},scrollableY:function(){return(r||s)&&this.height.scroll>this.height.client}};return c.y&&a.scrollableY()||c.x&&a.scrollableX()}})})(jQuery);"undefined"==
typeof JooseX||JooseX.SimpleRequest||Class("JooseX.SimpleRequest",{have:{req:null},methods:{initialize:function(){this.req=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP")},getText:function(a,b,c,d){var e=this.req,g,k;"string"!=typeof a?(g=a.headers,k=a.url,b=b||a.async,c=c||a.callback,d=d||a.scope):k=a;e.open("GET",k,b||!1);g&&Joose.O.eachOwn(g,function(a,b){e.setRequestHeader(b,a)});try{e.onreadystatechange=function(a){b&&4==e.readyState&&(200==e.status||0==e.status&&
0<e.responseText.length?c.call(d||this,!0,e.responseText):c.call(d||this,!1,"File not found: "+k))},e.send(null)}catch(f){throw"File not found: "+k;}if(!b){if(200==e.status||0==e.status&&0<e.responseText.length)return e.responseText;throw"File not found: "+k;}return null}}});Role("Siesta.Test.Action.Role.HasTarget",{has:{target:{required:!1},normalizedTarget:null,cachedTarget:null,passTargetToNext:!0,options:null,offset:null},after:{initialize:function(){if(this.passTargetToNext){var a=this,b=this.next;
this.next=function(){b.call(this,a.normalizedTarget)}}}},methods:{BUILD:function(a){a.el&&!a.target&&(a.target=a.el);return a},getTarget:function(){if(this.cachedTarget)return this.cachedTarget;var a=this.test,b=this.target||a.currentPosition;"Function"===a.typeOf(b)&&(b=b.call(a,this));this.normalizedTarget=a.normalizeActionTarget(b,!0);return this.cachedTarget=b}}});Class("Siesta.Test.Action.Swipe",{isa:Siesta.Test.Action,does:Siesta.Test.Action.Role.HasTarget,has:{requiredTestMethod:"swipe",direction:"left"},
methods:{process:function(){this.test.swipe(this.getTarget(),this.direction,this.next)}}});Siesta.Test.ActionRegistry().registerAction("swipe",Siesta.Test.Action.Swipe);Class("Siesta.Test.Action.Pinch",{isa:Siesta.Test.Action,does:Siesta.Test.Action.Role.HasTarget,has:{requiredTestMethod:"pinch",scale:2,target2:null,offset2:null,cachedTarget2:null},methods:{process:function(){this.test.pinch(this.getTarget(),this.getTarget2(),this.scale,this.next,null,this.options,this.offset,this.offset2)},getTarget2:function(){if(this.cachedTarget2)return this.cachedTarget2;
var a=this.test,b=this.target2;"Function"===a.typeOf(b)&&(b=b.call(a,this));return this.cachedTarget2=b}}});Siesta.Test.ActionRegistry().registerAction("pinch",Siesta.Test.Action.Pinch);Class("Siesta.Test.Action.LongPress",{isa:Siesta.Test.Action,does:Siesta.Test.Action.Role.HasTarget,has:{requiredTestMethod:"longPress"},methods:{process:function(){this.test.longpress(this.getTarget(),this.next,null,this.options,this.offset)}}});Siesta.Test.ActionRegistry().registerAction("longpress",Siesta.Test.Action.LongPress);
Class("Siesta.Test.Action.Tap",{isa:Siesta.Test.Action,does:Siesta.Test.Action.Role.HasTarget,has:{requiredTestMethod:"tap"},methods:{process:function(){this.test.tap(this.getTarget(),this.next,null,this.options,this.offset)}}});Siesta.Test.ActionRegistry().registerAction("tap",Siesta.Test.Action.Tap);Class("Siesta.Test.Action.DoubleTap",{isa:Siesta.Test.Action,does:Siesta.Test.Action.Role.HasTarget,has:{requiredTestMethod:"doubleTap"},methods:{process:function(){this.test.doubleTap(this.getTarget(),
this.next,null,this.options,this.offset)}}});Siesta.Test.ActionRegistry().registerAction("doubletap",Siesta.Test.Action.DoubleTap);Class("Siesta.Test.Action.TouchDrag",{isa:Siesta.Test.Action,does:Siesta.Test.Action.Role.HasTarget,has:{requiredTestMethod:"touchDragTo",to:null,fromOffset:null,toOffset:null,by:null,dragOnly:!1,byOrToMissingText:'Either "to" or "by" configuration option is required for "drag" step',byAndToDefinedText:'Exactly one of "to" or "by" configuration options is required for "drag" step, not both'},
override:{BUILD:function(a){a.source&&!a.target&&(a.target=a.source);return this.SUPER(a)}},methods:{initialize:function(){this.SUPER();if(!this.to&&!this.by)throw this.byOrToMissingText;if(this.to&&this.by)throw this.byAndToDefinedText;},getTo:function(){return"Function"==this.test.typeOf(this.to)?this.to.call(this.test,this):this.to},getBy:function(){return"Function"==this.test.typeOf(this.by)?this.by.call(this.test,this):this.by},process:function(){var a=this.next,b=this.test,c=this.getTarget(),
d=b.normalizeActionTarget(c,!0);this.to?b.touchDragTo(c,this.getTo(),function(){a(d||b.normalizeActionTarget(c))},null,this.options,this.dragOnly,this.fromOffset||this.offset,this.toOffset):b.touchDragBy(c,this.getBy(),function(){a(d||b.normalizeActionTarget(c))},null,this.options,this.dragOnly,this.fromOffset||this.offset)}}});Siesta.Test.ActionRegistry().registerAction("touchdrag",Siesta.Test.Action.TouchDrag);Class("Siesta.Test.Action.MouseDown",{isa:Siesta.Test.Action,does:Siesta.Test.Action.Role.HasTarget,
has:{requiredTestMethod:"mouseDown"},methods:{process:function(){this.test.mouseDown(this.getTarget(),this.options,this.offset);setTimeout(this.next,100)}}});Siesta.Test.ActionRegistry().registerAction("mouseDown",Siesta.Test.Action.MouseDown);Siesta.Test.ActionRegistry().registerAction("fingerDown",Siesta.Test.Action.MouseDown);Class("Siesta.Test.Action.MouseUp",{isa:Siesta.Test.Action,does:Siesta.Test.Action.Role.HasTarget,has:{requiredTestMethod:"mouseUp"},methods:{process:function(){this.test.mouseUp(this.getTarget(),
this.options,this.offset);setTimeout(this.next,100)}}});Siesta.Test.ActionRegistry().registerAction("mouseUp",Siesta.Test.Action.MouseUp);Siesta.Test.ActionRegistry().registerAction("fingerUp",Siesta.Test.Action.MouseUp);Class("Siesta.Test.Action.Click",{isa:Siesta.Test.Action,does:Siesta.Test.Action.Role.HasTarget,has:{requiredTestMethod:"click"},methods:{process:function(){this.test.click(this.getTarget(),this.next,null,this.options,this.offset)}}});Siesta.Test.ActionRegistry().registerAction("click",
Siesta.Test.Action.Click);Class("Siesta.Test.Action.DoubleClick",{isa:Siesta.Test.Action,does:Siesta.Test.Action.Role.HasTarget,has:{requiredTestMethod:"doubleClick"},methods:{process:function(){this.test.doubleClick(this.getTarget(),this.next,null,this.options,this.offset)}}});Siesta.Test.ActionRegistry().registerAction("doubleclick",Siesta.Test.Action.DoubleClick);Siesta.Test.ActionRegistry().registerAction("dblclick",Siesta.Test.Action.DoubleClick);Class("Siesta.Test.Action.RightClick",{isa:Siesta.Test.Action,
does:Siesta.Test.Action.Role.HasTarget,has:{requiredTestMethod:"rightClick"},methods:{process:function(){this.test.rightClick(this.getTarget(),this.next,null,this.options,this.offset)}}});Siesta.Test.ActionRegistry().registerAction("rightclick",Siesta.Test.Action.RightClick);Siesta.Test.ActionRegistry().registerAction("contextmenu",Siesta.Test.Action.RightClick);Class("Siesta.Test.Action.Type",{isa:Siesta.Test.Action,does:Siesta.Test.Action.Role.HasTarget,has:{requiredTestMethod:"type",text:"",options:null},
methods:{process:function(){this.target=this.target||this.test.activeElement();this.test.type(this.getTarget(),this.text,this.next,null,this.options)}}});Siesta.Test.ActionRegistry().registerAction("type",Siesta.Test.Action.Type);Class("Siesta.Test.Action.Drag",{isa:Siesta.Test.Action,does:Siesta.Test.Action.Role.HasTarget,has:{requiredTestMethod:"dragTo",to:null,fromOffset:null,toOffset:null,by:null,dragOnly:!1,byOrToMissingText:'Either "to" or "by" configuration option is required for "drag" step',
byAndToDefinedText:'Exactly one of "to" or "by" configuration options is required for "drag" step, not both'},override:{BUILD:function(a){a.source&&!a.target&&(a.target=a.source);return this.SUPER(a)}},methods:{initialize:function(){this.SUPER();if(!this.to&&!this.by)throw this.byOrToMissingText;if(this.to&&this.by)throw this.byAndToDefinedText;},getTo:function(){return"Function"==this.test.typeOf(this.to)?this.to.call(this.test,this):this.to},getBy:function(){return"Function"==this.test.typeOf(this.by)?
this.by.call(this.test,this):this.by},process:function(){var a=this.next,b=this.test,c=this.getTarget(),d=b.normalizeActionTarget(c,!0);this.to?b.dragTo(c,this.getTo(),function(){a(d||b.normalizeActionTarget(c))},null,this.options,this.dragOnly,this.fromOffset||this.offset,this.toOffset):b.dragBy(c,this.getBy(),function(){a(d||b.normalizeActionTarget(c))},null,this.options,this.dragOnly,this.fromOffset||this.offset)}}});Siesta.Test.ActionRegistry().registerAction("drag",Siesta.Test.Action.Drag);Class("Siesta.Test.Action.MoveCursor",
{isa:Siesta.Test.Action,has:{requiredTestMethod:"moveMouseTo",to:null,by:null,offset:null},methods:{getTo:function(){return"Function"==this.test.typeOf(this.to)?this.to.call(this.test,this):this.to},getBy:function(){return"Function"==this.test.typeOf(this.by)?this.by.call(this.test,this):this.by},process:function(){var a=this.test,b=this.next;if(this.to){var c=this.getTo(),d=a.normalizeActionTarget(c,!1);a.moveMouseTo(c,function(){b(d)},null,this.offset)}else{var c=this.getBy(),e=a.currentPosition,
d=a.normalizeActionTarget([e[0]+c[0],e[1]+c[1]]);a.moveMouseBy(c,function(){b(d)})}}}});Siesta.Test.ActionRegistry().registerAction("moveCursor",Siesta.Test.Action.MoveCursor);Siesta.Test.ActionRegistry().registerAction("moveMouse",Siesta.Test.Action.MoveCursor);Siesta.Test.ActionRegistry().registerAction("moveFinger",Siesta.Test.Action.MoveCursor);Class("Siesta.Test.Action.MoveCursorTo",{isa:Siesta.Test.Action,does:Siesta.Test.Action.Role.HasTarget,has:{requiredTestMethod:"moveMouseTo",target:{required:!0}},
methods:{process:function(){this.test.moveMouseTo(this.getTarget(),this.next,null,this.offset)}}});Siesta.Test.ActionRegistry().registerAction("moveCursorTo",Siesta.Test.Action.MoveCursorTo);Siesta.Test.ActionRegistry().registerAction("moveMouseTo",Siesta.Test.Action.MoveCursorTo);Siesta.Test.ActionRegistry().registerAction("moveFingerTo",Siesta.Test.Action.MoveCursorTo);Role("Siesta.Test.Simulate.Mouse",{requires:["simulateEvent","getSimulateEventsWith","normalizeElement","isTextInput"],has:{dragDelay:25,
moveCursorBetweenPoints:!0,dragPrecision:$.browser.msie?10:5,enableUnreachableClickWarning:!0,autoScrollElementsIntoView:!0,overEls:Joose.I.Array},after:{cleanup:function(){this.overEls=null}},methods:{createMouseEvent:function(a,b,c){var d,e=this.global;b=$.extend({bubbles:"mouseenter"!==a&&"mouseleave"!==a,cancelable:"mousemove"!=a,view:e,detail:0,screenX:0,screenY:0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0},b);if(!("clientX"in b&&"clientY"in b)){var g=this.findCenter(c);
b=$.extend({clientX:g[0],clientY:g[1]},b)}"screenX"in window&&(b=$.extend(b,{screenX:e.screenX+b.clientX,screenY:e.screenY+b.clientY}));c=c.ownerDocument;c.createEvent&&"dispatchEvent"==this.getSimulateEventsWith()?(g=a.match(/^(ms)?pointer/i),d=c.createEvent(g?(g[1]?"MS":"")+"PointerEvent":"MouseEvents"),d[g?"initPointerEvent":"initMouseEvent"](a,b.bubbles,b.cancelable,b.view,b.detail,b.screenX,b.screenY,b.clientX,b.clientY,b.ctrlKey,b.altKey,b.shiftKey,b.metaKey,b.button,b.relatedTarget||c.body.parentNode,
null,null,null,null,null,null,null,null,null,4,null,null)):c.createEventObject&&(d=c.createEventObject(),$.extend(d,b),d.button={0:1,1:4,2:2}[d.button]||d.button);"mouseover"!==a&&"mouseout"!==a&&(g=c.defaultView||c.parentWindow,a=b.clientX,c=b.clientY,g!==e&&(e=this.$(g.frameElement).offset(),a+=e.left,c+=e.top),b.doNotUpdateCurrentPosition||(this.currentPosition[0]=a,this.currentPosition[1]=c));return d},moveMouseTo:function(a,b,c,d){if(!a)throw"Trying to call moveMouseTo without a target";var e=
this.getNormalizedTopElementInfo(a,!0,"moveMouseTo",d);e?this.moveMouse(this.currentPosition,e.globalXY,b,c):this.waitForTarget(a,function(){this.moveMouseTo(a,b,c,d)},this,null,d)},moveCursorTo:function(a,b,c,d){this.moveMouseTo.apply(this,arguments)},moveMouseBy:function(a,b,c){this.moveCursorBy.apply(this,arguments)},moveCursorBy:function(a,b,c){if(!a)throw"Trying to call moveCursorBy without relative distances";this.moveMouse(this.currentPosition,[this.currentPosition[0]+a[0],this.currentPosition[1]+
a[1]],b,c)},moveMouse:function(a,b,c,d,e,g,k){var f=this;this.movePointerTemplate({xy:a,xy2:b,callback:c,scope:d,options:k||{},overEls:this.overEls,interval:!1!==g?this.dragDelay:0,callbackDelay:!1!==g?50:0,precision:e||f.dragPrecision,onVoidOverEls:function(){f.overEls=[]},onPointerEnter:function(a,b,c){f.simulateEvent(a,"mouseenter",b,c)},onPointerLeave:function(a,b,c){f.simulateEvent(a,"mouseleave",b,c)},onPointerOver:function(a,b,c){f.simulateEvent(a,"mouseover",b,c)},onPointerOut:function(a,
b,c){f.simulateEvent(a,"mouseout",b,c)},onPointerMove:function(a,b,c){f.simulateEvent(a,"mousemove",b,c)}})},movePointerTemplate:function(a){var b=this.global.document,c=this,d=a.overEls,e=d[d.length-1];try{e&&e.tagName}catch(g){e=null,a.onVoidOverEls()}for(var k=a.precision,f=a.options||{},m=this.getPathBetweenPoints(a.xy,a.xy2),n=Siesta.Harness.Browser.FeatureSupport().supports,p=new Siesta.Util.Queue({deferer:this.originalSetTimeout,deferClearer:this.originalClearTimeout,interval:a.interval,callbackDelay:a.callbackDelay,
observeTest:this,processor:function(g,k){for(var p=g.targetIndex,r=g.sourceIndex;r<=p;r++){var s=m[r],t=c.elementFromPoint(s[0],s[1]);if(t){if(t.ownerDocument!==b){var P=c.$((t.ownerDocument.defaultView||t.ownerDocument.parentWindow).frameElement).offset();s[0]-=P.left;s[1]-=P.top}if(t!==e){for(var T=d.length-1;0<=T;T--)if(P=d[T],P!==t&&0===c.$(P).has(t).length){if(n.mouseEnterLeave)a.onPointerLeave(P,$.extend({clientX:s[0],clientY:s[1],relatedTarget:t},f));d.splice(T,1)}if(e)a.onPointerOut(e,$.extend({clientX:s[0],
clientY:s[1],relatedTarget:t},f));if(n.mouseEnterLeave&&-1==jQuery.inArray(t,d)){for(var P=[],T=t.ownerDocument.body.parentNode,ma=t;ma&&ma!=T;)P.unshift(ma),ma=ma.parentNode;for(T=0;T<P.length;T++)-1==jQuery.inArray(P[T],d)&&(a.onPointerEnter(P[T],$.extend({clientX:s[0],clientY:s[1],relatedTarget:e},f)),d.push(P[T]))}a.onPointerOver(t,$.extend({clientX:s[0],clientY:s[1],relatedTarget:e},f));e=t}a.onPointerMove(t,$.extend({clientX:s[0],clientY:s[1]},f),r<p)}}}}),r=0,s=m.length;r<s;r+=k)p.addStep({sourceIndex:r,
targetIndex:Math.min(r+k-1,m.length-1)});var t=this.beginAsync();p.run(function(){c.endAsync(t);c.processCallbackFromTest(a.callback,null,a.scope||c)})},focusOnClick:function(a){if(this.isTextInput(a))this.focus(a);else{for(var b=a.ownerDocument,c=b.body;a&&a!=c&&a!=b;){if("on"==a.getAttribute("unselectable"))return;if(null!=a.getAttribute("tabIndex")){this.focus(a);return}a=a.parentNode}this.focus(c)}},genericMouseClick:function(a,b,c,d,e,g){jQuery.isFunction(a)&&(c=b,b=a,a=null);a=a||this.currentPosition;
var k="Array"==this.typeOf(a),f=this.normalizeElement(a,!0);if(f&&this.isElementVisible(f))if(d=d||{},!k&&this.autoScrollElementsIntoView&&this.scrollTargetIntoView(f,g),k=this.getNormalizedTopElementInfo(a,!0,e,g))if(k.originalEl=a,k.method=e,k.offset=g,d.clientX=null!=d.clientX?d.clientX:k.localXY[0],d.clientY=null!=d.clientY?d.clientY:k.localXY[1],this.moveCursorBetweenPoints&&b)this.syncCursor(k.globalXY,this[e],[k,b,c,d]);else this[e](k,b,c,d);else b&&b.call(c||this);else this.waitForTarget(a,
function(){this.genericMouseClick(a,b,c,d,e,g)},this,null,g)},click:function(a,b,c,d,e){this.genericMouseClick(a,b,c,d,"simulateMouseClick",e)},rightClick:function(a,b,c,d,e){this.genericMouseClick(a,b,c,d,"simulateRightClick",e)},doubleClick:function(a,b,c,d,e){this.genericMouseClick(a,b,c,d,"simulateDoubleClick",e)},mouseDown:function(a,b,c){var d=this.getNormalizedTopElementInfo(a,!1,"mouseDown",c);d?(b=b||{},b.clientX=null!=b.clientX?b.clientX:d.localXY[0],b.clientY=null!=b.clientY?b.clientY:
d.localXY[1],a=a||d.el,this.simulateEvent(a,"mousedown",b)):this.waitForTarget(a,function(){this.mouseDown(a,b,c)},this,null,c)},mouseUp:function(a,b,c){if(c=this.getNormalizedTopElementInfo(a,!1,"mouseUp",c))b=b||{},b.clientX=null!=b.clientX?b.clientX:c.localXY[0],b.clientY=null!=b.clientY?b.clientY:c.localXY[1],a=a||c.el,this.simulateEvent(a,"mouseup",b)},mouseOver:function(a,b){var c=this.getNormalizedTopElementInfo(a,!0);c&&(b=b||{},b.clientX=null!=b.clientX?b.clientX:c.localXY[0],b.clientY=null!=
b.clientY?b.clientY:c.localXY[1],this.simulateEvent(a,"mouseover",b))},mouseOut:function(a,b){var c=this.getNormalizedTopElementInfo(a,!0);c&&(b=b||{},b.clientX=null!=b.clientX?b.clientX:c.localXY[0],b.clientY=null!=b.clientY?b.clientY:c.localXY[1],this.simulateEvent(a,"mouseout",b))},processMouseClickSteps:function(a,b,c,d,e){a.originalEl&&this.enableUnreachableClickWarning&&this.getNormalizedTopElementInfo(a.originalEl,!1,a.method,a.offset);var g=this,k=a.globalXY[0],f=a.globalXY[1],m=g.elementFromPoint(k,
f,!1,a.el),n=!1,p=new Siesta.Util.Queue({deferer:this.originalSetTimeout,deferClearer:this.originalClearTimeout,interval:b?10:0,callbackDelay:g.afterActionDelay,observeTest:this,processor:function(a){var b=g.elementFromPoint(k,f,!1,m);a.reCaptureTheTarget&&(m=b,n=!1);b==m||($.contains(b,m)||$.contains(m,b))||(n=!0);if(!n||!a.cancelIfTargetChanged){var c=g.simulateEvent(b,a.event,d,a.suppressLog);!a.focus||"mousedown"==a.event&&g.isEventPrevented(c)||g.focusOnClick(b);$.browser.msie&&(11>Number(/^(\d+)/.exec($.browser.version)[1])&&
"click"===e[e.length-1].event&&"a"===b.tagName.toLowerCase()&&b.getAttribute("href")&&"click"===a.event)&&(a=b.getAttribute("href").match(/#(.*)/))&&(g.global.location.hash=a[1])}}});Joose.A.each(e,function(a){p.addStep(a)});var r=g.beginAsync();p.run(function(){g.endAsync(r);g.processCallbackFromTest(b,null,c||g)})},simulateMouseClick:function(a,b,c,d){this.processMouseClickSteps(a,b,c,d,[{event:"mousedown",suppressLog:!0,focus:!0},{event:"mouseup",suppressLog:!0},{event:"click",suppressLog:!1,cancelIfTargetChanged:!0}])},
simulateRightClick:function(a,b,c,d){d=d||{};d.button=2;this.processMouseClickSteps(a,b,c,d,[{event:"mousedown",suppressLog:!1,focus:!0},{event:"mouseup",suppressLog:!0},{event:"contextmenu",suppressLog:!1}])},simulateDoubleClick:function(a,b,c,d){this.processMouseClickSteps(a,b,c,d,[{event:"mousedown",suppressLog:!1,focus:!0},{event:"mouseup",suppressLog:!0},{event:"click",suppressLog:!1,cancelIfTargetChanged:!0},{event:"mousedown",suppressLog:!1,reCaptureTheTarget:!0,focus:!0},{event:"mouseup",
suppressLog:!0},{event:"click",suppressLog:!0,cancelIfTargetChanged:!0},{event:"dblclick",suppressLog:!1,cancelIfTargetChanged:!0}])},syncCursor:function(a,b,c){var d=this,e=this.currentPosition;a[0]!==e[0]||a[1]!==e[1]?this.moveMouse(e,a,function(){b&&b.apply(d,c)}):b&&b.apply(this,c)},drag:function(a,b,c,d,e,g){if(!a)throw"No drag source defined";b?this.dragTo(a,b,d,e,g):this.dragBy(a,c,d,e,g)},dragTo:function(a,b,c,d,e,g,k,f){if(!b)throw"No drag target defined";a=a||this.currentPosition;e=e||{};
if("Array"!=this.typeOf(a)){var m=this.normalizeElement(a,!0,k);m&&this.scrollTargetIntoView(m,k)}var m=this.getNormalizedTopElementInfo(a,!0,"dragTo: Source",k),n=this.getNormalizedTopElementInfo(b,!1,"dragTo: Target",f);m?n?(n=[m.globalXY,n.globalXY,c,d,e,g],this.moveCursorBetweenPoints&&c?this.syncCursor(m.globalXY,this.simulateDrag,n):this.simulateDrag.apply(this,n)):this.processCallbackFromTest(c,null,d||this):this.waitForTarget(a,function(){this.dragTo(a,b,c,d,e,g,k,f)},this,null,k)},dragBy:function(a,
b,c,d,e,g,k){if(!b)throw"No drag delta defined";a=a||this.currentPosition;if("Array"!=this.typeOf(a)){var f=this.normalizeElement(a,!0,k);f&&this.scrollTargetIntoView(f,k)}if(f=this.getNormalizedTopElementInfo(a,!0,"dragBy: Source",k)){var f=f.globalXY,m=[f,[f[0]+b[0],f[1]+b[1]],c,d,e,g];this.moveCursorBetweenPoints&&c?this.syncCursor(f,this.simulateDrag,m):this.simulateDrag.apply(this,m)}else this.waitForTarget(a,function(){this.dragBy(a,b,c,d,e,g,k)},this,null,k)},simulateDrag:function(a,b,c,d,
e,g){var k=this;e=e||{};var f=k.elementFromPoint(a[0],a[1],!0);k.elementFromPoint(b[0],b[1],!0);var m=new Siesta.Util.Queue({deferer:this.originalSetTimeout,deferClearer:this.originalClearTimeout,interval:k.dragDelay,callbackDelay:k.afterActionDelay,observeTest:this});m.addStep({processor:function(){k.simulateEvent(f,"mouseover",$.extend({clientX:a[0],clientY:a[1]},e))}});m.addStep({processor:function(){f=k.elementFromPoint(a[0],a[1],!0,f);k.simulateEvent(f,"mouseover",$.extend({clientX:a[0],clientY:a[1]},
e))}});m.addStep({processor:function(){k.simulateEvent(f,"mousedown",$.extend({clientX:a[0],clientY:a[1]},e))}});m.addStep({isAsync:!0,processor:function(c){k.moveMouse(a,b,c.next,this,null,!0,e)}});var n;m.addStep({processor:function(){n=k.elementFromPoint(b[0],b[1],!0);k.simulateEvent(n,"mouseover",$.extend({clientX:b[0],clientY:b[1]},e))}});g||(m.addStep({processor:function(){k.simulateEvent(n,"mouseup",$.extend({clientX:b[0],clientY:b[1]},e))}}),m.addStep({processor:function(){n===f&&k.simulateEvent(n,
"click",$.extend({clientX:b[0],clientY:b[1]},e))}}));var p=this.beginAsync();m.run(function(){k.endAsync(p);k.processCallbackFromTest(c,null,d||k)})}}});Singleton("Siesta.Test.Simulate.KeyCodes",{methods:{isNav:function(a){var b=this.keys;return 33<=a&&40>=a||a==b.RETURN||a==b.TAB||a==b.ESCAPE},isSpecial:function(a){return a===this.keys.BACKSPACE||16<=a&&20>=a||44<=a&&46>=a},fromCharCode:function(a,b){var c=this.keys,d;for(d in c)if(c[d]===a&&(!b||1<d.length))return d}},has:{keys:{init:{"\b":8,BACKSPACE:8,
"\t":9,TAB:9,"\r":13,RETURN:13,ENTER:13,SHIFT:16,CTRL:17,ALT:18,"PAUSE-BREAK":19,CAPS:20,ESCAPE:27,"NUM-LOCK":144,"SCROLL-LOCK":145,PRINT:44,"PAGE-UP":33,"PAGE-DOWN":34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,INSERT:45,DELETE:46," ":32,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,NUM0:96,NUM1:97,NUM2:98,NUM3:99,NUM4:100,NUM5:101,NUM6:102,NUM7:103,NUM8:104,NUM9:105,
"*":106,"+":107,"-":109,".":110,"/":111,";":186,"=":187,",":188,"-":189,".":190,"/":191,"`":192,"[":219,"\\":220,"]":221,"'":222,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123}}}});Role("Siesta.Test.Simulate.Keyboard",{requires:["simulateEvent","getSimulateEventsWith","getElementAtCursor"],methods:{createKeyboardEvent:function(a,b,c){var d;b=$.extend({bubbles:!0,cancelable:!0,view:this.global,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:0,charCode:0},
b);c=c.ownerDocument;if(c.createEvent&&"dispatchEvent"==this.getSimulateEventsWith())try{d=c.createEvent("KeyEvents"),d.initKeyEvent(a,b.bubbles,b.cancelable,b.view,b.ctrlKey,b.altKey,b.shiftKey,b.metaKey,b.keyCode,b.charCode)}catch(e){d=c.createEvent("Events"),d.initEvent(a,b.bubbles,b.cancelable),$.extend(d,{view:b.view,ctrlKey:b.ctrlKey,altKey:b.altKey,shiftKey:b.shiftKey,metaKey:b.metaKey,keyCode:b.keyCode,charCode:b.charCode})}else c.createEventObject&&(d=c.createEventObject(),$.extend(d,b));
if($.browser.msie||$.browser.opera)d.keyCode=0<b.charCode?b.charCode:b.keyCode,d.charCode=void 0;return d},createTextEvent:function(a,b,c){a=c.ownerDocument;c=null;if(a.createEvent&&!$.browser.msie)try{if((c=a.createEvent("TextEvent"))&&c.initTextEvent)return c.initTextEvent("textInput",!0,!0,this.global,b.text,0),c}catch(d){}return null},findNextFocusable:function(a,b){var c=this.$(a),d=this.$(":input, a[href]",a.ownerDocument).not(":disabled").not(":hidden").not("a[href]:empty");if("INPUT"===a.tagName&&
"radio"===a.type&&""!==a.name)var e=a.name.replace(/(!"#$%&'\(\)\*\+,\.\/:;<=>\?@\[\]^`\{\|\}~)/g,"\\\\$1"),d=d.not("input[type=radio][name="+e+"]").add(c);e=d.filter("[tabindex]");e.sort(function(a,b){return a.tabIndex<b.tabIndex?-1:1});var e=$(e.toArray().concat(d.filter(":not([tabindex])").toArray())),c=($(e).index(c)+b)%e.length,g;0<c&&(g=e.eq(c));return g&&g[0]||null},emulateTab:function(a,b){var c=this.findNextFocusable(a,b||1);c?this.focus(c):a.blur();return c},type:function(a,b,c,d,e){a=this.normalizeElement(a||
this.activeElement());var g=this.getSelectedText(a);g&&(a.value=a.value.replace(g,""));var k=this;if(a.readOnly||a.disabled)k.processCallbackFromTest(c,null,d||k);else{b=(b+"").match(/(\[(?:\w|-)+\])|([\s\S])/g)||[];var f=new Siesta.Util.Queue({deferer:this.originalSetTimeout,deferClearer:this.originalClearTimeout,interval:this.actionDelay,callbackDelay:this.afterActionDelay,observeTest:this,processor:function(b,c){var d=k.activeElement(!0,a,a);k.keyPress(d,b.key,e)}});f.addStep({processor:function(){k.focus(a)}});
$.browser.msie&&f.addStep({processor:function(){k.focus(a)}});jQuery.each(b,function(a,b){f.addStep({key:1==b.length?b:b.substring(1,b.length-1)})});var m=this.beginAsync();f.run(function(){k.endAsync(m);k.processCallbackFromTest(c,null,d||k)})}},keyPress:function(a,b,c){a=this.normalizeElement(a);var d=Siesta.Test.Simulate.KeyCodes().keys,e=d[b.toUpperCase()]||0;c=c||{};c.readableKey=b;var g=this.isReadableKey(e),k=g?b.charCodeAt(0):0;b=this.isTextInput(a);var f=this.isEditableNode(a),m=b||f,n=this.simulateEvent(a,
"keydown",$.extend({charCode:0,keyCode:e},c),!0),n=this.isEventPrevented(n);a=this.activeElement(!0,a,a);var k=this.simulateEvent(a,"keypress",$.extend({charCode:k,keyCode:g?0:e},c),!1),p=this.isEventPrevented(k),k=Siesta.Harness.Browser.FeatureSupport().supports;n||(p||e!==d.TAB)||(a=this.emulateTab(a,c.shiftKey?-1:1)||a);!p&&(m&&e!=d.TAB)&&(m=this.harness.isPhantomJS,n="value"in a?"value":"innerHTML",g&&(m||(f&&($.browser.msie&&0===a.innerHTML.indexOf("&nbsp;"))&&(a.innerHTML=a.innerHTML.substring(6)),
f&&!$.browser.msie?(8203===a.innerHTML.charCodeAt(a.innerHTML.length-1)&&(a.innerHTML=a.innerHTML.substring(0,a.innerHTML.length-1)),a.ownerDocument.execCommand("insertText",!1,c.readableKey)):this.simulateEvent(a,"textInput",{text:c.readableKey},!0)),g=a[n].length,f=a.getAttribute("maxlength"),null!=f&&(f=Number(f)),!b&&!$.browser.msie||(k.canSimulateKeyCharacters&&!m||g!==a[n].length||g===f)||(a[n]+=c.readableKey)),e===d.BACKSPACE&&(!k.canSimulateBackspace&&0<a[n].length)&&(b||$.browser.msie?a[n]=
a[n].substring(0,a[n].length-1):a.ownerDocument.execCommand("delete")),"value"!==n||(e!==d.ENTER||k.enterSubmitsForm)||(b=this.$(a).closest("form"),b.length&&b.submit()));b=a.nodeName&&a.nodeName.toLowerCase();"a"!=b&&"button"!=b||(e!==d.ENTER||k.enterOnAnchorTriggersClick)||this.simulateEvent(a,"click",{doNotUpdateCurrentPosition:!0},!0);this.simulateEvent(a,"keyup",$.extend({charCode:0,keyCode:e},c),!0)},isTextInput:function(a){var b=a.nodeName&&a.nodeName.toLowerCase();a=a.type&&a.type.toLowerCase();
return"textarea"===b||"input"===b&&("password"===a||"number"===a||"search"===a||"text"===a||"email"===a)},isEditableNode:function(a){return"on"===a.ownerDocument.designMode.toLowerCase()||"true"===a.contentEditable.toLowerCase()},isReadableKey:function(a){var b=Siesta.Test.Simulate.KeyCodes();return!b.isNav(a)&&!b.isSpecial(a)}}});Role("Siesta.Test.Simulate.Event",{requires:["createTextEvent","createMouseEvent","createKeyboardEvent"],has:{actionDelay:100,afterActionDelay:100,simulateEventsWith:{is:"rw",
init:"dispatchEvent"}},methods:{processMouseEventName:function(a){return a},simulateEvent:function(a,b,c,d){c=c||{};"Array"==this.typeOf(a)&&("clientX"in c||(c.clientX=a[0]),"clientY"in c||(c.clientY=a[1]));a=this.normalizeElement(a);var e,g=this.processMouseEventName(b);g!=b&&(e=this.createEvent(g,c,a),e.synthetic=!0,this.dispatchEvent(a,g,e));if(c=this.createEvent(b,c,a))c.synthetic=!0,this.dispatchEvent(a,b,c),d||this.fireEvent("eventsimulated",this,a,b,c);return e||c},createEvent:function(a,b,
c){if((a=/^text(Input)$/.test(a)?this.createTextEvent(a,b,c):/^mouse(over|out|down|up|move|enter|leave)|contextmenu|(dbl)?click$/.test(a)||/^(ms)?pointer/i.test(a)?this.createMouseEvent(a,b,c):/^key(up|down|press)$/.test(a)?this.createKeyboardEvent(a,b,c):this.createHtmlEvent(a,b,c))&&$.browser.msie&&10<=Number($.browser.version)){var d=a.preventDefault;d&&(a.preventDefault=function(){this.$defaultPrevented=!0;return d.apply(this,arguments)})}return a},createHtmlEvent:function(a,b,c){b=c.ownerDocument;
if(b.createEvent&&"dispatchEvent"==this.getSimulateEventsWith())return b=b.createEvent("HTMLEvents"),b.initEvent(a,!1,!1),b;if(b.createEventObject)return b.createEventObject()},dispatchEvent:function(a,b,c){if(a.dispatchEvent&&"dispatchEvent"==this.getSimulateEventsWith())a.dispatchEvent(c);else if(a.fireEvent)try{a.fireEvent("on"+b,c)}catch(d){}else throw"Can't dispatch event: "+b;return c}}});Role("Siesta.Test.Simulate.Touch",{requires:["normalizeElement"],has:{touchEventNamesMap:{lazy:"this.buildTouchEventNamesMap"},
currentTouchId:1,activeTouches:Joose.I.Object},methods:{checkTouchEventsSupport:function(){var a=Siesta.Harness.Browser.FeatureSupport().supports;a.TouchEvents||(a.PointerEvents||a.MSPointerEvents)||this.warn("Touch events are not supported by browser. For Chrome, you can enable them, by launching it with: --args --touch-events")},tap:function(a,b,c,d,e){this.checkTouchEventsSupport();var g=this,k=this.getNormalizedTopElementInfo(a,!0,"tap",e);if(k){var f=new Siesta.Util.Queue({deferer:this.originalSetTimeout,
deferClearer:this.originalClearTimeout,interval:b?30:0,observeTest:this}),m;f.addStep({processor:function(){m=g.touchStart(null,null,d,k)}});f.addStep({processor:function(){g.touchEnd(m,d)}});var n=g.beginAsync();f.run(function(){g.endAsync(n);g.processCallbackFromTest(b,null,c||g)})}else this.waitForTarget(a,function(){this.tap(a,b,c,e)},this,null,e)},doubleTap:function(a,b,c,d,e){this.checkTouchEventsSupport();var g=this,k=this.getNormalizedTopElementInfo(a,!0,"doubleTap",e);if(k){var f=new Siesta.Util.Queue({deferer:this.originalSetTimeout,
deferClearer:this.originalClearTimeout,interval:b?30:0,observeTest:this}),m;f.addStep({processor:function(){m=g.touchStart(null,null,d,k)}});f.addStep({processor:function(){g.touchEnd(m,d)}});f.addStep({processor:function(){m=g.touchStart(null,null,d,k)}});f.addStep({processor:function(){g.touchEnd(m,d)}});var n=g.beginAsync();f.run(function(){g.endAsync(n);g.processCallbackFromTest(b,null,c||g)})}else this.waitForTarget(a,function(){this.doubleTap(a,b,c,e)},this,null,e)},getLongPressDelay:function(){return 1500},
longpress:function(){return this.longPress.apply(this,arguments)},longPress:function(a,b,c,d,e){this.checkTouchEventsSupport();var g=this,k=this.getNormalizedTopElementInfo(a,!0,"longPress",e);if(k){var f=new Siesta.Util.Queue({deferer:this.originalSetTimeout,deferClearer:this.originalClearTimeout,interval:b?30:0,observeTest:this}),m;f.addStep({processor:function(){m=g.touchStart(null,null,d,k)}});f.addDelayStep(this.getLongPressDelay());f.addStep({processor:function(){g.touchEnd(m,d)}});var n=g.beginAsync();
f.run(function(){g.endAsync(n);g.processCallbackFromTest(b,null,c||g)})}else this.waitForTarget(a,function(){this.longPress(a,b,c,e)},this,null,e)},pinch:function(a,b,c,d,e,g,k,f){this.checkTouchEventsSupport();var m=this;"Number"==this.typeOf(b)&&(f=k,k=g,g=e,e=d,d=c,c=b,b=a);null==b&&(b=a);a!=b||(k||f)||(k=["25%","50%"],f=["75%","50%"]);var n=this.getNormalizedTopElementInfo(a,!0,"pinch: target1",k),p=this.getNormalizedTopElementInfo(b,!0,"pinch: target2",f);if(n&&p){var r=new Siesta.Util.Queue({deferer:this.originalSetTimeout,
deferClearer:this.originalClearTimeout,interval:d?30:0,observeTest:this}),s,t,w=n.localXY[0]-p.localXY[0],y=n.localXY[1]-p.localXY[1],z=Math.sqrt(w*w+y*y);1>z&&(z=1);c=(z*c-z)/2;var w=Math.atan(y/w),C=Math.round(n.localXY[0]-c*Math.cos(w)),M=Math.round(n.localXY[1]-c*Math.sin(w)),H=Math.round(p.localXY[0]+c*Math.cos(w)),P=Math.round(p.localXY[1]+c*Math.sin(w)),T=Joose.O.extend({},g);r.addStep({processor:function(){s=m.touchStart(null,null,g,n);t=m.touchStart(null,null,T,p)}});r.addAsyncStep({processor:function(a){var b=
!1,c=!1;m.touchMove(s,C,M,function(){(b=!0)&&c&&a.next()},null,g);m.touchMove(t,H,P,function(){c=!0;b&&c&&a.next()},null,T)}});r.addStep({processor:function(){m.touchEnd(s,g);m.touchEnd(t,T)}});var ma=m.beginAsync();r.run(function(){m.endAsync(ma);m.processCallbackFromTest(d,null,e||m)})}else r=Siesta.Resource("Siesta.Test.Browser"),this.waitFor({method:function(){var c=m.normalizeElement(a,!0),d=m.normalizeElement(b,!0);return c&&m.elementIsTop(c,!0,offset)&&d&&m.elementIsTop(d,!0,offset)},callback:function(){m.pinch(a,
b,e,d,e,g,k,f)},assertionName:"waitForTarget",description:" "+r.get("target")+' "'+a+'" and "'+b+'" '+r.get("toAppear")})},simulateTouchDrag:function(a,b,c,d,e,g){this.checkTouchEventsSupport();var k=this;e=e||{};k.elementFromPoint(a[0],a[1],!0);k.elementFromPoint(b[0],b[1],!0);var f=new Siesta.Util.Queue({deferer:this.originalSetTimeout,deferClearer:this.originalClearTimeout,interval:k.dragDelay,callbackDelay:k.afterActionDelay,observeTest:this}),m;f.addStep({processor:function(){m=k.touchStart(a,
null,e)}});f.addAsyncStep({processor:function(a){k.touchMove(m,b[0],b[1],a.next,null,e)}});f.addStep({processor:function(){g||k.touchEnd(m,e)}});var n=k.beginAsync();f.run(function(){k.endAsync(n);k.processCallbackFromTest(c,[g?m:null],d||k)})},touchDragTo:function(a,b,c,d,e,g,k,f){var m=this,n=this.getNormalizedTopElementInfo(a,!0,"touchDragTo: source",k),p=this.getNormalizedTopElementInfo(b,!0,"touchDragTo: target",f);n&&p?this.simulateTouchDrag(n.localXY,p.localXY,c,d,e,g):(n=Siesta.Resource("Siesta.Test.Browser"),
this.waitFor({method:function(){var c=m.normalizeElement(a,!0),d=m.normalizeElement(b,!0);return c&&m.elementIsTop(c,!0,k)&&d&&m.elementIsTop(d,!0,f)},callback:function(){m.touchDragTo(a,b,c,d,e,g,k,f)},assertionName:"waitForTarget",description:" "+n.get("target")+' "'+a+'" and "'+b+'" '+n.get("toAppear")}))},touchDragBy:function(a,b,c,d,e,g,k){var f=this.getNormalizedTopElementInfo(a,!0,"touchDragBy",k);f?(f=f.globalXY,this.simulateTouchDrag(f,[f[0]+b[0],f[1]+b[1]],c,d,e,g)):this.waitForTarget(a,
function(){this.touchDragBy(a,b,c,d,e,g,k)},this,null,k)},swipe:function(a,b,c,d,e){this.checkTouchEventsSupport();if(a=this.normalizeElement(a,!0)){var g=this.Ext(),k=Siesta.Resource("Siesta.Test.SenchaTouch"),g=g.fly(a).getBox();switch(b){case "u":case "up":k=[g.x+g.width/2,g.y+9*g.height/10];g=[g.x+g.width/2,g.y+g.height/10];g[1]=Math.min(k[1]-100,g[1]);break;case "d":case "down":k=[g.x+g.width/2,g.y+g.height/10];g=[g.x+g.width/2,g.y+9*g.height/10];g[1]=Math.max(k[1]+100,g[1]);break;case "r":case "right":k=
[g.x+g.width/10,g.y+g.height/2];g=[g.x+9*g.width/10,g.y+g.height/2];g[0]=Math.max(k[0]+100,g[0]);break;case "l":case "left":k=[g.x+9*g.width/10,g.y+g.height/2];g=[g.x+g.width/10,g.y+g.height/2];g[0]=Math.min(k[0]-100,g[0]);break;default:throw k.get("invalidSwipeDir")+": "+b;}this.touchDragTo(k,g,c,d,e)}else this.waitForTarget(a,function(){this.swipe(a,b,c,d,e)},this)},touchStart:function(a,b,c,d){d||(d=this.getNormalizedTopElementInfo(a,!0,"touchStart",b));c=Joose.O.extend({clientX:d.localXY[0],clientY:d.localXY[1]},
c||{});a=this.simulateTouchEventGeneric(d.el,"start",c);return a.pointerId||a.changedTouches[0].identifier},touchEnd:function(a,b){var c=this.activeTouches[a];if(!c)throw"Can't find active touch: "+a;b=Joose.O.extend({clientX:c.clientX,clientY:c.clientY},b||{});this.simulateTouchEventGeneric(c.currentEl||c.target,"end",b,{touchId:a})},touchMove:function(a,b,c,d,e,g){var k=this.activeTouches[a];if(!k)throw"Can't find active touch: "+a;var f=this,m=[];this.movePointerTemplate({xy:[k.clientX,k.clientY],
xy2:[b,c],callback:d,scope:e,options:g||{},overEls:m,interval:this.dragDelay,callbackDelay:f.afterActionDelay,precision:f.dragPrecision,onVoidOverEls:function(){m=[]},onPointerEnter:function(a,b,c){},onPointerLeave:function(a,b,c){},onPointerOver:function(a,b,c){},onPointerOut:function(a,b,c){},onPointerMove:function(b,c,d){k.clientX=c.clientX;k.clientY=c.clientY;k.pageX=c.clientX;k.pageY=c.clientY;k.currentEl=b;f.simulateTouchEventGeneric(b,"move",c,{touchId:a})}})},touchCancel:function(a,b){var c=
this.activeTouches[a];if(!c)throw"Can't find active touch: "+a;this.simulateTouchEventGeneric(c.currentEl||c.target,"cancel",b,{touchId:a})},simulatePointerEvent:function(a,b,c,d){var e=Siesta.Harness.Browser.FeatureSupport().supports;c=c||{};var g=this.global.document,k=g.createEvent(e.PointerEvents?"PointerEvent":e.MSPointerEvents?"MSPointerEvent":"MouseEvents");a=this.normalizeElement(a);if(!a)return!1;if(!/pointerdown$/i.test(b)||"clientX"in c&&"clientY"in c)k[e.MSPointerEvents||e.PointerEvents?
"initPointerEvent":"initMouseEvent"](b,!0,!0,this.global,c.detail,c.screenX,c.screenY,c.clientX,c.clientY,c.ctrlKey||!1,c.altKey||!1,c.shiftKey||!1,c.metaKey||!1,c.button,c.relatedTarget||g.body.parentNode,null,null,null,null,null,null,null,null,d.touchId||this.currentTouchId++,4,null,null);else b=this.findCenter(a),Joose.O.extend({clientX:b[0],clientY:b[1]},c);e.MSPointerEvents||e.PointerEvents||(k.pointerId=d.touchId||this.currentTouchId++);a.dispatchEvent(k);return k},simulateTouchEvent:function(a,
b,c,d){c=c||{};b=new this.global.CustomEvent(b,{bubbles:!0,cancelable:!0});a=this.normalizeElement(a);"clientX"in c&&"clientY"in c||this.findCenter(a);var e=this.activeTouches;d=d.touch;var g=[],k=[],f;for(f in e){var m=e[f];g.push(m);m.target==a&&k.push(m)}Joose.O.extend(b,{target:a,changedTouches:this.createTouchList([d]),touches:this.createTouchList(g),targetTouches:this.createTouchList(k),altKey:c.altKey,metaKey:c.metaKey,ctrlKey:c.ctrlKey,shiftKey:c.shiftKey});a.dispatchEvent(b);return b},createTouchList:function(a){var b=
this.global.document;if(b.createTouch){for(var c=[],d=0;d<a.length;d++){var e=a[d];c.push(b.createTouch(b.defaultView||b.parentWindow,e.target,e.identifier||this.currentTouchId++,e.pageX,e.pageY,e.screenX||e.pageX,e.screenY||e.pageY,e.clientX,e.clientY))}return b.createTouchList.apply(b,c)}return a},createTouch:function(a,b,c){return{identifier:this.currentTouchId++,target:a,clientX:b,clientY:c,screenX:0,screenY:0,pageX:b,pageY:c}},buildTouchEventNamesMap:function(){var a=Siesta.Harness.Browser.FeatureSupport().supports;
return a.PointerEvents?{start:"pointerdown",move:"pointermove",end:"pointerup",cancel:"pointercancel"}:a.MSPointerEvents?{start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp",cancel:"MSPointerCancel"}:{start:"touchstart",move:"touchmove",end:"touchend",cancel:"touchcancel"}},simulateTouchEventGeneric:function(a,b,c,d){d=d||{};a=this.normalizeElement(a);var e,g;"clientX"in c&&"clientY"in c?(e=c.clientX,g=c.clientY):(g=this.findCenter(a),e=g[0],g=g[1]);var k=this.activeTouches,f;"end"===b||
"cancel"===b?(f=k[d.touchId],a=f.currentEl||f.target,delete k[d.touchId]):"start"==b?(f=this.createTouch(a,e,g),k[f.identifier]=f):"move"==b&&(f=k[d.touchId],f.clientX=c.clientX,f.clientY=c.clientY);if(!f)throw"Can't find active touch"+(d.touchId?": "+d.touchId:"");d.touchId||(d.touchId=f.identifier);d.touch=f;b=this.getTouchEventNamesMap()[b];e=Siesta.Harness.Browser.FeatureSupport().supports;return e.PointerEvents||e.MSPointerEvents?this.simulatePointerEvent(a,b,c,d):this.simulateTouchEvent(a,b,
c,d)}}});Role("Siesta.Test.ExtJSCore",{has:{waitForExtReady:!0,waitForAppReady:!1,loaderPath:null,requires:null,simulateEventsWith:{is:"rw",lazy:function(){var a=navigator.userAgent.match(/MSIE 9.0;/),b=this.getExt();if(!b||!b.getVersion)return"dispatchEvent";b=b.getVersion("extjs");b=Boolean(b&&b.isLessThan&&b.isLessThan("4.2.1.883"));return document.createElement("div").attachEvent&&(a||b)?"fireEvent":"dispatchEvent"}},eventMap:{is:"rw",lazy:function(){var a=this.getExt();return a&&a.dom&&a.dom.Element&&
a.dom.Element.prototype.eventMap?Joose.O.copy(a.dom.Element.prototype.eventMap):null}},isExtOnReadyDone:!1,onReadyWaitingStarted:!1,isAppReadyDone:!1,requiringWaitingStarted:!1,isRequiringDone:!1},override:{cleanupContextBeforeStartDom:function(){var a=this.getExt();if(!a)return this.SUPER();var b=this;if(a.ComponentQuery){var c={},d=a.MessageBox;d&&(c[d.id]=!0);d=a.ComponentQuery.query("{ownerCt == null}");d.sort(function(b,c){b=b instanceof a.Container?0:1;c=c instanceof a.Container?0:1;return b-
c});Joose.A.each(d,function(a){c[a.id]||a.isDestroyed||a.destroy()})}if(a.ClassManager&&a.undefine){var e={};Joose.O.each(a.ClassManager.classes,function(c,d){var g=d.split(".")[0];b.isGlobalExpected(g,e)||a.undefine(d)})}if(a.data&&a.data.StoreManager){var g=[];a.data.StoreManager.each(function(a){"ext-empty-store"!==a.storeId&&g.push(a)});a.data.StoreManager.unregister.apply(a.data.StoreManager,g)}},processMouseEventName:function(a){var b=this.getEventMap();return b&&b[a]||a},processSubTestConfig:function(){var a=
this.SUPERARG(arguments);a.waitForAppReady=!1;a.waitForExtReady=!1;return a},isReady:function(){var a=this.SUPERARG(arguments);if(!a.ready)return a;var b=this,a=this.getExt(),c=Siesta.Resource("Siesta.Test.ExtJSCore"),d=this.requires;d&&(!this.requiringWaitingStarted&&a&&a.require)&&(this.requiringWaitingStarted=!0,a.require(d,function(){b.isRequiringDone=!0}));this.waitForExtReady&&(!this.onReadyWaitingStarted&&a&&a.onReady)&&(this.onReadyWaitingStarted=!0,a.onReady(function(){b.isExtOnReadyDone=
!0}));return d&&!this.isRequiringDone?{ready:!1,reason:c.get("waitedForRequires")}:this.waitForExtReady&&!this.isExtOnReadyDone?{ready:!1,reason:c.get("waitedForExt")}:this.waitForAppReady&&!this.isAppReadyDone?{ready:!1,reason:c.get("waitedForApp")}:{ready:!0}},simulateMouseClick:function(a,b,c,d){var e=a.el,g=this.getExt(),g=g&&g.getVersion&&g.getVersion("extjs")&&5==g.getVersion("extjs").major;if("fireEvent"!==this.getSimulateEventsWith()&&!g||"checkbox"!==e.type&&"radio"!==e.type||e.disabled||
e.readOnly)this.SUPERARG(arguments);else{var k=e.checked;b?this.SUPER(a,function(){e.checked===k&&(e.checked=!k);b.call(c||this)}):(this.SUPERARG(arguments),e.checked===k&&(e.checked=!k))}}},methods:{initialize:function(){this.expectGlobals("Ext","id");this.SUPER()},start:function(a){var b=this,c=this.getExt();if(c){this.harness.generateLoaderPathHook()(this.global.StartTest,c,this.loaderPath);c.isReady=!0;var d=c.ClassManager&&Boolean(c.ClassManager.get("Ext.app.Application"));d||(this.waitForAppReady=
!1);this.waitForAppReady&&d&&c.util.Observable.observe(c.app.Application,{launch:function(){b.isAppReadyDone=!0},single:!0,delay:100})}else this.waitForExtReady=this.waitForAppReady=!1,this.requires=null;this.SUPERARG(arguments)},getExt:function(){return this.global.Ext},Ext:function(){return this.global.Ext},isExtJSComponent:function(a){var b=this.getExt();return Boolean(b&&b.Component&&a instanceof b.Component)},normalizeComponent:function(a,b,c){c=c||{};var d=this.Ext(),e=!1;if("String"===this.typeOf(a)){a=
this.trimString(a.replace(/^(\s*>>)?/,""));var d=d.ComponentQuery.query(a),g=Siesta.Resource("Siesta.Test.ExtJSCore");!b&&1>d.length&&this.warn(g.get("noComponentMatch").replace("{component}",a));if(c.ignoreNonVisible){var k=[];Joose.A.each(d,function(a){(a.isVisible?a.isVisible():!a.isHidden())&&k.push(a)});d=k}1<d.length&&(e=!0,a=g.get("multipleComponentMatch").replace("{component}",a),this.harness.failOnMultipleComponentMatches?this.fail(a):this.warn(a));a=d[0]}return c.detailed?{comp:a,matchingMultiple:e}:
a},compToEl:function(a,b){var c=this.Ext();if(!a)return null;b=!1!==b;if(c&&c.form&&c.form.Field&&b){if(a instanceof c.form.Field&&a.inputEl)return a.inputEl.dom||a.inputEl;if(c.form.HtmlEditor&&a instanceof c.form.HtmlEditor)return a.iframe||a.inputEl}c&&(c.field&&c.field.Field&&a instanceof c.field.Field&&b)&&(a=a.getComponent());return a.getEl?a.getEl():a.el||a.element},normalizeElement:function(a,b,c,d,e){if(!a)return null;if(a.nodeName)return a;var g=!1;this.getExt();var k=a,f,m=e&&e.stopAtComponentLevel;
e=e&&e.hasOwnProperty("ignoreNonVisible")?e.ignoreNonVisible:!0;if("string"===typeof a){g=a.split("->");if(2===g.length&&(f=this.adjustScope(a),a=this.trimString(g[1]),!f||(a.match(/^\s*>>/)||a.match(/=>/))&&!this.Ext()))return this.resetScope(),null;if(a.match(/=>/))g=this.compositeQuery(a,null,b,e),a=g[0],g=1<g.length;else if(a.match(/^\s*>>/))g=this.normalizeComponent(a,b,{ignoreNonVisible:e,detailed:!0}),a=g.comp,g=g.matchingMultiple;else return d=this.SUPER(a,b,c,d),f&&this.resetScope(),d;if(!b&&
!a)throw d=Siesta.Resource("Siesta.Test.ExtJSCore").get("noComponentFound")+": "+k,this.warn(d),f&&this.resetScope(),d;}k=!1;this.isExtJSComponent(a)&&(m?k=!0:(a=this.compToEl(a),!c&&(this.isElementVisible(a)&&this.elementIsTop(a,!0))&&(e=this.findCenter(a),a=this.elementFromPoint(e[0],e[1],!1,a.dom))));a&&a.dom&&(m?k=!0:a=a.dom);a=k?a:this.SUPER(a,b,c);f&&this.resetScope();return d?{el:a,matchingMultiple:g}:a},normalizeActionTarget:function(a,b){return this.normalizeElement(a,b,!1,!1,{stopAtComponentLevel:!0})},
knownBugIn:function(a,b,c){var d=this.getExt(),d=d.versions.extjs||d.versions.touch,e=Siesta.Resource("Siesta.Test.ExtJSCore");this.harness.failKnownBugIn||d.isGreaterThan(a)?b.call(this.global,this):this.todo(e.get("knownBugIn")+" "+a+": "+(c||""),b)},requireOk:function(){var a=this,b=this.getExt(),c=Array.prototype.concat.apply([],arguments),d=Siesta.Resource("Siesta.Test.ExtJSCore"),e;"Function"==this.typeOf(c[c.length-1])&&(e=c.pop());var g=function(){a.endAsync(f);Joose.A.each(c,function(c){var e=
b.ClassManager.get(c);!e||"Function"!=a.typeOf(e)&&"Function"!=a.typeOf(e.self)?a.fail(d.get("Class")+": "+c+" "+d.get("wasNotLoaded")):a.pass(d.get("Class")+": "+c+" "+d.get("wasLoaded"))});e&&a.processCallbackFromTest(e)},k=b.isIE?12E4:3E4,f=this.beginAsync(k+100),m=!1,n=this.originalSetTimeout,p=this.originalClearTimeout,r=n(function(){m=!0;g()},k);b.Loader.setConfig({enabled:!0});b.require(c,function(){p(r);m||g()})},clickComponentQuery:function(a,b,c){2==arguments.length&&"Function"==this.typeOf(arguments[1])&&
(c=b,b=this.Ext().ComponentQuery);1==arguments.length&&(b=this.Ext().ComponentQuery);var d=b.query(a);this.chainClick(d,function(){c&&c.call(this,d)})},clickCQ:function(){this.clickComponentQuery.apply(this,arguments)},compositeQuery:function(a,b,c,d){c=!1!==c;var e=this.Ext(),g=Siesta.Resource("Siesta.Test.ExtJSCore"),k=a.split("=>"),f;b=b||e.ComponentQuery;if(!b)return[];if(2>k.length)throw g.get("invalidCompositeQuery")+": "+a;if(k[0].match(/\.\w+\(/)){f=this.trimString(k[0]).split(" ");for(e=
0;e<f.length;e++){var m=this.trimString(f[e]).split(".");b=b.query(m[0])[0];1<m.length&&(m=m[1].substr(0,m[1].length-2),b=b[m]())}b=[b]}else b=b.query(k[0]);if(!b.length){if(c)return[];throw g.get("ComponentQuery")+" "+k[0]+" "+g.get("matchedNoCmp");}for(e=0;e<b.length;e++)if(f=b[e],f.rendered&&(!d||(f.isVisible?f.isVisible():!f.isHidden()))&&(f=this.compToEl(f,!1),f=Array.prototype.slice.call($(k[1],f.dom)),0<f.length))return f;if(c)return[];throw g.get("CompositeQuery")+" "+a+" "+g.get("matchedNoCmp");
},cq:function(a){return this.Ext().ComponentQuery.query(a)},cq1:function(a){return this.Ext().ComponentQuery.query(a)[0]},waitForTarget:function(a,b,c,d,e){var g=this.SUPER;this.waitForAnimations(function(){g.call(this,a,b,c,d,e)},this,d)},messageBoxIsVisible:function(a){return this.notOk(this.Ext().Msg.isHidden(),a||Siesta.Resource("Siesta.Test.ExtJSCore","messageBoxVisible"))},messageBoxIsHidden:function(a){return this.ok(this.Ext().Msg.isHidden(),a||Siesta.Resource("Siesta.Test.ExtJSCore","messageBoxHidden"))},
cqExists:function(a,b){this.ok(this.cq1(a),b)},cqNotExists:function(a,b){this.notOk(this.cq1(a),b)},componentQueryExists:function(){this.cqExists.apply(this,arguments)}}});Role("Siesta.Test.ExtJS.Ajax",{has:{responses:Joose.I.Array,urlMatchers:Joose.I.Array},methods:{isAjaxLoading:function(a,b){var c=this.Ext();this.ok(c.Ajax.isLoading(a),b||Siesta.Resource("Siesta.Test.ExtJS.Ajax","ajaxIsLoading"))},ajaxRequestAndThen:function(a,b,c){var d=this.Ext(),e=a;"string"===typeof a&&(e={url:a,callback:b,
scope:c});d.Ajax.request(e)},waitForAjaxRequest:function(a,b,c,d){var e=this.Ext(),g;"function"===typeof a?(g=" "+Siesta.Resource("Siesta.Test.ExtJS.Ajax","allAjaxRequestsToComplete"),d=c,c=b,b=a,a=void 0):g=" "+Siesta.Resource("Siesta.Test.ExtJS.Ajax","ajaxRequest")+' "'+a.options.url+'" '+Siesta.Resource("Siesta.Test.ExtJS.Ajax","toComplete");return this.waitFor({method:function(){return a?!e.Ajax.isLoading(a)&&a:!e.Ajax.isLoading()},callback:b,scope:c,timeout:d,assertionName:"waitForAjaxRequest",
description:g})}}});Role("Siesta.Test.ExtJS.Store",{methods:{waitForStoresToLoad:function(){var a=this.getExt(),b=Array.prototype.concat.apply([],arguments),c=this,d=Siesta.Resource("Siesta.Test.ExtJS.Store"),e=a.data.AbstractStore||a.data.Store,g,f;Joose.A.each(b,function(a,b){if("Function"==c.typeOf(a))return g=a,f=b,!1});var l=0,a=c.waitFor({method:function(){return l==f},callback:g,name:"waitForStoresToLoad",description:f+" "+d.get("storesToLoad")});Joose.A.each(b,function(a){var b=a.proxy||a.getProxy&&
a.getProxy();if(!(a instanceof e))return!1;if(b){a.on("load",function(){l++;b.un("exception",g)},null,{single:!0});var g=function(a,b,e){a=a.api&&a.api.read||a.url;c.fail(d.get("failedToLoadStore"),d.get("URL")+": "+a)};b.on("exception",g)}else f--});return a},loadStoresAndThen:function(){this.getExt();this.waitForStoresToLoad.apply(this,arguments);var a=Array.prototype.concat.apply([],arguments);"Function"==this.typeOf(a[a.length-1])&&a.pop();Joose.A.each(a,function(a){(a.proxy||a.getProxy&&a.getProxy())&&
a.load&&a.load()})},isStoreEmpty:function(a,b){this.is(a.getCount(),0,b)}}});Role("Siesta.Test.ExtJS.Observable",{methods:{addListenerToObservable:function(a,b,c,d){a.nodeName&&a.tagName&&(a=this.Ext().get(a));a=this.normalizeActionTarget(a,!1);if(a.on&&a.un)a.on(b,c,null,{single:d});else this.SUPERARG(arguments)},removeListenerFromObservable:function(a,b,c){a.nodeName&&a.tagName&&(a=this.Ext().get(a));a=this.normalizeActionTarget(a,!1);a.on&&a.un?a.un(b,c):this.SUPERARG(arguments)},hasListener:function(a,
b,c){var d=Siesta.Resource("Siesta.Test.ExtJS.Observable");(a=this.normalizeActionTarget(a))&&a.hasListener?a.hasListener(b)?this.pass(c,{descTpl:d.get("hasListenerPass"),eventName:b}):this.fail(c,{assertionName:"hasListener",annotation:d.get("hasListenerFail")+": "+b}):this.fail(c,{assertionName:"hasListener",annotation:d.get("hasListenerInvalid")})}}});Role("Siesta.Test.ExtJS.Component",{requires:["waitFor"],methods:{waitForComponentVisible:function(a,b,c,d){var e=Siesta.Resource("Siesta.Test.ExtJS.Component"),
g=this;if("String"!=this.typeOf(a)&&!this.isExtJSComponent(a))throw e.get("badInputText")+": "+a;return this.waitFor({method:function(){var b=g.normalizeComponent(a,!0);if(!b)return!1;var c=g.compToEl(b);return c&&g.elementIsTop(c,!0)&&b},callback:b,scope:c,timeout:d,assertionName:"waitForComponentVisible",description:" "+e.get("component")+' "'+("String"==g.typeOf(a)?a:a.id)+'" '+e.get("toBeVisible")})},waitForComponentNotVisible:function(a,b,c,d){var e=Siesta.Resource("Siesta.Test.ExtJS.Component"),
g=this;if("String"!=this.typeOf(a)&&!this.isExtJSComponent(a))throw e.get("badInputText")+": "+a;return this.waitFor({method:function(){var b=g.normalizeComponent(a,!0);if(!b)return!1;var c=g.compToEl(b);return(b.isHidden()||c&&!g.isElementVisible(c))&&b},callback:b,scope:c,timeout:d,assertionName:"waitForComponentNotVisible",description:" "+e.get("component")+' "'+("String"==g.typeOf(a)?a:a.id)+'" '+e.get("toNotBeVisible")})},waitForComponentQuery:function(a,b,c,d,e){"Function"==this.typeOf(b)&&
(e=d,d=c,c=b,b=this.getExt().ComponentQuery);return this.waitFor({method:function(){var c=b.query(a);return 0<c.length?c:!1},callback:c,scope:d,timeout:e,assertionName:"waitForComponentQuery",description:" "+Siesta.Resource("Siesta.Test.ExtJS.Component","componentQuery")+' "'+a+'"'})},waitForCompositeQuery:function(a,b,c,d,e){"Function"==this.typeOf(b)&&(e=d,d=c,c=b,b=this.getExt().ComponentQuery);var g=this;return g.waitFor({method:function(){var c=g.compositeQuery(a,b,!0);return 0<c.length?c:!1},
callback:c,scope:d,timeout:e,assertionName:"waitForCompositeQuery",description:" "+Siesta.Resource("Siesta.Test.ExtJS.Component","compositeQuery")+' "'+a+'"'})},waitForCompositeQueryNotFound:function(a,b,c,d,e){"Function"==this.typeOf(b)&&(e=d,d=c,c=b,b=this.getExt().ComponentQuery);var g=this;return g.waitFor({method:function(){return 0<g.compositeQuery(a,b,!0).length?!1:!0},callback:c,scope:d,timeout:e,assertionName:"waitForCompositeQueryNotFound",description:" "+Siesta.Resource("Siesta.Test.ExtJS.Component",
"compositeQuery")+' "'+a+'" '+Siesta.Resource("Siesta.Test.ExtJS.Component","toReturnEmptyArray")})},waitForCQ:function(){return this.waitForComponentQuery.apply(this,arguments)},waitForCQNotFound:function(){return this.waitForComponentQueryNotFound.apply(this,arguments)},waitForComponentQueryNotFound:function(a,b,c,d,e){var g=Siesta.Resource("Siesta.Test.ExtJS.Component");"Function"==this.typeOf(b)&&(e=d,d=c,c=b,b=this.getExt().ComponentQuery);return this.waitFor({method:function(){var c=b.query(a);
return 0===c.length&&c},callback:c,scope:d,timeout:e,assertionName:"waitForComponentQueryNotFound",description:g.get("componentQuery")+": "+a+" "+g.get("toReturnEmpty")})},waitForCQVisible:function(){return this.waitForComponentQueryVisible.apply(this,arguments)},waitForCQNotVisible:function(){return this.waitForComponentQueryNotVisible.apply(this,arguments)},waitForComponentQueryVisible:function(a,b,c,d,e){var g=this,f=Siesta.Resource("Siesta.Test.ExtJS.Component"),l=g.getExt();"Function"==this.typeOf(b)&&
(e=d,d=c,c=b,b=l.ComponentQuery);return this.waitFor({method:function(){var c=b.query(a),d=!0;return 0<c.length?(Joose.A.each(c,function(a){if(!a.rendered||!g.isElementVisible(a))return d=!1}),d&&c):!1},callback:c,scope:d,timeout:e,assertionName:"waitForComponentQueryVisible",description:" "+f.get("componentQuery")+": "+a+" "+f.get("toReturnAVisibleComponent")})},waitForComponentQueryNotVisible:function(a,b,c,d,e){var g=Siesta.Resource("Siesta.Test.ExtJS.Component"),f=this.getExt();"Function"==this.typeOf(b)&&
(e=d,d=c,c=b,b=f.ComponentQuery);return this.waitFor({method:function(){var c=b.query(a),d=!0;return 0<c.length?(Joose.A.each(c,function(a){if(a.rendered&&!a.isHidden())return d=!1}),d&&c):!0},callback:c,scope:d,timeout:e,assertionName:"waitForComponentQueryVisible",description:" "+g.get("componentQuery")+": "+a+" "+g.get("toReturnHiddenCmp")})},waitForXType:function(a,b,c,d,e){return this.waitForComponentQuery(a,b,c,d,e)},waitForComponent:function(a,b,c,d,e){var g=this.getExt();a=g.isString(a)?g.ClassManager.get(a).xtype:
a.xtype;b&&(a+="[rendered]");return this.waitForXType(a,c,d,e)},hasSize:function(a,b,c,d){a=this.normalizeComponent(a);this.isDeeply(a.getSize(),{width:b,height:c},d)},hasPosition:function(a,b,c,d){a=this.normalizeComponent(a);this.isDeeply(a.getPosition(),[b,c],d)},destroysOk:function(a,b){var c=this.Ext(),d=Siesta.Resource("Siesta.Test.ExtJS.Component");"Array"!=this.typeOf(a)&&(a="String"==this.typeOf(a)?this.Ext().ComponentQuery.query(a):[a]);if(a.length){var e,g=this.getExceptionCatcher()(function(){Joose.A.each(a,
function(a){e=a;a.destroy()})});if(void 0!==g)this.fail(b,{assertionName:"destroysOk",got:g,gotDesc:d.get("exception"),annotation:d.get("exceptionAnnotation")+" "+e.id});else{var f=this;!1!==Joose.A.each(a,function(a){if(!a.isDestroyed&&a.destroy!=c.emptyFn)return f.fail(b,{assertionName:"destroysOk",annotation:d.get("Component")+" ["+a.id+"] "+d.get("destroyFailed")}),!1})&&this.pass(b,{descTpl:d.get("destroyPassed")})}}else this.fail(b,{assertionName:"destroysOk",annotation:d.get("invalidDestroysOkInput")})}}});
Role("Siesta.Test.ExtJS.Grid",{requires:["waitFor","pass","fail","typeOf"],methods:{waitForRowsVisible:function(a,b,c,d){"function"===typeof a&&(d=c,c=b,b=a,a=this.cq1("tablepanel"));var e=this.normalizeComponent(a,!0),g=this;if(e||"string"!==typeof a){if(e.normalGrid){var f=e.normalGrid.getView().itemSelector;a=function(){if(e.rendered&&e.normalGrid.rendered&&e.lockedGrid.rendered){var a=this.$(f,e.lockedGrid.el.dom),b=this.$(f,e.normalGrid.el.dom);if(0<a.length&&0<b.length)return{lockedRows:a,normalRows:b}}}}else a=
e.getView(),f=a.itemSelector||a.rowSelector,a=function(){if(e.rendered){var a=this.$(f,e.el.dom);if(0<a.length)return a}};return this.waitFor({method:a,callback:function(){var a=g.beginAsync();g.global.setTimeout(function(){g.endAsync(a);b.call(c||g)},100)},timeout:d,assertionName:"waitForRowsVisible",description:" "+Siesta.Resource("Siesta.Test.ExtJS.Grid").get("waitForRowsVisible")+' "'+e.id+'"'})}return this.waitForCQ(a,function(a){this.waitForRowsVisible(a[0],b,c,d)},this)},getFirstRow:function(a){a=
this.normalizeComponent(a);return this.getRow(a,0)},getFirstCell:function(a){a=this.normalizeComponent(a);return this.getCell(a,0,0)},getRow:function(a,b){a=this.normalizeComponent(a);var c=this.$(a.getView().itemSelector,a.el.dom)[b];return this.Ext().get(c)},getCell:function(a,b,c){a=this.normalizeComponent(a);b=this.getRow(a,b);a=this.$(a.view.cellSelector,b.dom)[c];return this.Ext().get(a)},getLastCellInRow:function(a,b){a=this.normalizeComponent(a);return this.getCell(a,b,a.headerCt.getColumnCount()-
1)},matchGridCellContent:function(a,b,c,d,e){a=this.normalizeComponent(a);a.getView();a=this.getCell(a,b,c).child("div");var g="RegExp"==this.typeOf(d),f=a.dom.innerHTML;(g?d.test(f):-1!=f.indexOf(d))?this.pass(e,{descTpl:g?"Cell content {content} matches regexp {string}":"Cell content {content} has a string {string}",content:f,string:d}):this.fail(e,{assertionName:"matchGridCellContent",got:a.dom.innerHTML,gotDesc:"Cell content",need:d,needDesc:"String matching",annotation:"Row index: "+b+", column index: "+
c})},clickToEditCell:function(a,b,c,d,e){var g=this.getExt(),f=(a=this.normalizeComponent(a))&&a.editingPlugin;if(f&&f instanceof g.grid.plugin.CellEditing){var l=this;this[2==f.clicksToEdit?"doubleClick":"click"](this.getCell(a,b,c),function(){f.getActiveEditor()||f.startEditByPosition({row:b,column:c});l.waitForSelectorAtCursor(e||"input",d)})}else this.fail("No grid, or grid has no editing plugin, or its not a Ext.grid.plugin.CellEditing plugin"),d&&d(null)}}});Role("Siesta.Test.ExtJS.DataView",
{requires:["waitFor","getExt"],methods:{waitForViewRendered:function(a,b,c,d){a=this.normalizeComponent(a);var e=0<a.store.getCount(),g=Siesta.Resource("Siesta.Test.ExtJS.DataView");return this.waitFor({method:function(){return e?!!a.getNode(0):a.rendered},callback:b,scope:c,timeout:d,assertionName:"waitForViewRendered",description:" "+g.get("view")+" "+a.id+" "+g.get("toRender")})},getFirstItem:function(a){var b=this.getExt();a=this.normalizeComponent(a);return b.get(a.getNode(0))}}});Role("Siesta.Test.ExtJS.Element",
{methods:{hasRegion:function(a,b,c){a=a.getRegion();var d=Siesta.Resource("Siesta.Test.ExtJS.Element");this.is(a.top,b.top,c+" "+d.get("top")+")");this.is(a.right,b.right,c+" "+d.get("right")+")");this.is(a.bottom,b.bottom,c+" "+d.get("bottom")+")");this.is(a.left,b.left,c+" "+d.get("left")+")")}}});Role("Siesta.Test.ExtJS.FormField",{methods:{fieldHasValue:function(a,b,c){a=this.normalizeComponent(a);this.is(a.getValue(),b,c)},hasValue:function(){this.fieldHasValue.apply(this,arguments)},isFieldEmpty:function(a,
b){a=this.normalizeComponent(a);var c=a.getValue();this.ok(null===c||""===c,b)},isEmpty:function(){this.isFieldEmpty.apply(this,arguments)}}});Role("Siesta.Test.TextSelection",{methods:{getSelectedText:function(a){a=this.normalizeElement(a);if("selectionStart"in a)try{return a.value.substring(a.selectionStart,a.selectionEnd)}catch(b){}a=this.global;var c=a.document;if(a.getSelection)return a.getSelection().toString();if(c.getSelection)return c.getSelection();if(c.selection)return c.selection.createRange().text},
selectText:function(a,b,c){a=this.normalizeElement(a);var d=a.value||a.innerHTML,e=!0;0<d.length&&(b=void 0===b?0:b,c=void 0===c?d.length:c,a.setSelectionRange?a.setSelectionRange(b,c):a.createTextRange&&(e=a.createTextRange(),e.moveStart("character",b),e.moveEnd("character",c-d.length),e.select()),e=$.browser.mozilla||$.browser.opera);e&&this.focus(a)}}});Role("Siesta.Test.Element",{requires:["typeOf","chain","normalizeElement"],methods:{findCenter:function(a,b){return this.getTargetCoordinate(a,
b)},normalizeOffset:function(a,b){var c;"Function"==this.typeOf(a)&&(a=a.call(this));a=a||["50%","50%"];"string"===typeof a[0]&&(c=a[0].split("%"),a[0]=parseInt(a[0].match(/\d+/)[0],10)*(b.outerWidth()-1)/100,c[1]&&(a[0]+=parseInt(c[1])),a[0]=Math.round(a[0]));"string"===typeof a[1]&&(c=a[1].split("%"),a[1]=parseInt(a[1].match(/\d+/)[0],10)*(b.outerHeight()-1)/100,c[1]&&(a[1]+=parseInt(c[1])),a[1]=Math.round(a[1]));return a},getTargetCoordinate:function(a,b,c){var d=this.normalizeElement(a);a=this.$(d);
var e=a.offset(),d=d.ownerDocument,g=this.$(d),e=[e.left-g.scrollLeft(),e.top-g.scrollTop()];c=this.normalizeOffset(c,a);e[0]+=c[0];e[1]+=c[1];!1===b&&(b=d.defaultView||d.parentWindow,b!==this.global&&(b=this.$(b.frameElement).offset(),e[0]+=b.left,e[1]+=b.top));return e},isElementVisible:function(a){return(a=this.normalizeElement(a))?window.SVGElement&&a instanceof this.global.SVGElement?"none"!==a.style.display&&"hidden"!==a.style.visibility:this.$(a).is(":visible")&&(!a.style||"hidden"!==a.style.visibility):
!1},contentLike:function(a,b,c){a=this.normalizeElement(a);this.like(a.innerHTML,b,c)},contentNotLike:function(a,b,c){a=this.normalizeElement(a);this.unlike(a.innerHTML,b,c)},waitForContentLike:function(a,b,c,d,e){var g=Siesta.Resource("Siesta.Test.Element");a=this.normalizeElement(a);return this.waitFor({method:function(){return a.innerHTML.match(b)},callback:c,scope:d,timeout:e,assertionName:"waitForContentLike",description:" "+g.get("elementContent")+' "'+b+'" '+g.get("toAppear")})},waitForContentNotLike:function(a,
b,c,d,e){var g=Siesta.Resource("Siesta.Test.Element");a=this.normalizeElement(a);return this.waitFor({method:function(){return!a.innerHTML.match(b)},callback:c,scope:d,timeout:e,assertionName:"waitForContentNotLike",description:" "+g.get("elementContent")+' "'+b+'" '+g.get("toDisappear")})},monkeyTest:function(a,b,c,d,e){var g=this.global;a=this.normalizeElement(a,!1,!0)||g.document.body;b=b||30;var f=a==g.document.body,l=this,m=l.$(a).offset(),n=m.left+l.$(f?g:a).width();a=m.top+l.$(f?g:a).height();
for(var p=[],r=Siesta.Resource("Siesta.Test.Element"),s=new Siesta.Util.Queue({deferer:l.originalSetTimeout,deferClearer:l.originalClearTimeout,interval:50,observeTest:this,processor:function(a){if(l.nbrExceptions||l.failed)l.warn(r.get("monkeyActionLog")+":"+JSON2.stringify(p)),s.abort();else{var b=l.beginAsync(null,function(a){a.fail(r.get("monkeyException"));l.warn(r.get("monkeyActionLog")+":"+JSON.stringify(p));return!0}),c=a.next;a.next=function(){l.endAsync(b);c()};a.action(a)}}}),g=0;g<b;g++)switch(f=
[l.randomBetween(m.left,n),l.randomBetween(m.top,a)],Math.floor(4*Math.random())){case 0:p.push({click:f});s.addAsyncStep({action:function(a){l.click(a.xy,a.next)},xy:f});break;case 1:p.push({doubleclick:f});s.addAsyncStep({action:function(a){l.doubleClick(a.xy,a.next)},xy:f});break;case 2:"oncontextmenu"in window?p.push({rightclick:f}):p.push({click:f});s.addAsyncStep({action:function(a){"oncontextmenu"in window?l.rightClick(a.xy,a.next):l.click(a.xy,a.next)},xy:f});break;case 3:var t=[l.randomBetween(m.left,
n),l.randomBetween(m.top,a)];p.push({action:"drag",target:f,to:t});s.addAsyncStep({action:function(a){l.drag(a.dragFrom,a.dragTo,null,a.next)},dragFrom:f,dragTo:t})}var w=!1,y=function(){w=!0;l.nbrExceptions&&l.warn(r.get("monkeyActionLog")+":"+JSON.stringify(p));l.is(l.nbrExceptions,0,c||r.get("monkeyNoExceptions"))};this.on("beforetestfinalizeearly",y);s.run(function(){w||(l.un("beforetestfinalizeearly",y),y());l.processCallbackFromTest(d,null,e||l)})},hasCls:function(a,b,c){var d=Siesta.Resource("Siesta.Test.Element");
a=this.normalizeElement(a);this.$(a).hasClass(b)?this.pass(c,{descTpl:d.get("elementHasClass")+" {cls}",cls:b}):this.fail(c,{assertionName:"hasCls",got:a.className,gotDesc:d.get("elementClasses"),need:b,needDesc:d.get("needClass")})},hasNotCls:function(a,b,c){var d=Siesta.Resource("Siesta.Test.Element");a=this.normalizeElement(a);this.$(a).hasClass(b)?this.fail(c,{assertionName:"hasNotCls",got:a.className,gotDesc:d.get("elementClasses"),annotation:d.get("elementHasClass")+" ["+b+"]"}):this.pass(c,
{descTpl:d.get("elementHasNoClass")+" {cls}",cls:b})},hasStyle:function(a,b,c,d){var e=Siesta.Resource("Siesta.Test.Element");a=this.normalizeElement(a);this.$(a).css(b)===c?this.pass(d,{descTpl:e.get("hasStyleDescTpl"),value:c,property:b}):this.fail(d,{assertionName:"hasStyle",got:this.$(a).css(b),gotDesc:e.get("elementStyles"),need:c,needDesc:e.get("needStyle")})},hasNotStyle:function(a,b,c,d){var e=Siesta.Resource("Siesta.Test.Element");a=this.normalizeElement(a);this.$(a).css(b)!==c?this.pass(d,
{descTpl:e.get("hasNotStyleDescTpl"),value:c,property:b}):this.fail(d,{assertionName:"hasNotStyle",got:a.style.toString(),gotDesc:e.get("elementStyles"),annotation:e.get("hasTheStyle")+" ["+b+"]"})},waitForSelectorAt:function(a,b,c,d,e){var g=Siesta.Resource("Siesta.Test.Element");if(!b)throw g.get("noCssSelector");var f=this;return this.waitFor({method:function(){var c=f.elementFromPoint(a[0],a[1],!0);if(c&&f.$(c).is(b))return c},callback:c,scope:d,timeout:e,assertionName:"waitForSelectorAt",description:" "+
g.get("selector")+' "'+b+'" '+g.get("toAppearAt")+": ["+a.toString()+"]"})},waitForSelectorAtCursor:function(a,b,c,d){return this.waitForSelectorAt(this.currentPosition,a,b,c,d)},waitForSelector:function(a,b,c,d,e){var g=Siesta.Resource("Siesta.Test.Element"),f=this;if(!a)throw g.get("noCssSelector");jQuery.isFunction(b)&&(e=d,d=c,c=b,b=null);b&&(b=this.normalizeElement(b));return this.waitFor({method:function(){var c=f.$(a,b);if(0<c.length)return c},callback:c,scope:d,timeout:e,assertionName:"waitForSelector",
description:" "+g.get("selector")+' "'+a+'" '+g.get("toAppear")})},waitForSelectors:function(a,b,c,d,e){var g=Siesta.Resource("Siesta.Test.Element");if(1>a.length)throw g.get("waitForSelectorsBadInput");jQuery.isFunction(b)&&(e=d,d=c,c=b,b=null);b&&(b=this.normalizeElement(b));var f=this;return this.waitFor({method:function(){var c=!0;Joose.A.each(a,function(a){if(0==f.$(a,b).length)return c=!1});return c},callback:c,scope:d,timeout:e,assertionName:"waitForSelectors",description:" "+g.get("selectors")+
' "'+a+'" '+g.get("toAppear")})},waitForSelectorNotFound:function(a,b,c,d,e){var g=Siesta.Resource("Siesta.Test.Element"),f=this;if(!a)throw"A CSS selector must be supplied";jQuery.isFunction(b)&&(e=d,d=c,c=b,b=null);b&&(b=this.normalizeElement(b));return this.waitFor({method:function(){return 0===f.$(a,b).length},callback:c,scope:d,timeout:e,assertionName:"waitForSelectorNotFound",description:" "+g.get("selector")+' "'+a+'" '+g.get("toDisappear")})},waitForElementVisible:function(a,b,c,d){var e=
Siesta.Resource("Siesta.Test.Element"),g=this;a=this.normalizeElement(a);return this.waitFor({method:function(){return g.isElementVisible(a)&&a},callback:b,scope:c,timeout:d,assertionName:"waitForElementVisible",description:" "+e.get("element")+' "'+a.toString()+'" '+e.get("toAppear")})},waitForElementNotVisible:function(a,b,c,d){a=this.normalizeElement(a);var e=Siesta.Resource("Siesta.Test.Element"),g=this;return this.waitFor({method:function(){return!g.isElementVisible(a)&&a},callback:b,scope:c,
timeout:d,assertionName:"waitForElementNotVisible",description:" "+e.get("element")+' "'+a.toString()+'" '+e.get("toDisappear")})},waitForElementTop:function(a,b,c,d){a=this.normalizeElement(a);var e=Siesta.Resource("Siesta.Test.Element"),g=this;return this.waitFor({method:function(){return g.elementIsTop(a,!0)&&a},callback:b,scope:c,timeout:d,assertionName:"waitForElementTop",description:" "+e.get("element")+' "'+a.toString()+'" '+e.get("toBeTopEl")})},waitForElementNotTop:function(a,b,c,d){a=this.normalizeElement(a);
var e=Siesta.Resource("Siesta.Test.Element"),g=this;return this.waitFor({method:function(){if(!g.elementIsTop(a,!0)){var b=g.findCenter(a);return g.elementFromPoint(b[0],b[1],!0)}},callback:b,scope:c,timeout:d,assertionName:"waitForElementNotTop",description:" "+e.get("element")+' "'+a.toString()+'" '+e.get("toNotBeTopEl")})},elementIsVisible:function(a,b){a=this.normalizeElement(a,!1,!1,!1,{ignoreNonVisible:!1});this.ok(this.isElementVisible(a),b)},elementIsNotVisible:function(a,b){a=this.normalizeElement(a,
!1,!1,!1,{ignoreNonVisible:!1});this.notOk(this.isElementVisible(a),b)},elementIsTop:function(a,b,c){a=this.normalizeElement(a);var d=a.ownerDocument;c=this.getTargetCoordinate(a,!0,c);return(d=d.elementFromPoint(c[0],c[1]))&&(d===a||b&&0<this.$(d).closest(a).length)},elementIsAt:function(a,b,c,d){a=this.normalizeElement(a);var e=this.elementFromPoint(b[0],b[1],!0),g=Siesta.Resource("Siesta.Test.Element");e?c?e===a||0<this.$(e).closest(a).length?this.pass(d,{descTpl:g.get("elementIsAtDescTpl"),x:b[0],
y:b[1]}):this.fail(d,{assertionName:"elementIsAt",got:e,gotDesc:g.get("topElement"),need:a,needDesc:g.get("allowChildrenDesc"),annotation:g.get("allowChildrenAnnotation")}):e===a?this.pass(d,{descTpl:g.get("elementIsAtPassTpl"),x:b[0],y:b[1]}):this.fail(d,{assertionName:"elementIsAt",got:e,gotDesc:g.get("topElement"),need:a,needDesc:"Should be",annotation:g.get("noChildrenFailAnnotation")}):this.fail(d,{assertionName:"elementIsAt",got:{x:b[0],y:b[1]},gotDesc:g.get("Position"),annotation:g.get("noElementAtPosition")})},
elementIsTopElement:function(a,b,c,d){a=this.normalizeElement(a);if(d){var e=this.$(a).offset();d=Siesta.Resource("Siesta.Test.Element");var g=e.top,f=e.left+this.$(a).outerWidth(),l=e.top+this.$(a).outerHeight(),e=e.left;this.elementIsAt(a,[e+1,g+1],b,c+" "+d.get("topLeft"));this.elementIsAt(a,[e+1,l-1],b,c+" "+d.get("bottomLeft"));this.elementIsAt(a,[f-1,g+1],b,c+" "+d.get("topRight"));this.elementIsAt(a,[f-1,l-1],b,c+" "+d.get("bottomRight"))}else this.elementIsAt(a,this.findCenter(a),b,c)},elementIsNotTopElement:function(a,
b,c){a=this.normalizeElement(a);var d=this.findCenter(a);(d=this.elementFromPoint(d[0],d[1],!0))?b?this.ok(d!==a&&0===this.$(d).closest(a).length,c):this.isnt(d,a,c):(a=Siesta.Resource("Siesta.Test.Element"),this.pass(c,{descTpl:a.get("elementIsNotTopElementPassTpl")}))},selectorIsAt:function(a,b,c){var d=Siesta.Resource("Siesta.Test.Element");if(!a)throw d.get("noCssSelector");var e=this.$(this.elementFromPoint(b[0],b[1],!0));0<e.has(a).length||0<e.closest(a).length?this.pass(c,{descTpl:d.get("selectorIsAtPassTpl"),
selector:a,xy:b}):this.fail(c,{got:e[0].outerHTML?e[0].outerHTML:e[0].innerHTML,need:d.get("elementMatching")+" "+a,assertionName:"selectorIsAt",annotation:d.get("selectorIsAtFailAnnotation")+" ["+b+"]"})},selectorExists:function(a,b){var c=Siesta.Resource("Siesta.Test.Element");if(!a)throw c.get("noCssSelector");0>=this.$(a).length?this.fail(b,c.get("selectorExistsFailTpl")+" : "+a):this.pass(b,{descTpl:c.get("selectorExistsPassTpl"),selector:a})},selectorNotExists:function(a,b){var c=Siesta.Resource("Siesta.Test.Element"),
d=this.$(a);0<d.length?this.fail(b,{descTpl:c.get("selectorNotExistsFailTpl")+": "+a,annotation:$.map(d,function(a,b){return b+1+". "+a.className}).join("\r\n")}):this.pass(b,{descTpl:c.get("selectorNotExistsPassTpl"),selector:a})},waitForScrollChange:function(a,b,c,d,e){a=this.normalizeElement(a);var g="scroll"+Joose.S.uppercaseFirst(b),f=a[g];b=Siesta.Resource("Siesta.Test.Element");return this.waitFor({method:function(){if(a[g]!==f)return a[g]},callback:c,scope:d,timeout:e,assertionName:"waitForScrollChange",
description:" "+g+" "+b.get("toChangeForElement")+" "+a.toString()})},waitForScrollLeftChange:function(a,b,c,d){return this.waitForScrollChange(this.normalizeElement(a),"left",b,c,d)},waitForScrollTopChange:function(a,b,c,d){return this.waitForScrollChange(this.normalizeElement(a),"top",b,c,d)},scrollVerticallyTo:function(a,b,c,d){a=this.normalizeElement(a);"Number"!=this.typeOf(c)&&(d=c,c=null);var e=this,g=this.originalSetTimeout,f=this.waitForEvent(a,"scroll",function(){if(0<c){var a=e.beginAsync(c+
100);g(function(){e.endAsync(a);e.processCallbackFromTest(d)},c)}else e.processCallbackFromTest(d)}),l=a.scrollTop;a.scrollTop=b;a.scrollTop==l&&f.force();return a.scrollTop},scrollHorizontallyTo:function(a,b,c,d){a=this.normalizeElement(a);"Number"!=this.typeOf(c)&&(d=c,c=null);var e=this,g=this.originalSetTimeout,f=this.waitForEvent(a,"scroll",function(){if(0<c){var a=e.beginAsync(c+100);g(function(){e.endAsync(a);e.processCallbackFromTest(d)},c)}else e.processCallbackFromTest(d)}),l=a.scrollLeft;
a.scrollLeft=b;a.scrollLeft==l&&f.force();return a.scrollLeft},chainClick:function(){var a=Array.prototype.concat.apply([],arguments),b;"Function"==this.typeOf(a[a.length-1])&&(b=a.pop());var a=Array.prototype.concat.apply([],a),c=[];Joose.A.each(a,function(a){c.push({action:"click",target:a})});var d=this;b&&c.push(function(){d.processCallbackFromTest(b)});this.chain.apply(this,c)},clickSelector:function(a,b,c,d){1<arguments.length&&"Function"==this.typeOf(arguments[1])&&(d=c,c=b,b=null);b&&(b=this.normalizeElement(b));
var e=Joose.A.map(this.$(a,b),function(a){return a});this.chainClick(e,function(){c&&c.call(d||this,e)})},selectorCountIs:function(a,b,c,d){var e=Siesta.Resource("Siesta.Test.Element");if(!a)throw e.get("noCssSelector");"Number"==this.typeOf(b)?(d=c,c=b,b=null):b=this.normalizeElement(b);b=this.$(a,b).length;b!=c?this.fail(d,{assertionName:"selectorCountIs",descTpl:e.get("selectorCountIsFailTpl"),selector:a,got:b,need:c}):this.pass(d,{descTpl:e.get("selectorCountIsPassTpl"),count:c,selector:a})},
isInView:function(a,b){if(this.elementIsInView(a)){var c=Siesta.Resource("Siesta.Test.Element");this.pass(b,{descTpl:c.get("isInViewPassTpl")})}else this.fail(b,{assertionName:"isInView"})},elementIsInView:function(a){a=this.normalizeElement(a);var b=!1,c=this.$(a).offset();if(c)var b=$(this.global).scrollTop(),d=b+$(this.global).height(),c=c.top,b=c+$(a).height()>=b&&c<=d;return b},waitUntilInView:function(a,b,c,d){a=this.normalizeElement(a);var e=this,g=Siesta.Resource("Siesta.Test.Element");this.waitFor({method:function(){return e.elementIsInView(a)&&
a},callback:b,scope:c,timeout:d,assertionName:"waitUntilInView",description:a.toString+" "+g.get("toAppearInTheViewport")})},focus:function(a){var b=a.getAttribute("tabIndex");try{null==b&&a.setAttribute("tabIndex",-1),a.focus()}catch(c){}finally{null==b?a.removeAttribute("tabIndex"):a.setAttribute("tabIndex",b)}},elementIsEmpty:function(a,b){if((a=this.normalizeElement(a))&&this.isElementEmpty(a)){var c=Siesta.Resource("Siesta.Test.Element");this.pass(b,{descTpl:c.get("elementIsEmptyPassTpl")})}else this.fail(b,
{got:a.innerHTML,need:"",assertionName:"elementIsEmpty"})},elementIsNotEmpty:function(a,b){if((a=this.normalizeElement(a))&&!this.isElementEmpty(a)){var c=Siesta.Resource("Siesta.Test.Element");this.pass(b,{descTpl:c.get("elementIsNotEmptyPassTpl")})}else this.fail(b,{assertionName:"elementIsNotEmpty"})},waitForElementEmpty:function(a,b,c,d){var e=this,g=Siesta.Resource("Siesta.Test.Element");a=this.normalizeElement(a);return this.waitFor({method:function(){return e.isElementEmpty(a)},callback:b,
scope:c,timeout:d,assertionName:"waitForElementEmpty",description:" "+g.get("elementToBeEmpty")})},waitForElementNotEmpty:function(a,b,c,d){var e=this,g=Siesta.Resource("Siesta.Test.Element");a=this.normalizeElement(a);return this.waitFor({method:function(){return!e.isElementEmpty(a)},callback:b,scope:c,timeout:d,assertionName:"waitForElementNotEmpty",description:" "+g.get("elementToNotBeEmpty")})},isElementEmpty:function(a){return!a.innerHTML.replace(/^\s+|\s+$/g,"")}}});Class("Siesta.Test.Browser",
{isa:Siesta.Test,does:[Siesta.Test.Simulate.Event,Siesta.Test.Simulate.Mouse,Siesta.Test.Simulate.Touch,Siesta.Test.Simulate.Keyboard,Siesta.Test.Element,Siesta.Test.TextSelection],has:{currentPosition:{init:function(){return[0,0]}},forceDOMVisible:!1,isDOMForced:!1,browserInfo:{lazy:function(){return this.parseBrowser(window.navigator.userAgent)}}},after:{cleanup:function(){this._global=null}},methods:{$:function(){return $.rebindWindowContext(this.global).apply(this.global,arguments)},isEventPrevented:function(a){return"Boolean"==
this.typeOf(a.$defaultPrevented)?a.$defaultPrevented:"Boolean"==this.typeOf(a.defaultPrevented)?a.defaultPrevented:!1===a.returnValue},cleanupContextBeforeStart:function(){this.cleanupContextBeforeStartDom();this.SUPER()},cleanupContextBeforeStartDom:function(){this.global.document.body.innerHTML=""},getElementPageRect:function(a,b){b=b||this.$(a);var c=b.offset();return new Siesta.Util.Rect({left:c.left,top:c.top,width:b.outerWidth(),height:b.outerHeight()})},elementHasScroller:function(a,b){b=b||
this.$(a);var c=a.scrollWidth!=a.clientWidth&&"visible"!=b.css("overflow-x"),d=a.scrollHeight!=a.clientHeight&&"visible"!=b.css("overflow-y");return c||d?{x:c,y:d}:!1},hasForcedIframe:function(){return Boolean((this.isDOMForced||this.forceDOMVisible)&&this.scopeProvider instanceof Scope.Provider.IFrame&&this.scopeProvider.iframe)},elementIsScrolledOut:function(a,b){for(var c=this.$(a),d=[],e=c,g=this.global.document.body;e=e.parent(),e.length&&e[0]!=g;){var f=this.elementHasScroller(e[0],e);f&&d.unshift({hasScroller:f,
$el:e})}f=this.$(g);e=f.offset();e=new Siesta.Util.Rect({left:e.left+f.scrollLeft(),top:e.top+f.scrollTop(),width:this.$(this.global).width(),height:this.$(this.global).height()});for(g=0;g<d.length;g++){var f=d[g].hasScroller,l=d[g].$el;f&&f.x&&(e=e.cropLeftRight(this.getElementPageRect(l[0],l)));if(e.isEmpty())return!0;f&&f.y&&(e=e.cropTopBottom(this.getElementPageRect(l[0],l)));if(e.isEmpty())return!0}d=this.getElementPageRect(c[0],c);f=e.intersect(d);if(f.isEmpty())return!0;b=this.normalizeOffset(b,
c);return!f.contains(d.left+b[0],d.top+b[1])},scrollTargetIntoView:function(a,b){this.elementIsScrolledOut(a,b)&&(a.scrollIntoView(),this.$(a).scrollintoview({duration:0}))},processSubTestConfig:function(){var a=this.SUPERARG(arguments),b=this;Joose.A.each("currentPosition actionDelay afterActionDelay dragDelay moveCursorBetweenPoints dragPrecision overEls".split(" "),function(c){a[c]=b[c]});a.simulateEventsWith=b.getSimulateEventsWith();return a},normalizeElement:function(a,b,c,d){if(a&&a.nodeName)return a;
var e=!1;if("String"===this.typeOf(a)){c=a;var e=this.adjustScope(a),g=this.$(0<=a.indexOf("->")?a.split("->")[1]:a);e&&this.resetScope();a=g[0];e=1<g.length;if(!b&&!a)throw a=Siesta.Resource("Siesta.Test.Browser","noDomElementFound")+": "+c,this.warn(a),a;}"Array"==this.typeOf(a)&&(a=this.elementFromPoint(a[0],a[1]));return d?{el:a,matchingMultiple:e}:a},normalizeActionTarget:function(a,b){return this.normalizeElement(a,b)},getPathBetweenPoints:function(a,b){if("number"!==typeof a[0]||"number"!==
typeof a[1]||"number"!==typeof b[0]||"number"!==typeof b[1]||isNaN(a[0])||isNaN(a[1])||isNaN(b[0])||isNaN(b[1]))throw"Incorrect arguments passed to getPathBetweenPoints";var c=[],d=Math.floor(a[0]),e=Math.floor(b[0]),g=Math.floor(a[1]),f=Math.floor(b[1]),l=Math.abs(e-d),m=Math.abs(f-g),n,p,r,s;n=d<e?1:-1;p=g<f?1:-1;for(r=l-m;d!==e||g!==f;)s=2*r,s>-m&&(r-=m,d+=n),s<l&&(r+=l,g+=p),c.push([d,g]);d=c[c.length-1];0<c.length&&(d[0]!==b[0]||d[1]!==b[1])&&c.push(b.slice());return c},randomBetween:function(a,
b){return Math.round(a+Math.random()*(b-a))},valueIsArray:function(a){return"Array"==this.typeOf(a)},elementFromPoint:function(a,b,c,d,e){var g=this.global.document,f=g.elementFromPoint(a,b);f||(f=g.elementFromPoint(a,b));f=f||d||g.body;d=a;g=b;if("IFRAME"==f.nodeName.toUpperCase()&&!c)try{var l=f.contentWindow.document,m=this.$(f).offset();d=a-m.left;var g=b-m.top,n=l.elementFromPoint(d,g);n||(n=l.elementFromPoint(d,g));n=n||l.body;"HTML"===n.nodeName.toUpperCase()&&(n=l.body);f=n}catch(p){d=a,g=
b}return e?{el:f,localXY:[d,g],globalXY:[a,b]}:f},activeElement:function(a,b,c){c=c?c.ownerDocument||c:this.global.document;var d=c.activeElement;if($(d).is("iframe")&&d.contentDocument&&d.contentDocument.body)d=d.contentDocument.activeElement;else if(!d||!d.nodeName||!d.tagName||d===c.body&&a)d=b;return d},getElementAtCursor:function(){var a=this.currentPosition;return this.elementFromPoint(a[0],a[1])},waitForEvent:function(a,b,c,d,e){var g=!1,f=Siesta.Resource("Siesta.Test.Browser");this.addListenerToObservable(a,
b,function(){g=!0});return this.waitFor({method:function(){return g},callback:c,scope:d,timeout:e,assertionName:"waitForEvent",description:" "+f.get("waitForEvent")+' "'+b+'" '+f.get("event")})},addListenerToObservable:function(a,b,c,d){this.$(a).bind(b,c)},removeListenerFromObservable:function(a,b,c){this.$(a).unbind(b,c)},firesOk:function(a,b,c,d,e,g,f){var l=this,m=l.getSourceLine(),n=Siesta.Resource("Siesta.Test.Browser"),p=arguments.length,r;if(1==p)r=a.observable,b=a.events,p=a.during,g=a.desc||
a.description,f=a.callback,d="Number"==this.typeOf(p)?p:null,e="Function"==this.typeOf(p)?p:null;else if(5<=p)r=a,"String"==this.typeOf(b)&&(p={},p[b]=c,b=p);else if(3>=p&&"Object"==this.typeOf(b))r=a,g=c;else if(4>=p&&"String"==this.typeOf(b))r=a,p={},p[b]=c,b=p,g=d,d=null;else throw Error(n.get("unrecognizedSignature"));var s={},t={};Joose.O.each(b,function(a,b){s[b]=0;var c=t[b]=function(){s[b]++};l.addListenerToObservable(r,b,c)});var w=function(){Joose.O.each(b,function(a,b){l.removeListenerFromObservable(r,
b,t[b]);var c=s[b];l.verifyExpectedNumber(c,a)?l.pass(g,{descTpl:n.get("observableFired")+" "+c+" `"+b+"` "+n.get("events")}):l.fail(g,{assertionName:"firesOk",sourceLine:m,descTpl:n.get("observableFiredOk")+" `"+b+"` "+n.get("events"),got:c,gotDesc:n.get("actualNbrEvents"),need:a,needDesc:n.get("expectedNbrEvents")})})};if(d){var y=this.beginAsync(d+100),p=this.originalSetTimeout;p(function(){l.endAsync(y);w();f&&l.processCallbackFromTest(f)},d)}else if(e)e(),w(),f&&l.processCallbackFromTest(f);
else this.on("beforetestfinalizeearly",w)},willFireNTimes:function(a,b,c,d,e){this.firesOk(a,b,e?">="+c:c,d)},getObjectWithExpectedEvents:function(a,b){var c={};"Array"==this.typeOf(a)?Joose.A.each(a,function(a){c[a]=b}):c[a]=b;return c},wontFire:function(a,b,c){this.firesOk({observable:a,events:this.getObjectWithExpectedEvents(b,0),desc:c})},firesOnce:function(a,b,c){this.firesOk({observable:a,events:this.getObjectWithExpectedEvents(b,1),desc:c})},isntFired:function(){this.wontFire.apply(this,arguments)},
firesAtLeastNTimes:function(a,b,c,d){this.firesOk(a,b,">="+c,d)},isFiredWithSignature:function(a,b,c,d){var e,g=this,f=g.getSourceLine(),l=Siesta.Resource("Siesta.Test.ExtJS.Observable"),m=function(){g.removeListenerFromObservable(a,b,n);e||g.fail(b+" "+l.get("isFiredWithSignatureNotFired"))};g.on("beforetestfinalizeearly",m);var n=function(){g.un("beforetestfinalizeearly",m);var p=c.apply(g,arguments);!e&&p&&g.pass(d||l.get("observableFired")+" "+b+" "+l.get("correctSignature"),{sourceLine:f});p||
(g.fail(d||l.get("observableFired")+" "+b+" "+l.get("incorrectSignature"),{sourceLine:f}),g.removeListenerFromObservable(a,b,n));e=!0};g.addListenerToObservable(a,b,n)},getNormalizedTopElementInfo:function(a,b,c,d){var e,g;a=a||this.currentPosition;var f="Array"==this.typeOf(a);f?(g=a,e=this.elementFromPoint(a[0],a[1],!1,null,!0),a=e.el,e=e.localXY):a=this.normalizeElement(a,b,Boolean(d));if(a||!b){if(!f){var l=Siesta.Resource("Siesta.Test.Browser");c="getNormalizedTopElementInfo: "+(c?l.get("targetElementOfAction")+
" ["+c+"]":l.get("targetElementOfSomeAction"))+" "+l.get("isNotVisible")+": "+(a.id?"#"+a.id:a);if(this.isElementVisible(a))b||this.elementIsTop(a,!0,d)||this.warn(c);else{this.fail(c);return}}if(!f&&(b=a.ownerDocument,l=Siesta.Resource("Siesta.Test.Browser"),e=this.getTargetCoordinate(a,!0,d),g=this.getTargetCoordinate(a,!1,d),a=b.elementFromPoint(e[0],e[1])||b.elementFromPoint(e[0],e[1])||b.body,!a)){this.fail("getNormalizedTopElementInfo: "+l.get("noElementFound")+" ["+e+"]");return}return{el:a,
localXY:e,globalXY:g}}},waitForTextPresent:function(a,b,c,d){var e=Siesta.Resource("Siesta.Test.Browser");return this.waitFor({method:function(){var b=this.global.document.body,c=":contains("+a+")";return 0<this.$(c,b).length||this.$(b).is(c)},callback:b,scope:c,timeout:d,assertionName:"waitForTextPresent",description:" "+e.get("text")+' "'+a+'" '+e.get("toBePresent")})},waitForTextNotPresent:function(a,b,c,d){var e=Siesta.Resource("Siesta.Test.Browser");return this.waitFor({method:function(){var b=
this.global.document.body,c=":contains("+a+")";return 0===this.$(c,b).length&&!this.$(b).is(c)},callback:b,scope:c,timeout:d,assertionName:"waitForTextNotPresent",description:" "+e.get("text")+' "'+a+'" '+e.get("toNotBePresent")})},waitForTarget:function(a,b,c,d,e){var g=this,f=Siesta.Resource("Siesta.Test.Browser");return this.waitFor({method:function(){var b=g.normalizeElement(a,!0);return b&&g.elementIsTop(b,!0,e)},callback:b,scope:c,timeout:d,assertionName:"waitForTarget",description:" "+f.get("target")+
' "'+a+'" '+f.get("toAppear")})},setWindowSize:function(a,b){this.scopeProvider.setViewportSize(a,b)},parseBrowser:function(a){var b="unknown",c="",d;if(d=/Firefox\/((?:\d+\.?)+)/.exec(a))b="Firefox",c=d[1];if(d=/Chrome\/((?:\d+\.?)+)/.exec(a))b="Chrome",c=d[1];if(d=/MSIE\s*((?:\d+\.?)+)/.exec(a))b="IE",c=d[1];a.match(/trident/i)&&(d=/rv.(\d\d\.?\d?)/.exec(a))&&(b="IE",c=d[1]);if(d=/Apple.*Version\/((?:\d+\.?)+)\s*(?=Safari\/((?:\d+\.?)+))/.exec(a))b="Safari",c=d[1]+" ("+d[2]+")";return{name:b,version:c}},
getJUnitClass:function(){var a=this.getBrowserInfo(),a=a.name+a.version;return a+":"+this.SUPER()},adjustScope:function(a){if("String"==this.typeOf(a)&&(a=a.split("->"),2===a.length)){a=this.$(this.trimString(a[0]))[0];if(!a||!a.contentWindow)return!1;this._global=this.global;this.global=a.contentWindow;return!0}return!1},resetScope:function(){this.global=this._global||this.global;this._global=null},screenshot:function(a,b){this.diag("Command: `screenshot` skipped - not running in Standard Package");
b&&b(!1)}}});Class("Siesta.Test.ExtJS",{isa:Siesta.Test.Browser,does:[Siesta.Test.ExtJSCore,Siesta.Test.ExtJS.Component,Siesta.Test.ExtJS.Element,Siesta.Test.ExtJS.FormField,Siesta.Test.ExtJS.Observable,Siesta.Test.ExtJS.Store,Siesta.Test.ExtJS.Grid,Siesta.Test.ExtJS.DataView,Siesta.Test.ExtJS.Ajax],has:{globalExtOverrides:null,extPathRegex1:/(.*ext(?:js)?(?:-\d\.\d+\.\d+)?.*?)\/(?:build\/)?ext(?:-all)?(?:-debug|-dev)?\.js/,extPathRegex2:/(.*ext(?:js)?-\d\.\d+(?:\.\d+)?.*?)\/ext-all(?:-debug|-dev)?\.js/,
extPathRegex3:/(.*ext(?:js)?\/gpl\/\d\.\d+(?:\.\d+)?.*?)\/ext-all(?:-debug|-dev)?\.js/},methods:{getExtBundlePath:function(){for(var a,b=this.harness.getScriptDescriptor(this.url),c=this;b&&!a;)b.preload&&Joose.A.each(b.preload,function(b){if(b.match&&(b.match(c.extPathRegex1)||b.match(c.extPathRegex2)||c.extPathRegex3.exec(b)))return a=b,!1}),b=b.parent;return a},getExtBundleFolder:function(){for(var a,b=this.harness.getScriptDescriptor(this.url),c=this;b&&!a;)b.preload&&Joose.A.each(b.preload,function(b){(b=
c.extPathRegex1.exec(b)||c.extPathRegex2.exec(b)||c.extPathRegex3.exec(b))&&(a=b[1]);return!1}),b=b.parent;return a},getNumberOfGlobalExtOverrides:function(a){var b=this.globalExtOverrides;if(null!=b)a&&a.call(this,b.length,b);else{var c=this,d=this.getExt();if(b=c.getExtBundlePath()){this.expectGlobal("0");var e=d.core.DomHelper.append(d.getBody(),{tag:"iframe",style:"width:0;height:0"},!1),g=e.contentWindow;g.document.open();g.document.write('<html><head><script type="text/javascript" src="'+b+
'">\x3c/script></head><body></body></html>');g.document.close();var f=function(a,b){for(var c=b.split("."),d=a,e=0;e<c.length;e++)d=d[c[e]];return d},l=function(a,b,c){var e=[],g;for(g in b)try{b.hasOwnProperty(g)&&(!a.hasOwnProperty(g)&&"undefined"==typeof a[g]||"function"==typeof b[g]&&a[g].toString()!==b[g].toString()||d.isPrimitive(b[g])&&b[g].toString()!==a[g].toString())&&((c+"."+g).match(/Ext\.data\.Store\.ImplicitModel|collectorThreadId|Ext\.dom\.GarbageCollector\.lastTime/)||e.push(c+"."+
g))}catch(f){}return e};c.waitFor(function(){return g.Ext&&g.Ext.isReady},function(){var b=c.global,n=[];d.iterate(d.ClassManager.classes,function(a){if(a.match(/^Ext\./)){var c=f(g,a),d=f(b,a);if(c&&"undefined"!==typeof d){var e=l(c,d,a);n.push.apply(n,e);d.prototype&&(a=l(c.prototype,d.prototype,a+".prototype"),n.push.apply(n,a))}}});c.globalExtOverrides=n;d.destroy(e);a&&a.call(c,n.length,n)})}else c.fail(Siesta.Resource("Siesta.Test.ExtJS","bundleUrlNotFound")),a&&a.call(c,null,null)}},assertNoGlobalExtOverrides:function(a,
b){this.getNumberOfGlobalExtOverrides(function(c,d){var e=Siesta.Resource("Siesta.Test.ExtJS");null==c?this.fail(e.get("assertNoGlobalExtOverridesInvalid")):(c?this.fail(a,{assertionName:"assertNoGlobalExtOverrides",descTpl:e.get("assertNoGlobalExtOverridesPassTpl"),got:c,gotDesc:e.get("assertNoGlobalExtOverridesGotDesc"),annotation:e.get("foundOverridesFor")+": `"+d.join("`, `")+"`"}):this.pass(a,{descTpl:e.get("assertNoGlobalExtOverridesPassTpl")}),b&&b.call(this))})},assertMaxNumberOfGlobalExtOverrides:function(a,
b,c){var d=Siesta.Resource("Siesta.Test.ExtJS");this.getNumberOfGlobalExtOverrides(function(e,g){null==e?this.fail(d.get("extOverridesInvalid")):(e>a?this.fail(b,{assertionName:"assertNoGlobalExtOverrides",descTpl:d.get("foundLessOrEqualThan")+" "+a+" "+d.get("globalOverrides"),got:e,gotDesc:d.get("nbrOverridesFound"),annotation:d.get("foundOverridesFor")+": `"+g.join("`, `")+"`"}):this.pass(b,{descTpl:d.get("foundLessOrEqualThan")+" "+a+" "+d.get("globalOverrides"),annotation:d.get("nbrOverridesFound")+
": "+e}),c&&c.call(this))})},getTotalLayoutCounter:function(){var a=0;this.Ext().each(this.cq("container"),function(b){a+=b.layoutCounter});return a},assertNoLayoutTriggered:function(a,b,c){var d=this.getTotalLayoutCounter();a.call(b||this);this.is(this.getTotalLayoutCounter(),d,c)},waitForAnimations:function(a,b,c){var d=this.Ext(),e=Siesta.Resource("Siesta.Test.ExtJS");return this.waitFor({method:function(){return!d||!d.fx||!d.fx.Manager.items||0===d.fx.Manager.items.getCount()},callback:a,scope:b,
timeout:c,assertionName:"waitForAnimations",description:" "+e.get("animationsToFinalize")})}}});Class("Siesta.Test.SenchaTouch",{isa:Siesta.Test.Browser,does:[Siesta.Test.ExtJSCore,Siesta.Test.ExtJS.Component,Siesta.Test.ExtJS.Element,Siesta.Test.ExtJS.Observable,Siesta.Test.ExtJS.Store,Siesta.Test.ExtJS.Ajax],has:{performSetup:!0,isSTSetupDone:!1,moveCursorBetweenPoints:!1},override:{isReady:function(){var a=this.SUPERARG(arguments),b=Siesta.Resource("Siesta.Test.SenchaTouch");return a.ready?this.parent||
!this.performSetup||this.isSTSetupDone?{ready:!0}:{ready:!1,reason:b.get("STSetupFailed")}:a},start:function(){var a=this,b=this.getExt();b&&(this.SUPERARG(arguments),this.performSetup&&!this.parent&&b.setup({onReady:function(){a.isSTSetupDone=!0}}))}},methods:{getTouchBundlePath:function(){for(var a,b=this.harness.getScriptDescriptor(this.url);b&&!a;)b.preload&&Joose.A.each(b.preload,function(b){if(b.match&&b.match(/(.*sencha-touch-\d\.\d+\.\d+.*?)\/sencha-touch(.*)\.js/))return a=b,!1}),b=b.parent;
return a},getTouchBundleFolder:function(){for(var a,b=this.harness.getScriptDescriptor(this.url);b&&!a;)b.preload&&Joose.A.each(b.preload,function(b){(b=/(.*sencha-touch-\d\.\d+\.\d+.*?)\/sencha-touch(.*)\.js/.exec(b))&&(a=b[1])}),b=b.parent;return a},getExtBundleFolder:function(){var a;this.harness.mainPreset.eachResource(function(b){b=b.asDescriptor();(b=/(.*sencha-touch-\d\.\d+\.\d+.*?)\/sencha-touch-all(?:-debug)?\.js/.exec(b.url))&&(a=b[1])});return a},moveFingerTo:function(a,b,c,d){this.moveCursorTo.apply(this,
arguments)},moveFingerBy:function(a,b,c){if(!a)throw Siesta.Resource("Siesta.Test.SenchaTouch").get("moveFingerByInvalidInput");this.moveCursorBy.apply(this,arguments)},scrollUntil:function(a,b,c,d,e){var g=this,f=new Date,l=b,m=Siesta.Resource("Siesta.Test.SenchaTouch");switch(l){case "u":case "up":b="down";break;case "d":case "down":b="up";break;case "l":case "left":b="right";break;case "r":case "right":b="left";break;default:throw m.get("invalidSwipeDir")+": "+b;}var n=function(){c.call(e||g,a)?
g.processCallbackFromTest(d,null,e||g):g.swipe(a,b,function(){if(new Date-f<this.waitForTimeout){var a=g.beginAsync();setTimeout(function(){g.endAsync(a);n()},1E3)}else g.fail(m.get("scrollUntilFailed"))})};n()},scrollUntilElementVisible:function(a,b,c,d,e){var g=this;c&&a?this.scrollUntil(a,b,function(){var a=g.normalizeElement(c,!0);return g.elementIsInView(a)},d,e):(a=Siesta.Resource("Siesta.Test.SenchaTouch"),this.fail(a.get("scrollUntilElementVisibleInvalid")))},waitForScrollerPosition:function(a,
b,c,d,e){return this.waitFor({method:function(){return(!("x"in b)||b.x===a.position.x)&&(!("y"in b)||b.y===a.position.y)},callback:c,scope:d,timeout:e,assertionName:"waitForScrollerPosition",description:" "+Siesta.Resource("Siesta.Test.SenchaTouch","scrollerReachPos")+" "+Siesta.Util.Serializer.stringify(b)})},waitForAnimations:function(a,b,c){var d=this.Ext();return this.waitFor({method:function(){return!d.AnimationQueue.isRunning},callback:a,scope:b,timeout:c,assertionName:"waitForAnimations",description:Siesta.Resource("Siesta.Test.ExtJS",
"animationsToFinalize")})}}});Class("Siesta.Test.jQuery",{isa:Siesta.Test.Browser,methods:{initialize:function(){this.expectGlobals("$","jQuery");this.SUPER()},get$:function(){return this.global.$},normalizeElement:function(a){return a.jquery?a.get(0):this.SUPERARG(arguments)}}});Class("Siesta.Content.Manager.Browser",{isa:Siesta.Content.Manager,has:{},methods:{load:function(a,b,c){var d=new JooseX.SimpleRequest;try{d.getText(a,!0,function(a,d){a?b(d):c(this+" not found")})}catch(e){c(e)}}}});Class("Siesta.Content.Manager.Browser.ExtJSCore",
{isa:Siesta.Content.Manager.Browser});Class("Siesta.Harness.Browser",{my:{isa:Siesta.Harness,has:{id:null,testClass:Siesta.Test.Browser,viewportClass:"Siesta.Harness.Browser.UI.Viewport",viewport:null,autoRun:!1,viewDOM:!1,speedRun:!0,breakOnFail:!1,debuggerOnFail:!1,contentManagerClass:Siesta.Content.Manager.Browser,scopeProvider:"Scope.Provider.IFrame",disableCaching:!1,baseUrl:window.location.href.replace(/\?.*$/,"").replace(/\/[^/]*$/,"/"),baseHost:window.location.host,baseProtocol:window.location.protocol,
forceDOMVisible:$.browser.msie,runInPopup:!1,hostPageUrl:null,useStrictMode:!0,sandbox:!0,sandboxBoundaryByGroup:!1,sandboxCleanup:!0,uniqueCounter:0,valueToHashIndicies:Joose.I.Object,sandboxHashStructure:{lazy:"this.buildSandboxHashStructure"},runCore:"parallel",forcedRunCore:null,simulateEventsWith:{is:"rw",init:"dispatchEvent"},testOfForcedIFrame:null,autoScrollElementsIntoView:!0,enableUnreachableClickWarning:!0,maintainViewportSize:!0,viewportWidth:1024,viewportHeight:768,recorderConfig:null,
needUI:!0,isAutomated:!1,stateful:!0,uiMask:null,uiMaskActive:!1},after:{onBeforeScopePreload:function(a,b){if(this.viewport)this.viewport.onBeforeScopePreload(a,b)},onTestSuiteStart:function(a,b){if(this.viewport)this.viewport.onTestSuiteStart(a,b)},onTestSuiteEnd:function(a,b){if(this.viewport)this.viewport.onTestSuiteEnd(a,b);delete this.testOfForcedIFrame;this.uiMaskActive&&this.hideUiMask()},onTestStart:function(a){if(this.viewport)this.viewport.onTestStart(a);a.hasForcedIframe()?(this.testOfForcedIFrame&&
this.hideForcedIFrame(this.testOfForcedIFrame),this.showForcedIFrame(a),this.testOfForcedIFrame=a):this.uiMaskActive&&this.hideUiMask()},onTestUpdate:function(a,b,c){if(this.viewport)this.viewport.onTestUpdate(a,b,c);b instanceof Siesta.Result.Diagnostic&&b.isWarning&&this.needUI&&"undefined"!=typeof console&&console.warn&&console.warn(b+"")},onTestEnd:function(a){a.hasForcedIframe()&&this.hideForcedIFrame(a);a==this.testOfForcedIFrame&&(this.testOfForcedIFrame=null);if(this.viewport)this.viewport.onTestEnd(a);
if(a=a.scopeProvider.wrapper)a.scrollLeft=a.scrollTop=0},onTestFail:function(a,b,c){if(this.viewport)this.viewport.onTestFail(a,b,c)}},methods:{buildSandboxHashStructure:function(){return["preload","alsoPreload","hostPageUrl","useStrictMode","overrideSetTimeout"]},createViewport:function(a){return Ext.create("Siesta.Harness.Browser.UI.Viewport",a)},canShowCursorForTest:function(a){return a.scopeProvider instanceof Scope.Provider.IFrame?this.testOfForcedIFrame?this.testOfForcedIFrame.isFromTheSameGeneration(a):
Boolean(a.scopeProvider.wrapper):!1},configure:function(){this.SUPERARG(arguments);this.id=this.title||window.location.href},start:function(){$.browser.opera&&(this.autoCheckGlobals=!1);$.browser.msie&&"9.0"!==$.browser.version&&!this.hasOwnProperty("runCore")&&(this.runCore="sequential");this.SUPERARG(arguments)},launch:function(){var a=this,b=arguments,c=this.SUPER;if(this.needUI&&!this.viewport){var d=function(){a.viewport=a.createViewport({title:a.title,harness:a});a.isAutomated&&c.apply(a,b)};
if(Ext.setup)Ext.setup({onReady:d});else Ext.onReady(d)}else this.SUPERARG(arguments)},populateCleanScopeGlobals:function(a,b){$.browser.msie&&9>Number(/^(\d+)/.exec($.browser.version)[1])?(this.disableGlobalsCheck=!0,b()):this.SUPER("Scope.Provider.IFrame",b)},onUnload:function(){Joose.O.each(this.scopesByURL,function(a,b){a instanceof Scope.Provider.Window&&a.cleanup()})},setup:function(a){var b=this,c=this.SUPER;window.onunload=function(){b.onUnload()};window.focus();if(this.isAutomated)$(function(){Siesta.Harness.Browser.FeatureSupport();
c.call(b,a)});else Ext.onReady(function(){Siesta.Harness.Browser.FeatureSupport();c.call(b,a)})},getDescriptorConfig:function(a,b,c){if("preload"!=b)return this.SUPERARG(arguments);var d=a.testConfig,d=d&&d.hasOwnProperty("preload")||a.hasOwnProperty("preload"),e=this.lookUpValueInDescriptorTree(a,"preload");if(Boolean(this.getDescriptorConfig(a,"hostPageUrl",!0))&&"inherit"!=e)return d?e:[];do{if((e=(d=a.testConfig)&&d.hasOwnProperty("preload"))||a.hasOwnProperty("preload"))if(d=e?d.preload:a.preload,
"inherit"!=d)return d;a=a.parent}while(a&&a!=this);return c?void 0:this.preload},normalizeScopeProvider:function(a){this.SUPERARG(arguments);this.getDescriptorConfig(a,"runInPopup")&&(a.scopeProvider="Scope.Provider.Window")},getScopeProviderConfigFor:function(a,b){var c=this.SUPERARG(arguments);c.name=a.title||a.url.replace(/(.*\/)?(.*)/,"$2");c.cls="tr-iframe";c.performWrap=!0;c.wrapCls="tr-iframe-wrapper";c.sourceURL=c.sourceURL||this.getDescriptorConfig(a,"hostPageUrl");c.minViewportSize=c.minViewportSize||
{width:this.getDescriptorConfig(a,"viewportWidth"),height:this.getDescriptorConfig(a,"viewportHeight")};c.hasOwnProperty("useStrictMode")||(c.useStrictMode=this.getDescriptorConfig(a,"useStrictMode"));return c},getNewTestConfiguration:function(a,b,c,d){var e=this.SUPERARG(arguments);this.getDescriptorConfig(a,"speedRun")&&Joose.O.extend(e,{actionDelay:1,dragPrecision:20,dragDelay:10});this.hasOwnProperty("simulateEventsWith")&&(e.simulateEventsWith=this.simulateEventsWith);e.forceDOMVisible=this.getDescriptorConfig(a,
"forceDOMVisible");e.autoScrollElementsIntoView=this.getDescriptorConfig(a,"autoScrollElementsIntoView");e.enableUnreachableClickWarning=this.getDescriptorConfig(a,"enableUnreachableClickWarning");return e},assignUniqueTag:function(a,b){if(null==a)return"";if(a===Object(a))return a.__UNIQUE__?a.__UNIQUE__:a.__UNIQUE__=(this.uniqueCounter++).toString(36);a+="";var c=this.valueToHashIndicies[b];c||(c=this.valueToHashIndicies[b]={});return c[a]?c[a]:c[a]=(this.uniqueCounter++).toString(36)},calculateSharedContextGroupHash:function(a){var b=
this,c=this.getSandboxHashStructure(),d="";Joose.A.each(c,function(c){d+=b.assignUniqueTag(b.getDescriptorConfig(a,c),c)});this.sandboxBoundaryByGroup&&(d+=this.assignUniqueTag(a.parent));return d},runCoreGeneral:function(a,b,c,d){var e=this,g=[],f=[],l=[],m={},n=this.forcedRunCore;Joose.A.each(a,function(a){if(e.getDescriptorConfig(a,"sandbox"))"sequential"==(n||e.getDescriptorConfig(a,"runCore"))||e.getDescriptorConfig(a,"forceDOMVisible")?f.push(a):g.push(a);else{var b=e.calculateSharedContextGroupHash(a),
c=m[b];c||(c=m[b]={groupHash:b,items:[]},l.push(c));c.items.push(a)}});e.runCoreSharedContext(l,b,c,function(){e.runCoreParallel(g,b,c,function(){e.runCoreSequential(f,b,c,d)})})},runCoreSharedContext:function(a,b,c,d){var e=this,g=function(d,m,n){if(d.length){var p=d.shift(),r=0<d.length;m?e.processURL(p,p.index,b,c,function(){g(d,!1,e.scopesByURL[p.url])},r):e.processUrlShared(p,p.index,b,c,function(){g(d,!1,n)},r,n)}else f(a)},f=function(a){a.length?(a=a.shift(),g(a.items,!0)):d()};f(a)},processUrlShared:function(a,
b,c,d,e,g,f){function l(){if(f.scope){var b=m.getDescriptorConfig(a,"testClass");"String"==m.typeOf(b)&&(b=Joose.S.strToClass(b));var l=m.getNewTestConfiguration(a,f,c,d);n.test=new b(l);m.launchTest({testHolder:n,desc:a,scopeProvider:f,contentManager:c,launchOptions:d,preloadErrors:p,onErrorHandler:r,startTestAnchor:f.scope.StartTest,noCleanup:g,reusingSandbox:!0},e)}else e()}var m=this;if(a.isMissing)e();else{var n={},p=[];b=this.getDescriptorConfig(a,"transparentEx");var r=function(a,b,c,d,e){(d=
n.test)&&d.isStarted()?(d.nbrExceptions++,d.failWithException(e||a+" "+b+" "+c)):p.push(a+" "+b+" "+c)};f.addOnErrorHandler(r,!b);a.testCode||this.cachePreload&&c.hasContentOf(a.url)?f.runCode(a.testCode||c.getContentOf(a.url),l):f.runScript(this.resolveURL(a.url,f,a),l)}},normalizeURL:function(a){/^jsan:/.test(a)&&(a="/jsan/"+a.replace(/^jsan:/,"").replace(/\./g,"/")+".js");/\.js$/.test(a)||(/\//.test(a)||/\.css(\?.*)?$/i.test(a))||(a="../lib/"+a.replace(/\./g,"/")+".js");return a},normalizeDescriptor:function(a,
b,c,d){a=this.SUPERARG(arguments);!a.group&&a.jasmine&&(a.hostPageUrl=a.url,a.testCode=this.getJasmineTestCode(),a.preload=[]);return a},resolveURL:function(a,b,c){b&&b.sourceURL&&(a=this.absolutizeURL(a));this.disableCaching&&(/\?./.test(a)?a+="&disableCaching="+(new Date).getTime():/\?$/.test(a)||(a+="?disableCaching="+(new Date).getTime()));return a},absolutizeURL:function(a,b){if(/^((https?|file):)?\/\//.test(a))return a;if(/^\//.test(a))return this.baseProtocol+"//"+this.baseHost+a;b=b||this.baseUrl;
b=b.replace(/\?.*$/,"").replace(/\/[^/]*$/,"/");var c=this.absolutizeURL(b,this.baseUrl),c=c.replace(/\/?$/,"/");return c+a},getUiMask:function(){if(this.uiMask)return this.uiMask;var a=this.uiMask=document.createElement("div");a.className="tr-ui-mask";a.style.display="none";document.body.appendChild(a);return a},showUiMask:function(){this.getUiMask().style.display="block";this.uiMaskActive=!0},hideUiMask:function(){this.getUiMask().style.display="none";this.uiMaskActive=!1},showForcedIFrame:function(a){$.rebindWindowContext(window);
a.isDOMForced=!0;var b=a.scopeProvider.wrapper;$(b).addClass("tr-iframe-forced");$(b).removeClass("tr-iframe-hidden");$(b).center();a.fireEvent("testframeshow")},hideForcedIFrame:function(a){$.rebindWindowContext(window);a.isDOMForced=!1;var b=a.scopeProvider.wrapper;$(b).removeClass("tr-iframe-forced");$(b).addClass("tr-iframe-hidden");a.fireEvent("testframehide")},showForcedIFrameScreenshot:function(a){this.showUiMask();$.rebindWindowContext(window);var b=a.scopeProvider.wrapper;$(b).addClass("tr-iframe-forced-screenshot");
$(b).removeClass("tr-iframe-forced");$(b).removeClass("tr-iframe-hidden");a.fireEvent("testframeshow")},hideForcedIFrameScreenshot:function(a){this.hideUiMask();$.rebindWindowContext(window);var b=a.scopeProvider.wrapper;$(b).removeClass("tr-iframe-forced-screenshot");a.isDOMForced&&($(b).addClass("tr-iframe-forced"),$(b).center());a.fireEvent("testframehide")},getQueryParam:function(a){return(a=RegExp("(?:\\?|&)"+a+"=(.*?)(?:\\?|&|$)","i").exec(window.location.search))?a[1]:null},getJasmineTestCode:function(){return";("+
function(){StartTest(function(a){a.expectGlobals("getJasmineRequireObj","jasmineRequire","jasmine","xdescribe","describe","xdescribe","fdescribe","it","xit","fit","spyOn","fail","jsApiReporter","beforeEach","afterEach","beforeAll","afterAll","expect","pending");window.jasmine?jasmine.SiestaReporter?jasmine.SiestaReporter.importResults(a):a.fail(a.resource("Siesta.Harness.Browser","noJasmineSiestaReporter")):a.fail(a.resource("Siesta.Harness.Browser","noJasmine"))})}.toString()+")();"},isStandardPackage:function(){return Boolean(Siesta.Harness.Browser.Automation)}}}});
Singleton("Siesta.Harness.Browser.FeatureSupport",{has:{supports:Joose.I.Object,simulator:null,tests:{init:[{id:"mouseEnterLeave",fn:function(){var a=document.createElement("div");return"onmouseenter"in a&&"onmouseleave"in a}},{id:"enterOnAnchorTriggersClick",fn:function(){var a=this.simulator,b=Siesta.Test.Simulate.KeyCodes().keys.ENTER,c=!1,d=$('<a href="foo" style="display:none">test me</a>');$("body").append(d);d.focus();d.click(function(a){c=!0;return!1});a.simulateEvent(d,"keypress",{keyCode:b,
charCode:0},!0);d.remove();return c}},{id:"canSimulateKeyCharacters",fn:function(){var a=this.simulator,b=$('<input class="siesta-hidden" type="text" />'),c=Siesta.Test.Simulate.KeyCodes().keys.A;$("body").append(b);b.focus();a.simulateEvent(b,"keypress",{keyCode:c,charCode:c},!0);a.simulateEvent(b,"textInput",{text:"A"},!0);a="A"===b.val();b.remove();return a}},{id:"canSimulateBackspace",fn:function(){var a=this.simulator,b=$('<input class="siesta-hidden" type="text" />'),c=Siesta.Test.Simulate.KeyCodes().keys.BACKSPACE,
d=Siesta.Test.Simulate.KeyCodes().keys.A;$("body").append(b);b.focus();a.simulateEvent(b,"keypress",{keyCode:d,charCode:d},!0);a.simulateEvent(b,"keypress",{keyCode:d,charCode:d},!0);a.simulateEvent(b,"keypress",{keyCode:c,charCode:c},!0);a="A"===b.val();b.remove();return a}},{id:"enterSubmitsForm",fn:function(){var a=this.simulator,b=Siesta.Test.Simulate.KeyCodes().keys.ENTER,c=!1,d=$('<form method="post"><input type="text"/></form>'),e=$(d).find("input");$("body").append(d);d[0].onsubmit=function(a){c=
!0;return!1};e.focus();a.simulateEvent(e,"keypress",{keyCode:b,charCode:0},!0);d.remove();return c}},{id:"imageWithIdCreatesGlobalEnumerable",fn:function(){var a=$('<img id="test_img_id"/>');$("body").append(a);var b=!1,c;for(c in window)"test_img_id"==c&&(b=!0);a.remove();return b}},{id:"TouchEvents",fn:function(){return this.isEventSupported("touchend",window)}},{id:"PointerEvents",fn:function(){return this.isEventSupported("pointerdown")}},{id:"MSPointerEvents",fn:function(){return this.isEventSupported("mspointerdown")}}]}},
methods:{initialize:function(){var a=function(){};this.simulator=new (Class({does:[Siesta.Util.Role.CanGetType,Siesta.Test.Simulate.Event,Siesta.Test.Simulate.Mouse,Siesta.Test.Simulate.Keyboard],has:{global:null},methods:{focusOnClick:a,getElementAtCursor:a,fireEvent:a,addResult:a,normalizeElement:function(a){return a[0]},findCenter:function(){return[0,0]},valueIsArray:function(a){return"length"in a}}}))({global:window});for(a=0;a<this.tests.length;a++){var b=this.tests[a];this.supports[b.id]=b.fn.call(this)}},
isEventSupported:function(a,b){var c;if(!a)return!1;b&&"string"!==typeof b||(b=document.createElement(b||"div"));a="on"+a;c=a in b;c||(b.setAttribute||(b=document.createElement("div")),b.setAttribute(a,""),c="function"===typeof b[a],void 0!==b[a]&&(b[a]=void 0),b.removeAttribute(a));return c}}});Role("Siesta.Harness.Browser.ExtJSCore",{has:{loaderPath:null,requires:null,failKnownBugIn:!1},override:{getNewTestConfiguration:function(a,b,c,d){var e=this.SUPERARG(arguments);e.loaderPath=this.getDescriptorConfig(a,
"loaderPath");e.requires=this.getDescriptorConfig(a,"requires");return e},buildSandboxHashStructure:function(){var a=this.SUPERARG(arguments);a.push("loaderPath","requires");return a}},methods:{createViewport:function(a){return Ext.create("Siesta.Harness.Browser.UI.Viewport",a)},generateLoaderPathHook:function(){return function(a,b,c){c&&(!a.loaderPathHookInstalled&&b&&b.Loader&&b.Loader.setPath)&&(a.loaderPathHookInstalled=!0,b.Loader.setPath(c))}},getLoaderPathHook:function(){return";("+function(a){var b=
(window.opener||window.parent).Siesta.my.activeHarness;eval("("+a+")")(StartTest,Ext,b.getDescriptorConfig(b.getScriptDescriptor(StartTest.id),"loaderPath"))}.toString()+")("+JSON.stringify(this.generateLoaderPathHook().toString())+")"}}});Class("Siesta.Harness.Browser.ExtJS",{isa:Siesta.Harness.Browser,my:{does:[Siesta.Harness.Browser.ExtJSCore],has:{testClass:Siesta.Test.ExtJS,waitForExtReady:!0,waitForAppReady:!1,extVersion:null,failOnMultipleComponentMatches:!1,extVersionRegExp:/ext(?:js)?-(\d\.\d+\.\d+.*?)\//,
contentManagerClass:Siesta.Content.Manager.Browser.ExtJSCore},methods:{setup:function(a){Function.prototype.$extIsFunction=!0;this.SUPER(function(){a()})},getNewTestConfiguration:function(a,b,c,d){var e=this.SUPERARG(arguments);e.waitForExtReady=this.getDescriptorConfig(a,"waitForExtReady");e.waitForAppReady=this.getDescriptorConfig(a,"waitForAppReady");return e},findExtVersion:function(){var a=this,b;this.mainPreset.eachResource(function(c){if(c=a.extVersionRegExp.exec(c.url))return b=c[1],!1});
return b}}}});Class("Siesta.Harness.Browser.SenchaTouch",{isa:Siesta.Harness.Browser,my:{does:[Siesta.Harness.Browser.ExtJSCore],has:{testClass:Siesta.Test.SenchaTouch,transparentEx:!0,keepNLastResults:0,performSetup:!0,forcedRunCore:"sequential",isRunningOnMobile:!0,contentManagerClass:Siesta.Content.Manager.Browser.ExtJSCore},methods:{setup:function(){this.isRunningOnMobile="undefined"!==typeof Ext&&Ext.getVersion&&Ext.getVersion("touch");this.isRunningOnMobile||(this.keepNLastResults=2);this.SUPERARG(arguments)},
getNewTestConfiguration:function(a,b,c,d){var e=this.SUPERARG(arguments),g=this.getDescriptorConfig(a,"hostPageUrl");!a.hasOwnProperty("performSetup")&&g?e.performSetup=!1:e.performSetup=this.getDescriptorConfig(a,"performSetup");return e}}}});"undefined"!==typeof Ext&&(Ext.versions&&Ext.versions.extjs&&Ext.versions.extjs.isGreaterThan("5"))&&(eval(function(a,b,c,d,e,g){e=function(a){return(a<b?"":e(parseInt(a/b)))+(35<(a%=b)?String.fromCharCode(a+29):a.toString(36))};if(!"".replace(/^/,String)){for(;c--;)g[e(c)]=
d[c]||e(c);d=[function(a){return g[a]}];e=function(){return"\\w+"};c=1}for(;c--;)d[c]&&(a=a.replace(RegExp("\\b"+e(c)+"\\b","g"),d[c]));return a}('K M;I(M)1S 2U("2a\'t 4k M 4K 2g 3l 4G 4H");(6(){6 r(f,e){I(!M.1R(f))1S 3m("3s 15 4R");K a=f.1w;f=M(f.1m,t(f)+(e||""));I(a)f.1w={1m:a.1m,19:a.19?a.19.1a(0):N};H f}6 t(f){H(f.1J?"g":"")+(f.4s?"i":"")+(f.4p?"m":"")+(f.4v?"x":"")+(f.3n?"y":"")}6 B(f,e,a,b){K c=u.L,d,h,g;v=R;5K{O(;c--;){g=u[c];I(a&g.3r&&(!g.2p||g.2p.W(b))){g.2q.12=e;I((h=g.2q.X(f))&&h.P===e){d={3k:g.2b.W(b,h,a),1C:h};1N}}}}5v(i){1S i}5q{v=11}H d}6 p(f,e,a){I(3b.Z.1i)H f.1i(e,a);O(a=a||0;a<f.L;a++)I(f[a]===e)H a;H-1}M=6(f,e){K a=[],b=M.1B,c=0,d,h;I(M.1R(f)){I(e!==1d)1S 3m("2a\'t 5r 5I 5F 5B 5C 15 5E 5p");H r(f)}I(v)1S 2U("2a\'t W 3l M 59 5m 5g 5x 5i");e=e||"";O(d={2N:11,19:[],2K:6(g){H e.1i(g)>-1},3d:6(g){e+=g}};c<f.L;)I(h=B(f,c,b,d)){a.U(h.3k);c+=h.1C[0].L||1}Y I(h=n.X.W(z[b],f.1a(c))){a.U(h[0]);c+=h[0].L}Y{h=f.3a(c);I(h==="[")b=M.2I;Y I(h==="]")b=M.1B;a.U(h);c++}a=15(a.1K(""),n.Q.W(e,w,""));a.1w={1m:f,19:d.2N?d.19:N};H a};M.3v="1.5.0";M.2I=1;M.1B=2;K C=/\\$(?:(\\d\\d?|[$&`\'])|{([$\\w]+)})/g,w=/[^5h]+|([\\s\\S])(?=[\\s\\S]*\\1)/g,A=/^(?:[?*+]|{\\d+(?:,\\d*)?})\\??/,v=11,u=[],n={X:15.Z.X,1A:15.Z.1A,1C:1r.Z.1C,Q:1r.Z.Q,1e:1r.Z.1e},x=n.X.W(/()??/,"")[1]===1d,D=6(){K f=/^/g;n.1A.W(f,"");H!f.12}(),y=6(){K f=/x/g;n.Q.W("x",f,"");H!f.12}(),E=15.Z.3n!==1d,z={};z[M.2I]=/^(?:\\\\(?:[0-3][0-7]{0,2}|[4-7][0-7]?|x[\\29-26-f]{2}|u[\\29-26-f]{4}|c[A-3o-z]|[\\s\\S]))/;z[M.1B]=/^(?:\\\\(?:0(?:[0-3][0-7]{0,2}|[4-7][0-7]?)?|[1-9]\\d*|x[\\29-26-f]{2}|u[\\29-26-f]{4}|c[A-3o-z]|[\\s\\S])|\\(\\?[:=!]|[?*+]\\?|{\\d+(?:,\\d*)?}\\??)/;M.1h=6(f,e,a,b){u.U({2q:r(f,"g"+(E?"y":"")),2b:e,3r:a||M.1B,2p:b||N})};M.2n=6(f,e){K a=f+"/"+(e||"");H M.2n[a]||(M.2n[a]=M(f,e))};M.3c=6(f){H r(f,"g")};M.5l=6(f){H f.Q(/[-[\\]{}()*+?.,\\\\^$|#\\s]/g,"\\\\$&")};M.5e=6(f,e,a,b){e=r(e,"g"+(b&&E?"y":""));e.12=a=a||0;f=e.X(f);H b?f&&f.P===a?f:N:f};M.3q=6(){M.1h=6(){1S 2U("2a\'t 55 1h 54 3q")}};M.1R=6(f){H 53.Z.1q.W(f)==="[2m 15]"};M.3p=6(f,e,a,b){O(K c=r(e,"g"),d=-1,h;h=c.X(f);){a.W(b,h,++d,f,c);c.12===h.P&&c.12++}I(e.1J)e.12=0};M.57=6(f,e){H 6 a(b,c){K d=e[c].1I?e[c]:{1I:e[c]},h=r(d.1I,"g"),g=[],i;O(i=0;i<b.L;i++)M.3p(b[i],h,6(k){g.U(d.3j?k[d.3j]||"":k[0])});H c===e.L-1||!g.L?g:a(g,c+1)}([f],0)};15.Z.1p=6(f,e){H J.X(e[0])};15.Z.W=6(f,e){H J.X(e)};15.Z.X=6(f){K e=n.X.1p(J,14),a;I(e){I(!x&&e.L>1&&p(e,"")>-1){a=15(J.1m,n.Q.W(t(J),"g",""));n.Q.W(f.1a(e.P),a,6(){O(K c=1;c<14.L-2;c++)I(14[c]===1d)e[c]=1d})}I(J.1w&&J.1w.19)O(K b=1;b<e.L;b++)I(a=J.1w.19[b-1])e[a]=e[b];!D&&J.1J&&!e[0].L&&J.12>e.P&&J.12--}H e};I(!D)15.Z.1A=6(f){(f=n.X.W(J,f))&&J.1J&&!f[0].L&&J.12>f.P&&J.12--;H!!f};1r.Z.1C=6(f){M.1R(f)||(f=15(f));I(f.1J){K e=n.1C.1p(J,14);f.12=0;H e}H f.X(J)};1r.Z.Q=6(f,e){K a=M.1R(f),b,c;I(a&&1j e.58()==="3f"&&e.1i("${")===-1&&y)H n.Q.1p(J,14);I(a){I(f.1w)b=f.1w.19}Y f+="";I(1j e==="6")c=n.Q.W(J,f,6(){I(b){14[0]=1f 1r(14[0]);O(K d=0;d<b.L;d++)I(b[d])14[0][b[d]]=14[d+1]}I(a&&f.1J)f.12=14[14.L-2]+14[0].L;H e.1p(N,14)});Y{c=J+"";c=n.Q.W(c,f,6(){K d=14;H n.Q.W(e,C,6(h,g,i){I(g)5b(g){24"$":H"$";24"&":H d[0];24"`":H d[d.L-1].1a(0,d[d.L-2]);24"\'":H d[d.L-1].1a(d[d.L-2]+d[0].L);5a:i="";g=+g;I(!g)H h;O(;g>d.L-3;){i=1r.Z.1a.W(g,-1)+i;g=1Q.3i(g/10)}H(g?d[g]||"":"$")+i}Y{g=+i;I(g<=d.L-3)H d[g];g=b?p(b,i):-1;H g>-1?d[g+1]:h}})})}I(a&&f.1J)f.12=0;H c};1r.Z.1e=6(f,e){I(!M.1R(f))H n.1e.1p(J,14);K a=J+"",b=[],c=0,d,h;I(e===1d||+e<0)e=5D;Y{e=1Q.3i(+e);I(!e)H[]}O(f=M.3c(f);d=f.X(a);){I(f.12>c){b.U(a.1a(c,d.P));d.L>1&&d.P<a.L&&3b.Z.U.1p(b,d.1a(1));h=d[0].L;c=f.12;I(b.L>=e)1N}f.12===d.P&&f.12++}I(c===a.L){I(!n.1A.W(f,"")||h)b.U("")}Y b.U(a.1a(c));H b.L>e?b.1a(0,e):b};M.1h(/\\(\\?#[^)]*\\)/,6(f){H n.1A.W(A,f.2S.1a(f.P+f[0].L))?"":"(?:)"});M.1h(/\\((?!\\?)/,6(){J.19.U(N);H"("});M.1h(/\\(\\?<([$\\w]+)>/,6(f){J.19.U(f[1]);J.2N=R;H"("});M.1h(/\\\\k<([\\w$]+)>/,6(f){K e=p(J.19,f[1]);H e>-1?"\\\\"+(e+1)+(3R(f.2S.3a(f.P+f[0].L))?"":"(?:)"):f[0]});M.1h(/\\[\\^?]/,6(f){H f[0]==="[]"?"\\\\b\\\\B":"[\\\\s\\\\S]"});M.1h(/^\\(\\?([5A]+)\\)/,6(f){J.3d(f[1]);H""});M.1h(/(?:\\s+|#.*)+/,6(f){H n.1A.W(A,f.2S.1a(f.P+f[0].L))?"":"(?:)"},M.1B,6(){H J.2K("x")});M.1h(/\\./,6(){H"[\\\\s\\\\S]"},M.1B,6(){H J.2K("s")})})();1j 2e!="1d"&&(2e.M=M);K 1v=6(){6 r(a,b){a.1l.1i(b)!=-1||(a.1l+=" "+b)}6 t(a){H a.1i("3e")==0?a:"3e"+a}6 B(a){H e.1Y.2A[t(a)]}6 p(a,b,c){I(a==N)H N;K d=c!=R?a.3G:[a.2G],h={"#":"1c",".":"1l"}[b.1o(0,1)]||"3h",g,i;g=h!="3h"?b.1o(1):b.5u();I((a[h]||"").1i(g)!=-1)H a;O(a=0;d&&a<d.L&&i==N;a++)i=p(d[a],b,c);H i}6 C(a,b){K c={},d;O(d 2g a)c[d]=a[d];O(d 2g b)c[d]=b[d];H c}6 w(a,b,c,d){6 h(g){g=g||1P.5y;I(!g.1F){g.1F=g.52;g.3N=6(){J.5w=11}}c.W(d||1P,g)}a.3g?a.3g("4U"+b,h):a.4y(b,h,11)}6 A(a,b){K c=e.1Y.2j,d=N;I(c==N){c={};O(K h 2g e.1U){K g=e.1U[h];d=g.4x;I(d!=N){g.1V=h.4w();O(g=0;g<d.L;g++)c[d[g]]=h}}e.1Y.2j=c}d=e.1U[c[a]];d==N&&b!=11&&1P.1X(e.13.1x.1X+(e.13.1x.3E+a));H d}6 v(a,b){O(K c=a.1e("\\n"),d=0;d<c.L;d++)c[d]=b(c[d],d);H c.1K("\\n")}6 u(a,b){I(a==N||a.L==0||a=="\\n")H a;a=a.Q(/</g,"&1y;");a=a.Q(/ {2,}/g,6(c){O(K d="",h=0;h<c.L-1;h++)d+=e.13.1W;H d+" "});I(b!=N)a=v(a,6(c){I(c.L==0)H"";K d="";c=c.Q(/^(&2s;| )+/,6(h){d=h;H""});I(c.L==0)H d;H d+\'<17 1g="\'+b+\'">\'+c+"</17>"});H a}6 n(a,b){a.1e("\\n");O(K c="",d=0;d<50;d++)c+="                    ";H a=v(a,6(h){I(h.1i("\\t")==-1)H h;O(K g=0;(g=h.1i("\\t"))!=-1;)h=h.1o(0,g)+c.1o(0,b-g%b)+h.1o(g+1,h.L);H h})}6 x(a){H a.Q(/^\\s+|\\s+$/g,"")}6 D(a,b){I(a.P<b.P)H-1;Y I(a.P>b.P)H 1;Y I(a.L<b.L)H-1;Y I(a.L>b.L)H 1;H 0}6 y(a,b){6 c(k){H k[0]}O(K d=N,h=[],g=b.2D?b.2D:c;(d=b.1I.X(a))!=N;){K i=g(d,b);I(1j i=="3f")i=[1f e.2L(i,d.P,b.23)];h=h.1O(i)}H h}6 E(a){K b=/(.*)((&1G;|&1y;).*)/;H a.Q(e.3A.3M,6(c){K d="",h=N;I(h=b.X(c)){c=h[1];d=h[2]}H\'<a 2h="\'+c+\'">\'+c+"</a>"+d})}6 z(){O(K a=1E.36("1k"),b=[],c=0;c<a.L;c++)a[c].3s=="20"&&b.U(a[c]);H b}6 f(a){a=a.1F;K b=p(a,".20",R);a=p(a,".3O",R);K c=1E.4i("3t");I(!(!a||!b||p(a,"3t"))){B(b.1c);r(b,"1m");O(K d=a.3G,h=[],g=0;g<d.L;g++)h.U(d[g].4z||d[g].4A);h=h.1K("\\r");c.39(1E.4D(h));a.39(c);c.2C();c.4C();w(c,"4u",6(){c.2G.4E(c);b.1l=b.1l.Q("1m","")})}}I(1j 3F!="1d"&&1j M=="1d")M=3F("M").M;K e={2v:{"1g-27":"","2i-1s":1,"2z-1s-2t":11,1M:N,1t:N,"42-45":R,"43-22":4,1u:R,16:R,"3V-17":R,2l:11,"41-40":R,2k:11,"1z-1k":11},13:{1W:"&2s;",2M:R,46:11,44:11,34:"4n",1x:{21:"4o 1m",2P:"?",1X:"1v\\n\\n",3E:"4r\'t 4t 1D O: ",4g:"4m 4B\'t 51 O 1z-1k 4F: ",37:\'<!4T 1z 4S "-//4V//3H 4W 1.0 4Z//4Y" "1Z://2y.3L.3K/4X/3I/3H/3I-4P.4J"><1z 4I="1Z://2y.3L.3K/4L/5L"><3J><4N 1Z-4M="5G-5M" 6K="2O/1z; 6J=6I-8" /><1t>6L 1v</1t></3J><3B 1L="25-6M:6Q,6P,6O,6N-6F;6y-2f:#6x;2f:#6w;25-22:6v;2O-3D:3C;"><T 1L="2O-3D:3C;3w-32:1.6z;"><T 1L="25-22:6A-6E;">1v</T><T 1L="25-22:.6C;3w-6B:6R;"><T>3v 3.0.76 (72 73 3x)</T><T><a 2h="1Z://3u.2w/1v" 1F="38" 1L="2f:#3y">1Z://3u.2w/1v</a></T><T>70 17 6U 71.</T><T>6T 6X-3x 6Y 6D.</T></T><T>6t 61 60 J 1k, 5Z <a 2h="6u://2y.62.2w/63-66/65?64=5X-5W&5P=5O" 1L="2f:#3y">5R</a> 5V <2R/>5U 5T 5S!</T></T></3B></1z>\'}},1Y:{2j:N,2A:{}},1U:{},3A:{6n:/\\/\\*[\\s\\S]*?\\*\\//2c,6m:/\\/\\/.*$/2c,6l:/#.*$/2c,6k:/"([^\\\\"\\n]|\\\\.)*"/g,6o:/\'([^\\\\\'\\n]|\\\\.)*\'/g,6p:1f M(\'"([^\\\\\\\\"]|\\\\\\\\.)*"\',"3z"),6s:1f M("\'([^\\\\\\\\\']|\\\\\\\\.)*\'","3z"),6q:/(&1y;|<)!--[\\s\\S]*?--(&1G;|>)/2c,3M:/\\w+:\\/\\/[\\w-.\\/?%&=:@;]*/g,6a:{18:/(&1y;|<)\\?=?/g,1b:/\\?(&1G;|>)/g},69:{18:/(&1y;|<)%=?/g,1b:/%(&1G;|>)/g},6d:{18:/(&1y;|<)\\s*1k.*?(&1G;|>)/2T,1b:/(&1y;|<)\\/\\s*1k\\s*(&1G;|>)/2T}},16:{1H:6(a){6 b(i,k){H e.16.2o(i,k,e.13.1x[k])}O(K c=\'<T 1g="16">\',d=e.16.2x,h=d.2X,g=0;g<h.L;g++)c+=(d[h[g]].1H||b)(a,h[g]);c+="</T>";H c},2o:6(a,b,c){H\'<2W><a 2h="#" 1g="6e 6h\'+b+" "+b+\'">\'+c+"</a></2W>"},2b:6(a){K b=a.1F,c=b.1l||"";b=B(p(b,".20",R).1c);K d=6(h){H(h=15(h+"6f(\\\\w+)").X(c))?h[1]:N}("6g");b&&d&&e.16.2x[d].2B(b);a.3N()},2x:{2X:["21","2P"],21:{1H:6(a){I(a.V("2l")!=R)H"";K b=a.V("1t");H e.16.2o(a,"21",b?b:e.13.1x.21)},2B:6(a){a=1E.6j(t(a.1c));a.1l=a.1l.Q("47","")}},2P:{2B:6(){K a="68=0";a+=", 18="+(31.30-33)/2+", 32="+(31.2Z-2Y)/2+", 30=33, 2Z=2Y";a=a.Q(/^,/,"");a=1P.6Z("","38",a);a.2C();K b=a.1E;b.6W(e.13.1x.37);b.6V();a.2C()}}}},35:6(a,b){K c;I(b)c=[b];Y{c=1E.36(e.13.34);O(K d=[],h=0;h<c.L;h++)d.U(c[h]);c=d}c=c;d=[];I(e.13.2M)c=c.1O(z());I(c.L===0)H d;O(h=0;h<c.L;h++){O(K g=c[h],i=a,k=c[h].1l,j=3W 0,l={},m=1f M("^\\\\[(?<2V>(.*?))\\\\]$"),s=1f M("(?<27>[\\\\w-]+)\\\\s*:\\\\s*(?<1T>[\\\\w-%#]+|\\\\[.*?\\\\]|\\".*?\\"|\'.*?\')\\\\s*;?","g");(j=s.X(k))!=N;){K o=j.1T.Q(/^[\'"]|[\'"]$/g,"");I(o!=N&&m.1A(o)){o=m.X(o);o=o.2V.L>0?o.2V.1e(/\\s*,\\s*/):[]}l[j.27]=o}g={1F:g,1n:C(i,l)};g.1n.1D!=N&&d.U(g)}H d},1M:6(a,b){K c=J.35(a,b),d=N,h=e.13;I(c.L!==0)O(K g=0;g<c.L;g++){b=c[g];K i=b.1F,k=b.1n,j=k.1D,l;I(j!=N){I(k["1z-1k"]=="R"||e.2v["1z-1k"]==R){d=1f e.4l(j);j="4O"}Y I(d=A(j))d=1f d;Y 6H;l=i.3X;I(h.2M){l=l;K m=x(l),s=11;I(m.1i("<![6G[")==0){m=m.4h(9);s=R}K o=m.L;I(m.1i("]]\\>")==o-3){m=m.4h(0,o-3);s=R}l=s?m:l}I((i.1t||"")!="")k.1t=i.1t;k.1D=j;d.2Q(k);b=d.2F(l);I((i.1c||"")!="")b.1c=i.1c;i.2G.74(b,i)}}},2E:6(a){w(1P,"4k",6(){e.1M(a)})}};e.2E=e.2E;e.1M=e.1M;e.2L=6(a,b,c){J.1T=a;J.P=b;J.L=a.L;J.23=c;J.1V=N};e.2L.Z.1q=6(){H J.1T};e.4l=6(a){6 b(j,l){O(K m=0;m<j.L;m++)j[m].P+=l}K c=A(a),d,h=1f e.1U.5Y,g=J,i="2F 1H 2Q".1e(" ");I(c!=N){d=1f c;O(K k=0;k<i.L;k++)(6(){K j=i[k];g[j]=6(){H h[j].1p(h,14)}})();d.28==N?1P.1X(e.13.1x.1X+(e.13.1x.4g+a)):h.2J.U({1I:d.28.17,2D:6(j){O(K l=j.17,m=[],s=d.2J,o=j.P+j.18.L,F=d.28,q,G=0;G<s.L;G++){q=y(l,s[G]);b(q,o);m=m.1O(q)}I(F.18!=N&&j.18!=N){q=y(j.18,F.18);b(q,j.P);m=m.1O(q)}I(F.1b!=N&&j.1b!=N){q=y(j.1b,F.1b);b(q,j.P+j[0].5Q(j.1b));m=m.1O(q)}O(j=0;j<m.L;j++)m[j].1V=c.1V;H m}})}};e.4j=6(){};e.4j.Z={V:6(a,b){K c=J.1n[a];c=c==N?b:c;K d={"R":R,"11":11}[c];H d==N?c:d},3Y:6(a){H 1E.4i(a)},4c:6(a,b){K c=[];I(a!=N)O(K d=0;d<a.L;d++)I(1j a[d]=="2m")c=c.1O(y(b,a[d]));H J.4e(c.6b(D))},4e:6(a){O(K b=0;b<a.L;b++)I(a[b]!==N)O(K c=a[b],d=c.P+c.L,h=b+1;h<a.L&&a[b]!==N;h++){K g=a[h];I(g!==N)I(g.P>d)1N;Y I(g.P==c.P&&g.L>c.L)a[b]=N;Y I(g.P>=c.P&&g.P<d)a[h]=N}H a},4d:6(a){K b=[],c=2u(J.V("2i-1s"));v(a,6(d,h){b.U(h+c)});H b},3U:6(a){K b=J.V("1M",[]);I(1j b!="2m"&&b.U==N)b=[b];a:{a=a.1q();K c=3W 0;O(c=c=1Q.6c(c||0,0);c<b.L;c++)I(b[c]==a){b=c;1N a}b=-1}H b!=-1},2r:6(a,b,c){a=["1s","6i"+b,"P"+a,"6r"+(b%2==0?1:2).1q()];J.3U(b)&&a.U("67");b==0&&a.U("1N");H\'<T 1g="\'+a.1K(" ")+\'">\'+c+"</T>"},3Q:6(a,b){K c="",d=a.1e("\\n").L,h=2u(J.V("2i-1s")),g=J.V("2z-1s-2t");I(g==R)g=(h+d-1).1q().L;Y I(3R(g)==R)g=0;O(K i=0;i<d;i++){K k=b?b[i]:h+i,j;I(k==0)j=e.13.1W;Y{j=g;O(K l=k.1q();l.L<j;)l="0"+l;j=l}a=j;c+=J.2r(i,k,a)}H c},49:6(a,b){a=x(a);K c=a.1e("\\n");J.V("2z-1s-2t");K d=2u(J.V("2i-1s"));a="";O(K h=J.V("1D"),g=0;g<c.L;g++){K i=c[g],k=/^(&2s;|\\s)+/.X(i),j=N,l=b?b[g]:d+g;I(k!=N){j=k[0].1q();i=i.1o(j.L);j=j.Q(" ",e.13.1W)}i=x(i);I(i.L==0)i=e.13.1W;a+=J.2r(g,l,(j!=N?\'<17 1g="\'+h+\' 5N">\'+j+"</17>":"")+i)}H a},4f:6(a){H a?"<4a>"+a+"</4a>":""},4b:6(a,b){6 c(l){H(l=l?l.1V||g:g)?l+" ":""}O(K d=0,h="",g=J.V("1D",""),i=0;i<b.L;i++){K k=b[i],j;I(!(k===N||k.L===0)){j=c(k);h+=u(a.1o(d,k.P-d),j+"48")+u(k.1T,j+k.23);d=k.P+k.L+(k.75||0)}}h+=u(a.1o(d),c()+"48");H h},1H:6(a){K b="",c=["20"],d;I(J.V("2k")==R)J.1n.16=J.1n.1u=11;1l="20";J.V("2l")==R&&c.U("47");I((1u=J.V("1u"))==11)c.U("6S");c.U(J.V("1g-27"));c.U(J.V("1D"));a=a.Q(/^[ ]*[\\n]+|[\\n]*[ ]*$/g,"").Q(/\\r/g," ");b=J.V("43-22");I(J.V("42-45")==R)a=n(a,b);Y{O(K h="",g=0;g<b;g++)h+=" ";a=a.Q(/\\t/g,h)}a=a;a:{b=a=a;h=/<2R\\s*\\/?>|&1y;2R\\s*\\/?&1G;/2T;I(e.13.46==R)b=b.Q(h,"\\n");I(e.13.44==R)b=b.Q(h,"");b=b.1e("\\n");h=/^\\s*/;g=4Q;O(K i=0;i<b.L&&g>0;i++){K k=b[i];I(x(k).L!=0){k=h.X(k);I(k==N){a=a;1N a}g=1Q.4q(k[0].L,g)}}I(g>0)O(i=0;i<b.L;i++)b[i]=b[i].1o(g);a=b.1K("\\n")}I(1u)d=J.4d(a);b=J.4c(J.2J,a);b=J.4b(a,b);b=J.49(b,d);I(J.V("41-40"))b=E(b);1j 2H!="1d"&&2H.3S&&2H.3S.1C(/5s/)&&c.U("5t");H b=\'<T 1c="\'+t(J.1c)+\'" 1g="\'+c.1K(" ")+\'">\'+(J.V("16")?e.16.1H(J):"")+\'<3Z 5z="0" 5H="0" 5J="0">\'+J.4f(J.V("1t"))+"<3T><3P>"+(1u?\'<2d 1g="1u">\'+J.3Q(a)+"</2d>":"")+\'<2d 1g="17"><T 1g="3O">\'+b+"</T></2d></3P></3T></3Z></T>"},2F:6(a){I(a===N)a="";J.17=a;K b=J.3Y("T");b.3X=J.1H(a);J.V("16")&&w(p(b,".16"),"5c",e.16.2b);J.V("3V-17")&&w(p(b,".17"),"56",f);H b},2Q:6(a){J.1c=""+1Q.5d(1Q.5n()*5k).1q();e.1Y.2A[t(J.1c)]=J;J.1n=C(e.2v,a||{});I(J.V("2k")==R)J.1n.16=J.1n.1u=11},5j:6(a){a=a.Q(/^\\s+|\\s+$/g,"").Q(/\\s+/g,"|");H"\\\\b(?:"+a+")\\\\b"},5f:6(a){J.28={18:{1I:a.18,23:"1k"},1b:{1I:a.1b,23:"1k"},17:1f M("(?<18>"+a.18.1m+")(?<17>.*?)(?<1b>"+a.1b.1m+")","5o")}}};H e}();1j 2e!="1d"&&(2e.1v=1v);',
62,441,"      function                                     return if this var length XRegExp null for index replace true  div push getParam call exec else prototype  false lastIndex config arguments RegExp toolbar code left captureNames slice right id undefined split new class addToken indexOf typeof script className source params substr apply toString String line title gutter SyntaxHighlighter _xregexp strings lt html test OUTSIDE_CLASS match brush document target gt getHtml regex global join style highlight break concat window Math isRegExp throw value brushes brushName space alert vars http syntaxhighlighter expandSource size css case font Fa name htmlScript dA can handler gm td exports color in href first discoveredBrushes light collapse object cache getButtonHtml trigger pattern getLineHtml nbsp numbers parseInt defaults com items www pad highlighters execute focus func all getDiv parentNode navigator INSIDE_CLASS regexList hasFlag Match useScriptTags hasNamedCapture text help init br input gi Error values span list 250 height width screen top 500 tagName findElements getElementsByTagName aboutDialog _blank appendChild charAt Array copyAsGlobal setFlag highlighter_ string attachEvent nodeName floor backref output the TypeError sticky Za iterate freezeTokens scope type textarea alexgorbatchev version margin 2010 005896 gs regexLib body center align noBrush require childNodes DTD xhtml1 head org w3 url preventDefault container tr getLineNumbersHtml isNaN userAgent tbody isLineHighlighted quick void innerHTML create table links auto smart tab stripBrs tabs bloggerMode collapsed plain getCodeLinesHtml caption getMatchesHtml findMatches figureOutLineNumbers removeNestedMatches getTitleHtml brushNotHtmlScript substring createElement Highlighter load HtmlScript Brush pre expand multiline min Can ignoreCase find blur extended toLowerCase aliases addEventListener innerText textContent wasn select createTextNode removeChild option same frame xmlns dtd twice 1999 equiv meta htmlscript transitional 1E3 expected PUBLIC DOCTYPE on W3C XHTML TR EN Transitional  configured srcElement Object after run dblclick matchChain valueOf constructor default switch click round execAt forHtmlScript token gimy functions getKeywords 1E6 escape within random sgi another finally supply MSIE ie toUpperCase catch returnValue definition event border imsx constructing one Infinity from when Content cellpadding flags cellspacing try xhtml Type spaces 2930402 hosted_button_id lastIndexOf donate active development keep to xclick _s Xml please like you paypal cgi cmd webscr bin highlighted scrollbars aspScriptTags phpScriptTags sort max scriptScriptTags toolbar_item _ command command_ number getElementById doubleQuotedString singleLinePerlComments singleLineCComments multiLineCComments singleQuotedString multiLineDoubleQuotedString xmlComments alt multiLineSingleQuotedString If https 1em 000 fff background 5em xx bottom 75em Gorbatchev large serif CDATA continue utf charset content About family sans Helvetica Arial Geneva 3em nogutter Copyright syntax close write 2004 Alex open JavaScript highlighter July 02 replaceChild offset 83".split(" "),
0,{})),eval(function(a,b,c,d,e,g){e=function(a){return(a<b?"":e(parseInt(a/b)))+(35<(a%=b)?String.fromCharCode(a+29):a.toString(36))};if(!"".replace(/^/,String)){for(;c--;)g[e(c)]=d[c]||e(c);d=[function(a){return g[a]}];e=function(){return"\\w+"};c=1}for(;c--;)d[c]&&(a=a.replace(RegExp("\\b"+e(c)+"\\b","g"),d[c]));return a}('(2(){1 h=5;h.I=2(){2 n(c,a){4(1 d=0;d<c.9;d++)i[c[d]]=a}2 o(c){1 a=r.H("J"),d=3;a.K=c;a.M="L/t";a.G="t";a.u=a.v=2(){6(!d&&(!8.7||8.7=="F"||8.7=="z")){d=q;e[c]=q;a:{4(1 p y e)6(e[p]==3)B a;j&&5.C(k)}a.u=a.v=x;a.D.O(a)}};r.N.R(a)}1 f=Q,l=h.P(),i={},e={},j=3,k=x,b;5.T=2(c){k=c;j=q};4(b=0;b<f.9;b++){1 m=f[b].w?f[b]:f[b].S(/\\s+/),g=m.w();n(m,g)}4(b=0;b<l.9;b++)6(g=i[l[b].E.A]){e[g]=3;o(g)}}})();',
56,56," var function false for SyntaxHighlighter if readyState this length                 true document  javascript onload onreadystatechange pop null in complete brush break highlight parentNode params loaded language createElement autoloader script src text type body removeChild findElements arguments appendChild split all".split(" "),0,{})),function(){function a(){var a=SyntaxHighlighter.regexLib;this.regexList=[{regex:a.multiLineDoubleQuotedString,css:"string"},{regex:a.multiLineSingleQuotedString,
css:"string"},{regex:a.singleLineCComments,css:"comments"},{regex:a.multiLineCComments,css:"comments"},{regex:/\s*#.*/gm,css:"preprocessor"},{regex:RegExp(this.getKeywords("break case catch continue default delete do else false  for function if in instanceof new null return super switch this throw true try typeof var while with"),"gm"),css:"keyword"}];this.forHtmlScript(a.scriptScriptTags)}"undefined"!=typeof require?SyntaxHighlighter=require("shCore").SyntaxHighlighter:null;a.prototype=new SyntaxHighlighter.Highlighter;
a.aliases=["js","jscript","javascript"];SyntaxHighlighter.brushes.JScript=a;"undefined"!=typeof exports?exports.Brush=a:null}(),Ext.define("ExtX.Reference.Slot",{override:"Ext.Component",slot:null,__COLLECTOR__:null,onRemoved:function(){this.__COLLECTOR__&&(delete this.__COLLECTOR__.slots[this.slot],delete this.__COLLECTOR__);this.callOverridden(arguments)},beforeDestroy:function(){this.__COLLECTOR__&&(delete this.__COLLECTOR__.slots[this.slot],delete this.__COLLECTOR__);this.callOverridden(arguments)}}),
Ext.define("ExtX.Reference.Slot2",{override:"Ext.Container",slots:null,onAdd:function(){this.cascade(function(a){if(a.slot&&!a.__COLLECTOR__){var b=a.__COLLECTOR__=a.up("{slots}");b&&(b.slots[a.slot]=a)}})},initComponent:function(){this.slots&&(this.slots={});this.callOverridden()}}),function(){var a={idProperty:"id",fields:["id","url","title",{name:"passCount",type:"int",defaultValue:0},{name:"failCount",type:"int",defaultValue:0},{name:"todoPassCount",type:"int",defaultValue:0},{name:"todoFailCount",
type:"int",defaultValue:0},{name:"time",type:"int",defaultValue:0},{name:"checked",defaultValue:!1},{name:"folderStatus",defaultValue:"yellow"},"isStarting","isStarted",{name:"isRunning",type:"boolean",defaultValue:!1},{name:"isMissing",type:"boolean",defaultValue:!1},{name:"isFailed",type:"boolean",defaultValue:!1},"assertionsStore","test","descriptor"]},b=Ext.getVersion&&Ext.getVersion("touch");Ext.define("Siesta.Harness.Browser.Model.TestFile",Ext.apply({extend:"Ext.data.Model",computeFolderStatus:function(){if(!this.childNodes.length)return"yellow";
var a=!1,b=!1,e=!0;Joose.A.each(this.childNodes,function(g){if(g.isLeaf()){var f=g.get("test");if(f&&f.isFailed())return e=!1,b=!0,!1;!f&&g.get("isStarting")&&(a=!0);f&&!f.isFinished()&&(a=!0);f&&!f.isPassed()&&(e=!1);f||(e=!1)}else{g=g.computeFolderStatus();if("red"==g)return e=!1,b=!0,!1;if("working"==g)return a=!0,!1;"yellow"==g&&(e=!1)}});return a?"working":b?"red":e?"green":"yellow"},updateFolderStatus:function(){this.set("folderStatus",this.computeFolderStatus());var a=this.parentNode;a&&!a.isRoot()&&
a.updateFolderStatus()}},b?{config:a}:a))}(),function(){var a={idProperty:"id",proxy:{type:"memory"},fields:["id",{name:"folderStatus",defaultValue:"yellow"},{name:"result"}]},b=Ext.getVersion&&Ext.getVersion("touch");Ext.define("Siesta.Harness.Browser.Model.Assertion",Ext.apply({extend:"Ext.data.Model",getResult:function(){return this.data.result},isAssertion:function(){return this.data.result instanceof Siesta.Result.Assertion},isDiagnostic:function(){return this.data.result instanceof Siesta.Result.Diagnostic},
isSummary:function(){return this.data.result instanceof Siesta.Result.Summary},ensureVisible:function(){for(var a=this.parentNode;a&&!a.isRoot();)a.expand(),a=a.parentNode},isWaitingAssertion:function(){var a=this.data.result;return this.isAssertion()&&a.isWaiting&&!a.completed},updateFolderStatus:function(){this.isLeaf()||this.set("folderStatus",this.computeFolderStatus());var a=this.parentNode;a&&!a.isRoot()&&a.updateFolderStatus()},triggerUIUpdate:function(){this.callJoined("afterEdit",[])},computeFolderStatus:function(){if(!this.isLeaf()&&
this.getResult().isWorking())return"working";if(!this.childNodes.length)return"yellow";var a=!1,b=!1,e=!0;Joose.A.each(this.childNodes,function(g){var f=g.getResult();if(g.isLeaf()){if(g.isWaitingAssertion()&&(a=!0),g.isAssertion()&&!f.isPassed())return e=!1,b=!0,!1}else{g=g.computeFolderStatus();if("red"==g)return e=!1,b=!0,!1;if(f.isWorking()||"working"==g)return a=!0,!1;"yellow"==g&&(e=!1)}});return a?"working":b?"red":e?"green":"yellow"}},b?{config:a}:a))}(),Ext.define("Sch.data.mixin.FilterableTreeStore",
{isFilteredFlag:!1,isHiddenFlag:!1,lastTreeFilter:null,lastTreeHiding:null,allowExpandCollapseWhileFiltered:!0,reApplyFilterOnDataChange:!0,suspendIncrementalFilterRefresh:0,filterGeneration:0,currentFilterGeneration:null,dataChangeListeners:null,monitoringDataChange:!1,onClassMixedIn:function(a){a.override(Sch.data.mixin.FilterableTreeStore.prototype.inheritables()||{})},initTreeFiltering:function(){this.treeFilter=new Ext.util.Filter({filterFn:this.isNodeFilteredIn,scope:this});this.dataChangeListeners=
{nodeappend:this.onNeedToUpdateFilter,nodeinsert:this.onNeedToUpdateFilter,scope:this}},startDataChangeMonitoring:function(){this.monitoringDataChange||(this.monitoringDataChange=!0,this.on(this.dataChangeListeners))},stopDataChangeMonitoring:function(){this.monitoringDataChange&&(this.monitoringDataChange=!1,this.un(this.dataChangeListeners))},onNeedToUpdateFilter:function(){this.reApplyFilterOnDataChange&&!this.suspendIncrementalFilterRefresh&&this.reApplyFilter()},clearTreeFilter:function(){this.isTreeFiltered()&&
(this.currentFilterGeneration=null,this.isFilteredFlag=!1,this.lastTreeFilter=null,this.isTreeFiltered(!0)||this.stopDataChangeMonitoring(),this.refreshNodeStoreContent(),this.fireEvent("filter-clear",this))},reApplyFilter:function(){this.isHiddenFlag&&this.hideNodesBy.apply(this,this.lastTreeHiding.concat(this.isFilteredFlag));this.isFilteredFlag&&this.filterTreeBy(this.lastTreeFilter)},refreshNodeStoreContent:function(){0>this.getFilters().indexOf(this.treeFilter)?this.addFilter(this.treeFilter):
this.getFilters().fireEvent("endupdate",this.getFilters())},getIndexInTotalDataset:function(a){var b=this.getRootNode(),c=-1,d=this.rootVisible;if(!d&&a==b)return-1;var e=this.isTreeFiltered(),g=this.currentFilterGeneration,f=function(l){if((e&&l.__filterGen!=g||l.hidden)&&l==a)return!1;(d||l!=b)&&c++;if(l==a)return!1;if(!l.data.leaf&&l.isExpanded()){l=l.childNodes;for(var m=l.length,n=0;n<m;n++)if(!1===f(l[n]))return!1}};f(b);return c},isTreeFiltered:function(a){return this.isFilteredFlag||a&&this.isHiddenFlag},
markFilteredNodes:function(a,b){var c=this,d=this.currentFilterGeneration,e={},g=this.getRootNode(),f=this.rootVisible,l=function(a){for(a=a.parentNode;a&&!e[a.internalId];)e[a.internalId]=!0,a=a.parentNode},m=b.filter,n=b.scope||this,p=b.shallow,r=b.checkParents||p,s=b.fullMatchingParents,t=b.onlyParents||s;if(t&&r)throw Error("Can't combine `onlyParents` and `checkParents` options");f&&(e[g.internalId]=!0);var w=function(a){if(!a.hidden){var b,c,d;if(a.data.leaf)m.call(n,a,e)&&(e[a.internalId]=
!0,l(a));else if(t){b=m.call(n,a);c=a.childNodes;d=c.length;if(b&&(e[a.internalId]=!0,l(a),s)){a.cascadeBy(function(a){e[a.internalId]=!0});return}for(a=0;a<d;a++)b&&c[a].data.leaf?e[c[a].internalId]=!0:c[a].data.leaf||w(c[a])}else if(r&&(b=m.call(n,a,e))&&(e[a.internalId]=!0,l(a)),!r||!p||p&&(b||a==g&&!f))for(c=a.childNodes,d=c.length,a=0;a<d;a++)w(c[a])}};w(a);g.cascadeBy(function(a){e[a.internalId]&&(a.__filterGen=d,c.allowExpandCollapseWhileFiltered&&!a.data.leaf&&a.expand())})},filterTreeBy:function(a,
b){this.currentFilterGeneration=this.filterGeneration++;1==arguments.length&&Ext.isObject(arguments[0])?b=a.scope:a={filter:a,scope:b};this.fireEvent("nodestore-datachange-start",this);a=a||{};this.markFilteredNodes(this.getRootNode(),a);this.startDataChangeMonitoring();this.isFilteredFlag=!0;this.lastTreeFilter=a;this.refreshNodeStoreContent();this.fireEvent("nodestore-datachange-end",this);this.fireEvent("filter-set",this)},isNodeFilteredIn:function(a){var b=this.isTreeFiltered(),c=this.currentFilterGeneration;
return this.loading||!Boolean(b&&a.__filterGen!=c||a.hidden)},hasNativeFilters:function(){var a=this.getFilters(),b=a.getCount();return b&&1<b||0>a.indexOf(this.treeFilter)},hideNodesBy:function(a,b,c){var d=this;if(d.isFiltered()&&d.hasNativeFilters())throw Error("Can't hide nodes of the filtered tree store");b=b||d;d.getRootNode().cascadeBy(function(c){c.hidden=Boolean(a.call(b,c,d))});d.startDataChangeMonitoring();d.isHiddenFlag=!0;d.lastTreeHiding=[a,b];c||d.refreshNodeStoreContent()},showAllNodes:function(a){this.getRootNode().cascadeBy(function(a){a.hidden=
!1});this.isHiddenFlag=!1;this.lastTreeHiding=null;this.isTreeFiltered(!0)||this.stopDataChangeMonitoring();a||this.refreshNodeStoreContent()},inheritables:function(){return{onNodeExpand:function(a,b,c){if(this.isTreeFiltered(!0)&&a==this.getRoot())this.callParent(arguments),this.reApplyFilter();else return this.callParent(arguments)},onNodeCollapse:function(a,b,c,d,e){var g=this,f=g.data,l=f.contains,m=g.isTreeFiltered(),n=g.currentFilterGeneration;f.contains=function(){var c,d,e,f=g.indexOf(a)+
1,k=!1;for(c=0;c<b.length;c++)if(!(b[c].hidden||m&&b[c].__filterGen!=n)&&l.call(this,b[c])){for(c=a;c.parentNode;){d=c;do d=d.nextSibling;while(d&&(d.hidden||m&&d.__filterGen!=n));if(d){k=!0;e=g.indexOf(d);break}else c=c.parentNode}k||(e=g.getCount());g.removeAt(f,e-f);break}return!1};this.callParent(arguments);f.contains=l},handleNodeExpand:function(a,b,c){for(var d=[],e=this.isTreeFiltered(),g=this.currentFilterGeneration,f=0;f<b.length;f++){var l=b[f];e&&l.__filterGen!=g||l.hidden||(d[d.length]=
l)}return this.callParent([a,d,c])},onNodeInsert:function(a,b,c){var d=b.raw||b.data,e;this.filterFn&&(e=this.filterFn(b),b.set("visible",e),e&&a.set("visible",this.filterFn(a)));this.registerNode(b,!0);this.beginUpdate();if(this.isVisible(b)){if(0!==c&&b.previousSibling){for(c=b.previousSibling;c&&!c.get("visible");c=c.previousSibling);if(c){for(;c.isExpanded()&&c.lastChild;)c=c.lastChild;a=c}}this.insert(this.indexOf(a)+1,b);if(!b.isLeaf()&&b.isExpanded())if(b.isLoaded())this.onNodeExpand(b,b.childNodes);
else this.fillCount||(b.set("expanded",!1),b.expand())}else this.needsSync=this.needsSync||b.phantom||b.dirty;!b.isLeaf()&&(!b.isLoaded()&&!this.lazyFill)&&(a=this.getProxy().getReader(),a=(c=(c=b.getProxy())?c.getReader():null)&&c.initialConfig.rootProperty?c:a,d=a.getRoot(d))&&(c=b.childType,this.fillNode(b,a.extractData(d,c?{model:c}:void 0)));this.endUpdate()},isFiltered:function(){return this.callParent(arguments)||this.isTreeFiltered()}}}}),Ext.define("Siesta.Harness.Browser.Model.FilterableTreeStore",
{extend:"Ext.data.TreeStore",mixins:["Sch.data.mixin.FilterableTreeStore"],constructor:function(){this.callParent(arguments);this.initTreeFiltering()},forEach:function(a,b){this.getRootNode().cascadeBy(a,b)}}),Ext.define("Siesta.Harness.Browser.Model.AssertionTreeStore",{extend:"Ext.data.TreeStore",model:"Siesta.Harness.Browser.Model.Assertion",mixins:["Sch.data.mixin.FilterableTreeStore"],constructor:function(){this.callParent(arguments);this.initTreeFiltering()},removeAll:function(){this.setRootNode({id:"__ROOT__",
expanded:!0,loaded:!0})},add:function(a){this.getRootNode().appendChild(a)}}),Ext.define("Siesta.Harness.Browser.UI.VersionField",{extend:"Ext.form.field.Spinner",alias:"widget.versionfield",width:90,versions:"4.0.2a 4.0.7 4.1.0 4.1.1 4.1.2 4.1.3 4.1.4".split(" "),onSpinUp:function(){var a=Ext.Array.indexOf(this.versions,this.getValue());a<this.versions.length-1&&this.setValue(this.versions[a+1])},onSpinDown:function(){var a=Ext.Array.indexOf(this.versions,this.getValue());0<a&&this.setValue(this.versions[a-
1])}}),Ext.define("Sch.mixin.FilterableTreeView",{filterableTreeStore:null,treeStoreFilteringListeners:null,initTreeFiltering:function(){this.treeStoreFilteringListeners={"nodestore-datachange-start":this.onFilterChangeStart,"nodestore-datachange-end":this.onFilterChangeEnd,"filter-clear":this.onFilterCleared,"filter-set":this.onFilterSet,forcedrefresh:this.onForcedRefresh,scope:this};var a=function(){var a=this.up("tablepanel").store;this.bindFilterableTreeStore(a)};if(this.rendered)a.call(this);
else this.on("beforerender",a,this,{single:!0})},bindFilterableTreeStore:function(a){this.filterableTreeStore&&this.mun(this.filterableTreeStore,this.treeStoreFilteringListeners);(this.filterableTreeStore=a)&&this.mon(a,this.treeStoreFilteringListeners)},onForcedRefresh:function(){this.focusRow=function(){};this.refresh();delete this.focusRow},onFilterChangeStart:function(){Ext.suspendLayouts()},onFilterChangeEnd:function(){Ext.resumeLayouts(!0)},onFilterCleared:function(){},onFilterSet:function(){}}),
Ext.define("Siesta.Harness.Browser.UI.FilterableTreeView",{extend:"Ext.tree.View",alias:"widget.filterabletreeview",mixins:["Sch.mixin.FilterableTreeView"],constructor:function(){this.callParent(arguments);this.initTreeFiltering()},bindStore:function(a,b,c){a instanceof Ext.data.TreeStore?(this.bindFilterableTreeStore(a),this.callParent([a.nodeStore||a,b,c])):this.callParent(arguments)}}),Ext.define("Siesta.Harness.Browser.UI.TreeFilterField",{extend:"Ext.form.field.Text",alias:"widget.treefilter",
filterGroups:!1,cls:"filterfield",store:null,filterField:"text",hasAndCheck:null,andChecker:null,andCheckerScope:null,triggerLeafCls:"icon-file-2",triggerGroupCls:"icon-folder",tipText:null,constructor:function(a){var b=this;Ext.apply(a,{triggers:{clear:{cls:"icon-close",handler:function(){b.store.clearTreeFilter();b.reset()}},leafOrGroup:{cls:b.triggerLeafCls,handler:function(){b.setFilterGroups(!b.getFilterGroups())}}},listeners:{change:{fn:this.onFilterChange,buffer:400,scope:this},specialkey:this.onFilterSpecialKey,
scope:this}});this.callParent(arguments)},afterRender:function(){this.callParent(arguments);this.tipText&&this.inputEl.set({title:this.tipText});this.filterGroups&&(this.triggerEl.item(1).addCls(this.triggerGroupCls),this.triggerEl.item(1).removeCls(this.triggerLeafCls))},onFilterSpecialKey:function(a,b,c){b.keyCode===b.ESC&&(this.store.clearTreeFilter(),a.reset())},setFilterGroups:function(a){if(a!=this.filterGroups){this.filterGroups=a;if(this.rendered){var b=this.triggerEl.item(1);a?(b.addCls(this.triggerGroupCls),
b.removeCls(this.triggerLeafCls)):(b.removeCls(this.triggerGroupCls),b.addCls(this.triggerLeafCls))}this.refreshFilter();this.fireEvent("filter-group-change",this)}},getFilterGroups:function(){return this.filterGroups},refreshFilter:function(){this.onFilterChange(this,this.getValue())},splitTermByPipe:function(a){a=a.split(/\s*\|\s*/);for(var b=[],c=0;c<a.length;c++)a[c]&&b.push(Ext.Array.map(a[c].split(/\s+/),function(a){return RegExp(Ext.String.escapeRegex(a),"i")}));return b},matchAnyOfRegExps:function(a,
b){for(var c=0;c<b.length;c++){for(var d=!0,e=b[c].length,g=0;g<e;g++)if(!b[c][g].test(a)){d=!1;break}if(d)return!0}return!1},onFilterChange:function(a,b){if(b||this.hasAndCheck&&this.hasAndCheck()){var c=this.filterField,d,e,g=this.filterGroups;g||(d=b.split(/\s*\>\s*/),e=1<d.length?d[0]:"",b=1<d.length?d[1]:d[0]);d=b.split(/\s*\|\s*/);var f=this.splitTermByPipe(b),l=e?this.splitTermByPipe(e):null,m=this.andChecker,n=this.andCheckerScope||this,p=this;this.store.filterTreeBy({filter:function(a){if(m&&
!m.call(n,a))return!1;if(!g&&e){for(var b=a,d=!1;b&&b.parentNode;)if(b=b.parentNode,p.matchAnyOfRegExps(b.get(c),l)){d=!0;break}if(!d)return!1}a=a.get(c);return p.matchAnyOfRegExps(a,f)?!0:!f.length},fullMatchingParents:g})}else this.store.clearTreeFilter()}}),Ext.define("Siesta.Harness.Browser.UI.CanFillAssertionsStore",{processNewResult:function(a,b,c,d){b={id:c.id,result:c,loaded:!0,leaf:!(c instanceof Siesta.Result.SubTest),expanded:c instanceof Siesta.Result.SubTest&&"it"!=c.test.specType};var e=
a.getNodeById(c.id);e?e.triggerUIUpdate():(Ext.suspendLayouts(),e=(a.getNodeById(d.id)||a.getRootNode()).appendChild(b),Ext.resumeLayouts());(c.isPassed&&!c.isPassed()||c.isWarning)&&e.ensureVisible();e.updateFolderStatus()},processEveryTestEnd:function(a,b){var c=a.getNodeById(b.getResults().id);c&&c.updateFolderStatus()}}),Ext.define("Siesta.Harness.Browser.UI.ComponentInspector",{extend:"Ext.util.Observable",inspectedComponent:null,inspectedComponentXType:null,boxIndicatorEl:null,active:!1,window:null,
resolveTarget:function(a){throw"resolveTarget API method must be provided by owner";},getIndicatorEl:function(){return this.boxIndicatorEl},getExt:function(){return this.window.Ext},start:function(a,b){a=a||this.window;if(!a)throw"Must provide a window context for the inspector";this.window=a;var c=this.getExt(),d=b||a.document.body;this.boxIndicatorEl=this.boxIndicatorEl||Ext.fly(d).createChild({cls:"target-inspector-box",children:{tag:"a",cls:"target-inspector-label",target:"_blank"}});c&&c.getBody&&
(this.toggleMouseMoveListener(!0),c.getBody().on("click",this.onInspectionClick,this));this.fireEvent("start",this);this.active=!0},stop:function(a){if(this.active){this.active=!1;var b=this.getExt();Ext.destroy(this.boxIndicatorEl);this.boxIndicatorEl=null;a||this.fireEvent("stop",this);b&&b.getBody&&(this.toggleMouseMoveListener(!1),b.getBody().un("click",this.onInspectionClick,this));this.inspectedComponent=this.inspectedComponentXType=null}},toggleMouseMoveListener:function(a){var b=this.getExt();
if(b){var c=b.getBody().select("iframe");a=a?"on":"un";b.getBody()[a]("mousemove",this.onMouseMove,this,{buffer:30});for(b=0;b<c.getCount();b++){var d=c.item(b).dom.contentWindow.Ext;d&&d.getBody&&d.getBody()[a]("mousemove",this.onMouseMove,this,{buffer:30})}}},onInspectionClick:function(a,b){this.boxIndicatorEl&&(this.toggleMouseMoveListener(!1),this.inspectedComponent&&this.findComponentByTarget(b)===this.inspectedComponent?this.fireEvent("targetselected",this,this.inspectedComponent,this.inspectedComponentXType):
this.stop())},onMouseMove:function(a,b){if(this.boxIndicatorEl){var c=this.findComponentByTarget(b);if(c&&c!==this.inspectedComponent){var d=this.resolveComponentXtype(c);this.inspectedComponent=c;this.inspectedComponentXType=d;this.highlightTarget(c.el);this.updateHighlightContent(c,d);this.fireEvent("targethover",this,this.inspectedComponent,this.inspectedComponentXType)}}},resolveComponentXtype:function(a){var b=a.getXType&&a.getXType()||a.xtype;if(!b)for(var c=a,d=0;10>d&&!b;d++)c=a.superclass,
b=c.xtype;return b},updateHighlightContent:function(a,b){var c,d={tag:"a",cls:"target-inspector-label",href:"#"};if("string"===typeof a)c=a;else if(Ext.ClassManager){c=Ext.ComponentQuery.query("recorderpanel")[0];var e=a.el.dom.ownerDocument.defaultView,e=e&&e.Ext&&e.Ext.ComponentQuery;if(c&&c.isVisible()){var g;e&&(g=(g=c.recorder.extractor.findComponentQueryFor(a))&&g.query||b);c=">>"+(g||b)}else{if(g=this.findExtAncestorClassName(a))c=Siesta.Resource("Siesta.Harness.Browser.UI.DomContainer","docsUrlText"),
e=Ext.versions.touch?"touch":"extjs",d.target="_blank",d.href=Ext.String.format(c,e,g),d.title=Siesta.Resource("Siesta.Harness.Browser.UI.DomContainer","viewDocsText")+g;c=b}}c&&(d.html=c,this.boxIndicatorEl.update(Ext.DomHelper.createHtml(d)))},highlightTarget:function(a,b){this.active||this.start();var c=this.resolveTarget(a),d=this.boxIndicatorEl.dom.style,e=this.getOffsets(c);d.left=Ext.fly(c).getX()-1+e[0]+"px";d.top=Ext.fly(c).getY()-1+e[1]+"px";d.width=(Ext.fly(c).getWidth()||parseInt(c.style.width.substring(0,
c.style.width.length-2),10))+2+"px";d.height=(Ext.fly(c).getHeight()||parseInt(c.style.height.substring(0,c.style.height.length-2),10))+2+"px";b&&this.updateHighlightContent(b)},findComponentByTarget:function(a){var b=this.getExt(),c;a.ownerDocument!==window.document&&(b=(a.ownerDocument.parentWindow||a.ownerDocument.defaultView).frameElement.contentWindow.Ext);for(;!c&&a&&"BODY"!==a.nodeName;)c=b.getCmp(a.id),a=a.parentNode;return c},getOffsets:function(a){var b=[0,0];a.ownerDocument!==this.window.document&&
(b=Ext.fly((a.ownerDocument.parentWindow||a.ownerDocument.defaultView).frameElement).getXY(),b[0]-=a.ownerDocument.body.scrollLeft,b[1]-=a.ownerDocument.body.scrollTop);return b},findExtAncestorClassName:function(a){for(;a;){var b=Ext.ClassManager.getName(a);if(b.match(/^Ext./))return b;a=a.superclass}return""}}),Ext.define("Siesta.Harness.Browser.UI.DomContainer",{extend:"Ext.Panel",alias:"widget.domcontainer",cls:"siesta-domcontainer",header:!1,collapsible:!0,animCollapse:!1,padding:10,test:null,
testListeners:null,maintainViewportSize:!0,canManageDOM:!0,suspendAfterLayoutAlign:!1,inspector:null,initComponent:function(){var a=this;this.testListeners=[];this.title=Siesta.Resource("Siesta.Harness.Browser.UI.DomContainer","title");Ext.apply(this,{dockedItems:this.consoleCt={xtype:"component",dock:"bottom",hidden:!0,height:20,cls:"domcontainer-console",renderTpl:'<div><input type="text" /></div>'}});this.callParent();this.on({afterlayout:this.onAfterLayout,expand:this.onExpand,collapse:this.onCollapse,
scope:this});this.inspector=new Siesta.Harness.Browser.UI.ComponentInspector({resolveTarget:function(b){return a.test.normalizeElement(b)}});this.inspector.on({start:this.onInspectionStart,stop:this.onInspectionStop,scope:this});this.relayEvents(this.inspector,["start","stop"],"inspection")},afterRender:function(){this.callParent(arguments);var a=this.consoleInput=this.el.down(".domcontainer-console input");this.inspector.on("targethover",function(b,c){a.dom.value='Ext.getCmp("'+c.id+'").'});this.inspector.on("targetselected",
function(b,c){a.focus(!0)});a.on({keyup:function(b,c){var d=a.dom.value;if(b.getKey()===b.ENTER&&d){var e=this.getIFrame();try{var g=e.contentWindow.eval(d);window.console&&console.log(g)}catch(f){window.console&&console.log(f.message)}}},scope:this})},setCanManageDOM:function(a){(this.canManageDOM=a)&&!this.hidden&&this.alignIFrame()},getIFrameWrapper:function(){var a=this.test;return a?this.canManageDOM&&a.scopeProvider&&a.scopeProvider.wrapper||null:null},getIFrame:function(){var a=this.test;return a?
this.canManageDOM&&a.scopeProvider&&a.scopeProvider.iframe||null:null},onAfterLayout:function(){this.suspendAfterLayoutAlign||this.alignIFrame()},alignIFrame:function(){var a=this.getIFrameWrapper();if(this.isFrameVisible()&&a){Ext.fly(a).removeCls("tr-iframe-hidden");Ext.fly(a).removeCls("tr-iframe-forced");var b=this.body.getBox();Ext.fly(a).setBox(b);this.maintainViewportSize||Ext.fly(this.getIFrame()).setSize(this.body.getSize());(a=this.test)&&a.fireEvent("testframeshow")}},onCollapse:function(){this.hideIFrame()},
onExpand:function(){this.alignIFrame()},hideIFrame:function(){var a=this.getIFrameWrapper();a&&Ext.fly(a).setStyle({left:"-10000px",top:"-10000px"});(a=this.test)&&a.fireEvent("testframehide")},isFrameVisible:function(){return!(this.hidden||this.collapsed)},showTest:function(a,b){this.stopInspection();this.test&&(Joose.A.each(this.testListeners,function(a){a.remove()}),this.testListeners=[],this.hideIFrame());this.test=a;this.testListeners=[a.on("testfinalize",this.onTestFinalize,this)];this.setCanManageDOM(!a.hasForcedIframe());
this.alignIFrame()},onTestFinalize:function(a,b){this.setCanManageDOM(!0);this.isFrameVisible()&&(b.forceDOMVisible=!1,b.isDOMForced=!1)},destroy:function(){Ext.destroy(this.boxIndicator);this.boxIndicator=null;this.hideIFrame();Joose.A.each(this.testListeners,function(a){a.remove()});this.test=null;this.callParent(arguments)},inspectedComponent:null,inspectedComponentXType:null,boxIndicator:null,inspecting:!1,toggleInspectionMode:function(a){this.test&&(a?this.startInspection():this.stopInspection())},
startInspection:function(a){this.inspector.start(this.test.global,this.getIFrameWrapper());var b=Ext.get(this.getIFrameWrapper());b.un("mouseout",this.onMouseLeave,this);b.on("mouseout",this.onMouseLeave,this);!1!==a&&(this.consoleCt instanceof Ext.Component||(this.consoleCt=Ext.widget(this.consoleCt)),this.consoleCt.show());this.addCls("inspection-mode")},stopInspection:function(){this.inspector.stop();this.removeCls("inspection-mode");this.consoleCt.rendered&&this.consoleCt.hide()},onMouseLeave:function(a,
b){this.el.contains(a.relatedTarget)||Ext.fly(this.getIFrameWrapper()).contains(a.relatedTarget)||this.stopInspection()},onInspectionStart:function(){var a=Ext.get(this.getIFrameWrapper());if(a)a.on("mouseout",this.onMouseLeave,this)},onInspectionStop:function(){var a=Ext.get(this.getIFrameWrapper());a&&a.un("mouseout",this.onMouseLeave,this)},clearHighlight:function(){this.stopInspection()},highlightTarget:function(a,b){this.inspector.active||this.startInspection();this.inspector.highlightTarget(a,
b)}}),Ext.define("Siesta.Harness.Browser.UI.MouseVisualizer",{cursorEl:null,onEventSimulatedListener:null,onTestFinishedListener:null,harness:null,currentTest:null,currentContainer:null,supportsTransitions:null,clickEvents:{click:0,dblclick:0,touchstart:0,touchend:0,mousedown:0,contextmenu:0},constructor:function(a){a=a||{};Ext.apply(this,a);this.supportsTransitions=Ext.feature&&Ext.feature.has.CssAnimations;delete this.harness;this.setHarness(a.harness)},getCursorEl:function(){if(this.cursorEl)return this.cursorEl;
var a=this.currentContainer;if(!a)throw"Need container for cursor";return this.cursorEl=Ext.fly(a).down(".ghost-cursor")||Ext.fly(a).createChild({tag:"div",cls:"ghost-cursor"})},setHarness:function(a){this.harness&&(this.harness.un("testframeshow",this.onTestFrameShow,this),this.harness.un("testframehide",this.onTestFrameHide,this));if(this.harness=a)a.on("testframeshow",this.onTestFrameShow,this),a.on("testframehide",this.onTestFrameHide,this)},reset:function(){this.onEventSimulatedListener&&(this.onEventSimulatedListener.remove(),
this.onEventSimulatedListener=null);this.onTestFinishedListener&&(this.onTestFinishedListener.remove(),this.onTestFinishedListener=null);this.currentContainer=this.currentTest=this.cursorEl=null},onTestFrameShow:function(a){a=a.source;a!=this.currentTest&&(this.reset(),this.currentTest=a,this.harness.canShowCursorForTest(a)&&(this.currentContainer=a.scopeProvider.wrapper,this.onEventSimulatedListener=a.on("eventsimulated",this.onEventSimulated,this),this.onTestFinishedListener=a.on("testfinalize",
this.onTestFinished,this)))},onTestFrameHide:function(a){this.cleanupCursor();this.reset()},cleanupCursor:function(a,b){a=a||this.cursorEl;if(b=b||this.currentContainer){try{Ext.fly(a).remove()}catch(c){}try{Ext.select(".ghost-cursor-click-indicator",!1,b).remove()}catch(d){}}},onTestFinished:function(a,b){var c=this.cursorEl,d=this.currentContainer;this.reset();if(c){var e=this;c.addCls("ghost-cursor-hidden");setTimeout(function(){e.cleanupCursor(c,d)},2E3)}},onEventSimulated:function(a,b,c,d,e){d.match(/touch|mouse|click|contextmenu/)&&
(Ext.isNumber(e.clientX)&&Ext.isNumber(e.clientY))&&this.currentContainer&&(a=b.currentPosition[0],b=b.currentPosition[1],this.updateGhostCursor(d,a,b),this.supportsTransitions&&d in this.clickEvents&&this.showClickIndicator(d,a,b))},showClickIndicator:function(a,b,c){var d=Ext.fly(this.currentContainer).createChild({cls:"ghost-cursor-click-indicator ",style:"left:"+b+"px;top:"+c+"px"});setTimeout(function(){d.addCls("ghost-cursor-click-indicator-big")},5)},updateGhostCursor:function(a,b,c){var d=
this.getCursorEl();b="translate3d("+(b-5)+"px, "+c+"px, 0px)";d.setStyle({"-webkit-transform":b,"-moz-transform":b,"-o-transform":b,transform:b});switch(a){case "touchstart":case "mousedown":d.addCls("ghost-cursor-press");break;case "dblclick":d.addCls("ghost-cursor-press");Ext.Function.defer(d.removeCls,40,d,["ghost-cursor-press"]);break;case "touchend":case "mouseup":case "click":d.removeCls("ghost-cursor-press")}}}),Ext.define("Siesta.Harness.Browser.UI.AssertionGrid",{alias:"widget.assertiongrid",
extend:"Ext.tree.Panel",mixins:["Siesta.Harness.Browser.UI.CanFillAssertionsStore"],cls:"siesta-assertion-grid",enableColumnHide:!1,enableColumnMove:!1,enableColumnResize:!1,sortableColumns:!1,border:!1,minWidth:100,trackMouseOver:!1,autoScrollToBottom:!0,hideHeaders:!0,rowLines:!1,isStandalone:!1,rootVisible:!1,collapseDirection:"left",test:null,testListeners:null,viewType:"filterabletreeview",lines:!1,disableSelection:!0,bufferedRenderer:!1,initComponent:function(){this.testListeners=[];this.store||
(this.store=new Siesta.Harness.Browser.Model.AssertionTreeStore({proxy:"memory",root:{id:"__ROOT__",expanded:!0,loaded:!0}}));Ext.apply(this,{columns:[{xtype:"assertiontreecolumn"}],viewConfig:{enableTextSelection:!0,stripeRows:!1,markDirty:!1,animate:!1,trackOver:!1,store:new Ext.data.Store({fields:[],data:[]}),deferInitialRefresh:!1,getRowClass:this.getRowClass}});this.callParent(arguments);this.getView().on("itemadd",this.onMyItemAdd,this)},onMyItemAdd:function(a){!this.test.isFinished()&&this.autoScrollToBottom&&
this.ensureVisible(a[0])},getRowClass:function(a,b,c,d){b=a.getResult();c="";switch(b.meta.name){case "Siesta.Result.Diagnostic":return"tr-diagnostic-row "+(b.isWarning?"tr-warning-row":"");case "Siesta.Result.Summary":return"tr-summary-row "+(b.isFailed?" tr-summary-failure":"");case "Siesta.Result.SubTest":return c="tr-subtest-row tr-subtest-row-"+a.get("folderStatus"),"describe"==b.test.specType&&(c+=" tr-subtest-row-describe"),"it"==b.test.specType&&(c+=" tr-subtest-row-it"),c;case "Siesta.Result.Assertion":return c+=
"tr-assertion-row ",c=b.isWaitFor?c+("tr-waiting-row "+(b.completed?b.passed?"tr-waiting-row-passed":"tr-assertion-row-failed tr-waiting-row-failed":"")):b.isException?c+(b.isTodo?"tr-exception-todo-row":"tr-exception-row"):b.isTodo?c+(b.passed?"tr-todo-row-passed":"tr-todo-row-failed"):c+(b.passed?"tr-assertion-row-passed":"tr-assertion-row-failed");default:throw"Unknown result class";}},showTest:function(a,b){this.test&&(Joose.A.each(this.testListeners,function(a){a.remove()}),this.testListeners=
[]);this.test=a;this.testListeners=[].concat(this.isStandalone?[a.on("testupdate",this.onTestUpdate,this),a.on("testendbubbling",this.onEveryTestEnd,this)]:[]);Ext.suspendLayouts();b?this.reconfigure(b):this.store.removeAll();Ext.resumeLayouts()},onTestUpdate:function(a,b,c,d){this.processNewResult(this.store,b,c,d)},onEveryTestEnd:function(a,b){this.processEveryTestEnd(this.store,b)},bindStore:function(a,b,c){this.callParent(arguments);(this.store=a)&&a.nodeStore&&(this.getView().dataSource=a.nodeStore,
this.getView().bindStore(a,b,c))},destroy:function(){Joose.A.each(this.testListeners,function(a){a.remove()});this.testListeners=[];this.test=null;this.callParent(arguments)},setInitializing:function(a){a?this.getView().addCls("siesta-test-initializing"):this.getView().removeCls("siesta-test-initializing")}}),Ext.define("Siesta.Harness.Browser.UI.AssertionTreeColumn",{extend:"Ext.tree.Column",alias:"widget.assertiontreecolumn",imgWithOffsetText:'<img src="{1}" class="{0}" style="left:{2}px" />',tdCls:"tr-tree-column",
resultTpl:null,dataIndex:"folderStatus",flex:1,menuDisabled:!0,sortable:!1,descriptionTpl:'<span class="assertion-text">{text}</span>',initComponent:function(){this.descriptionTpl=this.descriptionTpl instanceof Ext.XTemplate?this.descriptionTpl:new Ext.XTemplate(this.descriptionTpl);Ext.apply(this,{scope:this});this.callParent(arguments)},renderer:function(a,b,c,d,e,g){b="";b=c.data.result;a=b.annotation;if(b instanceof Siesta.Result.Summary)return c.data.result.description.join("<br>");b=this.descriptionTpl.apply({text:Ext.String.htmlEncode(b.isWarning?
"WARN: "+b.description:b.description)});a&&(b+='<pre title="'+a.replace(/"/g,"'")+'" style="margin-left:'+16*c.data.depth+'px" class="tr-assert-row-annontation">'+Ext.String.htmlEncode(a)+"</pre>");return b},_treeRenderer:function(a,b,c,d,e,g,f){for(var l=[],m=Ext.String.format,n=c.getDepth(),p=this.treePrefix,r=this.elbowPrefix,s=this.expanderCls,t=this.imgText,w=this.checkboxText,y=this.origRenderer.apply(this.origScope,arguments),z=Ext.BLANK_IMAGE_URL,C=c.get("href"),M=c.get("hrefTarget"),H=c.get("cls");c;){if(!c.isRoot()||
c.isRoot()&&f.rootVisible)c.getDepth()===n?(l.unshift(m(t,p+"icon "+p+"icon"+(c.get("icon")?"-inline ":c.isLeaf()?"-leaf ":"-parent ")+(c.get("iconCls")||""),c.get("icon")||z)),null!==c.get("checked")&&(l.unshift(m(w,p+"checkbox"+(c.get("checked")?" "+p+"checkbox-checked":""),c.get("checked")?'aria-checked="true"':"")),c.get("checked")&&(b.tdCls+=" "+p+"checked")),c.isLast()?c.isExpandable()?l.unshift(m(t,r+"end-plus "+s,z)):l.unshift(m(t,r+"end",z)):c.isExpandable()?l.unshift(m(t,r+"plus "+s,z)):
(l.unshift(m(t,p+"elbow",z)),l.unshift(m(this.imgWithOffsetText,p+"elbow-line tr-elbow-line",z,16*(c.getDepth()-1))))):c.isLast()||0===c.getDepth()?l.unshift(m(t,r+"empty",z)):0!==c.getDepth()&&(l.unshift(m(t,r+"line",z)),l.unshift(m(t,r+"line tr-elbow-line",z)));c=c.parentNode}C?l.push('<a href="',C,'" target="',M,'">',y,"</a>"):l.push(y);H&&(b.tdCls+=" "+H);return l.join("")}}),Ext.define("Siesta.Harness.Browser.UI.TestNameColumn",{extend:"Ext.tree.Column",xtype:"testnamecolumn",sortable:!1,dataIndex:"title",
menuDisabled:!0,flex:1,tdCls:"test-name-cell",scope:this,filterGroups:null,store:null,initComponent:function(){var a=Siesta.Resource("Siesta.Harness.Browser.UI.TestGrid");Ext.apply(this,{items:[{xtype:"treefilter",emptyText:a.get("filterTestsText"),margins:"0 0 0 10",itemId:"trigger",filterGroups:this.filterGroups,filterField:"title",store:this.store,tipText:a.get("filterFieldTooltip")}]});this.callParent(arguments)},renderer:function(a,b,c){var d="",e="";b.tdCls="tr-test-status ";c.isLeaf()?d=(d=
c.get("test"))?c.get("isFailed")?"icon-flag":c.get("isRunning")&&!d.isFinished()?"icon-lightning":d.isFinished()?d.isPassed()?"icon-checkmark":"icon-bug":"icon-busy":c.get("isMissing")?"icon-close":c.get("isStarting")?"icon-busy":"icon-file-2":(b=c.get("folderStatus"),d=c.data.expanded?d+" icon-folder-open":d+" icon-folder","working"==b?d+=" icon-busy":"working"==b?d+=" icon-busy":"green"==b&&(e+=' <span class="folder-status-icon icon-checkmark"></span>'),d+=" tr-folder-"+b);return'<span class="test-icon '+
d+'"></span>'+e+a}}),Ext.define("Siesta.Harness.Browser.UI.TestGridController",{extend:"Ext.app.ViewController",alias:"controller.testgrid",control:{"#":{collapse:"onCollapse",expand:"onExpand"},"#tool-menu [option]":{click:"onMenuItemClick"},"[actionName^=run]":{click:"onRunBtnClicked"},"[actionName=show-coverage]":{click:"onShowCoverageReport"},"#aboutSiesta":{click:"onAboutSiesta"}},onCollapse:function(){Ext.getBody().down(".logo-link").hide()},onExpand:function(){Ext.getBody().down(".logo-link").show()},
onShowCoverageReport:function(){this.getView().fireEvent("showcoverageinfo",this)},onRunBtnClicked:function(a){this.getView().fireEvent("buttonclick",this,a,a.actionName)},onMenuItemClick:function(a){this.getView().fireEvent("optionchange",this,a.option,a.checked)},onAboutSiesta:function(){(new Siesta.Harness.Browser.UI.AboutWindow).show()}}),Ext.define("Siesta.Harness.Browser.UI.TestGrid",{extend:"Ext.tree.Panel",alias:"widget.testgrid",controller:"testgrid",requires:["Siesta.Harness.Browser.UI.FilterableTreeView"],
stateful:!0,rootVisible:!1,header:!1,rowLines:!1,border:!1,cls:"tr-testgrid",iconCls:"tr-status-neutral-small",width:340,collapsible:!0,expanded:!0,viewType:"filterabletreeview",enableColumnMove:!1,lines:!1,filter:null,filterGroups:!1,resultSummary:null,stateConfig:null,showSizeControls:!1,coverageReportButton:null,initComponent:function(){var a=this,b=Siesta.Resource("Siesta.Harness.Browser.UI.TestGrid"),c=this.stateConfig;Ext.apply(this,{title:b.get("title"),viewConfig:{enableTextSelection:!0,toggleOnDblClick:!1,
markDirty:!1,trackOver:!1,shouldUpdateCell:function(a,b,c){return"passCount"===b.dataIndex&&c&&!Ext.Array.contains(c,"passCount")&&!Ext.Array.contains(c,"todoPassCount")||"failCount"===b.dataIndex&&c&&!Ext.Array.contains(c,"failCount")&&!Ext.Array.contains(c,"todoFailCount")?0:Ext.tree.View.prototype.shouldUpdateCell.apply(this,arguments)}},columns:{onFocusableContainerLeftKey:Ext.emptyFn,onFocusableContainerRightKey:Ext.emptyFn,onHeaderClick:Ext.emptyFn,items:[{xtype:"testnamecolumn",store:this.store},
{header:b.get("passText"),width:50,sortable:!1,tdCls:"x-unselectable",menuDisabled:!0,dataIndex:"passCount",align:"center",renderer:this.passedColumnRenderer,scope:this},{header:b.get("failText"),width:50,sortable:!1,tdCls:"x-unselectable",menuDisabled:!0,dataIndex:"failCount",align:"center",renderer:this.failedColumnRenderer,scope:this}]},bbar:{xtype:"toolbar",cls:"main-bbar siesta-toolbar",border:!1,height:45,defaults:{scale:"large",width:30,tooltipType:"title"},items:[{glyph:58895,cls:"run-checked",
text:'<span class="icon-checkmark"></span>',tooltip:b.get("runCheckedText"),actionName:"run-checked"},{glyph:58898,cls:"run-all",tooltip:b.get("runAllText"),actionName:"run-all"},{glyph:58895,cls:"run-failed",text:'<span class="icon-bug"></span>',tooltip:b.get("runFailedText"),actionName:"run-failed"},{glyph:58903,tooltip:b.get("showCoverageReportText"),cls:"show-coverage",actionName:"show-coverage",disabled:!0},{glyph:58904,tooltip:b.get("optionsText"),cls:"options",action:"options",menu:{itemId:"tool-menu",
items:[{text:b.get("transparentExText"),option:"transparentEx",checked:c.transparentEx},{text:b.get("cachePreloadsText"),option:"cachePreload",checked:c.cachePreload},{text:b.get("autoLaunchText"),option:"autoRun",checked:c.autoRun},{text:b.get("speedRunText"),option:"speedRun",checked:c.speedRun},{text:b.get("breakOnFailText"),option:"breakOnFail",checked:c.breakOnFail},{text:b.get("debuggerOnFailText"),option:"debuggerOnFail",checked:c.debuggerOnFail},{xtype:"menuseparator"},{text:b.get("aboutText"),
itemId:"aboutSiesta"},{text:b.get("documentationText"),href:b.get("siestaDocsUrl"),hrefTarget:"_blank"}]}},"->",{xtype:"component",cls:"summary-bar",border:!1,width:55,itemId:"result-summary",data:{pass:0,fail:0},tpl:'<div><span class="total-pass">{pass}</span><span class="icon-checkmark"></span></div><div><span class="total-fail">{fail}</span><span class="icon-bug"></span></div>'}]},dockedItems:this.showSizeControls?[{xtype:"toolbar",cls:"size-toolbar",border:!0,dock:"bottom",items:[{xtype:"slider",
itemId:"framesizeSlider",width:130,value:3,increment:1,minValue:0,maxValue:this.viewportSizes.length-1,listeners:{change:this.onDimensionOrOrientationChange,scope:this}},{xtype:"label",cls:"size-label",itemId:"sizeLabel",width:65},{boxLabel:b.get("landscape"),itemId:"orientationCheckbox",xtype:"checkbox",checked:!0,listeners:{change:this.onDimensionOrOrientationChange,scope:this}}]}]:[]});this.callParent(arguments);a=this;this.getView().on("beforerefresh",function(){var b=a.down("#trigger");a.filterGroups&&
b.setFilterGroups(a.filterGroups);a.filter&&b.setValue(a.filter);return!a.filter},null,{single:!0});this.coverageReportButton=this.down("[actionName=show-coverage]")},onDimensionOrOrientationChange:function(a,b){var c=this.viewportSizes[this.framesizeSlider.getValue()],d=this.orientationCheckbox.getValue();this.sizeLabel.setText(c.join("x"));this.fireEvent("framesizechange",a,c[0],c[1],d)},getFilterValue:function(){return this.down("#trigger").getValue()},getFilterGroups:function(){return this.down("#trigger").getFilterGroups()},
passedColumnRenderer:function(a,b,c){if(!c.isLeaf())return"";0<c.data.todoPassCount&&(a+=' <span title="'+c.data.todoPassCount+" "+Siesta.Resource("Siesta.Harness.Browser.UI.TestGrid","todoPassedText")+'" class="tr-test-todo tr-test-todo-pass">+ '+c.data.todoPassCount+"</span>");return a},failedColumnRenderer:function(a,b,c){if(!c.isLeaf())return"";0<c.data.todoFailCount&&(a+=' <span title="'+c.data.todoFailCount+" "+Siesta.Resource("Siesta.Harness.Browser.UI.TestGrid","todoFailedText")+'" class="tr-test-todo tr-test-todo-fail">+ '+
c.data.todoFailCount+"</span>");return a},afterRender:function(){this.callParent(arguments);this.summaryPassEl=this.el.down(".total-pass");this.summaryFailEl=this.el.down(".total-fail");if(this.showSizeControls){this.orientationCheckbox=this.down("#orientationCheckbox");this.sizeLabel=this.down("#sizeLabel");this.framesizeSlider=this.down("#framesizeSlider");var a=this.viewportSizes[this.framesizeSlider.getValue()];this.sizeLabel.setText(a.join("x"))}},updateStatus:function(a,b){this.summaryPassEl.update(String(a));
this.summaryFailEl.update(String(b))},enableCoverageButton:function(){this.coverageReportButton.enable()},disableCoverageButton:function(){this.coverageReportButton.disable()},setFilterValue:function(a){this.down("treefilter").setValue(a)}}),Ext.define("Siesta.Harness.Browser.UI.TestGridContextMenu",{extend:"Ext.menu.Menu",xtype:"testgridcontextmenu",items:[{itemId:"uncheckOthers",text:Siesta.Resource("Siesta.Harness.Browser.UI.Viewport").get("uncheckOthersText")},{itemId:"uncheckAll",text:Siesta.Resource("Siesta.Harness.Browser.UI.Viewport").get("uncheckAllText")},
{itemId:"checkAll",text:Siesta.Resource("Siesta.Harness.Browser.UI.Viewport").get("checkAllText")},{itemId:"runThis",text:Siesta.Resource("Siesta.Harness.Browser.UI.Viewport").get("runThisText")},{xtype:"menuseparator"},{itemId:"expandAll",text:Siesta.Resource("Siesta.Harness.Browser.UI.Viewport").get("expandAll")},{itemId:"collapseAll",text:Siesta.Resource("Siesta.Harness.Browser.UI.Viewport").get("collapseAll")},{xtype:"menuseparator"},{itemId:"filterToCurrentGroup",text:Siesta.Resource("Siesta.Harness.Browser.UI.Viewport").get("filterToCurrentGroup")},
{itemId:"filterToFailed",text:Siesta.Resource("Siesta.Harness.Browser.UI.Viewport").get("filterToFailed")}]}),Ext.define("Siesta.Harness.Browser.UI.SourcePanel",{extend:"Ext.Panel",alias:"widget.sourcepanel",__filled__:!1,autoScroll:!0,cls:"test-source-ct",layout:"absolute",border:!1,bodyBorder:!1,setSource:function(a,b){var c=this.el;this.__filled__||(this.__filled__=!0,this.update(Ext.String.format('<pre class="brush: javascript;">{0}</pre>',a)),SyntaxHighlighter.highlight(c));c.select(".highlighted").removeCls("highlighted");
Ext.Array.each(b,function(a){c.select(".line.number"+a).addCls("highlighted")});if(0<b.length){var d=c.down(".highlighted");d&&d.scrollIntoView(c)}},clear:function(){this.__filled__=!1}}),Ext.define("Siesta.Harness.Browser.UI.ResultPanel",{extend:"Ext.Panel",alias:"widget.resultpanel",requires:["Siesta.Harness.Browser.UI.AssertionGrid","Siesta.Harness.Browser.UI.DomContainer"],slots:!0,test:null,testListeners:null,maintainViewportSize:!0,viewDOM:!1,border:!1,canManageDOM:!0,harness:null,isStandalone:!1,
showToolbar:!0,minWidth:100,layout:"border",sourceButton:null,filterButton:null,inspectionButton:null,recorderPanel:null,recorderConfig:null,initComponent:function(){var a=Siesta.Resource("Siesta.Harness.Browser.UI.ResultPanel");Ext.apply(this,{cls:"tr-container",tbar:{cls:"resultpanel-toolbar",defaults:{tooltipType:"title",scope:this},items:this.showToolbar?[{text:a.get("rerunText"),padding:"0 10",cls:"rerun-button",glyph:58895,scale:"medium",handler:this.onRerun},{xtype:"label",cls:"resultpanel-testtitle",
itemId:"resultpanel-testtitle",margin:"0 0 0 10",text:" "},"->",this.viewDomButton=new Ext.Button({tooltip:a.get("toggleDomVisibleText"),cls:"testaction-button",action:"view-dom",scale:"medium",glyph:58905,enableToggle:!0,scope:this,pressed:this.viewDOM,handler:function(a){this.setViewDOM(!this.viewDOM)}}),this.sourceButton=new Ext.Button({tooltip:a.get("viewSourceText"),action:"view-source",cls:"testaction-button",glyph:58880,scale:"medium",tooltipType:"title",disabled:!0,enableToggle:!0,scope:this,
handler:function(a){a.pressed?this.showSource():this.hideSource()}}),this.filterButton=new Ext.Button({tooltip:a.get("showFailedOnlyText"),action:"show-failed-only",cls:"testaction-button",scale:"medium",glyph:58914,tooltipType:"title",scope:this,enableToggle:!0,handler:this.onAssertionFilterClick}),this.inspectionButton=new Ext.Button({glyph:58899,cls:"testaction-button cmp-inspector",action:"toggle-cmp-inspector",scale:"medium",tooltip:a.get("componentInspectorText"),tooltipType:"title",handler:this.toggleComponentInspectionMode,
scope:this,enableToggle:!0}),this.recorderButton=new Ext.Button({glyph:58900,action:"toggle-recorder",cls:"testaction-button",scale:"medium",disabled:!Siesta.Recorder||Ext.isIE9m,tooltip:a.get("eventRecorderText"),handler:this.onRecorderClick,margin:"0 30 0 0",scope:this,enableToggle:!0}),{xtype:"versionupdatebutton"},{xtype:"component",id:"siesta-logo"}]:null},items:[{region:"center",slot:"cardContainer",xtype:"container",layout:{type:"card",deferredRender:!0},activeItem:0,minWidth:100,items:[{xtype:"assertiongrid",
slot:"grid",isStandalone:this.isStandalone,listeners:{itemdblclick:this.onAssertionDoubleClick,scope:this}},{xtype:"sourcepanel",slot:"source",tbar:{cls:"siesta-toolbar",padding:"6 10",items:[{text:Siesta.Resource("Siesta.Harness.Browser.UI.ResultPanel","closeText"),scope:this,scale:"medium",handler:this.hideSource}]}}].concat(Ext.ClassManager.getByAlias("widget.coveragereport")?{xtype:"coveragereport",slot:"coverageReport",harness:this.harness}:[])},{xtype:"domcontainer",region:"east",collapsible:!0,
split:{size:7},bodyStyle:"text-align : center",slot:"domContainer",stateful:!0,id:this.id+"-domContainer",width:"50%",cls:"siesta-domcontainer",collapsed:!this.viewDOM}]});this.callParent();this.slots.domContainer.on({expand:this.onDomContainerExpand,collapse:this.onDomContainerCollapse,inspectionstart:function(){this.inspectionButton.toggle(!0)},inspectionstop:function(){this.inspectionButton.toggle(!1)},scope:this})},ensureLayout:function(){var a=this.getWidth(),b=this.slots.cardContainer,c=this.slots.domContainer,
d=c.getWidth(),b=b.minWidth+20;a-d<b&&c.setWidth(Math.max(0,a-b))},showSource:function(a){var b=this.test;if(this.test){var c=[],d=this.slots,e=d.source;d.cardContainer.layout.setActiveItem(e);0===arguments.length?Ext.each(b.getFailedAssertions(),function(a){null!=a.sourceLine&&c.push(a.sourceLine)}):c=[a];e.setSource(b.getSource(),c)}},hideSource:function(a){a=this.slots;var b=a.cardContainer;b.layout.getActiveItem()===a.source&&b.layout.setActiveItem(a.grid)},setViewDOM:function(a){var b=this.slots.domContainer;
a?b.expand(!1):b.collapse(Ext.Component.DIRECTION_RIGHT,!1)},onDomContainerCollapse:function(){this.viewDOM=!1;this.viewDomButton.toggle(!1);this.fireEvent("viewdomchange",this,!1)},onDomContainerExpand:function(){this.viewDOM=!0;this.viewDomButton.toggle(!0);this.fireEvent("viewdomchange",this,!0)},onRerun:function(){this.fireEvent("rerun",this)},showTest:function(a,b){var c=this.slots.recorderPanel;this.slots.source.clear();this.filterButton&&this.filterButton.toggle(!1);this.hideSource();this.sourceButton&&
this.sourceButton.enable();var d=a.url;Ext.suspendLayouts();this.slots.grid.showTest(a,b);this.slots.domContainer.showTest(a,b);c&&(c.stop(),c.attachTo(a),this.test&&a.url!==this.test.url&&this.slots.cardContainer.layout.setActiveItem(0));this.setTestTitle(d);Ext.resumeLayouts();this.test=a},setTestTitle:function(a){this.testTitle.setText(a)},onAssertionFilterClick:function(a){var b=this.slots.grid,c=b.store;c.filterTreeBy&&(a.pressed?(b.addCls("assertiongrid-filtered"),c.filterTreeBy(function(a){a=
a.getResult();return!1===a.passed&&!a.isTodo})):(b.removeCls("assertiongrid-filtered"),c.clearTreeFilter()))},alignIFrame:function(){this.slots.domContainer.alignIFrame()},hideIFrame:function(){this.slots.domContainer.hideIFrame()},setInitializing:function(a){this.slots.grid.setInitializing(a)},onAssertionDoubleClick:function(a,b){var c=b.getResult();c instanceof Siesta.Result.Assertion&&!c.isPassed(!0)&&this.showSource(c.sourceLine)},toggleComponentInspectionMode:function(a){this.slots.domContainer.toggleInspectionMode(a.pressed)},
onRecorderClick:function(){var a=this.slots.cardContainer;this.recorderPanel||(this.recorderPanel=new Siesta.Recorder.UI.RecorderPanel({slot:"recorderPanel",harness:this.harness,domContainer:this.slots.domContainer,recorderConfig:this.recorderConfig,closeButton:{text:Siesta.Resource("Siesta.Harness.Browser.UI.ResultPanel","closeText"),handler:function(){a.layout.setActiveItem(0)}},listeners:{startrecord:function(a){this.fireEvent("startrecord",a)},show:function(){this.recorderButton.toggle(!0)},hide:function(){this.recorderButton.toggle(!1)},
scope:this}}),this.slots.cardContainer.add(this.recorderPanel),this.test&&this.slots.recorderPanel.attachTo(this.test));a.layout.getActiveItem()===this.recorderPanel?a.layout.setActiveItem(this.slots.grid):a.layout.setActiveItem(this.recorderPanel)},afterRender:function(){this.callParent(arguments);this.testTitle=this.down("#resultpanel-testtitle");this.child("bordersplitter").tracker.tolerance=0}}),Ext.define("Siesta.Harness.Browser.UI.AboutWindow",{extend:"Ext.Window",id:"aboutwindow",bodyPadding:20,
modal:!0,width:500,height:380,closeAction:"destroy",bodyStyle:"background: #fff",autoScroll:!0,initComponent:function(){this.title=Siesta.Resource("Siesta.Harness.Browser.UI.AboutWindow","titleText").replace("{VERSION}",Siesta.meta.VERSION||"1.0.0");this.html=Siesta.Resource("Siesta.Harness.Browser.UI.AboutWindow","bodyText");this.buttons={padding:"10 13",style:"background: transparent",items:[{hidden:!Siesta.Harness.Browser.Automation,text:Siesta.Resource("Siesta.Harness.Browser.UI.AboutWindow",
"upgradeText"),handler:function(){window.open("http://bryntum.com/store/siesta")}},{text:Siesta.Resource("Siesta.Harness.Browser.UI.AboutWindow","closeText"),handler:function(){this.up("window").close()}}]};this.callParent(arguments)}}),Ext.define("Siesta.Harness.Browser.UI.VersionUpdateButton",{extend:"Ext.Button",xtype:"versionupdatebutton",text:Siesta.Resource("Siesta.Harness.Browser.UI.VersionUpdateButton","newUpdateText"),action:"upgrade-siesta",hidden:!0,latestVersion:null,scale:"medium",constructor:function(){this.callParent(arguments);
this.scope=this;Siesta.meta.VERSION&&!window.location.href.match("^https")&&this.fetchVersionInfo()},fetchVersionInfo:function(){Ext.data.JsonP.request({url:"//bryntum.com/siesta_version",params:{v:Siesta.meta.VERSION},scope:this,callback:this.onRequestCompleted})},onRequestCompleted:function(a,b){a&&(b&&b.name&&(new Ext.Version(b.name)).isGreaterThan(Siesta.meta.VERSION||"1.0.0"))&&(this.latestVersion=b.name,this.show())},handler:function(){var a=Siesta.Resource("Siesta.Harness.Browser.UI.VersionUpdateButton"),
b=new Ext.Window({cls:"changelog-window",title:a.get("updateWindowTitleText")+(Siesta.meta.VERSION||"1.0.0"),bodyPadding:5,modal:!0,width:500,height:380,closeAction:"destroy",plain:!0,autoScroll:!0,buttons:{padding:"10 13",style:"background: transparent",items:[{cls:"light-button",href:"http://www.bryntum.com/products/siesta/download-lite",hrefTarget:"_blank",scale:"medium",text:a.get("downloadText")+this.latestVersion+a.get("liteText")},{cls:"light-button",href:"http://bryntum.com/customerzone",
hrefTarget:"_blank",scale:"medium",text:a.get("downloadText")+this.latestVersion+a.get("standardText")},{text:a.get("cancelText"),scale:"medium",handler:function(){b.close()}}]}});b.show();b.body.mask(a.get("loadingChangelogText"));Ext.data.Connection.prototype.useDefaultXhrHeader=!1;Ext.Ajax.request({url:"http://bryntum.com/changelogs/_siesta.php",callback:function(a,d,e){b.body.unmask();d&&e&&e.responseText?b.body.update(e.responseText):b.body.update(Siesta.Resource("Siesta.Harness.Browser.UI.ResultPanel",
"changelogLoadFailedText"))}});Ext.data.Connection.prototype.useDefaultXhrHeader=!0}}),Ext.define("Siesta.Harness.Browser.UI.Header",{extend:"Ext.Component",xtype:"siesta-header",cls:"siesta-header",afterRender:function(){var a=Siesta.Resource("Siesta.Harness.Browser.UI.Viewport");this.callParent(arguments);this.getEl().createChild([{tag:"a",cls:"logo-link",href:"#",cn:[{tag:"span",html:Siesta.meta.VERSION||"1.0.0",cls:"tr-version-indicator"}]},{tag:"div",cls:"right-top-area",cn:[{tag:"a",id:"bryntum-logo",
href:"http://bryntum.com/",target:"_blank",cls:"bryntum-logo"},{tag:"a",cls:"apidocs-link",href:a.get("apiLinkUrl"),target:"_blank",html:a.get("apiLinkText")}]},{tag:"div",id:"update-ct"}])}}),Ext.define("Siesta.Harness.Browser.UI.ViewportController",{extend:"Ext.app.ViewController",alias:"controller.viewport",control:{testgrid:{selectionchange:"onTestGridSelectionChange",checkchange:"onTestGridCheckChange",itemcontextmenu:"onTestFileContextMenu",itemdblclick:"onTestFileDoubleClick",showcoverageinfo:"showCoverageReport",
resize:"onTestGridResize",optionchange:"onTestGridOptionChange",buttonclick:"onTestGridToolbarClick",framesizechange:"onFrameSizeChange"},"testgridcontextmenu #uncheckOthers":{click:"uncheckOthers"},"testgridcontextmenu #runThis":{click:"runThisFile"},"testgridcontextmenu #uncheckAll":{click:"uncheckAll"},"testgridcontextmenu #checkAll":{click:"checkAll"},"testgridcontextmenu #expandAll":{click:"expandAll"},"testgridcontextmenu #collapseAll":{click:"collapseAll"},"testgridcontextmenu #filterToCurrentGroup":{click:"filterToCurrentGroup"},
"testgridcontextmenu #filterToFailed":{click:"filterToFailed"},resultpanel:{viewdomchange:"onDomPanelVisibilityChange",rerun:"rerunTest"},coveragereport:{backtomainui:"onCoverageReportBackToMainUI"}},filterToFailed:function(){var a=this.getView(),b=[];a.forEachTestFile(function(a){var d=a.get("test");d&&d.isFailed()&&b.push(a.get("title"))});b.length&&a.slots.filesTree.setFilterValue(b.join(" | "))},filterToCurrentGroup:function(){var a=this.getView(),b=a.currentFile.get("descriptor");b.parent&&a.slots.filesTree.setFilterValue(b.parent.group+
">")},onTestGridSelectionChange:function(a,b){if(b.length){var c=this.getView(),d=b[0],e=d.get("test");e&&c.slots.resultPanel.showTest(e,d.get("assertionsStore"));c.selectedURL=d.getId();c.saveState()}},onTestGridCheckChange:function(a,b){this.getView().setNodeChecked(a,b)},onTestFileContextMenu:function(a,b,c,d,e){a=this.getView();a.currentFile=b;a.contextMenu||(a.contextMenu=new Siesta.Harness.Browser.UI.TestGridContextMenu);a.contextMenu.showAt(e.getXY());e.preventDefault()},onTestFileDoubleClick:function(a,
b){var c=this.getView(),d=c.testsStore;if(d.isTreeFiltered()&&!b.isLeaf()){var e=[];b.cascadeBy(function(a){a!=b&&(a.isLeaf()&&d.isNodeFilteredIn(a))&&e.push(a.get("descriptor"))});c.harness.launch(e)}else c.launchTest(b)},showCoverageReport:function(){var a=this.getView(),b=a.slots.resultPanel,c=b.slots.cardContainer,d=b.slots.coverageReport;d.loadHtmlReport(a.harness.generateCoverageHtmlReport(!1));if(c.getLayout().getActiveItem()!==d)b.hideIFrame(),b.slots.domContainer.collapse(),c.getLayout().setActiveItem(d);
else this.onCoverageReportBackToMainUI()},onTestGridResize:function(){this.getView().slots.resultPanel.ensureLayout()},onTestGridOptionChange:function(a,b,c){a=this.getView();a.setOption(b,c);a.saveState()},onTestGridToolbarClick:function(a,b,c){a=this.getView();switch(c){case "run-checked":a.runChecked();break;case "run-failed":a.runFailed();break;case "run-all":a.runAll();break;case "stop":a.stopSuite(b)}},onFrameSizeChange:function(a,b,c,d){a=this.getView();d||(d=b,b=c,c=d);$(".tr-iframe").width(b);
$(".tr-iframe").height(c);a.harness.viewportHeight=c;a.harness.viewportWidth=b},uncheckOthers:function(){var a=this.getView(),b=a.currentFile;a.uncheckAllExcept(b);a.setNodeChecked(b,!0)},runThisFile:function(){var a=this.getView();a.harness.launch([a.currentFile.get("descriptor")])},uncheckAll:function(){this.getView().uncheckAllExcept()},checkAll:function(){var a=this.getView();a.testsStore.forEach(function(b){a.setNodeChecked(b,!0,!0)})},expandAll:function(){this.getView().slots.filesTree.expandAll()},
collapseAll:function(){this.getView().slots.filesTree.collapseAll()},onDomPanelVisibilityChange:function(a,b){var c=this.getView();c.setOption("viewDOM",b);c.saveState()},rerunTest:function(){this.getView().rerunTest()},onCoverageReportBackToMainUI:function(){var a=this.getView().slots.resultPanel;a.slots.cardContainer.getLayout().setActiveItem(0);a.alignIFrame()}}),Ext.supports&&(Ext.supports.TouchEvents&&!Ext.supports.Touch)&&(Ext.supports.Touch=!1,Ext.supports.touchScroll=!1),Ext.define("Siesta.Harness.Browser.UI.Viewport",
{extend:"Ext.container.Viewport",mixins:["Siesta.Harness.Browser.UI.CanFillAssertionsStore"],controller:"viewport",requires:"Ext.state.LocalStorageProvider Ext.state.CookieProvider ExtX.Reference.Slot Siesta.Harness.Browser.UI.TestGrid Siesta.Harness.Browser.UI.ResultPanel Siesta.Harness.Browser.UI.MouseVisualizer Siesta.Harness.Browser.UI.Header".split(" "),title:null,harness:null,stateful:!1,layout:"border",selection:null,selectedURL:null,filter:null,filterGroups:!1,testsStore:null,contextMenu:null,
mouseVisualizer:null,enableVersionCheck:!0,collapsedNodes:null,headerXType:"siesta-header",showSizeControls:!1,viewportSizes:[[640,480],[800,600],[1024,768],[1920,1080],[2048,1536]],initComponent:function(){var a=this.harness;Ext.getBody().addCls("siesta");Ext.getBody().on("keydown",this.onBodyKeyDown,this);Ext.setGlyphFontFamily("icomoon");Ext.state.Manager.setProvider(Ext.supports.LocalStorage?new Ext.state.LocalStorageProvider:new Ext.state.CookieProvider);this.selection={};a.stateful&&this.applyState(this.loadState());
var b=this.buildTreeData({id:"root",group:"test suite"+this.title,items:a.descriptors}).children,b=this.testsStore=new Siesta.Harness.Browser.Model.FilterableTreeStore({model:"Siesta.Harness.Browser.Model.TestFile",sortOnLoad:!1,root:{expanded:!0,children:b},proxy:"memory",listeners:{nodecollapse:this.saveState,nodeexpand:this.saveState,scope:this}});Ext.apply(this,{mouseVisualizer:Ext.isIE?void 0:new Siesta.Harness.Browser.UI.MouseVisualizer({harness:a}),slots:!0,items:[{region:"west",xtype:"testgrid",
store:b,slot:"filesTree",id:a.id.replace(/\s+|\./g,"_")+"-testTree",showSizeControls:this.showSizeControls,viewportSizes:this.viewportSizes,stateConfig:this.getState(),animate:!Ext.isIE,split:{size:7},filter:this.filter,filterGroups:this.filterGroups},{xtype:"resultpanel",region:"center",slot:"resultPanel",cls:"resultPanel-panel",viewDOM:this.getOption("viewDOM"),id:a.id.replace(/\s+|\./g,"_")+"-resultpanel",harness:a,recorderConfig:a.recorderConfig,maintainViewportSize:a.maintainViewportSize}]});
this.callParent();this.slots.filesTree.getView().on("viewready",this.onViewReady,this,{single:!0});this.on("afterlayout",this.onAfterLayout,this,{single:!0,delay:1});this.slots.filesTree.store.on({"filter-set":this.saveState,"filter-clear":this.saveState,scope:this});a.on("testendbubbling",this.onEveryTestEnd,this);a.on("hassomecoverageinfo",this.onHasSomeCoverageInfo,this);a.on("nocoverageinfo",this.onNoCoverageInfo,this);a.on("testsuitelaunch",this.onTestSuiteLaunch,this);window.location.href.match("^file:///")&&
(a=Siesta.Resource("Siesta.Harness.Browser.UI.Viewport"),Ext.Msg.alert(a.get("httpWarningTitle"),a.get("httpWarningDesc")))},buildTreeData:function(a){var b={id:a.id,title:a.group||a.title||a.name||a.url.replace(/(?:.*\/)?([^/]+)$/,"$1"),descriptor:a,nodeType:1,cloneNode:function(){return this}},c=this,d=b.id,e=this.collapsedNodes||{};if(a.group){var g=[];Ext.each(a.items,function(a){g.push(c.buildTreeData(a))});Ext.apply(b,{expanded:null!=e[d]||!1===a.expanded?!1:!0,checked:c.selection.hasOwnProperty(d)||
!1,folderStatus:"yellow",children:g,leaf:!1})}else Ext.apply(b,{url:a.url,leaf:!0,checked:c.selection.hasOwnProperty(d)||!1,passCount:0,failCount:0,time:0,assertionsStore:new Siesta.Harness.Browser.Model.AssertionTreeStore({model:"Siesta.Harness.Browser.Model.Assertion",proxy:"memory",root:{id:"__ROOT__",expanded:!0}})});return b},onBodyKeyDown:function(a){a.getKey()==Ext.EventObject.E&&a.ctrlKey&&this.rerunTest()},onAfterLayout:function(){if(this.getOption("autoRun")){var a=this.getChecked();this.harness.launch(a.length&&
a||this.harness.descriptors)}},onViewReady:function(){if(this.selectedURL){var a=this.testsStore.getNodeById(this.selectedURL);a&&this.slots.filesTree.getSelectionModel().select(a)}},setNodeChecked:function(a,b,c,d){var e=this,g=a.getId();b?this.selection[g]=1:delete this.selection[g];a.set("checked",b);!b&&a.parentNode&&e.setNodeChecked(a.parentNode,!1,!0,!0);a.isLeaf()||c||Ext.each(a.childNodes,function(a){e.setNodeChecked(a,b,!1,!0)});d||this.saveState()},forEachTestFile:function(a,b){this.testsStore.each(a,
b)},getChecked:function(){var a=[];this.forEachTestFile(function(b){b.get("checked")&&b.isLeaf()&&a.push(b.get("descriptor"))});return a},runChecked:function(){0<this.getChecked().length&&this.harness.launch(this.getChecked())},runFailed:function(){var a=[];this.forEachTestFile(function(b){var c=b.get("test");c&&c.isFailed()&&a.push(b.get("descriptor"))});0<a.length&&this.harness.launch(a)},runAll:function(){var a=[];this.forEachTestFile(function(b){b.isLeaf()&&a.push(b.get("descriptor"))});0<a.length&&
this.harness.launch(a)},stopSuite:function(a){this.performStop();a.disable();setTimeout(function(){a.enable()},1E3)},performStop:function(){this.harness.needToStop=!0;this.testsStore.forEach(function(a){a.get("isStarting")&&!a.get("isStarted")&&a.set("isStarting",!1)})},onBeforeScopePreload:function(a,b){this.testsStore.getNodeById(b).data.isStarted=!0},isTestRunningVisible:function(a){if(!(a.scopeProvider instanceof Scope.Provider.IFrame))return!1;if(this.harness.testOfForcedIFrame)return this.harness.testOfForcedIFrame.isFromTheSameGeneration(a);
var b=this.slots.resultPanel;return b.test&&b.test.isFromTheSameGeneration(a)?b.isFrameVisible():!1},resetDescriptors:function(a){var b=this.testsStore;Joose.A.each(this.harness.flattenDescriptors(a),function(a){var d=b.getNodeById(a.id);d.get("assertionsStore").removeAll(!0);d.reject();d.set("checked",this.selection.hasOwnProperty(a.id)||!1)},this)},onTestSuiteStart:function(a){Ext.getBody().addCls("testsuite-running");var b=this.slots.filesTree.getSelectionModel(),c=b.getLastSelected(),d=this.testsStore;
this.resetDescriptors(a);c&&b.select(d.getNodeById(c.getId()))},onTestSuiteLaunch:function(a,b){var c=this.testsStore,d={};Joose.A.each(this.harness.flattenDescriptors(b),function(a){var b=c.getNodeById(a.id);b.set({isMissing:a.isMissing,isStarting:!0});if((a=b.parentNode)&&!d[a.getId()]){for(b=a;b;b=b.parentNode)d[b.getId()]=!0;a.updateFolderStatus()}})},onTestSuiteEnd:function(a){Ext.getBody().removeCls("testsuite-running");this.updateStatusIndicator()},onTestStart:function(a){var b=this.testsStore.getNodeById(a.url);
b.beginEdit();b.set({test:a,isRunning:!0});b.endEdit();var c=this.slots.filesTree.getSelectionModel().getLastSelected();c&&c.getId()==a.url&&(c=this.slots.resultPanel,c.showTest(a,b.get("assertionsStore")),c.setInitializing(!1))},isTestUpdateActual:function(a,b){b=b||this.testsStore.getNodeById(a.url);var c=b.get("test");return c&&c.isFromTheSameGeneration(a)},onTestUpdate:function(a,b,c){var d=this.testsStore.getNodeById(a.url);this.isTestUpdateActual(a,d)&&(this.processNewResult(d.get("assertionsStore"),
a,b,c),this.getOption("breakOnFail")&&0<a.getFailCount()&&(this.performStop(),this.slots.filesTree.getSelectionModel().select(d)))},onTestEnd:function(a){var b=this.testsStore.getNodeById(a.url);this.isTestUpdateActual(a,b)&&(b.beginEdit(),b.set({passCount:a.getPassCount(),failCount:a.getFailCount(),todoPassCount:a.getTodoPassCount(),todoFailCount:a.getTodoFailCount()}),b.endEdit(),b.parentNode&&b.parentNode.updateFolderStatus());this.updateStatusIndicator()},onEveryTestEnd:function(a,b){var c=this.testsStore.getNodeById(b.url);
this.isTestUpdateActual(b,c)&&this.processEveryTestEnd(c.get("assertionsStore"),b)},onTestFail:function(a,b,c){b=this.testsStore.getNodeById(a.url);this.isTestUpdateActual(a,b)&&!a.isTodo&&(b.set("isFailed",!0),b.parentNode&&b.parentNode.updateFolderStatus())},getOption:function(a){switch(a){case "selection":return this.selection;case "selectedURL":return this.selectedURL;default:return this.harness[a]}},setOption:function(a,b){switch(a){case "selection":return this.selection=b||{};case "selectedURL":return this.selectedURL=
b;case "collapsedNodes":return this.collapsedNodes=b;case "filter":return this.filter=b;case "filterGroups":return this.filterGroups=b;default:return this.harness[a]=b}},getState:function(){return{autoRun:this.getOption("autoRun"),speedRun:this.getOption("speedRun"),viewDOM:this.getOption("viewDOM"),cachePreload:this.getOption("cachePreload"),transparentEx:this.getOption("transparentEx"),breakOnFail:this.getOption("breakOnFail"),debuggerOnFail:this.getOption("debuggerOnFail"),selectedURL:this.selectedURL,
selection:this.getCheckedNodes(),collapsedNodes:this.getCollapsedFolders(),filter:this.slots?this.slots.filesTree.getFilterValue():this.filter,filterGroups:this.slots?this.slots.filesTree.getFilterGroups():this.filterGroups}},getCheckedNodes:function(){var a={};this.testsStore.forEach(function(b){b.get("checked")&&(a[b.getId()]=1)});return a},getCollapsedFolders:function(){var a={};this.testsStore.forEach(function(b){b.isLeaf()||b.isExpanded()||(a[b.getId()]=1)});return a},applyState:function(a){var b=
this;a&&Joose.O.each(a,function(a,d){b.setOption(d,a)})},getStateId:function(){return"test-run-"+this.title},loadState:function(){var a=this.getStateId(),b=Ext.state.Manager.get(a);if(b)return b.collapsedNodes||(b.collapsedNodes=Ext.state.Manager.get(a+"-collapsed")),b.selection||(b.selection=Ext.state.Manager.get(a+"-selection")),b},saveState:function(){var a=this.getStateId(),b=this.getState();Ext.state.Manager.set(a+"-collapsed",b.collapsedNodes);Ext.state.Manager.set(a+"-selection",b.selection);
delete b.collapsedNodes;delete b.selection;Ext.state.Manager.set(a,b)},uncheckAllExcept:function(a){var b=this;this.testsStore.forEach(function(c){c!=a&&b.setNodeChecked(c,!1,!0)})},launchTest:function(a){var b=this.slots.resultPanel;a.data.leaf&&b.setInitializing(!0);this.harness.launch([a.get("descriptor")])},updateStatusIndicator:function(){var a=0,b=0;this.testsStore.forEach(function(c){(c=c.get("test"))&&c.isFinished()&&(a+=c.getPassCount(),b+=c.getFailCount())});this.slots.filesTree.updateStatus(a,
b)},rerunTest:function(){var a=this.slots.filesTree.getSelectionModel().getSelection()[0];a&&this.launchTest(a)},afterRender:function(){this.callParent(arguments);this.enableVersionCheck&&Siesta.Harness.Browser.UI.VersionUpdateButton&&setTimeout(function(){new Siesta.Harness.Browser.UI.VersionUpdateButton},3E3)},onHasSomeCoverageInfo:function(){this.slots.filesTree.enableCoverageButton()},onNoCoverageInfo:function(){this.slots.filesTree.disableCoverageButton()}}),Ext.XTemplate.override({strict:!0}),
Ext.data.Connection.override({parseStatus:function(a){var b=this.callOverridden(arguments);0===a&&(b.success=!0);return b}}));Siesta.Content.Manager.meta.extend({has:{instrumentedUrls:Joose.I.Object,logicalUnits:Joose.I.Object,logicalUnitsByFile:Joose.I.Object,includeCoverageUnits:null,excludeCoverageUnits:null,collector:{lazy:function(){return new IstanbulCollector}}},methods:{addRawCoverageResultsFrom:function(a,b){if(a.__coverage__)return this.getCollector().add(a.__coverage__),!0},addRawCoverageResult:function(a){this.getCollector().add(a)},
disposeCoverageCollector:function(){this.getCollector().dispose()},hasInstrumentedContentOf:function(a){a instanceof Siesta.Content.Resource&&(a=a.url);return"string"==typeof this.instrumentedUrls[a]},getInstrumentedContentOf:function(a,b,c){a instanceof Siesta.Content.Resource&&(a=a.url);var d=this.getContentOf(a);if(null==d)return null;var e=this.instrumentedUrls;if(e.hasOwnProperty(a))return e[a];try{return e[a]=this.instrument(b,d,a,c)}catch(g){return window.console&&console.warn("Instrumentation of the file failed: "+
a+", error: "+g),e[a]=null}},filterUnit:function(a,b){return(!this.includeCoverageUnits||this.includeCoverageUnits.test(a))&&!(this.excludeCoverageUnits&&this.excludeCoverageUnits.test(a))},instrument:function(a,b,c,d){var e=this,g=this.getLogicalUnits(b,c,d),f=[];Joose.A.each(g,function(a){e.filterUnit(a.name,d)&&f.push(a)});if(!f.length)return b;for(var g=[],l=0;l<f.length;l++){var m=f[l],n=m.content=m.content||b.substring(m.start,m.end+1);g.push(b.substring(0<l?f[l-1].end+1:0,m.start));g.push(a.instrumentSync(n,
m.name))}g.push(b.substring(f[f.length-1].end+1));Joose.A.each(f,function(a){var b=a.name;if(e.logicalUnits[b]&&e.logicalUnits[b].replace(/\r\n/g,"\n")!=a.content.replace(/\r\n/g,"\n"))throw"Re-declaration of coverage unit: "+b;e.logicalUnits[b]=a.content;e.logicalUnitsByFile[c]=e.logicalUnitsByFile[c]||{};e.logicalUnitsByFile[c][b]=a;delete a.content});return g.join("")},getState:function(){var a=this.urls,b={};Joose.O.each(this.instrumentedUrls,function(c,d){null!=c&&(b[d]=a[d])});return{rawContent:b,
instrumentedContent:this.instrumentedUrls,logicalUnitsContent:this.logicalUnits,logicalUnitsByFile:this.logicalUnitsByFile}},getLogicalUnitContent:function(a){return this.logicalUnits[a]},getLogicalUnitOfFile:function(a,b){return this.logicalUnitsByFile[a][b]},getLogicalUnits:function(a,b,c){return[{name:b,start:0,end:a.length-1,content:a,loc:{start:{line:1,column:0},end:{line:null,column:null}}}]}},override:{cache:function(a,b,c){var d=this.harness;if(d.isAutomated&&d.enableCodeCoverageAutomation&&
(0<d.testPage||d.hasPreviousReport))var e=this,g=arguments,f=this.SUPER,l=setInterval(function(){var a=window.__CONTENT_MANAGER_STATE__;a&&(e.urls=a.rawContent,e.instrumentedUrls=a.instrumentedContent,e.logicalUnits=a.logicalUnitsContent,e.logicalUnitsByFile=a.logicalUnitsByFile,clearInterval(l),window.__CONTENT_MANAGER_STATE__=null,f.apply(e,g))},100);else this.SUPERARG(arguments)}}});Siesta.Content.Manager.Browser.ExtJSCore.meta.extend({methods:{filterUnit:function(a,b){return"extjs_class"==b?this.SUPER(a.replace(/\//g,
"."),b):this.SUPERARG(arguments)},getLogicalUnits:function(a,b,c){if("extjs_class"==c){var d=acorn.parse(a,{locations:!0}),e=acorn.walk,g=[];e.recursive(d,{},{CallExpression:function(a,b,c){var d=a.callee,f=d.object,r=d.property;"MemberExpression"==d.type&&"Identifier"==f.type&&"Ext"==f.name&&"Identifier"==r.type&&"define"==r.name&&"Literal"==a.arguments[0].type?g.push({name:a.arguments[0].value.replace(/\./g,"/"),loc:a.loc,start:a.start,end:a.end}):e.base.CallExpression(a,b,c)}});return g}return this.SUPERARG(arguments)}}});
Siesta.Test.Browser.meta.extend({override:{waitForPageLoad:function(a,b){var c=this,d=this.global,e=!1,g=function(){d.removeEventListener("unload",g);e=!0};d.addEventListener("unload",g);this.chain({waitFor:function(){return e||"complete"!=c.global.document.readyState}},function(a){d.removeEventListener("unload",g);g=d=null;a()},{waitFor:function(){return"complete"==c.global.document.readyState}},{waitFor:50},function(){a&&c.processCallbackFromTest(a,[c.global],b||c)})},setTimeout:function(a,b){var c=
this.global.setTimeout;c(a,b)},clearTimeout:function(a){var b=this.global.clearTimeout;b(a)}}});Siesta.Test.Browser.meta.extend({override:{queueCommand:function(a,b){if(this.harness.isAutomated){var c=this,d=c.beginAsync();this.harness.queueCommand(a,function(a){b&&b(a);c.endAsync(d)})}else this.diag("Command: `"+a.name+"` skipped - not running in automation"),b&&b(!1)},screenshot:function(a,b){var c=this;c.fireEvent("beforescreenshot");c.queueCommand({name:"screenshot",fileName:a},function(a){c.fireEvent("screenshot");
b&&b(a)})}}});Siesta.Test.ExtJSCore.meta.extend({has:{installLoaderInstrumentationHook:!1},override:{waitForPageLoad:function(a,b){return this.SUPER(function(b){a.call(this,b,b.Ext)},b||this)},start:function(){this.installLoaderInstrumentationHook&&this.installLoaderHook();this.SUPERARG(arguments)}},methods:{installLoaderHook:function(){this.harness.generateLoaderInstrumentationHook()(this.harness,this.Ext(),this.global.StartTest.launchId)}}});Siesta.Harness.Browser.my.meta.extend({has:{separateContext:!1,
testScopesByURL:{lazy:Joose.I.Object},enableCodeCoverage:!1,coverageUnit:{lazy:function(){return"file"}},includeCoverageUnits:/.*/,excludeCoverageUnits:null,hasPreviousReport:!1,coverageNoSource:!1,instrumenter:null,currentContentManager:null,htmlCoverageReport:{lazy:function(){return new IstanbulSiestaHtmlReport({mode:"file"==this.getCoverageUnit()?"normal":"trueTree"})}},lcovCoverageReport:{lazy:"this.buildLcovReport"}},override:{setup:function(){var a=!1;this.enableCodeCoverage&&(window.Instrumenter&&
window.IstanbulCollector&&window.IstanbulSiestaHtmlReport&&window.IstanbulSiestaLcovReport?this.instrumenter=new Instrumenter:(a="ifloaded"!=String(this.enableCodeCoverage).toLowerCase(),this.enableCodeCoverage=!1));this.SUPERARG(arguments);a&&!this.isAutomated&&alert(Siesta.Resource("Siesta.Harness.Browser","codeCoverageWarningText"))},launch:function(){this.enableCodeCoverage&&(this.cachePreload=!0);this.SUPERARG(arguments)},onTestSuiteStart:function(a,b){this.enableCodeCoverage&&(this.currentContentManager&&
this.currentContentManager.disposeCoverageCollector(),this.currentContentManager=b,b.includeCoverageUnits=this.includeCoverageUnits,b.excludeCoverageUnits=this.excludeCoverageUnits,this.fireEvent("nocoverageinfo"));this.SUPERARG(arguments)},onTestEnd:function(a){this.enableCodeCoverage&&a.contentManager.addRawCoverageResultsFrom(a.scopeProvider.scope,a)&&this.fireEvent("hassomecoverageinfo");this.SUPERARG(arguments)},addPreviousCoverageInfo:function(a){this.currentContentManager.addRawCoverageResult(a)},
buildLcovReport:function(){var a=[];return new IstanbulSiestaLcovReport({dir:"dir",writer:{println:function(b){a.push(b)},writeFile:function(a,c){c(this)},getContent:function(){return a.join("\n")}}})},generateCoverageRawReport:function(a){var b=this.currentContentManager,b={contentManagerState:this.getContentManagerState(),rawReport:b.getCollector().getFinalCoverage(),coverageUnit:this.coverageUnit};return a?JSON.stringify(b):b},generateCoverageHtmlReport:function(a){var b=this.currentContentManager,
b={coverageNoSource:this.coverageNoSource,htmlReport:this.getHtmlCoverageReport().getTreeReport(b.getCollector(),b,this.coverageNoSource),coverageUnit:this.coverageUnit};return a?JSON.stringify(b):b},generateCoverageLcovReport:function(a){var b=this.getLcovCoverageReport();b.writeReport(this.currentContentManager.getCollector());b={lcovReport:b.opts.writer.getContent(),coverageUnit:this.coverageUnit};return a?JSON.stringify(b):b},canUseCachedContent:function(a){return this.enableCodeCoverage?a instanceof
Siesta.Content.Resource.JavaScript&&a.instrument:this.SUPER(a)},addCachedResourceToPreloads:function(a,b,c){if(this.enableCodeCoverage){var d=b.getInstrumentedContentOf(c,this.instrumenter,this.getCoverageUnit());if(null!=d){a.addPreload({type:"js",content:d});return}}this.SUPERARG(arguments)},getRawTotalCoverageInfo:function(a,b){var c=this.currentContentManager;b&&c.addRawCoverageResult(b);c=c.getCollector().getFinalCoverage();return a?JSON.stringify(c):c},getContentManagerState:function(a){var b=
this.currentContentManager.getState();return a?JSON.stringify(b):b},prepareScopeSeeding:function(a,b,c){this.getDescriptorConfig(b,"separateContext")||this.SUPERARG(arguments)},launchTest:function(a,b){var c=this,d=a.desc,e=d.url;if(!this.getDescriptorConfig(d,"separateContext"))return this.SUPERARG(arguments);var g=this.getTestScopesByURL()[e]=new Scope.Provider.IFrame({seedingCode:this.getSeedingCode(d,a.launchOptions.launchId)});this.cachePreload&&a.contentManager.hasContentOf(e)?g.addPreload({type:"js",
content:a.contentManager.getContentOf(e)}):g.seedingScript=this.resolveURL(e,a.scopeProvider,d);var f=a.testHolder;this.getDescriptorConfig(d,"transparentEx")||g.addOnErrorHandler(function(a,b,c,d,e){d=f.test;d.nbrExceptions++;d.failWithException(e||a+" "+b+" "+c)});var l=this.SUPER;g.setup(function(){var d=g.scope;a.startTestAnchor=d.StartTest;a.originalSetTimeout=d.setTimeout;a.originalClearTimeout=d.clearTimeout;l.call(c,a,b)})},getNewTestConfiguration:function(a,b,c,d){var e=this.SUPERARG(arguments);
this.getDescriptorConfig(a,"separateContext")&&(e.overrideSetTimeout=!1);return e},cleanupScopeForURL:function(a){this.SUPER(a);var b=this.getTestScopesByURL()[a];b&&(delete this.getTestScopesByURL()[a],b.cleanup())}}});Siesta.Harness.Browser.my.meta.extend({has:{commandId:1,commands:null,commandCallbacks:null},override:{start:function(){this.commands=[];this.commandCallbacks={};this.on("beforescreenshot",this.onBeforeScreenshot,this);this.on("screenshot",this.onScreenshot,this);this.SUPERARG(arguments)},
onCommandDone:function(a){this.commandCallbacks[a]();delete this.commandCallbacks[a]},queueCommand:function(a,b){var c=this.commandId++;a.id=c;this.commandCallbacks[c]=b;this.commands.push(a)},flushAutomationCommands:function(){var a=this.commands;this.commands=[];return a},onBeforeScreenshot:function(a){this.showForcedIFrameScreenshot(a.source)},onScreenshot:function(a){this.hideForcedIFrameScreenshot(a.source)}}});Siesta.Harness.Browser.ExtJSCore.meta.extend({has:{coverageUnit:{lazy:function(){return"extjs_class"}},
installLoaderInstrumentationHook:!0,excludeCoverageUnits:/^Ext/},override:{getNewTestConfiguration:function(a,b,c,d){var e=this.SUPERARG(arguments);e.installLoaderInstrumentationHook=this.enableCodeCoverage&&this.getDescriptorConfig(a,"installLoaderInstrumentationHook");return e}},methods:{generateLoaderInstrumentationHook:function(){return function(a,b,c){if(b&&b.Loader&&b.getVersion&&!window.__loaderInstrumentationHookInstalled__){__loaderInstrumentationHookInstalled__=!0;null==a&&(a=(window.opener||
window.parent).Siesta.my.activeHarness);null==b&&(b=window.Ext);null==c&&(c=a.currentLaunchId);var d=a.launches[c].contentManager;c=b.Loader;var e=a.getCoverageUnit(),g=a.instrumenter;c.syncModeEnabled=!0;var f=c.loadScriptFile,l=b.globalEval,m,n=function(a){d.addContent(m,a);a=d.getInstrumentedContentOf(m,g,e);l.call(b,a)};a=b.getVersion("touch");var p=b.getVersion("extjs");if(a){var r=c.onFileLoaded;c.onFileLoaded=function(){0>=this.numPendingFiles&&(this.numPendingFiles=1);return r.apply(this,
arguments)}}else if(p&&4==p.major)c.loadScriptFile=function(a,c,p,r,s){m=a.replace(/\?.*/,"");var M=d.getInstrumentedContentOf(m,g,e);null!=M?(l.call(b,M),c.call(r)):(b.globalEval=n,f.apply(this,arguments),b.globalEval=l);m=null};else if(p&&5==p.major){var s=b.Boot.Entry.prototype.inject;b.Boot.Entry.prototype.inject=function(a,b){if(!this.isCss()){m=this.url.replace(/\?.*/,"");d.addContent(m,a);var c=d.getInstrumentedContentOf(m,g,e);null!=c&&(a=c);m=null}s.call(this,a,b)}}}}},getLoaderInstrumentationHook:function(){return";("+
this.generateLoaderInstrumentationHook().toString()+")((window.opener || window.parent).Siesta.my.activeHarness, Ext, window.StartTest && window.StartTest.launchId)"}}});Siesta.Harness.Browser.ExtJS.my.coverageUnit="extjs_class";Siesta.Harness.Browser.ExtJS.getLoaderInstrumentationHook=function(){return this.my.getLoaderInstrumentationHook.apply(this.my,arguments)};Siesta.Harness.Browser.SenchaTouch.my.coverageUnit="extjs_class";Siesta.Harness.Browser.SenchaTouch.getLoaderInstrumentationHook=function(){return this.my.getLoaderInstrumentationHook.apply(this.my,
arguments)};Role("Siesta.Harness.Report.JSON",{requires:["flattenDescriptors","allPassed"],methods:{generateJSONReport:function(a){a=a||{};var b=this.combinePageReports(a.pageReports||this.generateUnifiedPageReport({descriptors:this.descriptors,asJSON:!0}));return a.asJSON?b:JSON.stringify(b)}}});Role("Siesta.Harness.Report.JUnit",{requires:["flattenDescriptors","allPassed"],methods:{convertDateToISO8601:function(a){var b=function(a,b){return b&&1!=b?10>a?"00"+a:100>a?"0"+a:a:10>a?"0"+a:a};return a.getFullYear()+
"-"+b(a.getMonth()+1)+"-"+b(a.getDate())+"T"+b(a.getHours())+":"+b(a.getMinutes())+":"+b(a.getSeconds())+"."+b(a.getMilliseconds(),2)},generateJUnitReport:function(a){a=a||{};var b=this.combinePageReports(a.pageReports||this.generateUnifiedPageReport({descriptors:this.descriptors,asJSON:!0})),c=this,d=new Siesta.Util.XMLNode({tag:"testsuite",attributes:{name:this.title||"No title",timestamp:this.convertDateToISO8601(new Date(this.startDate)),time:((this.endDate||new Date)-this.startDate)/1E3,hostname:"undefined"!=
typeof window&&window.location&&window.location.host||"undefined"!=typeof require&&require("os")&&require("os").hostname()||"localhost"}});if(a=a.properties){var e=d.appendChild({tag:"properties"});Joose.O.each(a,function(a,b){e.appendChild({tag:"property",attributes:{name:b,value:a}})})}var g=0,f=0,l=0,c=this;Joose.A.each(b.testCases,function(a){g++;var b=new Siesta.Util.XMLNode({tag:"testcase",attributes:{name:a.url,classname:a.jUnitClass}});if(a.fileIsMissing)f++,b.appendChild({tag:"error",textContent:"Can't open test file: "+
a.url});else{b.setAttribute("time",(a.endDate-a.startDate)/1E3);var e=function(a,b,d){Joose.A.each(a.assertions,function(a){"Siesta.Result.Assertion"!=a.type||a.isTodo||b.call(d||c,a);"Siesta.Result.SubTest"==a.type&&e(a,b,d)})},r=!1;e(a,function(a){a.passed||(a.isException?(f++,r=!0,b.appendChild({tag:"error",attributes:{type:a.exceptionType},textContent:a.annotation})):b.appendChild({tag:"failure",attributes:{message:a.description||"",type:a.name||"FAIL"},textContent:a.annotation||""}))});r||a.passed||
l++}d.appendChild(b)});d.setAttribute("tests",g);d.setAttribute("errors",f);d.setAttribute("failures",l);return d+""}}});Class("Siesta.Harness.Browser.Automation.ScriptExecution",{has:{id:{required:!0},chunks:Joose.I.Array,maxMessageSize:{required:!0},result:null,exception:null,resultPos:0,resultChunkIndex:0,isDestroyed:!1},methods:{execute:function(){if(this.isDestroyed)throw Error("Result already retrieved");var a=window.executeScript||eval;__EXECUTE_SCRIPT_RESULT__=null;try{a("__EXECUTE_SCRIPT_RESULT__ = (function () {"+
this.chunks.join("")+"})()")}catch(b){this.exception=b+""+(b.stack?"\n"+b.stack:"");return}this.result=JSON.stringify(__EXECUTE_SCRIPT_RESULT__)||"null";__EXECUTE_SCRIPT_RESULT__=void 0},addChunk:function(a,b){if(this.isDestroyed)throw Error("Result already retrieved");if(b!=this.chunks.length)throw Error("Non-sequential chunk index");this.chunks.push(a)},getPartialResult:function(a,b){if(this.isDestroyed)throw Error("Result already retrieved");if(a!=this.id)throw Error("Wrong id");if(this.exception){if(b)throw Error("Started from non-zero index");
var c=JSON.stringify({exception:this.exception,chunk:null,index:0,isLastChunk:!0});this.destroy();return c}var c=this.result,d=c.length,e=this.resultPos;if(this.resultChunkIndex!=b)throw Error("Non-sequential result fetching");if(e>=d)throw Error("Over fetching of the result");for(var g,f=0.8*this.maxMessageSize;!g;)if(g=JSON.stringify(c.substr(e,f)),g.length>this.maxMessageSize&&(g=null,f=Math.floor(0.8*f),!f))throw Error("Chunk size zero");c={exception:null,chunk:c.substr(e,f),index:this.resultChunkIndex++};
this.resultPos+=f;c.isLastChunk=this.resultPos>=d;c.isLastChunk&&this.destroy();return JSON.stringify(c)},destroy:function(){this.isDestroyed=!0;this.chunks=this.result=this.exception=null}}});Role("Siesta.Harness.Browser.Automation.PhantomJS",{requires:["getQueryParam"],has:{isPhantomJS:!1},override:{start:function(){null!=this.getQueryParam("phantom")&&(this.isPhantomJS=this.isAutomated=!0);this.SUPERARG(arguments)},launch:function(){this.SUPERARG(arguments);this.isPhantomJS&&console.log("__PHANTOMJS__:pageCount:"+
this.pageCount)}},after:{onTestUpdate:function(a,b,c){this.isPhantomJS&&console.log("__PHANTOMJS__:keepAlive")},log:function(){this.isPhantomJS&&console.log("__PHANTOMJS__:log:"+Array.prototype.slice.call(arguments).join(" "))},exit:function(a){a=a||0;if(this.isPhantomJS){if(0<this.pageCount){var b=this.generateUnifiedPageReport({asJSON:!0});console.log("__PHANTOMJS__:pageReport:"+JSON.stringify(b));var c=this.testPage==this.pageCount-1;this.enableCodeCoverageAutomation&&(c?__PREV_COVERAGE_INFO__&&
this.addPreviousCoverageInfo(__PREV_COVERAGE_INFO__):(console.log("__PHANTOMJS__:contentManagerState:"+this.getContentManagerState(!0)),console.log("__PHANTOMJS__:coverageInfo:"+this.getRawTotalCoverageInfo(!0,__PREV_COVERAGE_INFO__))));if(c){__PAGE_REPORTS__.push(b);b=__PAGE_REPORTS__;console.log("__PHANTOMJS__:summaryMessage:"+this.getAutomatedSummaryMessage(b));__REPORT_OPTIONS__&&(__REPORT_OPTIONS__.pageReports=b,console.log("__PHANTOMJS__:combinedReport:"+this.generateReport(__REPORT_OPTIONS__)));
var d=this;this.enableCodeCoverageAutomation&&__COVERAGE_REPORT_FORMATS__&&__COVERAGE_REPORT_FORMATS__.forEach(function(a){switch(a){case "html":console.log("__PHANTOMJS__:htmlReport:"+d.generateCoverageHtmlReport(!0));break;case "lcov":console.log("__PHANTOMJS__:lcovReport:"+d.generateCoverageLcovReport(!0));break;case "raw":console.log("__PHANTOMJS__:rawReport:"+d.generateCoverageRawReport(!0))}})}}console.log("__PHANTOMJS__:exit:"+a)}}}});Role("Siesta.Harness.Browser.Automation.Selenium",{requires:["getQueryParam"],
has:{isSelenium:!1},override:{start:function(){null!=this.getQueryParam("selenium")&&(this.isSelenium=this.isAutomated=!0,this.testPageSize=10);this.SUPERARG(arguments)}},before:{launch:function(){this.isSelenium&&"undefined"!=typeof Ext&&(this.needUI=!0)}}});Role("Siesta.Harness.Browser.Automation.TeamCityReporter",{requires:["log"],has:{isTeamCity:!1,tcEncodeRegExp:/(['\[\]])/g},after:{onTestStart:function(a){this.isTeamCity&&this.log("##teamcity[testStarted name='"+this.tcEncode(this.tcTestName(a))+
"']")},onTestEnd:function(a){this.isTeamCity&&this.log("##teamcity[testFinished name='"+this.tcEncode(this.tcTestName(a))+"']")},onTestUpdate:function(a,b,c){this.isTeamCity&&b instanceof Siesta.Result.Assertion&&(!b.isWaitFor||b.completed)&&(b.isTodo||!b.isException&&b.passed||this.tcFail(b))}},override:{start:function(){this.isTeamCity=null!=this.getQueryParam("isTeamCity");this.SUPERARG(arguments)},logWarning:function(a){this.isTeamCity&&this.log("##teamcity[testStdOut name='"+this.tcEncode(this.tcTestName(a.parent.test))+
"' out='["+this.tcEncode(Siesta.Resource("Siesta.Role.ConsoleReporter","warnText")+"] "+a)+"']");this.SUPER(a)}},methods:{tcTestName:function(a){return"."+(a.name||a.url)},tcFail:function(a){this.log("##teamcity[testFailed name='"+this.tcEncode(this.tcTestName(a.parent.test))+"' details='"+this.tcEncode(a)+"']")},tcEncode:function(a){return String(a).replace(/\r/g,"|r").replace(/\n/g,"|n").replace(this.tcEncodeRegExp,"|$1")}}});Role("Siesta.Harness.Browser.Automation",{does:[Siesta.Role.ConsoleReporter,
Siesta.Util.Role.CanFormatStrings],has:{includeTests:null,excludeTests:null,testPage:null,testPageSize:5,pageCount:null,outputLog:"__NULL__",lastActivity:null,exitCode:null,launchedDesc:null,currentScriptExecution:null,enableCodeCoverageAutomation:!1},override:{setup:function(){if(this.isAutomated){this.speedRun=!0;this.forcedRunCore="sequential";this.transparentEx=!1;this.keepNLastResults=0;this.needSummaryMessage=this.needUI=!1;this.enableCodeCoverage=(this.enableCodeCoverageAutomation="true"==
this.getQueryParam("enableCodeCoverage"))||this.enableCodeCoverage;var a=this.getQueryParam("coverageUnit");a&&(this.coverageUnit=a);this.hasPreviousReport="true"==this.getQueryParam("hasPreviousReport");this.coverageNoSource="true"==this.getQueryParam("coverageNoSource");this.waitForTimeout*=3;this.defaultTimeout*=3;var a=this.getQueryParam("include"),b=this.getQueryParam("exclude");a&&(this.includeTests=decodeURIComponent(a));b&&(this.excludeTests=decodeURIComponent(b));this.testPageSize=this.getQueryParam("pageSize")||
this.testPageSize;if(a=this.getQueryParam("page"))this.testPage=Number(a);this.getQueryParam("verbose")&&this.verbosity++;a=this.getQueryParam("pause");this.pauseBetweenTests=null!=a?a:3E3;this.lastActivity=new Date;var c=this;window.onerror=function(a,b,g,f,l){c.warn("[ERROR] message : "+a);c.warn("[ERROR] url     : "+b);c.warn("[ERROR] line    : "+g);f&&c.warn("[ERROR] col     : "+f);l&&l.stack&&c.warn("[ERROR] stack   : "+l.stack)}}this.SUPERARG(arguments)},launch:function(a,b,c){var d=this.includeTests?
RegExp(this.includeTests):null,e=this.excludeTests?RegExp(this.excludeTests):null,g=[];d||e?Joose.A.each(this.flattenDescriptors(a),function(a){if(!d||d.test(a.url))e&&e.test(a.url)||g.push(a)}):g=this.flattenDescriptors(a);a=this.testPageSize;var f=this.testPage;null!=f&&(this.pageCount=Math.ceil(g.length/a),g=g.slice(f*a,(f+1)*a));this.isAutomated&&!g.length?(this.warn("Filter regexp doesn't match any test URL - exiting"),this.exit(4)):this.SUPER(this.launchedDesc=g,b,c)}},after:{onTestUpdate:function(){this.isAutomated&&
(this.lastActivity=new Date)}},methods:{restartFromNextTest:function(){this.lastActivity=new Date;var a=this.launches[this.currentLaunchId],b=a.descriptorsLeft&&0<a.descriptorsLeft.length;a.descriptorsLeft&&this.runCoreSequential(a.descriptorsLeft,a.contentManager,a,a.callback);return b},getPageState:function(){return{lastActivity:this.lastActivity-0,log:this.flushLog(),exitCode:this.exitCode,commands:this.flushAutomationCommands()}},allPagesPassed:function(a){var b=!0;Joose.A.each(a,function(a){if(!a||
!a.passed)return b=!1});return b},flushLog:function(){var a=this.outputLog.replace(/\n$/,"");this.outputLog="__NULL__";return a},getLastActivity:function(){return this.lastActivity-0},log:function(){if(this.isAutomated){var a=Array.prototype.slice.call(arguments).join(" ")+"\n";this.outputLog="__NULL__"==this.outputLog?a:this.outputLog+a}},exit:function(a){this.isAutomated&&(this.exitCode=a||0)},generateUnifiedPageReport:function(a){a=a||{};var b=this,c={testSuiteName:this.title||"",startDate:this.startDate,
endDate:this.endDate||new Date-0,passed:this.allPassed(),testCases:[]};Joose.A.each(this.flattenDescriptors(a.descriptors||this.launchedDesc||this.descriptors),function(a){var e=b.getTestByURL(a.url);e&&c.testCases.push(a.isMissing?{fileIsMissing:!0}:e.getResults().toJSON())});return a.asJSON?c:JSON.stringify(c)},combinePageReports:function(a){if(!a||!a.length)throw Error("No pages to combine");var b;Joose.A.each(a,function(c,d){d?Joose.A.each(c.testCases,function(a){b.testCases.push(a)}):(b=Joose.O.copy(c),
b.testCases=b.testCases.slice());d==a.length-1&&(b.endDate=c.endDate)});b.passed=this.allPagesPassed(a);return b},getAutomatedSummaryMessage:function(a){arguments.length||(a=__PAGE_REPORTS__);var b=this.combinePageReports(a).testCases,c=b.length,d=0,e=0,g=0,f=0,l=0,m=b[b.length-1].endDate-b[0].startDate,n=m+"ms";1E3<=m&&(m/=1E3,n=m+"s",60<=m&&(n=Math.floor(m/60)+"m "+Math.floor(m%60)+"s",m/=60,60<=m&&(n=Math.floor(m/60)+"h "+Math.floor(m%60)+"m")));for(var p=function(a,b){for(var c=0;c<a.assertions.length;c++){var d=
a.assertions[c];"Siesta.Result.Assertion"==d.type&&b(d);"Siesta.Result.SubTest"==d.type&&p(d,b)}},m=0;m<b.length;m++){var r=b[m];r.fileIsMissing?d++:(r.passed||d++,p(r,function(a){a.isTodo?a.passed?f++:l++:(e++,a.passed||g++)}))}return this.formatString("{assertionsPassed} passed, {assertionsFailed} failed assertions took {!timeTotal} to complete",{testsFailed:d,testsPassed:c-d,testsTotal:c,timeTotal:n,assertionsTotal:e,assertionsPassed:e-g,assertionsFailed:g,todoPassed:f,todoFailed:l})},executeScript:function(a,
b,c,d,e){var g=this.currentScriptExecution;if(g){if(g.id!=a)throw Error("Another execution in progress");if(g.maxMessageSize!=b)throw Error("`maxMessageSize` has changed");}else{if(d)throw Error("Starting from non-zero chunk");this.currentScriptExecution=g=new Siesta.Harness.Browser.Automation.ScriptExecution({id:a,maxMessageSize:b})}g.addChunk(c,d);return e?(g.execute(),this.retrieveScriptResult(a,0)):"Chunk received successfully"},retrieveScriptResult:function(a,b){var c=this.currentScriptExecution;
if(!c)throw Error("No current script execution");var d=c.getPartialResult(a,b);c.isDestroyed&&(this.currentScriptExecution=null);return d}}});Siesta.Harness.Browser.my.meta.extend({does:[Siesta.Harness.Browser.Automation,Siesta.Harness.Browser.Automation.PhantomJS,Siesta.Harness.Browser.Automation.Selenium,Siesta.Harness.Browser.Automation.TeamCityReporter]});Siesta.Harness.meta.extend({does:[Siesta.Harness.Report.JSON,Siesta.Harness.Report.JUnit]});if("undefined"!==typeof Ext&&Ext.versions&&Ext.versions.extjs){Class("Siesta.Recorder.Target",
{has:{targets:Joose.I.Array,activeTarget:null},methods:{initialize:function(){this.targets||(this.targets=[]);var a=this.targets[0];a&&!this.activeTarget&&(this.activeTarget=a.type)},clear:function(){this.targets=[]},getTargets:function(){var a=this.getTarget();return a&&a.targets||null},getTarget:function(){return this.getTargetByType(this.activeTarget)},clearOffset:function(){this.setOffset(null)},setOffset:function(a){var b=this.getTarget();b&&(a?b.offset=a:delete b.offset)},getOffset:function(){var a=
this.getTarget();if(a)return a.offset},getTargetByType:function(a){var b;Joose.A.each(this.targets,function(c){if(c.type==a)return b=c,!1});return b},setUserTarget:function(a,b){var c=this.getTargetByType("user");c?(c.target=a,b?c.offset=b:delete c.offset):(c={type:"user",target:a},b&&(c.offset=b),this.targets.unshift(c));this.activeTarget="user"},isTooGeneric:function(){var a=this.targets;if(!a||0===a.length||1===a.length&&"xy"==a[0].type)return!0;if(2===a.length){var a=this.getTargetByType("xy"),
b=this.getTargetByType("css");if(a&&b&&"body"==b.target)return!0}return!1}}});!function(){var a=1;Class("Siesta.Recorder.Event",{has:{id:function(){return a++},type:null,timestamp:null,options:null,x:null,y:null,target:null,charCode:null,keyCode:null,button:null},methods:{},my:{has:{ID:1,HOST:null},methods:{fromDomEvent:function(a){var c={};["altKey","ctrlKey","metaKey","shiftKey"].forEach(function(d){a[d]&&(c[d]=!0)});var d={type:a.type,target:a.target,timestamp:Date.now(),options:c};a.type.match(/^key/)?
(d.charCode=a.charCode||a.keyCode,d.keyCode=a.keyCode):(d.x=a.pageX,d.y=a.pageY,d.button=a.button);return new this.HOST(d)}}}})}();!function(){var a=1;Class("Siesta.Recorder.Action",{has:{id:function(){return a++},action:null,value:null,target:null,toTarget:null,by:null,waitForPageLoad:!1,options:null,sourceEvent:null},methods:{initialize:function(){var a=this.target;!a||a instanceof Siesta.Recorder.Target||(this.target=new Siesta.Recorder.Target({targets:a}));!(a=this.toTarget)||a instanceof Siesta.Recorder.Target||
(this.toTarget=new Siesta.Recorder.Target({targets:a}))},setAction:function(a){this.action=a;this.hasTarget()||(this.target&&this.target.clear(),this.toTarget&&this.toTarget.clear())},hasTarget:function(){return this.isMouseAction()},getTarget:function(a){var c=this.target;return a?c:c&&this.target.getTarget()},isMouseAction:function(){return(this.action||"").toLowerCase()in{click:1,contextmenu:1,dblclick:1,drag:1,mousedown:1,mouseup:1,movecursorby:1,movecursorto:1}},resetValues:function(){this.sourceEvent=
this.options=this.by=this.toTarget=this.value=this.target=null},parseOffset:function(a){a=a.split(",");if(!(2>a.length))return!a[0].match("%")&&(a[0]=parseInt(a[0],10),isNaN(a[0]))||!a[1].match("%")&&(a[1]=parseInt(a[1],10),isNaN(a[1]))?void 0:a},clearTargetOffset:function(){this.setTargetOffset(null)},setTargetOffset:function(a){var c=this.target;c&&c.setOffset(a)},getTargetOffset:function(){var a=this.target;if(a)return a.getOffset()},objectToSource:function(a){var c=this,d="",e,g=function(d,e){e=
e||a[d];return e instanceof Array?d+" : ["+e.join(", ")+"]":"object"===typeof e?d+" : "+c.objectToSource(e):d+" : "+("string"===typeof e?'"'+e+'"':e)};a.target&&(d=g(a.action,a.target),e=!0,delete a.target,delete a.action);var f=Object.keys(a);0<f.length&&(d=d+(e?", ":"")+f.map(function(a){return g(a)}).join(", "));return"{ "+d+" }"},asCode:function(){var a=this.asStep();return a?"function"==typeof a?a:this.objectToSource(a):null},asStep:function(a){var c=this.action;if(!c)return null;a={action:this.action};
var d=this.getTarget(),e=this.value;if(this.hasTarget()){if(d)if("cq"==d.type){var g=d.target.indexOf("->");a.target=0<g?d.target.split("->").splice(1,0,">>").join():">>"+d.target}else a.target=d.target;else a.target="";d&&d.offset&&(a.offset=d.offset.slice())}this.options&&!Joose.O.isEmpty(this.options)&&(a.options=this.options);if(c.match(/^waitFor/))switch(c){case "waitForFn":return{waitFor:eval("(function() {\n        "+e.replace(/\n/g,"\n        ")+"\n    })")};case "waitForMs":return{waitFor:"Ms",
args:parseInt(e,10)};default:return a={waitFor:c.split("waitFor")[1],args:[]},e&&(a.args=e),a}else switch(c){case "click":case "dblclick":case "contextmenu":case "mousedown":case "mouseup":case "moveCursorTo":break;case "moveCursor":this.by&&(a.by=this.by);break;case "type":a.text=e;delete a.target;break;case "drag":if((e=this.toTarget)&&!e.isTooGeneric()){a.to=e.target;e.offset&&(a.toOffset=e.offset);break}a.by=this.by;break;case "fn":return eval("(function(next) {\n        "+e.replace(/\n/g,"\n        ")+
"\n        next();\n    })");default:return null}return this.waitForPageLoad?{waitFor:"PageLoad",args:[],trigger:a}:a}}})}();Ext.define("Siesta.Recorder.Model.Action",{extend:"Ext.data.Model",fields:[],$action:null,constructor:function(a){a instanceof Siesta.Recorder.Action||(a=new Siesta.Recorder.Action(a));this.callParent(arguments);this.$action=this.data=a}},function(){var a=this.prototype,b=[];Siesta.Recorder.Action.meta.getAttributes().each(function(a){b.push(a.name)});this.addFields?this.addFields(b):
a.fields.addAll(b);Joose.A.each("getTargetOffset isMouseAction parseOffset getTarget getTargets hasTarget asStep asCode".split(" "),function(b){a[b]=function(){return this.$action[b].apply(this.$action,arguments)}});Joose.O.each({clearTargetOffset:["target"],setTargetOffset:["target"],resetValues:["target","value"],setAction:["action","target"]},function(b,d){a[d]=function(){return this.$action[d].apply(this.$action,arguments)}})});Role("Siesta.Recorder.TargetExtractor.Recognizer.Grid",{requires:["jquery",
"getFirstNonExtCssClass","getNthPosition","findDomQueryFor"],override:{getCssQuerySegmentForElement:function(a,b,c,d){var e=this.Ext,g=e&&e.grid&&e.grid.View&&e.grid.View.prototype,f=g&&(g.rowSelector||g.itemSelector);if(!f)return this.SUPERARG(arguments);var l=this.jquery(a).closest(".x-grid-cell"),e=l[0];if(!e)return this.SUPERARG(arguments);var m=l.closest(f)[0],l=(l=(l=(l=this.getComponentOfNode(m))&&l.ownerCt)&&(l.el||l.element))&&l.dom;if(!m||m==d||$.contains(m,d)||!l)return this.SUPERARG(arguments);
if(m.id&&!this.ignoreDomId(m.id,m))g="#"+m.id;else{var n=this.getFirstNonExtCssClass(m);n?g="."+n:(g=g.itemSelector||f,f=this.getNthPosition(m,g),g=g+":nth-child("+(f+1)+")")}m=(f=this.getFirstNonExtCssClass(e))?"."+f:".x-grid-cell:nth-child("+(this.getNthPosition(e,".x-grid-cell")+1)+")";f=this.findDomQueryFor(a,e,1);g=g+" "+m+(f?" "+f.query:"");f&&f.foundId&&(g=f.query);return{current:l,segment:g,target:f?f.target:e}}}});Role("Siesta.Recorder.TargetExtractor.Recognizer.BoundList",{requires:["jquery"],
override:{getCssQuerySegmentForElement:function(a){var b=this.jquery(a).closest(".x-boundlist-item");return b.length?{current:b.closest(".x-boundlist")[0],segment:".x-boundlist-item:contains("+b[0].innerHTML+")",target:b[0]}:this.SUPERARG(arguments)}}});Role("Siesta.Recorder.TargetExtractor.Recognizer.View",{override:{getCssQuerySegmentForElement:function(a,b,c,d){var e=$(a).closest(".x-component");if(0===e.length||$.contains(e[0],d))return this.SUPERARG(arguments);var g=this.Ext,e=g&&g.getCmp(e[0].id);
if(!(e&&g.ComponentQuery.is(e,"dataview")&&0<$(a).closest(e.itemSelector).length))return this.SUPERARG(arguments);var f=e.itemSelector,l=a,g=a;$(a).is(f)||(l=$(a).closest(f)[0]);var m=Array.prototype.slice.apply(l.parentNode.childNodes).indexOf(l)+1,f=f+":nth-child("+m+") ";a!==l&&((m=this.getFirstNonExtCssClass(a))?f+="."+m:(m=this.allowNodeNamesForTargetNodes,this.allowNodeNamesForTargetNodes=!0,l=this.findDomQueryFor(a,l),this.allowNodeNamesForTargetNodes=m,l&&(f+=l.query,g=l.target)));return{current:(e.el||
e.element).dom,segment:f,target:g}}}});Role("Siesta.Recorder.TargetExtractor.Recognizer.NumberField",{override:{getCssQuerySegmentForElement:function(a){return a.className.match(/\bx-form-spinner-(?:up|down)/)?"."+a.className.match(/\bx-form-spinner-(?:up|down)/)[0]:this.SUPERARG(arguments)}}});Role("Siesta.Recorder.TargetExtractor.Recognizer.DatePicker",{override:{getCssQuerySegmentForElement:function(a){return a.className.match(/\bx-datepicker-date\b/)?".x-datepicker-date:contains("+a.innerHTML.match(/^\d{1,2}/)[0]+
")":this.SUPERARG(arguments)}}});Class("Siesta.Recorder.TargetExtractor",{has:{lookUpUntil:"HTML",saveOffset:!0,skipNodeNameForCSS:!1,ignoreIdRegExp:function(){return/\0/},ignoreClasses:Joose.I.Array,ignoreCssClassesRegExp:null,allowNodeNamesForTargetNodes:!0,allowParentMatching:!0,uniqueDomNodeProperty:"id"},methods:{initialize:function(){this.ignoreCssClassesRegExp=this.ignoreClasses.length?RegExp(this.ignoreClasses.join("|")):/\0/},ignoreDomId:function(a,b){return this.ignoreIdRegExp.test(a)},
ignoreCssClass:function(a){return this.ignoreCssClassesRegExp.test(a)},jquery:function(a){this.rebindJQueryTo(a);return $(a)},findOffset:function(a,b,c){c=this.jquery(c).offset();c.left=Math.round(c.left);c.top=Math.round(c.top);return[a-c.left,b-c.top]},getCssClasses:function(a){a=a.classList;for(var b=[],c={},d=0;d<a.length;d++){var e=a[d];this.ignoreCssClass(e)||c[e]||(b.push(e),c[e]=!0)}return this.processCssClasses(b)},getCssQuerySegmentForElement:function(a,b,c,d){c=null!=c?c:1E10;if(a==a.ownerDocument.body)return"body";
if("id"!==this.uniqueDomNodeProperty&&(d=$(a).attr(this.uniqueDomNodeProperty)))return"["+this.uniqueDomNodeProperty+"='"+d+"']";if(a.id&&!this.ignoreDomId(a.id,a))return"#"+a.id.replace(/:/gi,"\\:").replace(/\./gi,"\\.");d=this.getCssClasses(a);var e=a.nodeName.toLowerCase();d.length>c&&(d.length=c);return 0<d.length?"."+d.join("."):"a"===e&&a.innerHTML&&0>a.innerHTML.indexOf("<")&&0>a.innerHTML.indexOf("(")&&0>a.innerHTML.indexOf(")")?"a:contains("+a.innerHTML+")":b&&this.allowNodeNamesForTargetNodes?
a.nodeName.toLowerCase():null},processCssClasses:function(a){return a},findDomQueryFor:function(a,b,c){var d=a,e=[],g=a.ownerDocument,f=!1;b=b||g.body;for(var g=!1,l=d;l!=b;){var m=this.getCssQuerySegmentForElement(l,l==a,c,b);Object(m)===m&&(l=m.current,m.target&&(d=m.target),m=m.segment);if(a==l&&!m)if(this.allowParentMatching)g=!0;else break;if(m&&(g&&(d=l,g=!1),e.unshift(m),m.match(/^#/)||"id"!==this.uniqueDomNodeProperty&&$(l).attr(this.uniqueDomNodeProperty))){f=!0;break}if(l==b||$.contains(l,
b))break;l=l.parentNode}var n;c=!1;for(g=f?0:e.length-1;0<=g;g--){var p=e.slice(g),r=p.join(" ");a=this.jquery(b).find(r);if(1==a.length)if(a[0]==d){c=!0;n={query:r,target:d,foundId:f,parts:p};break}else return null;if(0==g&&a[0]==d)return{query:r,target:d,foundId:f}}if(c){d=n.parts;for(e=1;e<d.length-1;)this.domSegmentIsNotSignificant(d[e])&&(d.slice().splice(e,1),a=this.jquery(b).find(r),1==a.length&&(d.splice(e,1),e--)),e++;n.query=p.join(" ");delete n.parts;return n}return null},domSegmentIsNotSignificant:function(a){if(/^#/.test(a))return!1;
if(!/^\./.test(a))return!0;a=a.split(".");a.shift();for(var b=0;b<a.length;b++)if(!/^x-/.test(a[b]))return!1;return!0},resolveDomQuery:function(a,b){this.jquery(b).find(a)},insertIntoTargets:function(a,b,c){for(var d=this.calculateDistance(this.resolveTarget(b,c),c),e=0;e<a.length;e++){var g=a[e];if("xy"==g.type){a.splice(e,0,b);return}g=this.calculateDistance(this.resolveTarget(g,c),c);if(d<=g){a.splice(e,0,b);return}}a.push(b)},calculateDistance:function(a,b){for(var c=0;b&&a!=b;)c++,b=b.parentNode;
return c},rebindJQueryTo:function(a){a=a.ownerDocument;$.rebindWindowContext(a.defaultView||a.parentWindow)},resolveTarget:function(a,b){if("css"==a.type)return this.rebindJQueryTo(b),$(a.target)[0]},getTargets:function(a){var b=[],c=this.findDomQueryFor(a.target);c&&b.push({type:"css",target:c.query,offset:this.saveOffset?this.findOffset(a.x,a.y,c.target):null});b.push({type:"xy",target:[a.x,a.y]});return b},regExpEscape:function(a){return a.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}}});Class("Siesta.Recorder.TargetExtractor.ExtJS",
{isa:Siesta.Recorder.TargetExtractor,does:[Siesta.Recorder.TargetExtractor.Recognizer.Grid,Siesta.Recorder.TargetExtractor.Recognizer.BoundList,Siesta.Recorder.TargetExtractor.Recognizer.DatePicker,Siesta.Recorder.TargetExtractor.Recognizer.NumberField,Siesta.Recorder.TargetExtractor.Recognizer.View],has:{Ext:null,baseCSSPrefix:null,allowNodeNamesForTargetNodes:!1,ignoreIdRegExp:function(){return/^ext-element-|^ext-gen\d+|^ext-comp-\d+/},compAutoGenIdRegExp:/^ext-gen\d+|^ext-comp\d+/,uniqueComponentProperty:null,
componentIdentifiers:function(){return"id itemId text dataIndex iconCls type name title inputType fieldLabel".split(" ")},ignoreClasses:function(){return"-focus$ -over$ -selected$ -active$ -default$ -focused$ x-body x-box-item x-btn-wrap x-component x-datepicker-cell x-fit-item x-form-field x-form-empty-field x-form-required-field x-grid-cell-inner x-grid-view x-grid-resize-marker x-layout x-menu-item-link x-noicon x-resizable-overlay x-tab-noicon x-tab-default-noicon x-tab-default x-tree-icon x-trigger-index- x-unselectable x-grid-with-row-lines ^x-autocontainer- ^x-btn-inner x-panel-bwrap sch-gantt-terminal$ sch-gantt-task-handle$ sch-gantt-item sch-resizable-handle$ null undefined".split(" ")},
ignoreXTypes:function(){return["viewport","tableview","treeview","gridview",">>headercontainer[isColumn=undefined]"]}},methods:{initialize:function(){var a=this.uniqueComponentProperty;a&&this.componentIdentifiers.unshift.apply(this.componentIdentifiers,a instanceof Array?a:[a]);this.SUPER()},setExt:function(a){a=a.ownerDocument;if(this.Ext=(a.defaultView||a.parentWindow).Ext)this.baseCSSPrefix=this.Ext.baseCSSPrefix||"x"},getTargets:function(a){var b=a.target;this.setExt(b);var c=this.SUPERARG(arguments);
if(!this.Ext||!this.Ext.ComponentQuery)return c;var d=this.getComponentOfNode(b);if(d){var e=this.findComponentQueryFor(d);e&&(this.insertIntoTargets(c,{type:"cq",target:e.query,offset:this.saveOffset?this.findOffset(a.x,a.y,(d.el||d.element).dom):null},b),(d=this.findCompositeQueryFor(b,e,e.target))&&this.insertIntoTargets(c,{type:"csq",target:d.query,offset:this.saveOffset?this.findOffset(a.x,a.y,d.target):null},b))}return c},findCompositeQueryFor:function(a,b,c){if(!b&&(c=this.getComponentOfNode(a))){b=
this.findComponentQueryFor(c);if(!b)return null;c=b.target}return(a=this.findDomQueryFor(a,(c.el||c.element).dom,1))&&a.foundId?null:a?{query:b.query+" => "+a.query,target:a.target}:null},getComponentOfNode:function(a){for(var b=a.ownerDocument.body,c=this.Ext;a&&a!=b;){if(a.id&&c.getCmp(a.id))return c.getCmp(a.id);a=a.parentNode}return null},ignoreDomId:function(a,b){var c=this.Ext,d=this.SUPERARG(arguments);return!d&&c&&c.getCmp?(c=this.getComponentOfNode(b))&&this.hasAutoGeneratedId(c)&&-1<a.indexOf(c.id)?
!0:!1:d},ignoreComponent:function(a){var b=!1,c=this.Ext;Joose.A.each(this.ignoreXTypes,function(d){var e=/^>>(.*)/.exec(d);if(e&&c.ComponentQuery.is(a,e[1])||!e&&a.xtype==d)return b=!0,!1});return b},getComponentQuerySegmentForComponent:function(a){var b="";a.pickerField&&a.pickerField.getPicker&&(a=a.pickerField,b=".getPicker()");var c=this.Ext;c.ComponentQuery.is(a,"menu")&&(b="{isVisible()}");for(var d=a.getXType&&a.getXType()||a.xtype||a.xtypes[0],e=!1,g="",f=0;f<this.componentIdentifiers.length;f++){var l=
this.componentIdentifiers[f],m=a[l];if(m&&"string"===typeof m&&!("id"==l&&this.hasAutoGeneratedId(a)||"inputType"==l&&c.slider&&c.slider.Multi&&a instanceof c.slider.Multi||"title"==l&&"&#160;"==m||"name"==l&&this.propertyIsAutoGenerated(a,"name"))){m=m.replace(/,/g,"\\,").replace(/\[/g,"\\[").replace(/\]/g,"\\]");g="id"===l?"#"+m:"["+l+"="+m+"]";if("id"===l||"itemId"==l)e=!0;break}}return g||"component"!=d&&"container"!=d&&"toolbar"!=d&&!this.ignoreComponent(a)?(e?g:d+g)+b:null},propertyIsAutoGenerated:function(a,
b){if(!a.up)return!1;if(a.autoGenId&&0<=a[b].indexOf(a.id))return!0;var c=a.up("[autoGenId=true]");return Boolean(c)&&0<=a[b].indexOf(c.id)},hasAutoGeneratedId:function(a){return this.compAutoGenIdRegExp.test(a.id)?!0:a.autoGenId||this.propertyIsAutoGenerated(a,"id")},processCssClasses:function(a){var b=RegExp("^"+this.baseCSSPrefix),c=a.filter(function(a){return!b.test(a)});return c.length?c:a},findComponentQueryFor:function(a,b){for(var c=a,d=[],e=!1,g=0,f=!1,l=c;l&&l!=b;){var m=this.getComponentQuerySegmentForComponent(l);
if(l==a&&!m)if(this.allowParentMatching)f=!0;else break;if(m){f&&(c=l,f=!1);d.unshift(m);if(m.match(/^#/)){e=!0;break}m.match(/^\[itemId=.*\]/)&&(g=d.length)}do l=l.ownerCt;while(l&&l!=b&&this.ignoreComponent(l))}for(var n,f=!1,e=e?0:d.length-(g?g:1);0<=e;e--){var p=d.slice(e),r=p.join(" "),g=this.doNonStandardComponentQuery(r);if(1==g.length)if(g[0]==c){f=!0;n={query:r,target:c,parts:p};break}else return null;if(0==e&&g[0]==c)return{query:r,target:c}}if(f){c=n.parts;for(d=1;d<c.length-1;)this.componentSegmentIsNotSignificant(c[d])&&
(c.slice().splice(d,1),1==this.doNonStandardComponentQuery(r).length&&(c.splice(d,1),d--)),d++;n.query=p.join(" ");delete n.parts;return n}return null},componentSegmentIsNotSignificant:function(){return!1},doNonStandardComponentQuery:function(a,b){var c=this.Ext,d=/(.*?)(?:\.(\w+)\(\))?\s*$/.exec(a),e=d[2],c=c.ComponentQuery.query(d[1]+"{isVisible()}");if(e)for(d=0;d<c.length;d++)"[object Function]"==Object.prototype.toString.call(c[d][e])&&(c[d]=c[d][e]());return c},resolveTarget:function(a){if("cq"==
a.type){var b=this.doNonStandardComponentQuery(a.target)[0];return(b=b&&(b.el||b.element))&&b.dom}if("csq"==a.type){var b=a.target.split("=>"),c=this.resolveTarget({type:"cq",target:b[0]});return b=c&&this.jquery(c).find(b[1])[0]}return this.SUPERARG(arguments)},getFirstNonExtCssClass:function(a){for(var b=this.baseCSSPrefix,c=0;c<a.classList.length;c++){var d=a.classList[c];if(0!=d.indexOf(b))return d}return null},getNthPosition:function(a,b){var c=this.jquery(a).is(b)?a:this.jquery(a).closest(b)[0];
return Array.prototype.slice.apply(c.parentNode.childNodes).indexOf(c)}}});Class("Siesta.Recorder.Recorder",{does:[JooseX.Observable],has:{active:null,extractor:null,extractorClass:Siesta.Recorder.TargetExtractor.ExtJS,extractorConfig:null,uniqueComponentProperty:null,uniqueDomNodeProperty:"id",recordOffsets:!0,ignoreSynthetic:!0,window:null,idleTimeout:3E3,eventsToRecord:{init:function(){return"keydown keypress keyup click dblclick contextmenu mousedown mouseup".split(" ")}},events:Joose.I.Array,
actions:Joose.I.Array,actionsByEventId:Joose.I.Object},methods:{initialize:function(){this.onUnload=Ext.Function.bind(this.onUnload,this);this.onFrameLoad=Ext.Function.bind(this.onFrameLoad,this);this.onDomEvent=Ext.Function.bind(this.onDomEvent,this);this.resetMouseMoveListener=Ext.Function.bind(this.resetMouseMoveListener,this);var a=$.extend({saveOffset:this.recordOffsets,uniqueComponentProperty:this.uniqueComponentProperty,uniqueDomNodeProperty:this.uniqueDomNodeProperty},this.extractorConfig||
{});this.extractor=new this.extractorClass(a);this.onBodyMouseMove=this.throttleMouseMoveListener(this.onBodyMouseMove,this.idleTimeout,this)},isSamePoint:function(a,b){return a.x==b.x&&a.y==b.y},clear:function(){this.events=[];this.actions=[];this.fireEvent("clear",this)},onUnload:function(){var a=this.actions;(a=a.length&&a[a.length-1])&&a.target&&(a.waitForPageLoad=!0)},onFrameLoad:function(a){this.stop();this.attach(a.target.contentWindow);this.start()},attach:function(a){this.stop();this.events=
[];this.window=a},start:function(){this.stop();this.active=Date.now();this.onStart();this.fireEvent("start",this)},stop:function(){this.active&&(this.active=null,this.onStop(),this.fireEvent("stop",this))},getRecordedEvents:function(){return this.events},getRecordedActions:function(){return this.actions},getRecordedActionsAsSteps:function(){return Joose.A.map(this.actions,function(a){return a.asStep()})},onDomEvent:function(a){if(!(!a.target||this.ignoreSynthetic&&a.synthetic)){var b=a.type.match(/^key/),
c=Siesta.Test.Simulate.KeyCodes().keys;if(!b||a.keyCode!==c.SHIFT&&a.keyCode!==c.CTRL&&a.keyCode!==c.ALT)a=Siesta.Recorder.Event.fromDomEvent(a),this.resetMouseMoveListener(),this.convertToAction(a),this.events.push(a),this.fireEvent("domevent",a)}},eventToAction:function(a,b){var c=a.type;b||(b=c.match(/^key/)?"type":c);var c={action:b,target:this.extractor.getTargets(a),options:a.options,sourceEvent:a},d=a.target.ownerDocument.defaultView;if(d!==this.window){if(!d.frameElement.id)throw'To record events in a nested iframe, please set an "id" property on your frames';
c.target=c.target.filter(function(a){return"string"===typeof a.target?(a.target="#"+d.frameElement.id+" -> "+a.target,!0):!1})}return new Siesta.Recorder.Action(c)},recordAsAction:function(a,b){var c=this.eventToAction(a,b);c&&this.addAction(c)},addAction:function(a){this.actions.push(a);a.sourceEvent&&(this.actionsByEventId[a.sourceEvent.id]=a);this.fireEvent("actionadd",a)},removeAction:function(a){for(var b=this.actions,c=0;c<b.length;c++){var d=b[c];if(d==a){b.splice(c,1);d.sourceEvent&&delete this.actionsByEventId[d.sourceEvent.id];
this.fireEvent("actionremove",a);break}}},removeActionByEventId:function(a){this.removeAction(this.getActionByEventId(a))},removeActionByEvent:function(a){this.removeAction(this.getActionByEventId(a.id))},getActionByEventId:function(a){return this.actionsByEventId[a]},getLastAction:function(){return this.actions[this.actions.length-1]},convertToAction:function(a){var b=this.events,c=b.length,d=b[b.length-1],e=a.type;if("keypress"==e||"keyup"==e||"keydown"==e){var c=Siesta.Test.Simulate.KeyCodes(),
g="keydown"==e&&(c.isSpecial(a.keyCode)||c.isNav(a.keyCode)),d="keypress"==e&&d&&"keydown"==d.type&&(c.isSpecial(d.keyCode)||c.isNav(d.keyCode));if("keypress"==e&&!g&&!d||"keydown"==e&&g)b=this.getLastAction(),e=g?"["+c.fromCharCode(a.charCode,!0)+"]":String.fromCharCode(a.charCode),b&&"type"===b.action?(b.value+=e,this.fireEvent("actionupdate",b)):this.addAction(new Siesta.Recorder.Action({action:"type",value:e,sourceEvent:a,options:a.options}))}else if(c){if(d=b[c-1],c=2<=c?b[c-2]:null,g=d.type,
"click"!=e||"click"!=g||!d.target.getAttribute("for"))if("dblclick"==e)this.removeAction(this.getLastAction()),this.getLastAction().action="dblclick",this.fireEvent("actionupdate",this.getLastAction());else{if("mousedown"==g&&"mouseup"==e&&a.button==d.button&&!this.isSamePoint(a,d)){b=this.getLastAction();if("moveCursorTo"!=b.action){b.action="drag";b.by=[a.x-d.x,a.y-d.y];this.fireEvent("actionupdate",b);return}this.addAction(new Siesta.Recorder.Action({action:"moveCursorTo",target:this.extractor.getTargets(a),
sourceEvent:a,options:a.options}))}"click"===e&&this.getLastAction()&&"drag"===this.getLastAction().action||(c&&("click"===e||"contextmenu"===e)&&("mouseup"==g&&a.button==d.button&&a.button==c.button&&this.isSamePoint(a,d)&&"mousedown"==c.type&&(a.target==d.target||$.contains(a.target,d.target)||$.contains(d.target,a.target))&&(a.target==c.target||$.contains(a.target,c.target)||$.contains(c.target,a.target))&&this.isSamePoint(a,c))&&(this.removeActionByEvent(d),this.removeActionByEvent(c)),this.recordAsAction(a))}}else this.recordAsAction(a)},
onStart:function(){var a=this,b=a.window,c=b.document.body,d=this.getNestedFrames().map(function(a){return a.contentWindow});[b].concat(d).forEach(function(b){a.registerWindowListeners(b);b.frameElement&&b.frameElement.addEventListener("load",function(){a.registerWindowListeners(b)})});c.addEventListener("mousemove",this.onBodyMouseMove);$(c).bind("mouseleave",this.resetMouseMoveListener);b.frameElement&&b.frameElement.addEventListener("load",this.onFrameLoad);b.addEventListener("unload",this.onUnload)},
registerWindowListeners:function(a){var b=this;b.eventsToRecord.forEach(function(c){a.document.addEventListener(c,b.onDomEvent,!0)})},deregisterWindowListeners:function(a){var b=this;b.eventsToRecord.forEach(function(c){a.document.removeEventListener(c,b.onDomEvent,!0)})},getNestedFrames:function(){return Array.prototype.slice.apply(this.window.document.getElementsByTagName("iframe")).filter(function(a){return!0})},onStop:function(){var a=this,b=a.window,c=b.document.body,d=this.getNestedFrames().map(function(a){return a.contentWindow});
[b].concat(d).forEach(function(b){a.deregisterWindowListeners(b);b.frameElement&&b.frameElement.addEventListener("unload",function(){a.deregisterWindowListeners(b)})});c.removeEventListener("mousemove",this.onBodyMouseMove);$(c).unbind("mouseleave",this.resetMouseMoveListener);b.frameElement&&b.frameElement.removeEventListener("load",this.onFrameLoad);b.removeEventListener("unload",this.onUnload);this.resetMouseMoveListener()},resetMouseMoveListener:function(){clearTimeout(this.mouseMoveDeferTimer)},
onBodyMouseMove:function(a,b){if(a.target.ownerDocument===this.window.document){var c=new Siesta.Recorder.Event.fromDomEvent(a);this.addAction(new Siesta.Recorder.Action({action:"moveCursorTo",target:this.extractor.getTargets(c),sourceEvent:c,options:c.options}))}},throttleMouseMoveListener:function(a,b,c){var d,e=this;return function(){var g=c||this,f=Date.now(),l=arguments;d&&f<d+b?(clearTimeout(e.mouseMoveDeferTimer),e.mouseMoveDeferTimer=setTimeout(function(){d=f;a.apply(g,l)},b)):d=f}}}});var f=
function(){function a(f,k){function G(a){return 0<=a&&a<F.size}function B(a){for(var b=F;!b.lines;)for(var c=0;;++c){var d=b.children[c],e=d.chunkSize();if(a<e){b=d;break}a-=e}return b.lines[a]}function p(a,b){Qa=!0;for(var c=b-a.height,d=a;d;d=d.parent)d.height+=c}function R(a){var b={line:0,ch:0};ha(b,{line:F.size-1,ch:B(F.size-1).text.length},eb(a),b,b);cb=!0}function ra(a){if(!v.onDragEvent||!v.onDragEvent(Y,M(a))){a.preventDefault();var b=wa(a,!0),c=a.dataTransfer.files;if(b&&!v.readOnly)if(c&&
c.length&&window.FileReader&&window.File){a=function(a,c){var f=new FileReader;f.onload=function(){e[c]=f.result;++g==d&&(b=W(b),I(function(){var a=X(e.join(""),b,b);Na(b,a)})())};f.readAsText(a)};for(var d=c.length,e=Array(d),g=0,f=0;f<d;++f)a(c[f],f)}else try{(e=a.dataTransfer.getData("Text"))&&yc(function(){var a=u.from,c=u.to;Na(b,b);sc&&X("",a,c);Xa(e);ca()})}catch(h){}}}function ya(a){var b=qb();a.dataTransfer.setData("Text",b);if(la||ba)b=document.createElement("img"),b.scr="data:image/gif;base64,R0lGODdhAgACAIAAAAAAAP///ywAAAAAAgACAAACAoRRADs=",
a.dataTransfer.setDragImage(b,0,0)}function C(a,b){if("string"==typeof a&&(a=db[a],!a))return!1;var c=za;try{v.readOnly&&(bc=!0),b&&(za=null),a(Y)}catch(d){if(d!=ob)throw d;return!1}finally{za=c,bc=!1}return!0}function P(a){function e(){q=!0}var g=b(v.keyMap),f=g.auto;clearTimeout(Cc);f&&!d(a)&&(Cc=setTimeout(function(){b(v.keyMap)==g&&(v.keyMap=f.call?f.call(null,Y):f)},50));var h=Ca[fa(a,"keyCode")],k=!1;if(null==h||a.altGraphKey)return!1;fa(a,"altKey")&&(h="Alt-"+h);fa(a,"ctrlKey")&&(h="Ctrl-"+
h);fa(a,"metaKey")&&(h="Cmd-"+h);var q=!1,k=fa(a,"shiftKey")?c("Shift-"+h,v.extraKeys,v.keyMap,function(a){return C(a,!0)},e)||c(h,v.extraKeys,v.keyMap,function(a){if("string"==typeof a&&/^go[A-Z]/.test(a))return C(a)},e):c(h,v.extraKeys,v.keyMap,C,e);q&&(k=!1);k&&(H(a),L&&(a.oldKeyCode=a.keyCode,a.keyCode=0));return k}function dc(a,b){var d=c("'"+b+"'",v.extraKeys,v.keyMap,function(a){return C(a,!0)});d&&H(a);return d}function da(a){Aa||fb();L&&27==a.keyCode&&(a.returnValue=!1);Db&&yb()&&(Db=!1);
if(!v.onKeyEvent||!v.onKeyEvent(Y,M(a))){var b=fa(a,"keyCode");ic(16==b||fa(a,"shiftKey"));var c=P(a);window.opera&&(vc=c?b:null,!c&&(88==b&&fa(a,ta?"metaKey":"ctrlKey"))&&Xa(""))}}function fb(){if("nocursor"!=v.readOnly){if(!Aa){if(v.onFocus)v.onFocus(Y);Aa=!0;-1==Q.className.search(/\bCodeMirror-focused\b/)&&(Q.className+=" CodeMirror-focused");Rb||zb(!0)}na();nb()}}function ia(a){if(Aa){if(v.onBlur)v.onBlur(Y,a);Aa=!1;ib&&I(function(){ib&&(ib(),ib=null)})();Q.className=Q.className.replace(" CodeMirror-focused",
"")}clearInterval(qc);setTimeout(function(){Aa||(za=null)},150)}function ha(a,b,c,d,e){if(!bc){if(xa){var f=[];F.iter(a.line,b.line+1,function(a){f.push(a.text)});for(xa.addChange(a.line,c.length,f);xa.done.length>v.undoDepth;)xa.done.shift()}Yb(a,b,c,d,e)}}function ec(a,b){if(a.length){for(var c=a.pop(),d=[],e=c.length-1;0<=e;e-=1){var f=c[e],g=[],h=f.start+f.added;F.iter(f.start,h,function(a){g.push(a.text)});d.push({start:f.start,added:f.old.length,old:g});var k=W({line:f.start+f.old.length-1,
ch:Ua(g[g.length-1],f.old[f.old.length-1])});Yb({line:f.start,ch:0},{line:h-1,ch:B(h-1).text.length},f.old,k,k)}cb=!0;b.push(d)}}function Yb(a,b,c,d,e){if(!bc){var f=!1,g=jb.length;v.lineWrapping||F.iter(a.line,b.line+1,function(a){if(a.text.length==g)return f=!0});if(a.line!=b.line||1<c.length)Qa=!0;var h=b.line-a.line,k=B(a.line),q=B(b.line);if(0==a.ch&&0==b.ch&&""==c[c.length-1]){var l=[],k=null;a.line?(k=B(a.line-1),k.fixMarkEnds(q)):q.fixMarkStarts();for(var m=0,D=c.length-1;m<D;++m)l.push(n.inheritMarks(c[m],
k));h&&F.remove(a.line,h,Sb);l.length&&F.insert(a.line,l)}else if(k==q)if(1==c.length)k.replace(a.ch,b.ch,c[0]);else{q=k.split(b.ch,c[c.length-1]);k.replace(a.ch,null,c[0]);k.fixMarkEnds(q);l=[];m=1;for(D=c.length-1;m<D;++m)l.push(n.inheritMarks(c[m],k));l.push(q);F.insert(a.line+1,l)}else if(1==c.length)k.replace(a.ch,null,c[0]),q.replace(null,b.ch,""),k.append(q),F.remove(a.line+1,h,Sb);else{l=[];k.replace(a.ch,null,c[0]);q.replace(null,b.ch,c[c.length-1]);k.fixMarkEnds(q);m=1;for(D=c.length-1;m<
D;++m)l.push(n.inheritMarks(c[m],k));1<h&&F.remove(a.line+1,h-1,Sb);F.insert(a.line+1,l)}if(v.lineWrapping){var G=Math.max(5,E.clientWidth/Wb()-3);F.iter(a.line,a.line+c.length,function(a){if(!a.hidden){var b=Math.ceil(a.text.length/G)||1;b!=a.height&&p(a,b)}})}else F.iter(a.line,a.line+c.length,function(a){a=a.text;a.length>g&&(jb=a,g=a.length,kb=null,f=!1)}),f&&(g=0,jb="",kb=null,F.iter(0,F.size,function(a){a=a.text;a.length>g&&(g=a.length,jb=a)}));q=[];h=c.length-h-1;m=0;for(l=La.length;m<l;++m)D=
La[m],D<a.line?q.push(D):D>b.line&&q.push(D+h);m=a.line+Math.min(c.length,500);A(a.line,m);q.push(m);La=q;V(100);Da.push({from:a.line,to:b.line+1,diff:h});a={from:a,to:b,text:c};if(Qb){for(c=Qb;c.next;c=c.next);c.next=a}else Qb=a;sb(d,e,u.from.line<=Math.min(b.line,b.line+h)?u.from.line:u.from.line+h,u.to.line<=Math.min(b.line,b.line+h)?u.to.line:u.to.line+h);E.clientHeight&&(oa.style.height=F.height*Sa()+2*O.offsetTop+"px")}}function X(a,b,c){function d(f){if(h(f,b))return f;if(!h(c,f))return e;
var g=f.line+a.length-(c.line-b.line)-1,k=f.ch;f.line==c.line&&(k+=a[a.length-1].length-(c.ch-(c.line==b.line?b.ch:0)));return{line:g,ch:k}}b=W(b);c=c?W(c):b;a=eb(a);var e;qa(a,b,c,function(a){e=a;return{from:d(u.from),to:d(u.to)}});return e}function Xa(a,b){qa(eb(a),u.from,u.to,function(a){return"end"==b?{from:a,to:a}:"start"==b?{from:u.from,to:u.from}:{from:u.from,to:a}})}function qa(a,b,c,d){d=d({line:b.line+a.length-1,ch:1==a.length?a[0].length+b.ch:a[a.length-1].length});ha(b,c,a,d.from,d.to)}
function fc(a,b){var c=a.line,d=b.line;if(c==d)return B(c).text.slice(a.ch,b.ch);var e=[B(c).text.slice(a.ch)];F.iter(c+1,d,function(a){e.push(a.text)});e.push(B(d).text.slice(0,b.ch));return e.join("\n")}function qb(){return fc(u.from,u.to)}function na(){Db||Hb.set(v.pollInterval,function(){ja();yb();Aa&&na();nc()})}function rb(){function a(){ja();yb()||b?(Db=!1,na()):(b=!0,Hb.set(60,a));nc()}var b=!1;Db=!0;Hb.set(20,a)}function yb(){if(Rb||!Aa||xb(S)||v.readOnly)return!1;var a=S.value;if(a==lb)return!1;
za=null;for(var b=0,c=Math.min(lb.length,a.length);b<c&&lb[b]==a[b];)++b;b<lb.length?u.from={line:u.from.line,ch:u.from.ch-(lb.length-b)}:ac&&U(u.from,u.to)&&(u.to={line:u.to.line,ch:Math.min(B(u.to.line).text.length,u.to.ch+(a.length-b))});Xa(a.slice(b),"end");lb=a;return!0}function zb(a){U(u.from,u.to)?a&&(lb=S.value=""):(lb="",S.value=qb(),bb(S))}function ca(){"nocursor"!=v.readOnly&&S.focus()}function pc(){if(ka.getBoundingClientRect){var a=ka.getBoundingClientRect();if(!L||a.top!=a.bottom){var b=
window.innerHeight||Math.max(document.body.offsetHeight,document.documentElement.offsetHeight);(0>a.top||a.bottom>b)&&ka.scrollIntoView()}}}function Ta(){var a=Z(u.inverted?u.from:u.to),b=v.lineWrapping?Math.min(a.x,O.offsetWidth):a.x;return Kb(b,a.y,b,a.yBot)}function Kb(a,b,c,d){var e=O.offsetLeft,f=O.offsetTop;b+=f;d+=f;a+=e;c+=e;var g=E.clientHeight,h=E.scrollTop,f=!1,k=!0;b<h?(E.scrollTop=Math.max(0,b),f=!0):d>h+g&&(E.scrollTop=d-g,f=!0);b=E.clientWidth;d=E.scrollLeft;g=v.fixedGutter?pa.clientWidth:
0;e=a<g+e+10;a<d+g||e?(e&&(a=0),E.scrollLeft=Math.max(0,a-10-g),f=!0):c>b+d-3&&(E.scrollLeft=c+10-b,f=!0,c>oa.clientWidth&&(k=!1));if(f&&v.onScroll)v.onScroll(Y);return k}function Lb(){var a=Sa(),b=E.scrollTop-O.offsetTop,c=Math.max(0,Math.floor(b/a)),a=Math.ceil((b+E.clientHeight)/a);return{from:w(F,c),to:w(F,a)}}function Ya(a,b){function c(){kb=E.clientWidth;var a=ga.firstChild,b=!1;F.iter(ea,va,function(c){if(!c.hidden){var d=Math.round(a.offsetHeight/q)||1;c.height!=d&&(p(c,d),Qa=b=!0)}a=a.nextSibling});
b&&(oa.style.height=F.height*q+2*O.offsetTop+"px");return b}if(E.clientWidth){var d=Lb();if(!(!0!==a&&0==a.length&&d.from>ea&&d.to<va)){var e=Math.max(d.from-100,0),d=Math.min(F.size,d.to+100);ea<e&&20>e-ea&&(e=ea);va>d&&20>va-d&&(d=Math.min(F.size,va));for(var f=!0===a?[]:Ba([{from:ea,to:va,domStart:0}],a),g=0,h=0;h<f.length;++h){var k=f[h];k.from<e&&(k.domStart+=e-k.from,k.from=e);k.to>d&&(k.to=d);k.from>=k.to?f.splice(h--,1):g+=k.to-k.from}if(g!=d-e||e!=ea||d!=va){f.sort(function(a,b){return a.domStart-
b.domStart});var q=Sa(),g=pa.style.display;ga.style.display="none";gc(e,d,f);ga.style.display=pa.style.display="";(h=e!=ea||d!=va||Dc!=E.clientHeight+q)&&(Dc=E.clientHeight+q);ea=e;va=d;Tb=y(F,e);Zb.style.top=Tb*q+"px";E.clientHeight&&(oa.style.height=F.height*q+2*O.offsetTop+"px");if(ga.childNodes.length!=va-ea)throw Error("BAD PATCH! "+JSON.stringify(f)+" size="+(va-ea)+" nodes="+ga.childNodes.length);v.lineWrapping?c():(null==kb&&(kb=Ra(jb)),kb>E.clientWidth?(O.style.width=kb+"px",oa.style.width=
"",oa.style.width=E.scrollWidth+"px"):O.style.width=oa.style.width="");pa.style.display=g;(h||Qa)&&Mb()&&v.lineWrapping&&c()&&Mb();hc();if(!b&&v.onUpdate)v.onUpdate(Y);return!0}}}else ea=va=Tb=0}function Ba(a,b){for(var c=0,d=b.length||0;c<d;++c){for(var e=b[c],f=[],g=e.diff||0,h=0,k=a.length;h<k;++h){var q=a[h];e.to<=q.from&&e.diff?f.push({from:q.from+g,to:q.to+g,domStart:q.domStart}):e.to<=q.from||e.from>=q.to?f.push(q):(e.from>q.from&&f.push({from:q.from,to:e.from,domStart:q.domStart}),e.to<q.to&&
f.push({from:e.to+g,to:q.to+g,domStart:q.domStart+(e.to-q.from)}))}a=f}return a}function gc(a,b,c){if(c.length){for(var d=function(a){var b=a.nextSibling;a.parentNode.removeChild(a);return b},e=0,f=ga.firstChild,g=0;g<c.length;++g){for(var h=c[g];h.domStart>e;)f=d(f),e++;for(var k=0,h=h.to-h.from;k<h;++k)f=f.nextSibling,e++}for(;f;)f=d(f)}else ga.innerHTML="";var q=c.shift(),f=ga.firstChild,k=a,l=document.createElement("div");F.iter(a,b,function(a){q&&q.to==k&&(q=c.shift());if(!q||q.from>k){if(a.hidden)var b=
l.innerHTML="<pre></pre>";else b="<pre"+(a.className?' class="'+a.className+'"':"")+">"+a.getHTML(Pa)+"</pre>",a.bgClassName&&(b='<div style="position: relative"><pre class="'+a.bgClassName+'" style="position: absolute; left: 0; right: 0; top: 0; bottom: 0; z-index: -2">&#160;</pre>'+b+"</div>");l.innerHTML=b;ga.insertBefore(l.firstChild,f)}else f=f.nextSibling;++k})}function Mb(){if(v.gutter||v.lineNumbers){var a=Zb.offsetHeight,b=E.clientHeight;pa.style.height=(2>a-b?b:a)+"px";var c=[],d=ea,e;F.iter(ea,
Math.max(va,ea+1),function(a){if(a.hidden)c.push("<pre></pre>");else{var b=a.gutterMarker,f=v.lineNumbers?d+v.firstLineNumber:null;b&&b.text?f=b.text.replace("%N%",null!=f?f:""):null==f&&(f="\u00a0");c.push(b&&b.style?'<pre class="'+b.style+'">':"<pre>",f);for(f=1;f<a.height;++f)c.push("<br/>&#160;");c.push("</pre>");b||(e=d)}++d});pa.style.display="none";Gb.innerHTML=c.join("");if(null!=e){for(var a=Gb.childNodes[e-ea],b=String(F.size).length,f=a.textContent||a.innerText||a.nodeValue||"",g="";f.length+
g.length<b;)g+="\u00a0";g&&a.insertBefore(document.createTextNode(g),a.firstChild)}pa.style.display="";a=2<Math.abs((parseInt(O.style.marginLeft)||0)-pa.offsetWidth);O.style.marginLeft=pa.offsetWidth+"px";Qa=!1;return a}}function hc(){var a=U(u.from,u.to),b=Z(u.from,!0),c=a?b:Z(u.to,!0),d=u.inverted?b:c,e=Sa(),f=x(Q),g=x(ga);mb.style.top=Math.max(0,Math.min(E.offsetHeight,d.y+g.top-f.top))+"px";mb.style.left=Math.max(0,Math.min(E.offsetWidth,d.x+g.left-f.left))+"px";if(a)ka.style.top=d.y+"px",ka.style.left=
(v.lineWrapping?Math.min(d.x,O.offsetWidth):d.x)+"px",ka.style.display="",Ja.style.display="none";else{var a=b.y==c.y,h="",k=O.clientWidth||O.offsetWidth,d=O.clientHeight||O.offsetHeight,f=function(a,b,c,d){h+='<div class="CodeMirror-selected" style="position: absolute; left: '+a+"px; top: "+b+"px; "+(N?"width: "+(c?k-c-a:k)+"px":"right: "+c+"px")+"; height: "+d+'px"></div>'};u.from.ch&&0<=b.y&&f(b.x,b.y,a?k-c.x:0,e);b=Math.max(0,b.y+(u.from.ch?e:0));g=Math.min(c.y,d)-b;g>0.2*e&&f(0,b,0,g);a&&u.from.ch||
!(c.y<d-0.5*e)||f(0,c.y,k-c.x,e);Ja.innerHTML=h;ka.style.display="none";Ja.style.display=""}}function ic(a){za=a?za||(u.inverted?u.to:u.from):null}function Na(a,b){var c=za&&W(za);c&&(h(c,a)?a=c:h(b,c)&&(b=c));sb(a,b);kc=!0}function sb(a,b,c,d){mc=null;null==c&&(c=u.from.line,d=u.to.line);if(!U(u.from,a)||!U(u.to,b)){if(h(b,a)){var e=b;b=a;a=e}a.line!=c&&((c=tb(a,c,u.from.ch))?a=c:Vb(a.line,!1));b.line!=d&&(b=tb(b,d,u.to.ch));U(a,b)?u.inverted=!1:U(a,u.to)?u.inverted=!1:U(b,u.from)&&(u.inverted=!0);
if(v.autoClearEmptyLines&&U(u.from,u.to)&&(u.inverted?a:b).line!=u.from.line&&u.from.line<F.size){var f=B(u.from.line);/^\s+$/.test(f.text)&&setTimeout(I(function(){if(f.parent&&/^\s+$/.test(f.text)){var a=t(f);X("",{line:a,ch:0},{line:a,ch:f.text.length})}},10))}u.from=a;u.to=b;gb=!0}}function tb(a,b,c){function d(b){for(var e=a.line+b,g=1==b?F.size:-1;e!=g;){var h=B(e);if(!h.hidden){b=a.ch;if(f||b>c||b>h.text.length)b=h.text.length;return{line:e,ch:b}}e+=b}}var e=B(a.line),f=a.ch==e.text.length&&
a.ch!=c;return e.hidden?a.line>=b?d(1)||d(-1):d(-1)||d(1):a}function Oa(a,b,c){a=W({line:a,ch:b||0});(c?Na:sb)(a,a)}function Ab(a){return Math.max(0,Math.min(a,F.size-1))}function W(a){if(0>a.line)return{line:0,ch:0};if(a.line>=F.size)return{line:F.size-1,ch:B(F.size-1).text.length};var b=a.ch,c=B(a.line).text.length;return null==b||b>c?{line:a.line,ch:c}:0>b?{line:a.line,ch:0}:a}function Nb(a,b){function c(b){if(f==(0>a?0:g.text.length)){if(b=!b)a:{b=e+a;for(var d=0>a?-1:F.size;b!=d;b+=a){var h=
B(b);if(!h.hidden){e=b;g=h;b=!0;break a}}b=void 0}if(b)f=0>a?g.text.length:0;else return!1}else f+=a;return!0}var d=u.inverted?u.from:u.to,e=d.line,f=d.ch,g=B(e);if("char"==b)c();else if("column"==b)c(!0);else if("word"==b)for(d=!1;!(0>a)||c();){if(Ea(g.text.charAt(f)))d=!0;else if(d){0>a&&(a=1,c());break}if(0<a&&!c())break}return{line:e,ch:f}}function Ob(a){for(var b=B(a.line).text,c=a.ch,d=a.ch;0<c&&Ea(b.charAt(c-1));)--c;for(;d<b.length&&Ea(b.charAt(d));)++d;Na({line:a.line,ch:c},{line:a.line,
ch:d})}function jc(a){Na({line:a,ch:0},W({line:a+1,ch:0}))}function ab(a,b){b||(b="add");if("smart"==b)if(aa.indent)var c=ub(a);else b="prev";var d=B(a),e=d.indentation(v.tabSize),f=d.text.match(/^\s*/)[0],g;"prev"==b?g=a?B(a-1).indentation(v.tabSize):0:"smart"==b?g=aa.indent(c,d.text.slice(f.length),d.text):"add"==b?g=e+v.indentUnit:"subtract"==b&&(g=e-v.indentUnit);g=Math.max(0,g);if(g-e){e="";c=0;if(v.indentWithTabs)for(d=Math.floor(g/v.tabSize);d;--d)c+=v.tabSize,e+="\t";for(;c<g;)++c,e+=" "}else{if(u.from.line!=
a&&u.to.line!=a)return;e=f}X(e,{line:a,ch:0},{line:a,ch:f.length})}function Pb(){aa=a.getMode(v,v.mode);F.iter(0,F.size,function(a){a.stateAfter=null});La=[0];V()}function Za(a,b){if(v.lineWrapping){Q.className+=" CodeMirror-wrap";var c=E.clientWidth/Wb()-3;F.iter(0,F.size,function(a){if(!a.hidden){var b=Math.ceil(a.text.length/c)||1;1!=b&&p(a,b)}});O.style.width=oa.style.width=""}else Q.className=Q.className.replace(" CodeMirror-wrap",""),kb=null,jb="",F.iter(0,F.size,function(a){1==a.height||a.hidden||
p(a,1);a.text.length>jb.length&&(jb=a.text)});Da.push({from:0,to:F.size})}function Pa(a){a=v.tabSize-a%v.tabSize;var b=Ec[a];if(b)return b;for(var b='<span class="cm-tab">',c=0;c<a;++c)b+=" ";return Ec[a]={html:b+"</span>",width:a}}function uc(){E.className=E.className.replace(/\s*cm-s-\S+/g,"")+v.theme.replace(/(^|\s)\s*/g," cm-s-")}function Ub(){this.set=[]}function hb(a,b,c){function d(a,b,c,f){B(a).addMark(new l(b,c,f,e))}a=W(a);b=W(b);var e=new Ub;if(!h(a,b))return e;if(a.line==b.line)d(a.line,
a.ch,b.ch,c);else{d(a.line,a.ch,null,c);for(var f=a.line+1,g=b.line;f<g;++f)d(f,null,null,c);d(b.line,null,b.ch,c)}Da.push({from:a.line,to:b.line+1});return e}function Bb(a,b){var c=a,d=a;"number"==typeof a?d=B(Ab(a)):c=t(a);if(null!=c&&b(d,c))Da.push({from:c,to:c+1});else return null;return d}function Vb(a,b){return Bb(a,function(a,c){if(a.hidden!=b){a.hidden=b;p(a,b?0:1);var d=u.from.line,e=u.to.line;if(b&&(d==c||e==c)){d=d==c?tb({line:d,ch:0},d,0):u.from;e=e==c?tb({line:e,ch:0},e,0):u.to;if(!e)return;
sb(d,e)}return Qa=!0}})}function Ra(a){Ia.innerHTML="<pre><span>x</span></pre>";Ia.firstChild.firstChild.firstChild.nodeValue=a;return Ia.firstChild.firstChild.offsetWidth||10}function wb(a,b){if(0==b)return{top:0,left:0};var c=v.lineWrapping&&b<a.text.length&&pb.test(a.text.slice(b-1,b+1));Ia.innerHTML="<pre>"+a.getHTML(Pa,b,Fc,c)+"</pre>";var c=document.getElementById(Fc),d=c.offsetTop,e=c.offsetLeft;L&&(0==d&&0==e)&&(d=document.createElement("span"),d.innerHTML="x",c.parentNode.insertBefore(d,
c.nextSibling),d=d.offsetTop);return{top:d,left:e}}function Z(a,b){var c,d=Sa(),e=d*(y(F,a.line)-(b?Tb:0));if(0==a.ch)c=0;else{var f=wb(B(a.line),a.ch);c=f.left;v.lineWrapping&&(e+=Math.max(0,f.top))}return{x:c,y:e,yBot:e+d}}function Ha(a,b){function c(a){a=wb(h,a);if(q){var b=Math.round(a.top/d);return Math.max(0,a.left+(b-l)*E.clientWidth)}return a.left}0>b&&(b=0);var d=Sa(),e=Wb(),f=Tb+Math.floor(b/d),g=w(F,f);if(g>=F.size)return{line:F.size-1,ch:B(F.size-1).text.length};var h=B(g),k=h.text,q=
v.lineWrapping,l=q?f-y(F,g):0;if(0>=a&&0==l)return{line:g,ch:0};for(var m=f=0,k=k.length,n,e=Math.min(k,Math.ceil((a+0.9*l*E.clientWidth)/e));;){var D=c(e);if(D<=a&&e<k)e=Math.min(k,Math.ceil(1.2*e));else{n=D;k=e;break}}if(a>n)return{line:g,ch:k};e=Math.floor(0.8*k);D=c(e);D<a&&(f=e,m=D);for(;;){if(1>=k-f)return{line:g,ch:n-a>a-m?f:k};e=Math.ceil((f+k)/2);D=c(e);D>a?(k=e,n=D):(f=e,m=D)}}function Sa(){if(null==vb){vb="<pre>";for(var a=0;49>a;++a)vb+="x<br/>";vb+="x</pre>"}a=ga.clientHeight;if(a==Gc)return wc;
Gc=a;Ia.innerHTML=vb;wc=Ia.firstChild.offsetHeight/50||1;Ia.innerHTML="";return wc}function Wb(){if(E.clientWidth==Hc)return Ic;Hc=E.clientWidth;return Ic=Ra("x")}function wa(a,b){var c=x(E,!0),d,e;try{d=a.clientX,e=a.clientY}catch(f){return null}if(!b&&(d-c.left>E.clientWidth||e-c.top>E.clientHeight))return null;c=x(O,!0);return Ha(d-c.left,e-c.top)}function Fb(a){function b(){var a=eb(S.value).join("\n");a!=f&&I(Xa)(a,"end");mb.style.position="relative";S.style.cssText=e;$a&&(E.scrollTop=d);Rb=
!1;zb(!0);na()}var c=wa(a),d=E.scrollTop;if(c&&!window.opera){(U(u.from,u.to)||h(c,u.from)||!h(c,u.to))&&I(Oa)(c.line,c.ch);var e=S.style.cssText;mb.style.position="absolute";S.style.cssText="position: fixed; width: 30px; height: 30px; top: "+(a.clientY-5)+"px; left: "+(a.clientX-5)+"px; z-index: 1000; background: white; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);";Rb=!0;var f=S.value=qb();ca();bb(S);if(la){T(a);var g=J(window,"mouseup",function(){g();
setTimeout(b,20)},!0)}else setTimeout(b,50)}}function nb(){clearInterval(qc);var a=!0;ka.style.visibility="";qc=setInterval(function(){ka.style.visibility=(a=!a)?"":"hidden"},650)}function Cb(a){function b(a,c,d){if(a.text){var e=a.styles;a=g?0:a.text.length-1;for(var f,k=g?0:e.length-2,q=g?e.length:-2;k!=q;k+=2*h){var l=e[k];if(null!=e[k+1]&&e[k+1]!=m)a+=h*l.length;else for(var G=g?0:l.length-1,Rc=g?l.length:-1;G!=Rc;G+=h,a+=h)if(a>=c&&a<d&&D.test(f=l.charAt(G))){var B=xc[f];if(">"==B.charAt(1)==
g)n.push(f);else{if(n.pop()!=B.charAt(0))return{pos:a,match:!1};if(!n.length)return{pos:a,match:!0}}}}}}var c=u.inverted?u.from:u.to,d=B(c.line),e=c.ch-1,f=0<=e&&xc[d.text.charAt(e)]||xc[d.text.charAt(++e)];if(f){f.charAt(0);for(var g=">"==f.charAt(1),h=g?1:-1,k=d.styles,q=e+1,f=0,l=k.length;f<l;f+=2)if(0>=(q-=k[f].length)){var m=k[f+1];break}for(var n=[d.text.charAt(e)],D=/[(){}[\]]/,f=c.line,l=g?Math.min(f+100,F.size):Math.max(-1,f-100);f!=l;f+=h){var d=B(f),G=f==c.line;if(G=b(d,G&&g?e+1:0,G&&!g?
e:d.text.length))break}G||(G={pos:null,match:!1});var m=G.match?"CodeMirror-matchingbracket":"CodeMirror-nonmatchingbracket",p=hb({line:c.line,ch:e},{line:c.line,ch:e+1},m),N=null!=G.pos&&hb({line:f,ch:G.pos},{line:f,ch:G.pos+1},m),c=I(function(){p.clear();N&&N.clear()});a?setTimeout(c,800):ib=c}}function lc(a){var b,c,d=a;for(a-=40;d>a;--d){if(0==d)return 0;var e=B(d-1);if(e.stateAfter)return d;e=e.indentation(v.tabSize);if(null==c||b>e)c=d-1,b=e}return c}function ub(a){var b=lc(a),c=b&&B(b-1).stateAfter,
c=c?e(aa,c):g(aa);F.iter(b,a,function(a){a.highlight(aa,c,v.tabSize);a.stateAfter=e(aa,c)});b<a&&Da.push({from:b,to:a});a<F.size&&!B(a).stateAfter&&La.push(a);return c}function A(a,b){var c=ub(a);F.iter(a,b,function(a){a.highlight(aa,c,v.tabSize);a.stateAfter=e(aa,c)})}function ua(){for(var a=+new Date+v.workTime,b=La.length;La.length;){var c=B(ea).stateAfter?La.pop():ea;if(!(c>=F.size)){var d=lc(c),f=d&&B(d-1).stateAfter,f=f?e(aa,f):g(aa),h=0,k=aa.compareStates,q=!1,l=d,m=!1;F.iter(l,F.size,function(b){var d=
b.stateAfter;if(+new Date>a)return La.push(l),V(v.workDelay),q&&Da.push({from:c,to:l+1}),m=!0;var g=b.highlight(aa,f,v.tabSize);g&&(q=!0);b.stateAfter=e(aa,f);b=null;if(k){var n=d&&k(d,f);n!=ob&&(b=!!n)}null==b&&(!1===g&&d?3<++h&&(!aa.indent||aa.indent(d,"")==aa.indent(f,""))&&(b=!0):h=0);if(b)return!0;++l});if(m)return;q&&Da.push({from:c,to:l+1})}}if(b&&v.onHighlightComplete)v.onHighlightComplete(Y)}function V(a){La.length&&Nc.set(a,I(ua))}function ja(){cb=kc=Qb=null;Da=[];gb=!1;Sb=[]}function nc(){var a=
!1,b;gb&&(a=!Ta());Da.length?b=Ya(Da,!0):(gb&&hc(),Qa&&Mb());a&&Ta();gb&&(pc(),nb());Aa&&(!Rb&&(!0===cb||!1!==cb&&gb))&&zb(kc);gb&&v.matchBrackets&&setTimeout(I(function(){ib&&(ib(),ib=null);U(u.from,u.to)&&Cb(!1)}),20);var c=Qb,a=Sb;if(gb&&v.onCursorActivity)v.onCursorActivity(Y);if(c&&v.onChange&&Y)v.onChange(Y,c);for(c=0;c<a.length;++c)a[c](Y);if(b&&v.onUpdate)v.onUpdate(Y)}function I(a){return function(){Jc++||ja();try{var b=a.apply(this,arguments)}finally{--Jc||nc()}return b}}function yc(a){xa.startCompound();
try{return a()}finally{xa.endCompound()}}var v={},oc=a.defaults,Eb;for(Eb in oc)oc.hasOwnProperty(Eb)&&(v[Eb]=(k&&k.hasOwnProperty(Eb)?k:oc)[Eb]);var Q=document.createElement("div");Q.className="CodeMirror"+(v.lineWrapping?" CodeMirror-wrap":"");Q.innerHTML='<div style="overflow: hidden; position: relative; width: 3px; height: 0px;"><textarea style="position: absolute; padding: 0; width: 1px; height: 1em" wrap="off" autocorrect="off" autocapitalize="off"></textarea></div><div class="CodeMirror-scroll" tabindex="-1"><div style="position: relative"><div style="position: relative"><div class="CodeMirror-gutter"><div class="CodeMirror-gutter-text"></div></div><div class="CodeMirror-lines"><div style="position: relative; z-index: 0"><div style="position: absolute; width: 100%; height: 0; overflow: hidden; visibility: hidden;"></div><pre class="CodeMirror-cursor">&#160;</pre><div style="position: relative; z-index: -1"></div><div></div></div></div></div></div></div>';
f.appendChild?f.appendChild(Q):f(Q);var mb=Q.firstChild,S=mb.firstChild,E=Q.lastChild,oa=E.firstChild,Zb=oa.firstChild,pa=Zb.firstChild,Gb=pa.firstChild,O=pa.nextSibling.firstChild,Ia=O.firstChild,ka=Ia.nextSibling,Ja=ka.nextSibling,ga=Ja.nextSibling;uc();Va&&(S.style.width="0px");sa||(O.draggable=!0);O.style.outline="none";null!=v.tabindex&&(S.tabIndex=v.tabindex);v.autofocus&&ca();v.gutter||v.lineNumbers||(pa.style.display="none");Jb&&(mb.style.height="1px",mb.style.position="absolute");try{Ra("x")}catch(Ka){throw Ka.message.match(/runtime/i)&&
(Ka=Error("A CodeMirror inside a P-style element does not work in Internet Explorer. (innerHTML bug)")),Ka;}var Hb=new Ga,Nc=new Ga,qc,aa,F=new s([new r([new n("")])]),La,Aa;Pb();var u={from:{line:0,ch:0},to:{line:0,ch:0},inverted:!1},za,$b,Ib,rc=0,sc,ac=!1,bc=!1,cb,kc,Da,Qb,gb,Rb,Qa,Sb,Tb=0,ea=0,va=0,Dc=0,ib,jb="",kb,Ec={};I(function(){R(v.value||"");cb=!1})();var xa=new z;J(E,"mousedown",I(function(a){function b(a){var c=wa(a,!0);if(c&&!U(c,f)){Aa||fb();f=c;Na(e,c);cb=!1;var d=Lb();if(c.line>=d.to||
c.line<d.from)g=setTimeout(I(function(){b(a)}),150)}}function c(a){clearTimeout(g);var b=wa(a);b&&Na(e,b);H(a);ca();cb=!0;k();q()}ic(fa(a,"shiftKey"));for(var d=a.target||a.srcElement;d!=Q;d=d.parentNode)if(d.parentNode==oa&&d!=Zb)return;for(d=a.target||a.srcElement;d!=Q;d=d.parentNode)if(d.parentNode==Gb){if(v.onGutterClick)v.onGutterClick(Y,Fa(Gb.childNodes,d)+ea,a);return H(a)}var e=wa(a);switch(ma(a)){case 3:la&&!ta&&Fb(a);return;case 2:e&&Oa(e.line,e.ch,!0);return}if(e){Aa||fb();d=+new Date;
if(Ib&&Ib.time>d-400&&U(Ib.pos,e))return H(a),setTimeout(ca,20),jc(e.line);if($b&&$b.time>d-400&&U($b.pos,e))return Ib={time:d,pos:e},H(a),Ob(e);$b={time:d,pos:e};var f=e,g;if(!v.dragDrop||!cc||v.readOnly||U(u.from,u.to)||h(e,u.from)||h(u.to,e)){H(a);Oa(e.line,e.ch,!0);var k=J(document,"mousemove",I(function(a){clearTimeout(g);H(a);L||ma(a)?b(a):c(a)}),!0),q=J(document,"mouseup",I(c),!0)}else{sa&&(O.draggable=!0);var d=function(b){sa&&(O.draggable=!1);sc=!1;q();l();10>Math.abs(a.clientX-b.clientX)+
Math.abs(a.clientY-b.clientY)&&(H(b),Oa(e.line,e.ch,!0),ca())},q=J(document,"mouseup",I(d),!0),l=J(E,"drop",I(d),!0);sc=!0;O.dragDrop&&O.dragDrop()}}else(a.target||a.srcElement)==E&&H(a)}));J(E,"dblclick",I(function(a){for(var b=a.target||a.srcElement;b!=Q;b=b.parentNode)if(b.parentNode==Gb)return H(a);if(b=wa(a))Ib={time:+new Date,pos:b},H(a),Ob(b)}));J(O,"selectstart",H);la||J(E,"contextmenu",Fb);J(E,"scroll",function(){rc=E.scrollTop;Ya([]);v.fixedGutter&&(pa.style.left=E.scrollLeft+"px");if(v.onScroll)v.onScroll(Y)});
J(window,"resize",function(){Ya(!0)});J(S,"keyup",I(function(a){v.onKeyEvent&&v.onKeyEvent(Y,M(a))||16==fa(a,"keyCode")&&(za=null)}));J(S,"input",rb);J(S,"keydown",I(da));J(S,"keypress",I(function(a){Db&&yb();if(!v.onKeyEvent||!v.onKeyEvent(Y,M(a))){var b=fa(a,"keyCode"),c=fa(a,"charCode");window.opera&&b==vc?(vc=null,H(a)):(window.opera&&!a.which||Jb)&&P(a)||(b=String.fromCharCode(null==c?b:c),v.electricChars&&aa.electricChars&&v.smartIndent&&!v.readOnly&&-1<aa.electricChars.indexOf(b)&&setTimeout(I(function(){ab(u.to.line,
"smart")}),75),dc(a,b)||rb())}}));J(S,"focus",fb);J(S,"blur",ia);if(v.dragDrop){J(O,"dragstart",ya);var Kc=function(a){v.onDragEvent&&v.onDragEvent(Y,M(a))||T(a)};J(E,"dragenter",Kc);J(E,"dragover",Kc);J(E,"drop",I(ra))}J(E,"paste",function(){ca();rb()});J(S,"paste",rb);J(S,"cut",I(function(){v.readOnly||Xa("")}));Jb&&J(oa,"mouseup",function(){document.activeElement==S&&S.blur();ca()});var Lc;try{Lc=document.activeElement==S}catch(Sc){}Lc||v.autofocus?setTimeout(fb,20):ia();var Y=Q.CodeMirror={getValue:function(){var a=
[];F.iter(0,F.size,function(b){a.push(b.text)});return a.join("\n")},setValue:I(R),getSelection:qb,replaceSelection:I(Xa),focus:function(){window.focus();ca();fb();rb()},setOption:function(a,b){var c=v[a];v[a]=b;"mode"==a||"indentUnit"==a?Pb():"readOnly"==a&&"nocursor"==b?(ia(),S.blur()):"readOnly"!=a||b?"theme"==a?uc():"lineWrapping"==a&&c!=b?I(Za)():"tabSize"==a&&Ya(!0):zb(!0);if("lineNumbers"==a||"gutter"==a||"firstLineNumber"==a||"theme"==a)c=v.gutter||v.lineNumbers,pa.style.display=c?"":"none",
c?Qa=!0:ga.parentNode.style.marginLeft=0,Ya(!0)},getOption:function(a){return v[a]},undo:I(function(){ec(xa.done,xa.undone)}),redo:I(function(){ec(xa.undone,xa.done)}),indentLine:I(function(a,b){"string"!=typeof b&&(b=null==b?v.smartIndent?"smart":"prev":b?"add":"subtract");G(a)&&ab(a,b)}),indentSelection:I(function(a){if(U(u.from,u.to))return ab(u.from.line,a);for(var b=u.to.line-(u.to.ch?0:1),c=u.from.line;c<=b;++c)ab(c,a)}),historySize:function(){return{undo:xa.done.length,redo:xa.undone.length}},
clearHistory:function(){xa=new z},matchBrackets:I(function(){Cb(!0)}),getTokenAt:I(function(a){a=W(a);return B(a.line).getTokenAt(aa,ub(a.line),a.ch)}),getStateAfter:function(a){a=Ab(null==a?F.size-1:a);return ub(a+1)},cursorCoords:function(a,b){null==a&&(a=u.inverted);return this.charCoords(a?u.from:u.to,b)},charCoords:function(a,b){a=W(a);if("local"==b)return Z(a,!1);if("div"==b)return Z(a,!0);var c=Z(a,!0),d=x(O);return{x:d.left+c.x,y:d.top+c.y,yBot:d.top+c.yBot}},coordsChar:function(a){var b=
x(O);return Ha(a.x-b.left,a.y-b.top)},markText:I(hb),setBookmark:function(a){a=W(a);var b=new m(a.ch);B(a.line).addMark(b);return b},findMarksAt:function(a){a=W(a);var b=[],c=B(a.line).marked;if(!c)return b;for(var d=0,e=c.length;d<e;++d){var f=c[d];(null==f.from||f.from<=a.ch)&&(null==f.to||f.to>=a.ch)&&b.push(f.marker||f)}return b},setMarker:I(function(a,b,c){"number"==typeof a&&(a=B(Ab(a)));a.gutterMarker={text:b,style:c};Qa=!0;return a}),clearMarker:I(function(a){"number"==typeof a&&(a=B(Ab(a)));
a.gutterMarker=null;Qa=!0}),setLineClass:I(function(a,b,c){return Bb(a,function(a){if(a.className!=b||a.bgClassName!=c)return a.className=b,a.bgClassName=c,!0})}),hideLine:I(function(a){return Vb(a,!0)}),showLine:I(function(a){return Vb(a,!1)}),onDeleteLine:function(a,b){if("number"==typeof a){if(!G(a))return null;a=B(a)}(a.handlers||(a.handlers=[])).push(b);return a},lineInfo:function(a){if("number"==typeof a){if(!G(a))return null;var b=a;a=B(a);if(!a)return null}else if(b=t(a),null==b)return null;
var c=a.gutterMarker;return{line:b,handle:a,text:a.text,markerText:c&&c.text,markerClass:c&&c.style,lineClass:a.className,bgClass:a.bgClassName}},addWidget:function(a,b,c,d,e){a=Z(W(a));var f=a.yBot,g=a.x;b.style.position="absolute";oa.appendChild(b);if("over"==d)f=a.y;else if("near"==d){d=Math.max(E.offsetHeight,F.height*Sa());var h=Math.max(oa.clientWidth,O.clientWidth)-O.offsetLeft;a.yBot+b.offsetHeight>d&&a.y>b.offsetHeight&&(f=a.y-b.offsetHeight);g+b.offsetWidth>h&&(g=h-b.offsetWidth)}b.style.top=
f+O.offsetTop+"px";b.style.left=b.style.right="";"right"==e?(g=oa.clientWidth-b.offsetWidth,b.style.right="0px"):("left"==e?g=0:"middle"==e&&(g=(oa.clientWidth-b.offsetWidth)/2),b.style.left=g+O.offsetLeft+"px");c&&Kb(g,f,g+b.offsetWidth,f+b.offsetHeight)},lineCount:function(){return F.size},clipPos:W,getCursor:function(a){null==a&&(a=u.inverted);return{line:(a?u.from:u.to).line,ch:(a?u.from:u.to).ch}},somethingSelected:function(){return!U(u.from,u.to)},setCursor:I(function(a,b,c){null==b&&"number"==
typeof a.line?Oa(a.line,a.ch,c):Oa(a,b,c)}),setSelection:I(function(a,b,c){(c?Na:sb)(W(a),W(b||a))}),getLine:function(a){if(G(a))return B(a).text},getLineHandle:function(a){if(G(a))return B(a)},setLine:I(function(a,b){G(a)&&X(b,{line:a,ch:0},{line:a,ch:B(a).text.length})}),removeLine:I(function(a){G(a)&&X("",{line:a,ch:0},W({line:a+1,ch:0}))}),replaceRange:I(X),getRange:function(a,b){return fc(W(a),W(b))},triggerOnKeyDown:I(da),execCommand:function(a){return db[a](Y)},moveH:I(function(a,b){var c=
0>a?u.from:u.to;if(za||U(u.from,u.to))c=Nb(a,b);Oa(c.line,c.ch,!0)}),deleteH:I(function(a,b){U(u.from,u.to)?0>a?X("",Nb(a,b),u.to):X("",u.from,Nb(a,b)):X("",u.from,u.to);kc=!0}),moveV:I(function(a,b){var c=0,d=Z(u.inverted?u.from:u.to,!0);null!=mc&&(d.x=mc);"page"==b?c=Math.min(E.clientHeight,window.innerHeight||document.documentElement.clientHeight):"line"==b&&(c=Sa());c=Ha(d.x,d.y+c*a+2);"page"==b&&(E.scrollTop+=Z(c,!0).y-d.y);Oa(c.line,c.ch,!0);mc=d.x}),toggleOverwrite:function(){ac?(ac=!1,ka.className=
ka.className.replace(" CodeMirror-overwrite","")):(ac=!0,ka.className+=" CodeMirror-overwrite")},posFromIndex:function(a){var b=0,c;F.iter(0,F.size,function(d){d=d.text.length+1;if(d>a)return c=a,!0;a-=d;++b});return W({line:b,ch:c})},indexFromPos:function(a){if(0>a.line||0>a.ch)return 0;var b=a.ch;F.iter(0,a.line,function(a){b+=a.text.length+1});return b},scrollTo:function(a,b){null!=a&&(E.scrollLeft=a);null!=b&&(E.scrollTop=b);Ya([])},operation:function(a){return I(a)()},compoundChange:function(a){return yc(a)},
refresh:function(){Ya(!0);E.scrollHeight>rc&&(E.scrollTop=rc)},getInputField:function(){return S},getWrapperElement:function(){return Q},getScrollerElement:function(){return E},getGutterElement:function(){return pa}},vc=null,Cc,Db=!1,lb="",mc=null;Ub.prototype.clear=I(function(){for(var a=Infinity,b=-Infinity,c=0,d=this.set.length;c<d;++c){var e=this.set[c],f=e.marked;if(f&&e.parent)for(e=t(e),a=Math.min(a,e),b=Math.max(b,e),e=0;e<f.length;++e)f[e].marker==this&&f.splice(e--,1)}Infinity!=a&&Da.push({from:a,
to:b+1})});Ub.prototype.find=function(){for(var a,b,c=0,d=this.set.length;c<d;++c)for(var e=this.set[c],f=e.marked,g=0;g<f.length;++g){var h=f[g];if(h.marker==this&&(null!=h.from||null!=h.to)){var k=t(e);null!=k&&(null!=h.from&&(a={line:k,ch:h.from}),null!=h.to&&(b={line:k,ch:h.to}))}}return{from:a,to:b}};var Fc="CodeMirror-temp-"+Math.floor(16777215*Math.random()).toString(16),wc,Gc,vb,Ic,Hc=0,xc={"(":")>",")":"(<","[":"]>","]":"[<","{":"}>","}":"{<"},Jc=0,Xb;for(Xb in Wa)Wa.propertyIsEnumerable(Xb)&&
!Y.propertyIsEnumerable(Xb)&&(Y[Xb]=Wa[Xb]);return Y}function b(a){return"string"==typeof a?da[a]:a}function c(a,c,d,e,f){function g(c){c=b(c);var d=c[a];if(null!=d&&e(d))return!0;if(c.nofallthrough)return f&&f(),!0;c=c.fallthrough;if(null==c)return!1;if("[object Array]"!=Object.prototype.toString.call(c))return g(c);for(var d=0,h=c.length;d<h;++d)if(g(c[d]))return!0;return!1}return c&&g(c)?!0:g(d)}function d(a){a=Ca[fa(a,"keyCode")];return"Ctrl"==a||"Alt"==a||"Shift"==a||"Mod"==a}function e(a,b){if(!0===
b)return b;if(a.copyState)return a.copyState(b);var c={},d;for(d in b){var e=b[d];e instanceof Array&&(e=e.concat([]));c[d]=e}return c}function g(a,b,c){return a.startState?a.startState(b,c):!0}function f(a,b){this.pos=this.start=0;this.string=a;this.tabSize=b||8}function l(a,b,c,d){this.from=a;this.to=b;this.style=c;this.marker=d}function m(a){this.to=this.from=a;this.line=null}function n(a,b){this.styles=b||[a,null];this.text=a;this.height=1;this.stateAfter=this.parent=this.hidden=this.marked=this.gutterMarker=
this.className=this.bgClassName=this.handlers=null}function p(a,b,c,d){for(var e=0,f=0,g=0;f<b;e+=2){var h=c[e],k=f+h.length;0==g?(k>a&&d.push(h.slice(a-f,Math.min(h.length,b-f)),c[e+1]),k>=a&&(g=1)):1==g&&(k>b?d.push(h.slice(0,b-f),c[e+1]):d.push(h,c[e+1]));f=k}}function r(a){this.lines=a;this.parent=null;for(var b=0,c=a.length,d=0;b<c;++b)a[b].parent=this,d+=a[b].height;this.height=d}function s(a){this.children=a;for(var b=0,c=0,d=0,e=a.length;d<e;++d){var f=a[d],b=b+f.chunkSize(),c=c+f.height;
f.parent=this}this.size=b;this.height=c;this.parent=null}function t(a){if(null==a.parent)return null;var b=a.parent;a=Fa(b.lines,a);for(var c=b.parent;c;b=c,c=c.parent)for(var d=0;c.children[d]!=b;++d)a+=c.children[d].chunkSize();return a}function w(a,b){var c=0;a:do{for(var d=0,e=a.children.length;d<e;++d){var f=a.children[d],g=f.height;if(b<g){a=f;continue a}b-=g;c+=f.chunkSize()}return c}while(!a.lines);d=0;for(e=a.lines.length;d<e;++d){f=a.lines[d].height;if(b<f)break;b-=f}return c+d}function y(a,
b){var c=0;a:do{for(var d=0,e=a.children.length;d<e;++d){var f=a.children[d],g=f.chunkSize();if(b<g){a=f;continue a}b-=g;c+=f.height}return c}while(!a.lines);for(d=0;d<b;++d)c+=a.lines[d].height;return c}function z(){this.time=0;this.done=[];this.undone=[];this.compound=0;this.closed=!1}function C(){T(this)}function M(a){a.stop||(a.stop=C);return a}function H(a){a.preventDefault?a.preventDefault():a.returnValue=!1}function P(a){a.stopPropagation?a.stopPropagation():a.cancelBubble=!0}function T(a){H(a);
P(a)}function ma(a){if(a.which)return a.which;if(a.button&1)return 1;if(a.button&2)return 3;if(a.button&4)return 2}function fa(a,b){return a.override&&a.override.hasOwnProperty(b)?a.override[b]:a[b]}function J(a,b,c,d){if("function"==typeof a.addEventListener){if(a.addEventListener(b,c,!1),d)return function(){a.removeEventListener(b,c,!1)}}else{var e=function(a){c(a||window.event)};a.attachEvent("on"+b,e);if(d)return function(){a.detachEvent("on"+b,e)}}}function Ga(){this.id=null}function na(a,b,
c){null==b&&(b=a.search(/[^\s\u00a0]/),-1==b&&(b=a.length));for(var d=0,e=0;d<b;++d)"\t"==a.charAt(d)?e+=c-e%c:++e;return e}function x(a,b){for(var c=a.ownerDocument.body,d=0,e=0,f=!1,g=a;g;g=g.offsetParent){var h=g.offsetLeft,k=g.offsetTop;g==c?(d+=Math.abs(h),e+=Math.abs(k)):(d+=h,e+=k);if(h=b)h=g.currentStyle?g.currentStyle:window.getComputedStyle(g,null),h="fixed"==h.position;h&&(f=!0)}c=b&&!f?null:c;for(g=a.parentNode;g!=c;g=g.parentNode)null!=g.scrollLeft&&(d-=g.scrollLeft,e-=g.scrollTop);return{left:d,
top:e}}function bb(a){Va?(a.selectionStart=0,a.selectionEnd=a.value.length):a.select()}function U(a,b){return a.line==b.line&&a.ch==b.ch}function h(a,b){return a.line<b.line||a.line==b.line&&a.ch<b.ch}function ha(a){ia.textContent=a;return ia.innerHTML}function Ua(a,b){if(!b)return 0;if(!a)return b.length;for(var c=a.length,d=b.length;0<=c&&0<=d&&a.charAt(c)==b.charAt(d);--c,--d);return d+1}function Fa(a,b){if(a.indexOf)return a.indexOf(b);for(var c=0,d=a.length;c<d;++c)if(a[c]==b)return c;return-1}
function Ea(a){return/\w/.test(a)||a.toUpperCase()!=a.toLowerCase()}a.defaults={value:"",mode:null,theme:"default",indentUnit:2,indentWithTabs:!1,smartIndent:!0,tabSize:4,keyMap:"default",extraKeys:null,electricChars:!0,autoClearEmptyLines:!1,onKeyEvent:null,onDragEvent:null,lineWrapping:!1,lineNumbers:!1,gutter:!1,fixedGutter:!1,firstLineNumber:1,readOnly:!1,dragDrop:!0,onChange:null,onCursorActivity:null,onGutterClick:null,onHighlightComplete:null,onUpdate:null,onFocus:null,onBlur:null,onScroll:null,
matchBrackets:!1,workTime:100,workDelay:200,pollInterval:100,undoDepth:40,tabindex:null,autofocus:null};var Va=/AppleWebKit/.test(navigator.userAgent)&&/Mobile\/\w+/.test(navigator.userAgent),ta=Va||/Mac/.test(navigator.platform);/Win/.test(navigator.platform);var Ba=a.modes={},qa=a.mimeModes={};a.defineMode=function(b,c){a.defaults.mode||"null"==b||(a.defaults.mode=b);if(2<arguments.length){c.dependencies=[];for(var d=2;d<arguments.length;++d)c.dependencies.push(arguments[d])}Ba[b]=c};a.defineMIME=
function(a,b){qa[a]=b};a.resolveMode=function(b){if("string"==typeof b&&qa.hasOwnProperty(b))b=qa[b];else if("string"==typeof b&&/^[\w\-]+\/[\w\-]+\+xml$/.test(b))return a.resolveMode("application/xml");return"string"==typeof b?{name:b}:b||{name:"null"}};a.getMode=function(b,c){c=a.resolveMode(c);var d=Ba[c.name];return d?d(b,c):a.getMode(b,"text/plain")};a.listModes=function(){var a=[],b;for(b in Ba)Ba.propertyIsEnumerable(b)&&a.push(b);return a};a.listMIMEs=function(){var a=[],b;for(b in qa)qa.propertyIsEnumerable(b)&&
a.push({mime:b,mode:qa[b]});return a};var Wa=a.extensions={};a.defineExtension=function(a,b){Wa[a]=b};var db=a.commands={selectAll:function(a){a.setSelection({line:0,ch:0},{line:a.lineCount()-1})},killLine:function(a){var b=a.getCursor(!0),c=a.getCursor(!1),d=!U(b,c);d||a.getLine(b.line).length!=b.ch?a.replaceRange("",b,d?c:{line:b.line}):a.replaceRange("",b,{line:b.line+1,ch:0})},deleteLine:function(a){var b=a.getCursor().line;a.replaceRange("",{line:b,ch:0},{line:b})},undo:function(a){a.undo()},
redo:function(a){a.redo()},goDocStart:function(a){a.setCursor(0,0,!0)},goDocEnd:function(a){a.setSelection({line:a.lineCount()-1},null,!0)},goLineStart:function(a){a.setCursor(a.getCursor().line,0,!0)},goLineStartSmart:function(a){var b=a.getCursor(),c=a.getLine(b.line),c=Math.max(0,c.search(/\S/));a.setCursor(b.line,b.ch<=c&&b.ch?0:c,!0)},goLineEnd:function(a){a.setSelection({line:a.getCursor().line},null,!0)},goLineUp:function(a){a.moveV(-1,"line")},goLineDown:function(a){a.moveV(1,"line")},goPageUp:function(a){a.moveV(-1,
"page")},goPageDown:function(a){a.moveV(1,"page")},goCharLeft:function(a){a.moveH(-1,"char")},goCharRight:function(a){a.moveH(1,"char")},goColumnLeft:function(a){a.moveH(-1,"column")},goColumnRight:function(a){a.moveH(1,"column")},goWordLeft:function(a){a.moveH(-1,"word")},goWordRight:function(a){a.moveH(1,"word")},delCharLeft:function(a){a.deleteH(-1,"char")},delCharRight:function(a){a.deleteH(1,"char")},delWordLeft:function(a){a.deleteH(-1,"word")},delWordRight:function(a){a.deleteH(1,"word")},
indentAuto:function(a){a.indentSelection("smart")},indentMore:function(a){a.indentSelection("add")},indentLess:function(a){a.indentSelection("subtract")},insertTab:function(a){a.replaceSelection("\t","end")},transposeChars:function(a){var b=a.getCursor(),c=a.getLine(b.line);0<b.ch&&b.ch<c.length-1&&a.replaceRange(c.charAt(b.ch)+c.charAt(b.ch-1),{line:b.line,ch:b.ch-1},{line:b.line,ch:b.ch+1})},newlineAndIndent:function(a){a.replaceSelection("\n","end");a.indentLine(a.getCursor().line)},toggleOverwrite:function(a){a.toggleOverwrite()}},
da=a.keyMap={};da.basic={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharRight",Backspace:"delCharLeft",Tab:"insertTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite"};da.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Alt-Up":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Down":"goDocEnd",
"Ctrl-Left":"goWordLeft","Ctrl-Right":"goWordRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delWordLeft","Ctrl-Delete":"delWordRight","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore",fallthrough:"basic"};da.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd",
"Cmd-Down":"goDocEnd","Alt-Left":"goWordLeft","Alt-Right":"goWordRight","Cmd-Left":"goLineStart","Cmd-Right":"goLineEnd","Alt-Backspace":"delWordLeft","Ctrl-Alt-Backspace":"delWordRight","Alt-Delete":"delWordRight","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore",fallthrough:["basic","emacsy"]};da["default"]=ta?da.macDefault:da.pcDefault;da.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft",
"Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Alt-F":"goWordRight","Alt-B":"goWordLeft","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageUp","Shift-Ctrl-V":"goPageDown","Ctrl-D":"delCharRight","Ctrl-H":"delCharLeft","Alt-D":"delWordRight","Alt-Backspace":"delWordLeft","Ctrl-K":"killLine","Ctrl-T":"transposeChars"};a.fromTextArea=function(b,c){function d(){b.value=h.getValue()}c||(c={});c.value=b.value;!c.tabindex&&b.tabindex&&(c.tabindex=b.tabindex);null==c.autofocus&&null!=b.getAttribute("autofocus")&&
(c.autofocus=!0);if(b.form){var e=J(b.form,"submit",d,!0);if("function"==typeof b.form.submit){var f=b.form.submit,g=function(){d();b.form.submit=f;b.form.submit();b.form.submit=g};b.form.submit=g}}b.style.display="none";var h=a(function(a){b.parentNode.insertBefore(a,b.nextSibling)},c);h.save=d;h.getTextArea=function(){return b};h.toTextArea=function(){d();b.parentNode.removeChild(h.getWrapperElement());b.style.display="";b.form&&(e(),"function"==typeof b.form.submit&&(b.form.submit=f))};return h};
a.copyState=e;a.startState=g;f.prototype={eol:function(){return this.pos>=this.string.length},sol:function(){return 0==this.pos},peek:function(){return this.string.charAt(this.pos)},next:function(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)},eat:function(a){var b=this.string.charAt(this.pos);if("string"==typeof a?b==a:b&&(a.test?a.test(b):a(b)))return++this.pos,b},eatWhile:function(a){for(var b=this.pos;this.eat(a););return this.pos>b},eatSpace:function(){for(var a=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;
return this.pos>a},skipToEnd:function(){this.pos=this.string.length},skipTo:function(a){a=this.string.indexOf(a,this.pos);if(-1<a)return this.pos=a,!0},backUp:function(a){this.pos-=a},column:function(){return na(this.string,this.start,this.tabSize)},indentation:function(){return na(this.string,null,this.tabSize)},match:function(a,b,c){if("string"==typeof a){if((c?this.string.toLowerCase():this.string).indexOf(c?a.toLowerCase():a,this.pos)==this.pos)return!1!==b&&(this.pos+=a.length),!0}else return(a=
this.string.slice(this.pos).match(a))&&!1!==b&&(this.pos+=a[0].length),a},current:function(){return this.string.slice(this.start,this.pos)}};a.StringStream=f;l.prototype={attach:function(a){this.marker.set.push(a)},detach:function(a){a=Fa(this.marker.set,a);-1<a&&this.marker.set.splice(a,1)},split:function(a,b){return this.to<=a&&null!=this.to?null:new l(this.from<a||null==this.from?null:this.from-a+b,null==this.to?null:this.to-a+b,this.style,this.marker)},dup:function(){return new l(null,null,this.style,
this.marker)},clipTo:function(a,b,c,d,e){a&&d>this.from&&(d<this.to||null==this.to)?this.from=null:null!=this.from&&this.from>=b&&(this.from=Math.max(d,this.from)+e);c&&(b<this.to||null==this.to)&&(b>this.from||null==this.from)?this.to=null:null!=this.to&&this.to>b&&(this.to=d<this.to?this.to+e:b)},isDead:function(){return null!=this.from&&null!=this.to&&this.from>=this.to},sameSet:function(a){return this.marker==a.marker}};m.prototype={attach:function(a){this.line=a},detach:function(a){this.line==
a&&(this.line=null)},split:function(a,b){if(a<this.from)return this.from=this.to=this.from-a+b,this},isDead:function(){return this.from>this.to},clipTo:function(a,b,c,d,e){(a||b<this.from)&&(c||d>this.to)?(this.from=0,this.to=-1):this.from>b&&(this.from=this.to=Math.max(d,this.from)+e)},sameSet:function(a){return!1},find:function(){return this.line&&this.line.parent?{line:t(this.line),ch:this.from}:null},clear:function(){if(this.line){var a=Fa(this.line.marked,this);-1!=a&&this.line.marked.splice(a,
1);this.line=null}}};n.inheritMarks=function(a,b){var c=new n(a),d=b&&b.marked;if(d)for(var e=0;e<d.length;++e)if(null==d[e].to&&d[e].style){var f=c.marked||(c.marked=[]),g=d[e].dup();f.push(g);g.attach(c)}return c};n.prototype={replace:function(a,b,c){var d=[],e=this.marked,f=null==b?this.text.length:b;p(0,a,this.styles,d);c&&d.push(c,null);p(f,this.text.length,this.styles,d);this.styles=d;this.text=this.text.slice(0,a)+c+this.text.slice(f);this.stateAfter=null;if(e)for(c=c.length-(f-a),d=0;d<e.length;++d){var g=
e[d];g.clipTo(null==a,a||0,null==b,f,c);g.isDead()&&(g.detach(this),e.splice(d--,1))}},split:function(a,b){var c=[b,null],d=this.marked;p(a,this.text.length,this.styles,c);c=new n(b+this.text.slice(a),c);if(d)for(var e=0;e<d.length;++e){var f=d[e],g=f.split(a,b.length);g&&(c.marked||(c.marked=[]),c.marked.push(g),g.attach(c),g==f&&d.splice(e--,1))}return c},append:function(a){var b=this.text.length,c=a.marked,d=this.marked;this.text+=a.text;p(0,a.text.length,a.styles,this.styles);if(d)for(a=0;a<d.length;++a)null==
d[a].to&&(d[a].to=b);if(c&&c.length)a:for(d||(this.marked=d=[]),a=0;a<c.length;++a){var e=c[a];if(!e.from)for(var f=0;f<d.length;++f){var g=d[f];if(g.to==b&&g.sameSet(e)){g.to=null==e.to?null:e.to+b;g.isDead()&&(g.detach(this),c.splice(a--,1));continue a}}d.push(e);e.attach(this);e.from+=b;null!=e.to&&(e.to+=b)}},fixMarkEnds:function(a){var b=this.marked;a=a.marked;if(b)for(var c=0;c<b.length;++c){var d=b[c],e=null==d.to;if(e&&a)for(var f=0;f<a.length;++f)if(a[f].sameSet(d)){e=!1;break}e&&(d.to=this.text.length)}},
fixMarkStarts:function(){var a=this.marked;if(a)for(var b=0;b<a.length;++b)null==a[b].from&&(a[b].from=0)},addMark:function(a){a.attach(this);null==this.marked&&(this.marked=[]);this.marked.push(a);this.marked.sort(function(a,b){return(a.from||0)-(b.from||0)})},highlight:function(a,b,c){c=new f(this.text,c);var d=this.styles,e=0,g=!1,h=d[0],l;for(""==this.text&&a.blankLine&&a.blankLine(b);!c.eol();){var m=a.token(c,b),n=this.text.slice(c.start,c.pos);c.start=c.pos;e&&d[e-1]==m?d[e-2]+=n:n&&(!g&&(d[e+
1]!=m||e&&d[e-2]!=l)&&(g=!0),d[e++]=n,d[e++]=m,l=h,h=d[e]);if(5E3<c.pos){d[e++]=this.text.slice(c.pos);d[e++]=null;break}}d.length!=e&&(d.length=e,g=!0);e&&d[e-2]!=l&&(g=!0);return g||(5>d.length&&10>this.text.length?null:!1)},getTokenAt:function(a,b,c){for(var d=new f(this.text);d.pos<c&&!d.eol();){d.start=d.pos;var e=a.token(d,b)}return{start:d.start,end:d.pos,string:d.current(),className:e||null,state:b}},indentation:function(a){return na(this.text,null,a)},getHTML:function(a,b,c,d){function e(b,
c){if(b){h&&(L&&" "==b.charAt(0))&&(b="\u00a0"+b.slice(1));h=!1;if(-1==b.indexOf("\t")){k+=b.length;var d=ha(b)}else for(var d="",f=0;;){var l=b.indexOf("\t",f);if(-1==l){d+=ha(b.slice(f));k+=b.length-f;break}else{k+=l-f;var m=a(k),d=d+(ha(b.slice(f,l))+m.html);k+=m.width;f=l+1}}c?g.push('<span class="',c,'">',d,"</span>"):g.push(d)}}function f(a){return a?"cm-"+a.replace(/ +/g," cm-"):null}var g=[],h=!0,k=0,l=e;if(null!=b)var m=0,n='<span id="'+c+'">',l=function(a,c){var f=a.length;b>=m&&b<m+f?(b>
m&&(e(a.slice(0,b-m),c),d&&g.push("<wbr>")),g.push(n),e(a.slice(b-m),c),g.push("</span>"),b--,m+=f):(m+=f,e(a,c),m==b&&m==r?g.push(n+"</span>"):m>b+10&&/\s/.test(a)&&(l=function(){}))};c=this.styles;var p=this.text,N=this.marked,r=p.length;if(p||null!=b)if(N&&N.length)for(var s=0,p=0,t="",w=N[0].from||0,y=[],x=0,z=function(){for(var a;x<N.length&&((a=N[x]).from==s||null==a.from);)null!=a.style&&y.push(a),++x;w=x<N.length?N[x].from:Infinity;for(a=0;a<y.length;++a){var b=y[a].to||Infinity;b==s?y.splice(a--,
1):w=Math.min(b,w)}};s<r;){w==s&&z();for(var ba=Math.min(r,w);;){if(t){for(var sa=s+t.length,ya=H,C=0;C<y.length;++C)ya=(ya?ya+" ":"")+y[C].style;l(sa>ba?t.slice(0,ba-s):t,ya);if(sa>=ba){t=t.slice(ba-s);s=ba;break}s=sa}t=c[p++];H=f(c[p++])}}else for(t=p=0;t<r;p+=2){var z=c[p],H=c[p+1],ba=z.length;t+ba>r&&(z=z.slice(0,r-t));t+=ba;l(z,f(H))}else l(" ");return g.join("")},cleanUp:function(){this.parent=null;if(this.marked)for(var a=0,b=this.marked.length;a<b;++a)this.marked[a].detach(this)}};r.prototype=
{chunkSize:function(){return this.lines.length},remove:function(a,b,c){for(var d=a,e=a+b;d<e;++d){var f=this.lines[d];this.height-=f.height;f.cleanUp();if(f.handlers)for(var g=0;g<f.handlers.length;++g)c.push(f.handlers[g])}this.lines.splice(a,b)},collapse:function(a){a.splice.apply(a,[a.length,0].concat(this.lines))},insertHeight:function(a,b,c){this.height+=c;L?this.lines=this.lines.slice(0,a).concat(b).concat(this.lines.slice(a)):this.lines.splice.apply(this.lines,[a,0].concat(b));a=0;for(c=b.length;a<
c;++a)b[a].parent=this},iterN:function(a,b,c){for(b=a+b;a<b;++a)if(c(this.lines[a]))return!0}};s.prototype={chunkSize:function(){return this.size},remove:function(a,b,c){this.size-=b;for(var d=0;d<this.children.length;++d){var e=this.children[d],f=e.chunkSize();if(a<f){var g=Math.min(b,f-a),h=e.height;e.remove(a,g,c);this.height-=h-e.height;f==g&&(this.children.splice(d--,1),e.parent=null);if(0==(b-=g))break;a=0}else a-=f}25>this.size-b&&(a=[],this.collapse(a),this.children=[new r(a)],this.children[0].parent=
this)},collapse:function(a){for(var b=0,c=this.children.length;b<c;++b)this.children[b].collapse(a)},insert:function(a,b){for(var c=0,d=0,e=b.length;d<e;++d)c+=b[d].height;this.insertHeight(a,b,c)},insertHeight:function(a,b,c){this.size+=b.length;this.height+=c;for(var d=0,e=this.children.length;d<e;++d){var f=this.children[d],g=f.chunkSize();if(a<=g){f.insertHeight(a,b,c);if(f.lines&&50<f.lines.length){for(;50<f.lines.length;)a=f.lines.splice(f.lines.length-25,25),a=new r(a),f.height-=a.height,this.children.splice(d+
1,0,a),a.parent=this;this.maybeSpill()}break}a-=g}},maybeSpill:function(){if(!(10>=this.children.length)){var a=this;do{var b=a.children.splice(a.children.length-5,5),b=new s(b);if(a.parent){a.size-=b.size;a.height-=b.height;var c=Fa(a.parent.children,a);a.parent.children.splice(c+1,0,b)}else c=new s(a.children),c.parent=a,a.children=[c,b],a=c;b.parent=a.parent}while(10<a.children.length);a.parent.maybeSpill()}},iter:function(a,b,c){this.iterN(a,b-a,c)},iterN:function(a,b,c){for(var d=0,e=this.children.length;d<
e;++d){var f=this.children[d],g=f.chunkSize();if(a<g){g=Math.min(b,g-a);if(f.iterN(a,g,c))return!0;if(0==(b-=g))break;a=0}else a-=g}}};z.prototype={addChange:function(a,b,c){this.undone.length=0;var d=+new Date,e=this.done[this.done.length-1],f=e&&e[e.length-1],g=d-this.time;if(this.compound&&e&&!this.closed)e.push({start:a,added:b,old:c});else if(400<g||!f||this.closed||f.start>a+c.length||f.start+f.added<a)this.done.push([{start:a,added:b,old:c}]),this.closed=!1;else{for(var e=Math.max(0,f.start-
a),g=Math.max(0,a+c.length-(f.start+f.added)),h=e;0<h;--h)f.old.unshift(c[h-1]);for(h=g;0<h;--h)f.old.push(c[c.length-h]);e&&(f.start=a);f.added+=b-(c.length-e-g)}this.time=d},startCompound:function(){this.compound++||(this.closed=!0)},endCompound:function(){--this.compound||(this.closed=!0)}};a.e_stop=T;a.e_preventDefault=H;a.e_stopPropagation=P;a.connect=J;Ga.prototype={set:function(a,b){clearTimeout(this.id);this.id=setTimeout(b,a)}};var ob=a.Pass={toString:function(){return"CodeMirror.Pass"}},
la=/gecko\/\d{7}/i.test(navigator.userAgent),L=/MSIE \d/.test(navigator.userAgent),$a=/MSIE [1-8]\b/.test(navigator.userAgent),N=L&&5==document.documentMode,sa=/WebKit\//.test(navigator.userAgent),ba=/Chrome\//.test(navigator.userAgent),ya=/Apple Computer/.test(navigator.vendor),Jb=/KHTML\//.test(navigator.userAgent),cc=function(){if($a)return!1;var a=document.createElement("div");return"draggable"in a||"dragDrop"in a}();(function(){var a=document.createElement("textarea");a.value="foo\nbar";return-1<
a.value.indexOf("\r")?"\r\n":"\n"})();var pb=/^$/;la?pb=/$'/:ya?pb=/\-[^ \-?]|\?[^ !'\"\),.\-\/:;\?\]\}]/:ba&&(pb=/\-[^ \-\.?]|\?[^ \-\.?\]\}:;!'\"\),\/]|[\.!\"#&%\)*+,:;=>\]|\}~][\(\{\[<]|\$'/);null!=document.documentElement.getBoundingClientRect&&(x=function(a,b){try{var c=a.getBoundingClientRect(),c={top:c.top,left:c.left}}catch(d){c={top:0,left:0}}if(!b)if(null==window.pageYOffset){var e=document.documentElement||document.body.parentNode;null==e.scrollTop&&(e=document.body);c.top+=e.scrollTop;
c.left+=e.scrollLeft}else c.top+=window.pageYOffset,c.left+=window.pageXOffset;return c});var ia=document.createElement("pre");"\na"==ha("a")?ha=function(a){ia.textContent=a;return ia.innerHTML.slice(1)}:"\t"!=ha("\t")&&(ha=function(a){ia.innerHTML="";ia.appendChild(document.createTextNode(a));return ia.innerHTML});a.htmlEscape=ha;var eb=3!="\n\nb".split(/\n/).length?function(a){for(var b=0,c,d=[];-1<(c=a.indexOf("\n",b));)d.push(a.slice(b,"\r"==a.charAt(c-1)?c-1:c)),b=c+1;d.push(a.slice(b));return d}:
function(a){return a.split(/\r?\n/)};a.splitLines=eb;var xb=window.getSelection?function(a){try{return a.selectionStart!=a.selectionEnd}catch(b){return!1}}:function(a){try{var b=a.ownerDocument.selection.createRange()}catch(c){}return b&&b.parentElement()==a?0!=b.compareEndPoints("StartToEnd",b):!1};a.defineMode("null",function(){return{token:function(a){a.skipToEnd()}}});a.defineMIME("text/plain","null");var Ca={3:"Enter",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",
20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",91:"Mod",92:"Mod",93:"Mod",127:"Delete",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",63276:"PageUp",63277:"PageDown",63275:"End",63273:"Home",63234:"Left",63232:"Up",63235:"Right",63233:"Down",63302:"Insert",63272:"Delete"};a.keyNames=Ca;(function(){for(var a=0;10>a;a++)Ca[a+48]=String(a);for(a=
65;90>=a;a++)Ca[a]=String.fromCharCode(a);for(a=1;12>=a;a++)Ca[a+111]=Ca[a+63235]="F"+a})();return a}();(function(){function a(a){b(a,e,"warning",!0);b(a,g,"error");var c;a:{c=a.description;for(var f=0;f<d.length;f++)if(-1!==c.indexOf(d[f])){c=!0;break a}c=!1}return c?null:a}function b(a,b,c,d){var e,f,g;e=a.description;for(var t=0;t<b.length;t++){f=b[t];g="string"===typeof f?f:f[0];f="string"===typeof f?null:f[1];g=-1!==e.indexOf(g);if(d||g)a.severity=c;g&&f&&(a.description=f)}}function c(b,c){for(var d=
0;d<b.length;d++){var e=b[d];if(e){var g;g=[];if(e.evidence){var r=g[e.line];if(!r){var s=e.evidence,r=[];Array.prototype.forEach.call(s,function(a,b){"\t"===a&&r.push(b+1)});g[e.line]=r}if(0<r.length){var t=e.character;r.forEach(function(a){t>a&&(t-=1)});e.character=t}}var s=e.character-1,w=s+1;e.evidence&&(g=e.evidence.substring(s).search(/.\b/),-1<g&&(w+=g));e.description=e.reason;e.start=e.character;e.end=w;(e=a(e))&&c.push({message:e.description,severity:e.severity,from:f.Pos(e.line-1,s),to:f.Pos(e.line-
1,w)})}}}var d=["Dangerous comment"],e=[["Expected '{'","Statement body should be inside '{ }' braces."]],g="Missing semicolon;Extra comma;Missing property name;Unmatched ; and instead saw; is not defined;Unclosed string;Stopping, unable to continue".split(";");f.javascriptValidatorWithOptions=function(a){return function(b){JSHINT(b,a);b=JSHINT.data().errors;var d=[];b&&c(b,d);return d}};f.javascriptValidator=f.javascriptValidatorWithOptions(null)})();f.defineMode("javascript",function(a,b){function c(a,
b){for(var c=!1,d;null!=(d=a.next());){if(d==b&&!c)return!1;c=!c&&"\\"==d}return c}function d(a,b,c){da=a;ob=c;return b}function e(a,b){var e=a.next();if('"'==e||"'"==e)return e=g(e),b.tokenize=e,e(a,b);if(/[\[\]{}\(\),;\:\.]/.test(e))return d(e);if("0"==e&&a.eat(/x/i))return a.eatWhile(/[\da-f]/i),d("number","number");if(/\d/.test(e)||"-"==e&&a.eat(/\d/))return a.match(/^\d*(?:\.\d*)?(?:[eE][+\-]?\d+)?/),d("number","number");if("/"==e){if(a.eat("*"))return e=k,b.tokenize=e,e(a,b);if(a.eat("/"))return a.skipToEnd(),
d("comment","comment");if("operator"==b.lastType||"keyword c"==b.lastType||/^[\[{}\(,;:]$/.test(b.lastType))return c(a,"/"),a.eatWhile(/[gimy]/),d("regexp","string-2");a.eatWhile(db);return d("operator",null,a.current())}if("#"==e)return a.skipToEnd(),d("error","error");if(db.test(e))return a.eatWhile(db),d("operator",null,a.current());a.eatWhile(/[\w\$_]/);var e=a.current(),f=Wa.propertyIsEnumerable(e)&&Wa[e];return f&&"."!=b.lastType?d(f.type,f.style,e):d("variable","variable",e)}function g(a){return function(b,
f){c(b,a)||(f.tokenize=e);return d("string","string")}}function k(a,b){for(var c=!1,f;f=a.next();){if("/"==f&&c){b.tokenize=e;break}c="*"==f}return d("comment","comment")}function l(a,b,c,d,e,f){this.indented=a;this.column=b;this.type=c;this.prev=e;this.info=f;null!=d&&(this.align=d)}function m(){for(var a=arguments.length-1;0<=a;a--)L.cc.push(arguments[a])}function n(){m.apply(null,arguments);return!0}function p(a){function b(c){for(;c;c=c.next)if(c.name==a)return!0;return!1}var c=L.state;c.context?
(L.marked="def",b(c.localVars)||(c.localVars={name:a,next:c.localVars})):b(c.globalVars)||(c.globalVars={name:a,next:c.globalVars})}function r(){L.state.context={prev:L.state.context,vars:L.state.localVars};L.state.localVars=$a}function s(){L.state.localVars=L.state.context.vars;L.state.context=L.state.context.prev}function t(a,b){var c=function(){var c=L.state;c.lexical=new l(c.indented,L.stream.column(),a,null,c.lexical,b)};c.lex=!0;return c}function w(){var a=L.state;a.lexical.prev&&(")"==a.lexical.type&&
(a.indented=a.lexical.indented),a.lexical=a.lexical.prev)}function y(a){return function(b){return b==a?n():";"==a?m():n(arguments.callee)}}function z(a){return"var"==a?n(t("vardef"),bb,y(";"),w):"keyword a"==a?n(t("form"),C,z,w):"keyword b"==a?n(t("form"),z,w):"{"==a?n(t("}"),Ga,w):";"==a?n():"function"==a?n(Ea):"for"==a?n(t("form"),y("("),t(")"),h,y(")"),w,z,w):"variable"==a?n(t("stat"),P):"switch"==a?n(t("form"),C,t("}","switch"),y("{"),Ga,w,w):"case"==a?n(C,y(":")):"default"==a?n(y(":")):"catch"==
a?n(t("form"),r,y("("),Va,y(")"),z,w,s):m(t("stat"),C,y(";"),w)}function C(a){return la.hasOwnProperty(a)?n(H):"function"==a?n(Ea):"keyword c"==a?n(M):"("==a?n(t(")"),M,y(")"),w,H):"operator"==a?n(C):"["==a?n(t("]"),J(C,"]"),w,H):"{"==a?n(t("}"),J(ma,"}"),w,H):n()}function M(a){return a.match(/[;\}\)\],]/)?m():m(C)}function H(a,b){if("operator"==a)return/\+\+|--/.test(b)?n(H):"?"==b?n(C,y(":"),C):n(C);if(";"!=a){if("("==a)return n(t(")"),J(C,")"),w,H);if("."==a)return n(T,H);if("["==a)return n(t("]"),
C,y("]"),w,H)}}function P(a){return":"==a?n(w,z):m(H,y(";"),w)}function T(a){if("variable"==a)return L.marked="property",n()}function ma(a,b){if("variable"==a){if(L.marked="property","get"==b||"set"==b)return n(fa)}else if("number"==a||"string"==a)L.marked=a+" property";if(la.hasOwnProperty(a))return n(y(":"),C)}function fa(a){if(":"==a)return n(C);if("variable"!=a)return n(y(":"),C);L.marked="property";return n(Ea)}function J(a,b){function c(d){return","==d?n(a,c):d==b?n():n(y(b))}return function(d){return d==
b?n():m(a,c)}}function Ga(a){return"}"==a?n():m(z,Ga)}function na(a){return":"==a?n(x):m()}function x(a){return"variable"==a?(L.marked="variable-3",n()):m()}function bb(a,b){return"variable"==a?(p(b),qa?n(na,U):n(U)):m()}function U(a,b){if("="==b)return n(C,U);if(","==a)return n(bb)}function h(a){return"var"==a?n(bb,y(";"),Ua):";"==a?n(Ua):"variable"==a?n(ha):n(Ua)}function ha(a,b){return"in"==b?n(C):n(H,Ua)}function Ua(a,b){return";"==a?n(Fa):"in"==b?n(C):n(C,y(";"),Fa)}function Fa(a){")"!=a&&n(C)}
function Ea(a,b){if("variable"==a)return p(b),n(Ea);if("("==a)return n(t(")"),r,J(Va,")"),w,z,s)}function Va(a,b){if("variable"==a)return p(b),qa?n(na):n()}var ta=a.indentUnit,Ba=b.json,qa=b.typescript,Wa=function(){function a(b){return{type:b,style:"keyword"}}var b=a("keyword a"),c=a("keyword b"),d=a("keyword c"),e=a("operator"),f={type:"atom",style:"atom"},b={"if":b,"while":b,"with":b,"else":c,"do":c,"try":c,"finally":c,"return":d,"break":d,"continue":d,"new":d,"delete":d,"throw":d,"var":a("var"),
"const":a("var"),let:a("var"),"function":a("function"),"catch":a("catch"),"for":a("for"),"switch":a("switch"),"case":a("case"),"default":a("default"),"in":e,"typeof":e,"instanceof":e,"true":f,"false":f,"null":f,undefined:f,NaN:f,Infinity:f,"this":a("this")};if(qa){var c={type:"variable",style:"variable-3"},c={"interface":a("interface"),"class":a("class"),"extends":a("extends"),constructor:a("constructor"),"public":a("public"),"private":a("private"),"protected":a("protected"),"static":a("static"),
"super":a("super"),string:c,number:c,bool:c,any:c},g;for(g in c)b[g]=c[g]}return b}(),db=/[+\-*&%=<>!?|~^]/,da,ob,la={atom:!0,number:!0,variable:!0,string:!0,regexp:!0,"this":!0},L={state:null,column:null,marked:null,cc:null},$a={name:"this",next:{name:"arguments"}};w.lex=!0;return{startState:function(a){return{tokenize:e,lastType:null,cc:[],lexical:new l((a||0)-ta,0,"block",!1),localVars:b.localVars,globalVars:b.globalVars,context:b.localVars&&{vars:b.localVars},indented:0}},token:function(a,b){a.sol()&&
(b.lexical.hasOwnProperty("align")||(b.lexical.align=!1),b.indented=a.indentation());if(a.eatSpace())return null;var c=b.tokenize(a,b);if("comment"==da)return c;b.lastType=da;a:{var d=da,e=ob,f=b.cc;L.state=b;L.stream=a;L.marked=null;L.cc=f;b.lexical.hasOwnProperty("align")||(b.lexical.align=!0);for(;;)if((f.length?f.pop():Ba?C:z)(d,e)){for(;f.length&&f[f.length-1].lex;)f.pop()();if(L.marked){c=L.marked;break a}if(d="variable"==d)b:{for(d=b.localVars;d;d=d.next)if(d.name==e){d=!0;break b}d=void 0}if(d){c=
"variable-2";break a}break a}c=void 0}return c},indent:function(a,b){if(a.tokenize==k)return f.Pass;if(a.tokenize!=e)return 0;var c=b&&b.charAt(0),d=a.lexical;"stat"==d.type&&"}"==c&&(d=d.prev);var g=d.type,h=c==g;return"vardef"==g?d.indented+("operator"==a.lastType||","==a.lastType?4:0):"form"==g&&"{"==c?d.indented:"form"==g?d.indented+ta:"stat"==g?d.indented+("operator"==a.lastType||","==a.lastType?ta:0):"switch"!=d.info||h?d.align?d.column+(h?0:1):d.indented+(h?0:ta):d.indented+(/^(?:case|default)\b/.test(b)?
ta:2*ta)},electricChars:":{}",jsonMode:Ba}});f.defineMIME("text/javascript","javascript");f.defineMIME("text/ecmascript","javascript");f.defineMIME("application/javascript","javascript");f.defineMIME("application/ecmascript","javascript");f.defineMIME("application/json",{name:"javascript",json:!0});f.defineMIME("text/typescript",{name:"javascript",typescript:!0});f.defineMIME("application/typescript",{name:"javascript",typescript:!0});Ext.define("Ext.ux.form.field.CodeMirror",{extend:"Ext.Component",
alias:"widget.jseditor",alternateClassName:"Ext.form.CodeMirror",requires:["Ext.tip.QuickTipManager","Ext.toolbar.Item","Ext.util.Format"],width:"100%",mode:"text/javascript",showLineNumbers:!0,enableMatchBrackets:!0,enableElectricChars:!1,enableIndentWithTabs:!0,enableSmartIndent:!0,enableLineWrapping:!1,enableLineNumbers:!0,enableFixedGutter:!1,firstLineNumber:1,readOnly:!1,pollInterval:100,indentUnit:4,tabSize:4,theme:"default",scriptsLoaded:[],lastMode:"",initComponent:function(){var a=this;a.callParent(arguments);
a.on("resize",function(){a.editor&&a.editor.refresh()},a)},resetOriginalValue:Ext.emptyFn,isValid:function(){return 0===(this.getErrors()||[]).length},afterRender:function(){this.callParent(arguments);this.initEditor()},initEditor:function(){var a=this;a.editor=f(a.el.dom,{matchBrackets:a.enableMatchBrackets,electricChars:a.enableElectricChars,autoClearEmptyLines:!0,indentUnit:a.indentUnit,smartIndent:a.enableSmartIndent,indentWithTabs:a.indentWithTabs,pollInterval:a.pollInterval,lineNumbers:a.enableLineNumbers,
lineWrapping:a.enableLineWrapping,firstLineNumber:a.firstLineNumber,tabSize:a.tabSize,gutters:["CodeMirror-lint-markers"],fixedGutter:a.enableFixedGutter,theme:a.theme,mode:"javascript",lintWith:f.javascriptValidatorWithOptions({onecase:!0,asi:!0,expr:!0,loopfunc:!0,laxbreak:!0,debug:!0,laxcomma:!0,smarttabs:!0}),onChange:function(b,d){a.checkValid()},onCursorActivity:function(b){a.fireEvent("cursoractivity",a)},onGutterClick:function(b,d,e){a.fireEvent("gutterclick",a,d,e)},onFocus:function(b){a.fireEvent("activate",
a)},onBlur:function(b,d){a.fireEvent("deactivate",a);a.onBlur(d)},onScroll:function(b){a.fireEvent("scroll",a)},onHighlightComplete:function(b){a.fireEvent("highlightcomplete",a)},onUpdate:function(b){a.fireEvent("update",a)},onKeyEvent:function(b,d){d.cancelBubble=!0;a.fireEvent("keyevent",a,d)}});a.setReadOnly(a.readOnly);a.fireEvent("initialize",a);var b=Ext.util.CSS.getRule(".CodeMirror");b&&(b.style.height="100%",b.style.position="relative",b.style.overflow="hidden");if(b=Ext.util.CSS.getRule(".CodeMirror-Scroll"))b.style.height=
"100%"},checkValid:function(){0<(this.getErrors()||[]).length?this.addCls("siesta-invalid-syntax"):this.removeCls("siesta-invalid-syntax")},getErrors:function(){},relayBtnCmd:function(a){this.relayCmd(a.getItemId())},relayCmd:function(a){Ext.defer(function(){this.editor.focus();switch(a){case "justifycenter":f.extensions.autoIndentRange?this.doIndentSelection():this.loadDependencies(this.extensions.format,this.pathExtensions,this.doIndentSelection,this);break;case "insertorderedlist":this.doChangeLineNumbers()}},
10,this)},doChangeLineNumbers:function(){this.enableLineNumbers=!this.enableLineNumbers;this.editor.setOption("lineNumbers",this.enableLineNumbers)},doIndentSelection:function(){this.reloadExtentions();try{var a=this.editor.getCursor(!0),b=this.editor.getCursor(!1);this.editor.autoIndentRange(a,b)}catch(c){}},setReadOnly:function(a){this.editor&&this.editor.setOption("readOnly",a)},onDisable:function(){this.bodyEl.mask();this.callParent(arguments)},onEnable:function(){this.bodyEl.unmask();this.callParent(arguments)},
setValue:function(a){this.editor&&this.editor.setValue(a||"");return this},getSubmitValue:function(){return this.getValue()},getRawValue:function(){return this.getValue()},getValue:function(){return this.editor?this.editor.getValue()||"":""},onDestroy:function(){if(this.rendered){for(var a in this.editor)this.editor.hasOwnProperty(a)&&delete this.editor[a];Ext.destroyMembers("tb","toolbarWrap","editorEl")}this.callParent()},commentLine:function(){function a(a){k=b.getLine(a);k.match(/^\s*\/\/\s*/)?
(k=k.replace(/\s*\/\/\s*/,""),f=!0):k=k.substr(0,k.indexOf(Ext.String.trim(k)))+"// "+Ext.String.trim(k);b.setLine(a,k)}var b=this.editor,c=b.getCursor(!0),d=b.getCursor(!1),e=c.line,f=!1;if(c.line===d.line&&c.ch===d.ch)a(c.line);else if(0==c.character){for(;e!=d.line;)a(e),e=b.getLine(++e);b.selectLines(c.line,c.ch,d.line,d.ch)}else{var k=b.getSelection();k.match(/^\/\*/)&&k.match(/^\/\*/)?(k=k.substring(2,k.length-2),f=!0):k="/*"+k+"*/";b.replaceSelection(k)}f&&b.autoIndentRange({line:0},{line:b.lineCount()})}});
Ext.define("Siesta.Recorder.Editor.ActionName",{extend:"Ext.form.field.ComboBox",alias:"widget.typeeditor",displayField:"id",valueField:"id",queryMode:"local",matchFieldWidth:!1,forceSelection:!0,typeAhead:!0,selectOnFocus:!0,actions:[{id:"click",type:"mouseinput"},{id:"dblclick",type:"mouseinput"},{id:"contextmenu",type:"mouseinput"},{id:"drag",type:"mouseinput"},{id:"fn",type:"fn"},{id:"moveCursorTo",type:"mouseinput"},{id:"moveCursorBy",type:"mouseinput"},{id:"type",type:"keyinput"}],initComponent:function(){this.store=
new Ext.data.JsonStore({fields:["id","type"]});this.callParent()},applyChanges:function(a){a.setAction(this.getValue())},populate:function(a){var b=[],c;for(c in a)c.match(/waitFor.+/)&&"function"===typeof a[c]&&b.push({id:c,type:"wait"});a=this.actions.concat(b).sort(function(a,b){return a.id<b.id?-1:1});this.store.loadData(a)}});Ext.define("Siesta.Recorder.Editor.Target",{extend:"Ext.form.field.ComboBox",alias:"widget.targeteditor",enableKeyEvents:!0,queryMode:"local",valueField:"type",displayField:"value",
cls:"siesta-targeteditor",targetProperty:"target",initComponent:function(){Ext.apply(this,{store:new Ext.data.Store({proxy:"memory",fields:["type","value","target"]})});this.callParent()},getTarget:function(){var a=this.getValue();return a&&/^!!(.+)/.exec(a)?(a=this.store.findRecord("type",a))?a.get("target"):null:a?{type:"user",target:a}:null},setValue:function(a){a instanceof Siesta.Recorder.Target?a.getTarget()?this.callParent(["!!"+a.getTarget().type]):this.callParent([""]):this.callParent(arguments)},
getEditorValue:function(a){return a.data[this.targetProperty]},applyChanges:function(a){var b=this.getValue(),c,d=a.data[this.targetProperty];b&&!d&&(d=a.data[this.targetProperty]=new Siesta.Recorder.Target({targets:[{type:"user",target:b}]}));d&&(b&&(c=/^!!(.+)/.exec(b))?d.activeTarget=c[1]:d.setUserTarget(b))},populate:function(a){var b=[];a&&a.targets.forEach(function(a){var d=a.type;value=a.target;"cq"===d&&(value=0<a.target.indexOf("->")?a.target.split("->").splice(1,0,">>").join():">>"+a.target);
b.push({type:"!!"+d,value:value,target:a})});this.store.loadData(b)}});Ext.define("Siesta.Recorder.Editor.Code",{extend:"Ext.ux.form.field.CodeMirror",xtype:"codeeditor",height:100,cls:"siesta-recorder-codeeditor",listeners:{afterrender:function(){this.editor.focus()},delay:50},applyChanges:function(a){a.set("value",this.getValue())},getEditorValue:function(a){return a.get("value")},getErrors:function(){var a=this.getValue();if(a)try{new Function(a)}catch(b){return[Siesta.Resource("Siesta.Recorder.Editor.Code",
"invalidSyntax")]}return this.callParent(arguments)}});Ext.define("Siesta.Recorder.Editor.DragTarget",{extend:"Ext.form.field.Picker",alias:"widget.drageditor",editable:!1,hideTrigger:!0,pickerOffset:[0,-20],sourceEditor:null,targetEditor:null,onTargetChange:null,listeners:{focus:function(a,b,c){a.expand()}},cancelEdit:function(){this.fireEvent("blur");this.collapse()},applyValues:function(){var a=this.picker.getForm().getValues(),b=this.up("gridpanel").editing.activeRecord;this.sourceEditor.applyChanges(b);
this.targetEditor.applyChanges(b);a=a.by;b.set("by",a&&b.parseOffset(a)||a);this.fireEvent("blur");this.collapse()},applyChanges:function(){},collapseIf:function(a){if(!a.getTarget(".x-layer"))return this.callParent(arguments)},mimicBlur:function(a){if(!a.getTarget(".x-layer"))return this.callParent(arguments)},createPicker:function(){var a=Siesta.Resource("Siesta.Recorder.Editor.DragTarget"),b=this,c={select:this.onTargetChange,keyup:this.onTargetChange,focus:this.onTargetChange,buffer:50,scope:this};
return new Ext.form.Panel({ownerCt:this,renderTo:document.body,floating:!0,bodyPadding:5,title:a.get("dragVariantTitle"),items:[this.sourceEditor=new Siesta.Recorder.Editor.Target({fieldLabel:a.get("targetLabel")+":",anchor:"100%",name:"target",labelWidth:60,listeners:c}),this.targetEditor=new Siesta.Recorder.Editor.Target({targetProperty:"toTarget",fieldLabel:a.get("toLabel")+":",name:"toTarget",anchor:"100%",labelWidth:60,listeners:c}),{xtype:"textfield",name:"by",fieldLabel:a.get("byLabel")+":",
labelWidth:60,width:200}],listeners:{afterrender:function(a,c){var f=a.up("gridpanel").editing.activeRecord;b.sourceEditor.populate(f.get("target"));b.targetEditor.populate(f.get("toTarget"));a.getForm().setValues(f.data)}},buttons:[{name:"cancel",text:a.get("cancelButtonText"),handler:function(a,c,f){b.cancelEdit()}},"->",{name:"save",text:a.get("saveButtonText"),handler:function(a,c,f){b.applyValues()}}]})}});Ext.define("Siesta.Recorder.Editor.MoveCursorTarget",{extend:"Ext.form.field.Picker",alias:"widget.movecursoreditor",
editable:!1,hideTrigger:!0,pickerOffset:[0,-20],targetEditor:null,onTargetChange:null,listeners:{focus:function(a,b,c){a.expand()}},cancelEdit:function(){this.fireEvent("blur");this.collapse()},applyValues:function(){var a=this.picker.getForm().getValues(),b=this.up("gridpanel").editing.activeRecord;this.targetEditor.applyChanges(b);a=a.by;b.set("by",a&&b.parseOffset(a)||a);this.fireEvent("blur");this.collapse()},applyChanges:function(){},collapseIf:function(a){if(!a.getTarget(".x-layer"))return this.callParent(arguments)},
mimicBlur:function(a){if(!a.getTarget(".x-layer"))return this.callParent(arguments)},createPicker:function(){var a=Siesta.Resource("Siesta.Recorder.Editor.DragTarget"),b=this,c={select:this.onTargetChange,keyup:this.onTargetChange,focus:this.onTargetChange,buffer:50,scope:this};return new Ext.form.Panel({ownerCt:this,renderTo:document.body,floating:!0,bodyPadding:5,title:a.get("moveCursorVariantTitle"),items:[this.targetEditor=new Siesta.Recorder.Editor.Target({targetProperty:"toTarget",fieldLabel:a.get("toLabel")+
":",name:"toTarget",anchor:"100%",labelWidth:60,listeners:c}),this.byEditor=new Ext.form.field.Text({name:"by",fieldLabel:a.get("byLabel")+":",labelWidth:60,width:200})],listeners:{afterrender:function(a,c){var f=a.up("gridpanel").editing.activeRecord;b.targetEditor.populate(f.get("toTarget"));a.getForm().setValues(f.data)}},buttons:[{name:"cancel",text:a.get("cancelButtonText"),handler:function(a,c,f){b.cancelEdit()}},"->",{name:"save",text:a.get("saveButtonText"),handler:function(a,c,f){b.applyValues()}}]})}});
Ext.define("Siesta.Recorder.UI.TargetColumn",{extend:"Ext.grid.Column",alias:"widget.targetcolumn",header:Siesta.Resource("Siesta.Recorder.UI.TargetColumn","headerText"),dataIndex:"target",flex:1,sortable:!1,menuDisabled:!0,field:{},tdCls:"eventview-targetcolumn",highlightTarget:null,renderer:function(a,b,c){a="";b=(c.data.action||"").toLowerCase();var d="movecursor"===b;if(c.hasTarget()||d){var e=c.getTarget();if(e||d)if(a=d?"":e.target,e&&"cq"==e.type&&(a=">>"+a),"drag"===b||d)b=Siesta.Resource("Siesta.Recorder.UI.TargetColumn"),
d=c.data.toTarget,c=c.data.by,!d||!d.targets.length||d.isTooGeneric()&&c?c&&(a+=" "+b.get("by")+": ["+c+"]"):a+=" "+b.get("to")+": "+d.getTarget().target}else a=c.get("value");return a},setTargetEditor:function(a){a=this.getTargetEditor(a);if(!a)return!1;this.setEditor(a)},getTargetEditor:function(a){var b=this,c=a.get("action");if(c.match(/^waitFor/)){if("waitForAnimations"===c)return null;if("waitForFn"===c)return new Siesta.Recorder.Editor.Code;this.dataIndex="value";return"waitForMs"===c?new Ext.form.field.Number:
new Ext.form.field.Text}if("drag"===c)return this.dataIndex="target",new Siesta.Recorder.Editor.DragTarget({onTargetChange:function(){b.onTargetChange.apply(b,arguments)}});if("moveCursor"===c)return this.dataIndex="target",new Siesta.Recorder.Editor.MoveCursorTarget({onTargetChange:function(){b.onTargetChange.apply(b,arguments)}});if("fn"===c)return this.dataIndex="value",new Siesta.Recorder.Editor.Code;if("type"===c)return this.dataIndex="value",new Ext.form.field.Text;this.dataIndex="target";c=
new Siesta.Recorder.Editor.Target({listeners:{select:this.onTargetChange,keyup:this.onTargetChange,focus:this.onTargetChange,buffer:50,scope:this}});c.populate(a.data.target);return c},onTargetChange:function(a){var b=a.getTarget();if(b){var c=b.target;"cq"==b.type&&(c=">>"+c);b=this.highlightTarget(c);b.success?a.clearInvalid():a.markInvalid(b.message)}}});Ext.define("Siesta.Recorder.UI.EventView",{extend:"Ext.grid.Panel",alias:"widget.eventview",cls:"siesta-eventview",editing:null,test:null,enableColumnMove:!1,
typeEditor:null,highlightTarget:function(){return{success:!0}},initComponent:function(){var a=this,b=Siesta.Resource("Siesta.Recorder.UI.EventView");a.plugins=a.plugins||[];a.editing=new Ext.grid.plugin.CellEditing({clicksToEdit:1,startEdit:function(b,d,e){this.completeEdit();d="number"===typeof d?a.headerCt.items.getAt(d):d;return"targetcolumn"===d.xtype&&(b="number"===typeof b?a.store.getAt(b):b,!1===d.setTargetEditor(b))?void 0:Ext.grid.plugin.CellEditing.prototype.startEdit.apply(this,arguments)}});
a.editing.on({beforeedit:a.onBeforeEdit,validateedit:a.onValidateEdit,edit:a.afterEdit,canceledit:a.afterEdit,scope:a});a.editing.on({beforeedit:function(){this.typeEditor.populate(a.test)},scope:a});this.relayEvents(a.editing,["beforeedit","afteredit","validateedit"]);a.plugins.push(a.editing);Ext.apply(a,{viewConfig:{forceFit:!0,markDirty:!1,stripeRows:!1,allowCopy:!0,plugins:"gridviewdragdrop"},columns:[{header:b.get("actionColumnHeader"),dataIndex:"action",width:100,sortable:!1,menuDisabled:!0,
tdCls:"eventview-typecolumn",editor:this.typeEditor=new Siesta.Recorder.Editor.ActionName},new Siesta.Recorder.UI.TargetColumn({cellEditing:a.editing,highlightTarget:this.highlightTarget}),{header:b.get("offsetColumnHeader"),dataIndex:"__offset__",width:50,sortable:!1,menuDisabled:!0,tdCls:"eventview-offsetcolumn",renderer:function(a,b,e){if((a=e.getTarget())&&a.offset)return a.offset+'<div class="eventview-clearoffset"></div>'},editor:{}},{xtype:"actioncolumn",width:18,sortable:!1,menuDisabled:!0,
tdCls:"eventview-actioncolumn",items:[{iconCls:"icon-delete",handler:function(b,d,e){a.editing.completeEdit();b.store.removeAt(d)}}]}]});this.callParent()},scrollToBottom:function(){this.view.rendered&&(this.view.el.dom.scrollTop=this.view.el.dom.scrollHeight)},onBeforeEdit:function(a,b){return"__offset__"!==b.field||b.record.isMouseAction()},afterEdit:function(a,b){if("action"===b.field){var c=b.column.field.store;c.clearFilter();c.getById(b.value).get("type")!==c.getById(b.originalValue).get("type")&&
b.record.resetValues()}},onValidateEdit:function(a,b){var c=b.value;"__offset__"===b.field?(b.cancel=!0,c?(c=b.record.parseOffset(c))&&b.record.setTargetOffset(c):b.record.clearTargetOffset()):b.column.getEditor().applyChanges&&(b.cancel=!0,b.column.getEditor().applyChanges(b.record));b.cancel&&(this.afterEdit(a,b),this.getView().refreshNode(b.record))},afterRender:function(){this.callParent(arguments);var a=this.view;a.el.on({mousedown:function(b,c){var d=a.getRecord(a.findItemByChild(c));d.clearTargetOffset();
this.getView().refreshNode(d);b.stopEvent()},scope:this,delegate:".eventview-clearoffset"})}});Ext.define("Siesta.Recorder.UI.RecorderPanel",{extend:"Ext.panel.Panel",alias:"widget.recorderpanel",layout:"fit",buttonAlign:"left",border:!1,bodyBorder:!1,newActionDefaults:{action:"click"},eventView:null,test:null,recorder:null,harness:null,domContainer:null,recorderConfig:null,initComponent:function(){var a=this;this.store=new Ext.data.Store({proxy:"memory",model:"Siesta.Recorder.Model.Action"});a.createToolbars();
a.items=this.eventView=new Siesta.Recorder.UI.EventView({border:!1,itemId:"eventView",store:a.store,highlightTarget:Ext.Function.bind(a.highlightTarget,a)});this.eventView.on({beforeedit:function(b,d){"target"===d.column.dataIndex&&a.domContainer.startInspection(!1)}});this.eventView.on({afteredit:this.onAfterEventViewEdit,validateedit:this.onAfterEventViewEdit,canceledit:this.onAfterEventViewEdit,scope:this,buffer:200});var b=a.recorder=a.recorder||new Siesta.Recorder.Recorder(this.recorderConfig||
{});b.on("actionadd",this.onActionAdded,this);b.on("actionremove",this.onActionRemoved,this);b.on("actionupdate",this.onActionUpdated,this);b.on("clear",this.onRecorderClear,this);b.on("start",this.onRecorderStart,this);b.on("stop",this.onRecorderStop,this);a.callParent();this.mon(Ext.getBody(),"mousedown",this.onBodyMouseDown,this,{delegate:".target-inspector-label"});this.on("hide",function(){var b=a.getEventView();b&&b.editing&&b.editing.completeEdit()})},onAfterEventViewEdit:function(){this.eventView.editing.getActiveEditor()||
this.hideHighlighter()},onBodyMouseDown:function(a,b){var c=document.activeElement;Ext.fly(c).up(".siesta-targeteditor")&&(a.stopEvent(),a.preventDefault(),c.value=Ext.htmlDecode(b.innerHTML))},onRecorderStart:function(){this.fireEvent("startrecord",this);this.addCls("recorder-recording")},onRecorderStop:function(){this.fireEvent("stoprecord",this);this.removeCls("recorder-recording")},hideHighlighter:function(){this.test&&this.domContainer.clearHighlight()},highlightTarget:function(a){if(a){var b=
this.test;if(!b)return this.hideHighlighter(),{success:!0};var c=Siesta.Resource("Siesta.Recorder.UI.RecorderPanel"),d,e;try{d=this.test.normalizeElement(a,!0,!0,!0),e=d.el}catch(f){}finally{if(!e)return{success:!1,warning:c.get("queryMatchesNothing")}}d=d.matchingMultiple?c.get("queryMatchesMultiple"):"";b.isElementVisible(e)?this.domContainer.highlightTarget(e,'<span class="target-inspector-label">'+a+"</span>"):d=d||c.get("noVisibleElsFound");return{success:!d,message:d}}this.hideHighlighter()},
createToolbars:function(){var a=this,b=Siesta.Resource("Siesta.Recorder.UI.RecorderPanel");a.tbar={cls:"siesta-toolbar",height:45,defaults:{scale:"medium",tooltipType:"title",scope:a},items:[{iconCls:"recorder-tool-icon icon-record",action:"recorder-start",cls:"recorder-tool",whenIdle:!0,tooltip:b.get("recordTooltip"),handler:a.onRecordClick},{iconCls:"recorder-tool-icon",glyph:58916,cls:"recorder-tool",action:"recorder-stop",handler:a.stop,tooltip:b.get("stopTooltip")},{iconCls:"recorder-tool-icon",
glyph:58895,action:"recorder-play",cls:"recorder-tool",handler:a.onPlayClick,tooltip:b.get("playTooltip")},{iconCls:"recorder-tool-icon",glyph:58884,action:"recorder-remove-all",cls:"recorder-tool icon-clear",handler:function(){0!==this.store.getCount()&&Ext.Msg.confirm(b.get("removeAllPromptTitle"),b.get("removeAllPromptMessage"),function(b){"yes"==b&&a.clear();this.close()})},tooltip:b.get("clearTooltip")},"->",{text:"Generate code",action:"recorder-generate-code",handler:function(){(new Ext.Window({title:b.get("codeWindowTitle"),
layout:"fit",height:400,width:600,autoScroll:!0,autoShow:!0,constrain:!0,closeAction:"destroy",items:{xtype:"jseditor",mode:"text/javascript"}})).items.first().setValue("t.chain(\n    "+a.generateCodeForSteps().join(",\n\n    ")+"\n);")}},{text:"+",action:"recorder-add-step",tooltip:b.get("addNewTooltip"),tooltipType:"title",scope:a,handler:function(){if(a.test){var c=a.store,d=a.getEventView(),e=d.getSelectionModel().selected.first(),f=new c.model(new Siesta.Recorder.Action(this.newActionDefaults));
e?c.insert(c.indexOf(e)+1,f):c.add(f);d.editing.startEdit(f,0)}else Ext.Msg.alert(b.get("noTestDetected"),b.get("noTestStarted"))}},a.closeButton]};a.bbar={xtype:"component",cls:"cheatsheet",height:70,html:'<table><tr><td class="cheatsheet-type">CSS Query:</td><td class="cheatsheet-sample"> .x-btn</td></tr><tr><td class="cheatsheet-type">Component Query:</td><td class="cheatsheet-sample"> &gt;&gt;toolbar button</td></tr><tr><td class="cheatsheet-type">Composite Query:</td><td class="cheatsheet-sample"> toolbar =&gt; .x-btn</td></tr></table>'}},
attachTo:function(a,b){var c=this.test&&this.test.url!==a.url;this.setTest(a);var d=b?b.contentWindow:a.scopeProvider.scope;d&&this.recorder.attach(d);c&&this.clear()},getEventView:function(){return this.eventView},onRecordClick:function(){var a=this.test,b=Siesta.Resource("Siesta.Recorder.UI.RecorderPanel");this.recorder&&a&&a.global?(this.attachTo(a),this.recorder.start()):Ext.Msg.alert("Error",b.get("noTestStarted"))},onPlayClick:function(){var a=this,b=this.test;if(a.recorder&&b&&(a.recorder.stop(),
0<a.store.getCount())){var c=this.harness,d=function(b,c){a.setTest(c);c.chain(a.generateSteps())};c.on("teststart",function(a,c){if(c.url===b.url)c.on("beforetestfinalizeearly",d,null,{single:!0})},null,{single:!0});c.launch([c.getScriptDescriptor(b.url)])}},stop:function(){this.recorder.stop()},clear:function(){this.recorder.clear()},onRecorderClear:function(){this.store.removeAll()},setTest:function(a){this.test=a;this.eventView.test=a},generateSteps:function(a){var b=[],c=this.test;this.store.each(function(a){(a=
a.asStep(c))&&b.push(a)},this);return b},onActionAdded:function(a,b){var c=new Siesta.Recorder.Model.Action(b);this.store.add(c);this.getEventView().scrollToBottom()},onActionRemoved:function(a,b){this.store.remove(this.store.getById(b.id));this.getEventView().scrollToBottom()},onActionUpdated:function(a,b){this.store.getById(b.id).callJoined("afterEdit",[["target","action","__offset__"]])},generateCodeForSteps:function(){var a=[];this.store.each(function(b){(b=b.asCode())&&a.push(b)},this);return a},
getActions:function(a){var b=this.store.getRange();return a?Ext.Array.pluck(b,"data"):b},onDestroy:function(){this.recorder.stop();this.callParent(arguments)}})}Siesta.Harness.meta.extend({override:{launch:function(){if(10<this.flattenDescriptors(this.descriptors).length)throw window.alert("Sorry, trial version only allows test suites with no more than 10 files"),"Sorry, trial version only allows test suites with no more than 10 files";this.SUPERARG(arguments)},onTestUpdate:function(a,b){if(30<a.assertCount)throw window.alert("Sorry, trial version only allows 30 assertions per test file"),
"Sorry, trial version only allows 30 assertions per test file";this.SUPERARG(arguments)}}});Siesta.Harness.Browser.UI.Viewport.override({initComponent:function(){this.on("render",function(){var a=this.harness,b=this.el;Ext.Function.defer(function(){b.down("> .x-box-inner").setOpacity(0.35,{duration:2E3,callback:function(){b.mask("Sorry, trial version only allows 10 minutes of work per harness launch").setStyle("z-index",1E4)}});a.descriptors=[];a.descriptorsById={}},6E5);b.createChild({tag:"a",href:"http://www.bryntum.com/store/siesta",
title:"Click here to purchase a license",style:"display:block;height:54px;width:230px;background: #fff url(http://www.bryntum.com/site-images/bryntum-trial.png) no-repeat;z-index:10000;border:1px solid #ddd;-webkit-box-shadow: 2px 2px 2px rgba(100, 100, 100, 0.5);-moz-box-shadow: 2px 2px 2px rgba(100, 100, 100, 0.5);-moz-border-radius:5px;-webkit-border-radius:5px;position:absolute;bottom:10px;right:15px;"});try{if(Ext.util.Cookies.get("tbmeval")){var c=Ext.util.Cookies.get("tbmeval"),d=new Date(parseInt(c,
10));Ext.Date.add(d,Ext.Date.DAY,45)<new Date&&(a.descriptors=[],a.descriptorsById={},b.mask("Trial Period Expired!").setStyle("z-index",1E4))}else Ext.util.Cookies.set("tbmeval",(new Date).getTime(),Ext.Date.add(new Date,Ext.Date.YEAR,2))}catch(e){}},this);this.callOverridden()}})})();
